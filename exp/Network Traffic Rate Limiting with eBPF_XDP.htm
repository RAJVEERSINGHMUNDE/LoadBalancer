<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Network Traffic Rate Limiting with eBPF/XDP</title><link nonce="" rel="stylesheet" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/inter.css"><link nonce="" rel="stylesheet" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">hr[data-v-34b8dd49]{border-top:var(--prose-hr-width) var(--prose-hr-style) var(--prose-hr-color);margin:var(--prose-hr-margin)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><style nonce="">details>summary[data-v-370f298d]{font-size:var(--prose-p-fontSize)}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><link nonce="" integrity="sha384-dmAK1hhiumNXMs/NjWqR1YxMm3vyiMg16sggZx3HjlYKju1wCeiJzsSNr9NEW6TG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddhl0Rna.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-jGINj1ShftWKDI7S23mVZ+L6D2f9piqFpjk0Pzqu1vUKQJ4qE55dJD6e7E5C0bPG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BBTDB2dI.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="Learn how to implement a basic per-client ICMPv6 packet rate limiter using eBPF/XDP. This tutorial shows how to track client activity with eBPF maps and enforce limits directly in the kernel—without any user-space interaction."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="Network Traffic Rate Limiting with eBPF/XDP | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="Network Traffic Rate Limiting with eBPF/XDP | iximiuz Labs"><meta property="og:description" content="Learn how to implement a basic per-client ICMPv6 packet rate limiter using eBPF/XDP. This tutorial shows how to track client activity with eBPF maps and enforce limits directly in the kernel—without any user-space interaction."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-ratelimiting-dbc12915/__static__/ratelimitpp.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="Network Traffic Rate Limiting with eBPF/XDP | iximiuz Labs"><meta name="twitter:description" content="Learn how to implement a basic per-client ICMPv6 packet rate limiter using eBPF/XDP. This tutorial shows how to track client activity with eBPF maps and enforce limits directly in the kernel—without any user-space interaction."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-ratelimiting-dbc12915/__static__/ratelimitpp.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915"><link nonce="" rel="image_src" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ratelimitpp.png"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/_name_.BsyFxT4E.css"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseLi.BqrAa653.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseHr.BdCZvnSy.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProsePre.B_fgAJq0.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/DetailsBox.3wfYThLq.css"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ProseCodeInline.BhuXSD4-.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ratelimitpp.png"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="Network Traffic Rate Limiting with eBPF/XDP" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">Network Traffic Rate Limiting with eBPF/XDP</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Febpf-ratelimiting-dbc12915" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-ratelimiting-dbc12915" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#high-level-concept" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">High-Level Concept</a><!----></li><li data-v-c294bba9=""><a href="#lets-run-it" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">Let's Run It</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-ratelimiting-dbc12915" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=networking" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Networking</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="Network Traffic Rate Limiting with eBPF/XDP"><meta itemprop="abstract" content="Learn how to implement a basic per-client ICMPv6 packet rate limiter using eBPF/XDP. This tutorial shows how to track client activity with eBPF maps and enforce limits directly in the kernel—without any user-space interaction."><meta itemprop="dateCreated" content="2025-10-13T00:00:00.000Z"><meta itemprop="datePublished" content="2025-10-13T00:00:00.000Z"><meta itemprop="dateModified" content="2025-10-13T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=networking" class="font-normal hover:underline no-underline truncate">Networking</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Oct 13, 2025"><time datetime="createdAt"> Published: Oct 13, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">Network Traffic Rate Limiting with eBPF/XDP</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->In the <a href="https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->previous tutorial<!--]--><!----></a>,
 we learned how to capture and parse network packets using eBPF/XDP. 
That was a good starting point, but building any useful programs also 
requires other eBPF features like eBPF maps and helper functions.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The
 complexity of different applications naturally depends on the problem, 
but one of the simplest—and also one of the first—examples I built early
 on was packet rate limiting.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Packet
 rate limiting is quite common today because of the large number of 
scrapers collecting data for AI training and the growing number of 
attacks that try to overwhelm servers or take down websites.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But
 it’s not only about limiting potentially bad traffic. Rate limiting 
also helps ensure fair API usage or enforce usage tiers (for example, 10
 requests per second).<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ratelimitpp.png" alt="XDP Packet Rate Limiting" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->This
 tutorial won’t come close to a production-ready tool — a real system 
would also use techniques like TCP/TLS fingerprinting. Still, it’s a 
great way to understand how eBPF/XDP can enforce rate-limiting rules 
directly in the kernel.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Nonetheless,
 the approaches to rate limiting mainly differ in how they decide 
whether a client should be limited, while the actual enforcement logic 
is mostly the same.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In this tutorial, we’ll focus on building a solution that rate-limits network traffic based on the client’s IP address.<!--]--></p><h2 id="high-level-concept" class="prose-h2" data-v-b9b1576a=""><!--[-->High-Level Concept<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->In general, most network packet rate-limiting solutions follow the same three steps:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->Capture incoming client traffic<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Check/Store the request against a table of rate-limit rules<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Enforce the rule (allow, delay, or drop)<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->When we map this idea to eBPF, the flow looks very similar:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Capture and parse packet metadata using eBPF/XDP<!--]--></strong> — in our case, we extract the client IP from the IPv6 header.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Check/Store per-client state<!--]--></strong> — we keep the client’s IPv6 address and the timestamp of their last allowed packet in an eBPF map.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Enforce rate limits<!--]--></strong> — by comparing the current timestamp with the stored one and deciding whether to allow or drop the packet.<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->But while it might sound trivial to simply rate-limit all packets, things can get a bit trickier.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For
 example, imagine you want to rate-limit HTTP requests. Since HTTP 
typically runs over TCP, it also involves the TCP handshake—and you 
usually don’t want to slow down that handshake. Throttling it would make
 new connections feel broken before the actual HTTP traffic even begins.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->However,
 once a client has already exceeded the limit, even their handshake 
packets should be dropped. Otherwise, they could keep opening new 
connections that would immediately be rate-limited anyway.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To
 keep things simple in this tutorial, we’ll avoid these nuances and 
focus on rate-limiting ICMPv6 traffic instead. There’s no handshake 
involved—each packet is just a single echo request (ping).<!--]--></p><hr class="prose-hr" data-v-34b8dd49=""><p class="prose-p" data-v-b025fb9f=""><!--[-->First, we need to extract the client’s IPv6 address from the captured network packet, just like we did in the <a href="https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->first tutorial<!--]--><!----></a>:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"xdp"</span><span style="--shiki-default:#E6E6E6">) 
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> xdp_program</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> xdp_md </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data_end </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data_end</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> hdr_cursor nh;
</span></span><span class="line" line="6"><span style="--shiki-default:#9CDCFE">    nh</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">pos</span><span style="--shiki-default:#D4D4D4"> =</span><span style="--shiki-default:#E6E6E6"> data;
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#6A9955">    // For simplicity we only showcase IPv6 ICMP rate-limiting
</span></span><span class="line" line="9"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> ethhdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">eth;
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> eth_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ethhdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">eth);
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IPV6)) {
</span></span><span class="line highlight" line="12"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> ipv6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ipv6;
</span></span><span class="line highlight" line="13"><span style="--shiki-default:#569CD6">        int</span><span style="--shiki-default:#E6E6E6"> ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ip6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ipv6);
</span></span><span class="line" line="14"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="15"><span style="--shiki-default:#C586C0">        if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_ICMPV6) {
</span></span><span class="line highlight" line="16"><span style="--shiki-default:#6A9955">            // Parse ICMP header
</span></span><span class="line highlight" line="17"><span style="--shiki-default:#569CD6">            struct</span><span style="--shiki-default:#E6E6E6"> icmp6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">icmp6;
</span></span><span class="line highlight" line="18"><span style="--shiki-default:#569CD6">            int</span><span style="--shiki-default:#E6E6E6"> icmp6_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_icmp6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">icmp6);
</span></span><span class="line highlight" line="19"><span style="--shiki-default:#E6E6E6">            ...
</span></span><span class="line highlight" line="20"><span style="--shiki-default:#C586C0">            if</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_type</span><span style="--shiki-default:#D4D4D4"> ==</span><span style="--shiki-default:#E6E6E6"> ICMPV6_ECHO_REQUEST) {
</span></span><span class="line highlight" line="21"><span style="--shiki-default:#DCDCAA">                bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an ICMPv6 packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="22"><span style="--shiki-default:#DCDCAA">                bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"IPv6 src: %x:%x:%x:%x:%x:%x:%x:%x"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="23"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="24"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="25"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">2</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="26"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">3</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="27"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">4</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="28"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">5</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="29"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">6</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="30"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">7</span><span style="--shiki-default:#E6E6E6">]));
</span></span><span class="line highlight" line="31"><span style="--shiki-default:#DCDCAA">                bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Echo id=%d seq=%d"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="32"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_dataun</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u_echo</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">identifier</span><span style="--shiki-default:#E6E6E6">),
</span></span><span class="line highlight" line="33"><span style="--shiki-default:#DCDCAA">                  bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_dataun</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u_echo</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">sequence</span><span style="--shiki-default:#E6E6E6">));
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">More information about ICMPv6 network traffic</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 For ICMP network traffic, we need to distinguish between <strong class="prose-strong" data-v-24022f14=""><!--[-->echo request<!--]--></strong> and <strong class="prose-strong" data-v-24022f14=""><!--[-->echo reply<!--]--></strong> packets. We can do this using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->icmp6-&gt;icmp6_type<!--]--></code> field:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#E6E6E6"> icmp6_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_icmp6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">nh</span><span style="--shiki-default:#E6E6E6">, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0">if</span><span style="--shiki-default:#E6E6E6"> (icmp6</span><span style="--shiki-default:#D4D4D4">-&gt;</span><span style="--shiki-default:#E6E6E6">icmp6_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> ICMPV6_ECHO_REQUEST) {
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955">  // handle echo request
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->For simplicity, I’ve hard-coded the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ICMPV6_ECHO_REQUEST<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->ICMPV6_ECHO_REPLY<!--]--></code> values (from <a href="https://github.com/torvalds/linux/blob/master/include/uapi/linux/icmpv6.h" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->linux/icmpv6.h<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>) inside <code class="prose-code-inline" data-v-a031129a=""><!--[-->parse_helpers.h<!--]--></code> file:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">parse_helpers.h</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0">#define</span><span style="--shiki-default:#DCDCAA"> ICMPV6_ECHO_REQUEST</span><span style="--shiki-default:#B5CEA8"> 128
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0">#define</span><span style="--shiki-default:#DCDCAA"> ICMPV6_ECHO_REPLY</span><span style="--shiki-default:#B5CEA8"> 129
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Someone who remembers from the first tutorial that an eBPF/XDP program only runs on the ingress path might wonder - <strong class="prose-strong" data-v-24022f14=""><!--[-->Why do we even need to check for <code class="prose-code-inline" data-v-a031129a=""><!--[-->ICMPV6_ECHO_REQUEST<!--]--></code>? Isn’t the host only receiving requests anyways?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->It’s
 true that in our case the server is only gonna be receiving echo 
requests from a client. But imagine if you'd ping the client from the 
server, the server’s XDP program would receive the echo reply (<code class="prose-code-inline" data-v-a031129a=""><!--[-->ICMPV6_ECHO_REPLY<!--]--></code>). Without checking the type, the program could mistakenly handle replies using the logic meant for echo requests.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->That’s why we’re a bit more explicit in the program and check the packet type.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->If you’ve followed along with the last tutorial, this logic shouldn’t surprise you in any way.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Now, to implement rate limiting like <strong class="prose-strong" data-v-24022f14=""><!--[-->allowing 1 ICMPv6 packet per 2 seconds<!--]--></strong>, we need to store each client’s IPv6 address along with the timestamp of their last packet. For this, we’ll use:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->an eBPF map of type <a href="https://docs.ebpf.io/linux/map-type/BPF_MAP_TYPE_LRU_HASH/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LRU_HASH<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, which stores, in our case, the client’s IPv6 address as the key and the last packet timestamp as the value.<!--]--></li><!--]--></ul><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line highlight" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line highlight" line="2"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(type, BPF_MAP_TYPE_LRU_HASH);
</span></span><span class="line highlight" line="3"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(max_entries, </span><span style="--shiki-default:#B5CEA8">65536</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="4"><span style="--shiki-default:#DCDCAA">    __type</span><span style="--shiki-default:#E6E6E6">(key, </span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> ipv6_key);</span><span style="--shiki-default:#6A9955">   // IPv6 address
</span></span><span class="line highlight" line="5"><span style="--shiki-default:#DCDCAA">    __type</span><span style="--shiki-default:#E6E6E6">(value, __u64);</span><span style="--shiki-default:#6A9955"> // last allowed ts (ns)
</span></span><span class="line highlight" line="6"><span style="--shiki-default:#E6E6E6">} last_time </span><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">".maps"</span><span style="--shiki-default:#E6E6E6">);
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 This eBPF map is similar to <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_HASH<!--]--></code>,
 except the LRU behavior automatically removes old entries when the map 
is full, ensuring we don’t get stuck with no room for new clients.<!--]--></p><!--]--></div><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->the <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_ktime_get_ns()<!--]--></code>
 helper function, which returns the time elapsed since system boot in 
nanoseconds and later allows us to calculate how much time has passed 
since the last packet from a given client.<!--]--></li><!--]--></ul><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">  ...
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0">  if</span><span style="--shiki-default:#E6E6E6"> (icmp6</span><span style="--shiki-default:#D4D4D4">-&gt;</span><span style="--shiki-default:#E6E6E6">icmp6_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> ICMPV6_ECHO_REQUEST) {
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    ...
</span></span><span class="line highlight" line="4"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> ipv6_key key </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {};
</span></span><span class="line highlight" line="5"><span style="--shiki-default:#DCDCAA">    __builtin_memcpy</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">addr</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">addr</span><span style="--shiki-default:#E6E6E6">));</span><span style="--shiki-default:#6A9955"> // copy 16 bytes of IPv6 into key
</span></span><span class="line highlight" line="6"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="7"><span style="--shiki-default:#E6E6E6">    __u64 now </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_ktime_get_ns</span><span style="--shiki-default:#E6E6E6">();</span><span style="--shiki-default:#6A9955"> // Get current time from boot in ns
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#E6E6E6">    __u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">lastp </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_map_lookup_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">last_time, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key);</span><span style="--shiki-default:#6A9955"> // Check last packet timestamp from this
</span></span><span class="line highlight" line="9"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (lastp) {
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#C586C0">      if</span><span style="--shiki-default:#E6E6E6"> (now </span><span style="--shiki-default:#D4D4D4">-</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">lastp </span><span style="--shiki-default:#D4D4D4">&lt;</span><span style="--shiki-default:#E6E6E6"> TWO_SECONDS_NS) {
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#C586C0">        return</span><span style="--shiki-default:#E6E6E6"> XDP_DROP;</span><span style="--shiki-default:#6A9955"> // rate-limit this client by dropping it's packet
</span></span><span class="line highlight" line="12"><span style="--shiki-default:#E6E6E6">      }
</span></span><span class="line highlight" line="13"><span style="--shiki-default:#D4D4D4">      *</span><span style="--shiki-default:#E6E6E6">lastp </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> now;</span><span style="--shiki-default:#6A9955"> // update allowed timestamp
</span></span><span class="line highlight" line="14"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line highlight" line="15"><span style="--shiki-default:#DCDCAA">      bpf_map_update_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">last_time, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">now, BPF_ANY);</span><span style="--shiki-default:#6A9955"> // First time we see this client: allow it and set timestamp
</span></span><span class="line highlight" line="16"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="17"><span style="--shiki-default:#E6E6E6">  }
</span></span><span class="line" line="18"><span style="--shiki-default:#E6E6E6">  ...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 Notice also how we use <code class="prose-code-inline" data-v-a031129a=""><!--[-->XDP_DROP<!--]--></code> to discard the packet.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In the <code class="prose-code-inline" data-v-a031129a=""><!--[-->lab/xdp.c<!--]--></code> eBPF program, you’ll also see an <code class="prose-code-inline" data-v-a031129a=""><!--[-->XDP_PASS<!--]--></code> action at the end, which simply hands the packet off to the kernel’s network stack as usual.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->And that’s really all there is to it. Let's see it in action.<!--]--></p><h2 id="lets-run-it" class="prose-h2" data-v-b9b1576a=""><!--[-->Let's Run It<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->Current playground has two nodes, <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->client<!--]--></code> respectively.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Network%20Traffic%20Rate%20Limiting%20with%20eBPF_XDP_files/ipv6-play.png" alt="XDP IPv6 Packet Rate Limiting" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->I can’t really hardcode an IPv6 address in the playground (for now), but you can easily find yours using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">ip</span><span style="--shiki-default:#CE9178"> address</span><span style="--shiki-default:#CE9178"> show</span><span style="--shiki-default:#CE9178"> eth0
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>4: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether 02:ab:7b:0f:6e:d5 brd ff:ff:ff:ff:ff:ff
    inet 172.16.0.10/24 brd 172.16.0.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::f858:faff:fe56:1301/64 scope link # &lt;- HERE!
       valid_lft forever preferred_lft forever
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Then compile and run the eBPF program in the <code class="prose-code-inline" data-v-a031129a=""><!--[-->lab<!--]--></code> directory, from the <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> tab:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> generate
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> build
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ./xdp</span><span style="--shiki-default:#CE9178"> -i</span><span style="--shiki-default:#CE9178"> eth0
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">What is the `-i eth0` flag?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 The input argument (<code class="prose-code-inline" data-v-a031129a=""><!--[-->-i eth0<!--]--></code>) specifies the network interface where the eBPF/XDP program will be attached.<!--]--></p><!--[--><div class="highlight-go prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/main.go</span><!--[--><pre class="language-go shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line highlight" line="1"><span style="--shiki-default:#9CDCFE">iface</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> net</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">InterfaceByName</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ifname</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0">if</span><span style="--shiki-default:#9CDCFE"> err</span><span style="--shiki-default:#D4D4D4"> !=</span><span style="--shiki-default:#569CD6"> nil</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="3"><span style="--shiki-default:#9CDCFE">    log</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">Fatalf</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Getting interface %s: %s"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">ifname</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">}
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#9CDCFE">xdplink</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">AttachXDP</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#4EC9B0">link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#4EC9B0">XDPOptions</span><span style="--shiki-default:#E6E6E6">{
</span></span><span class="line" line="7"><span style="--shiki-default:#9CDCFE">            Program</span><span style="--shiki-default:#E6E6E6">:   </span><span style="--shiki-default:#9CDCFE">objs</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">XdpProgram</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#9CDCFE">            Interface</span><span style="--shiki-default:#E6E6E6">: </span><span style="--shiki-default:#9CDCFE">iface</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">Index</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="9"><span style="--shiki-default:#9CDCFE">            Flags</span><span style="--shiki-default:#E6E6E6">: </span><span style="--shiki-default:#9CDCFE">link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">XDPGenericMode</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="10"><span style="--shiki-default:#E6E6E6">})
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Finally, ping the server from the client (<code class="prose-code-inline" data-v-a031129a=""><!--[-->client<!--]--></code> tab) using it's IPv6 address:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ping</span><span style="--shiki-default:#CE9178"> -6</span><span style="--shiki-default:#D4D4D4"> &lt;</span><span style="--shiki-default:#CE9178">SERVER-IPv</span><span style="--shiki-default:#D4D4D4">6&gt;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Since
 the rate limiter allows ICMPv6 packets from a specific client only once
 every 2 seconds, you should see roughly every other ping (default rate:
 1 ping/s) succeed (and every second dropped):<!--]--></p><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=1 ttl=64 time=0.821 ms
64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=3 ttl=64 time=0.628 ms
64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=5 ttl=64 time=0.627 ms
64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=7 ttl=64 time=0.562 ms
64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=9 ttl=64 time=0.534 ms
64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=11 ttl=64 time=0.623 ms
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->This was a rather short one, where we learned how eBPF maps and <code class="prose-code-inline" data-v-a031129a=""><!--[-->XDP_DROP<!--]--></code>
 action can be utilized to rate-limit network traffic, but I really like
 examples like this because they require no interaction with user space —
 everything is detected and enforced directly in the kernel.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In the <a href="https://labs.iximiuz.com/tutorials/ebpf-firewall-ed03d648" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->next tutorial<!--]--><!----></a>,
 we’ll take it a step further and implement an eBPF/XDP firewall. 
Additionally, instead of blocking individual clients by IP, we’ll handle
 entire IP ranges using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code> map type.<!--]--></p><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game — Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-ebpf-ratelimiting-dbc12915" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10"> ✕ </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial ebpf-ratelimiting-dbc12915<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">ebpf-ratelimiting-dbc12915</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial ebpf-ratelimiting-dbc12915<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-ratelimiting-dbc12915" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":3029,"once":3044,"_errors":3045,"serverRendered":11,"path":3047},["ShallowReactive",3],{"tutorial-page-tutorial-ebpf-ratelimiting-dbc12915":4,"content-tutorial-ebpf-ratelimiting-dbc12915-v1764263277958":50,"i-material-symbols-light:expand-content":3023,"i-ph:copy":3026},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":41,"completionCount":42,"accessControl":43,"userAccess":49},"68ed4c288221d03de9632346","tutorial","ebpf-ratelimiting-dbc12915","Network Traffic Rate Limiting with eBPF/XDP","Learn how to implement a basic per-client ICMPv6 packet rate limiter using eBPF/XDP. This tutorial shows how to track client activity with eBPF maps and enforce limits directly in the kernel—without any user-space interaction.","2025-10-13T00:00:00.000Z",true,"flexbox",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#ebpf-ratelimiting-dbc12915","2025-10-13","tutorials/ebpf-ratelimiting-dbc12915/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1764263277958,"https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915","/content/files/tutorials/ebpf-ratelimiting-dbc12915/__static__/ratelimitpp.png",[30,31],"linux","networking",[33],"eBPF","todo",{"clone_hello_world":36},{"init":11,"user":37,"machine":38,"name":39,"status":40},"laborant","server","clone_hello_world",0,22,4,{"canList":44,"canPreview":46,"canRead":47,"canStart":48},[45],"anyone",[45],[45],[45],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[51],{"title":8,"description":52,"kind":6,"playground":53,"categories":88,"tagz":89,"createdAt":10,"updatedAt":10,"cover":28,"type":90,"children":91,"hash":15,"preview":-1,"pageUrl":27,"tasks":3011,"toc":3012,"tutorials":3016,"challenges":3018,"courses":3020,"key":3022},"Learn how to implement a basic per-client ICMPv6 packet rate limiter using eBPF/XDP. This tutorial shows how to track client activity with eBPF maps and enforce limits directly in the kernel—without any user-space interaction.\n",{"name":12,"networks":54,"machines":58},[55],{"name":56,"subnet":57},"net-1","172.16.0.0/24",[59,76],{"name":38,"kernel":60,"drives":61,"users":66,"network":69,"resources":73},"6.1",[62],{"source":63,"mount":64,"size":65},"oci://ghcr.io/dorkamotorka/ebpf-labs:latest","/","10GiB",[67],{"name":37,"default":11,"welcome":68},"This is the server node.\n\nIP: 172.16.0.10/24\n",{"interfaces":70},[71],{"network":56,"address":72},"172.16.0.10",{"cpuCount":74,"ramSize":75},1,"1GiB",{"name":77,"kernel":60,"drives":78,"users":80,"network":83,"resources":87},"client",[79],{"source":63,"mount":64,"size":65},[81],{"name":37,"default":11,"welcome":82},"This is a client node.\n\nIP: 172.16.0.11/24\n",{"interfaces":84},[85],{"network":56,"address":86},"172.16.0.11",{"cpuCount":74,"ramSize":75},[30,31],[33],"root",[92,111,116,121,126,131,136,141,146,153,158,178,183,217,222,227,232,237,241,254,1493,1752,1757,1769,1790,1919,1937,1953,2395,2431,2436,2442,2460,2465,2470,2502,2512,2532,2586,2907,2919,2958,2963,2972,2984,3005],{"type":93,"tag":94,"props":95,"children":96},"element","p",{},[97,100,109],{"type":98,"value":99},"text","In the ",{"type":93,"tag":101,"props":102,"children":106},"a",{"href":103,"rel":104},"https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e",[105],"nofollow",[107],{"type":98,"value":108},"previous tutorial",{"type":98,"value":110},", we learned how to capture and parse network packets using eBPF/XDP. That was a good starting point, but building any useful programs also requires other eBPF features like eBPF maps and helper functions.",{"type":93,"tag":94,"props":112,"children":113},{},[114],{"type":98,"value":115},"The complexity of different applications naturally depends on the problem, but one of the simplest—and also one of the first—examples I built early on was packet rate limiting.",{"type":93,"tag":94,"props":117,"children":118},{},[119],{"type":98,"value":120},"Packet rate limiting is quite common today because of the large number of scrapers collecting data for AI training and the growing number of attacks that try to overwhelm servers or take down websites.",{"type":93,"tag":94,"props":122,"children":123},{},[124],{"type":98,"value":125},"But it’s not only about limiting potentially bad traffic. Rate limiting also helps ensure fair API usage or enforce usage tiers (for example, 10 requests per second).",{"type":93,"tag":127,"props":128,"children":130},"image-box",{":alt":129,":src":28},"XDP Packet Rate Limiting",[],{"type":93,"tag":94,"props":132,"children":133},{},[134],{"type":98,"value":135},"This tutorial won’t come close to a production-ready tool — a real system would also use techniques like TCP/TLS fingerprinting. Still, it’s a great way to understand how eBPF/XDP can enforce rate-limiting rules directly in the kernel.",{"type":93,"tag":94,"props":137,"children":138},{},[139],{"type":98,"value":140},"Nonetheless, the approaches to rate limiting mainly differ in how they decide whether a client should be limited, while the actual enforcement logic is mostly the same.",{"type":93,"tag":94,"props":142,"children":143},{},[144],{"type":98,"value":145},"In this tutorial, we’ll focus on building a solution that rate-limits network traffic based on the client’s IP address.",{"type":93,"tag":147,"props":148,"children":150},"h2",{"id":149},"high-level-concept",[151],{"type":98,"value":152},"High-Level Concept",{"type":93,"tag":94,"props":154,"children":155},{},[156],{"type":98,"value":157},"In general, most network packet rate-limiting solutions follow the same three steps:",{"type":93,"tag":159,"props":160,"children":161},"ul",{},[162,168,173],{"type":93,"tag":163,"props":164,"children":165},"li",{},[166],{"type":98,"value":167},"Capture incoming client traffic",{"type":93,"tag":163,"props":169,"children":170},{},[171],{"type":98,"value":172},"Check/Store the request against a table of rate-limit rules",{"type":93,"tag":163,"props":174,"children":175},{},[176],{"type":98,"value":177},"Enforce the rule (allow, delay, or drop)",{"type":93,"tag":94,"props":179,"children":180},{},[181],{"type":98,"value":182},"When we map this idea to eBPF, the flow looks very similar:",{"type":93,"tag":159,"props":184,"children":185},{},[186,197,207],{"type":93,"tag":163,"props":187,"children":188},{},[189,195],{"type":93,"tag":190,"props":191,"children":192},"strong",{},[193],{"type":98,"value":194},"Capture and parse packet metadata using eBPF/XDP",{"type":98,"value":196}," — in our case, we extract the client IP from the IPv6 header.",{"type":93,"tag":163,"props":198,"children":199},{},[200,205],{"type":93,"tag":190,"props":201,"children":202},{},[203],{"type":98,"value":204},"Check/Store per-client state",{"type":98,"value":206}," — we keep the client’s IPv6 address and the timestamp of their last allowed packet in an eBPF map.",{"type":93,"tag":163,"props":208,"children":209},{},[210,215],{"type":93,"tag":190,"props":211,"children":212},{},[213],{"type":98,"value":214},"Enforce rate limits",{"type":98,"value":216}," — by comparing the current timestamp with the stored one and deciding whether to allow or drop the packet.",{"type":93,"tag":94,"props":218,"children":219},{},[220],{"type":98,"value":221},"But while it might sound trivial to simply rate-limit all packets, things can get a bit trickier.",{"type":93,"tag":94,"props":223,"children":224},{},[225],{"type":98,"value":226},"For example, imagine you want to rate-limit HTTP requests. Since HTTP typically runs over TCP, it also involves the TCP handshake—and you usually don’t want to slow down that handshake. Throttling it would make new connections feel broken before the actual HTTP traffic even begins.",{"type":93,"tag":94,"props":228,"children":229},{},[230],{"type":98,"value":231},"However, once a client has already exceeded the limit, even their handshake packets should be dropped. Otherwise, they could keep opening new connections that would immediately be rate-limited anyway.",{"type":93,"tag":94,"props":233,"children":234},{},[235],{"type":98,"value":236},"To keep things simple in this tutorial, we’ll avoid these nuances and focus on rate-limiting ICMPv6 traffic instead. There’s no handshake involved—each packet is just a single echo request (ping).",{"type":93,"tag":238,"props":239,"children":240},"hr",{},[],{"type":93,"tag":94,"props":242,"children":243},{},[244,246,252],{"type":98,"value":245},"First, we need to extract the client’s IPv6 address from the captured network packet, just like we did in the ",{"type":93,"tag":101,"props":247,"children":249},{"href":103,"rel":248},[105],[250],{"type":98,"value":251},"first tutorial",{"type":98,"value":253},":",{"type":93,"tag":255,"props":256,"children":289},"pre",{"className":257,"code":258,"filename":259,"highlights":260,"language":287,"meta":288,"style":288},"language-c shiki shiki-themes slack-dark","SEC(\"xdp\") \nint xdp_program(struct xdp_md *ctx) {\n    void *data_end = (void *)(unsigned long long)ctx->data_end;\n    void *data = (void *)(unsigned long long)ctx->data;\n    struct hdr_cursor nh;\n    nh.pos = data;\n\n    // For simplicity we only showcase IPv6 ICMP rate-limiting\n    struct ethhdr *eth;\n    int eth_type = parse_ethhdr(&nh, data_end, &eth);\n    if (eth_type == bpf_htons(ETH_P_IPV6)) {\n        struct ipv6hdr *ipv6;\n        int ip_type = parse_ip6hdr(&nh, data_end, &ipv6);\n        ...\n        if (ip_type == IPPROTO_ICMPV6) {\n            // Parse ICMP header\n            struct icmp6hdr *icmp6;\n            int icmp6_type = parse_icmp6hdr(&nh, data_end, &icmp6);\n            ...\n            if (icmp6->icmp6_type == ICMPV6_ECHO_REQUEST) {\n                bpf_printk(\"We have captured an ICMPv6 packet\");\n                bpf_printk(\"IPv6 src: %x:%x:%x:%x:%x:%x:%x:%x\",\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[0]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[1]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[2]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[3]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[4]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[5]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[6]),\n                  bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[7]));\n                bpf_printk(\"Echo id=%d seq=%d\",\n                  bpf_ntohs(icmp6->icmp6_dataun.u_echo.identifier),\n                  bpf_ntohs(icmp6->icmp6_dataun.u_echo.sequence));\n","xdp.c",[261,262,263,264,265,266,267,268,269,270,271,41,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286],10,11,12,13,15,16,17,18,19,20,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,"c","",[290],{"type":93,"tag":291,"props":292,"children":293},"code",{"__ignoreMap":288},[294,322,368,449,518,532,561,570,580,602,649,679,702,746,755,778,787,810,854,863,900,923,945,1006,1059,1112,1165,1218,1271,1324,1378,1399,1447],{"type":93,"tag":295,"props":296,"children":298},"span",{"class":297,"line":74},"line",[299,305,311,317],{"type":93,"tag":295,"props":300,"children":302},{"style":301},"--shiki-default:#DCDCAA",[303],{"type":98,"value":304},"SEC",{"type":93,"tag":295,"props":306,"children":308},{"style":307},"--shiki-default:#E6E6E6",[309],{"type":98,"value":310},"(",{"type":93,"tag":295,"props":312,"children":314},{"style":313},"--shiki-default:#CE9178",[315],{"type":98,"value":316},"\"xdp\"",{"type":93,"tag":295,"props":318,"children":319},{"style":307},[320],{"type":98,"value":321},") \n",{"type":93,"tag":295,"props":323,"children":325},{"class":297,"line":324},2,[326,332,337,341,346,351,357,363],{"type":93,"tag":295,"props":327,"children":329},{"style":328},"--shiki-default:#569CD6",[330],{"type":98,"value":331},"int",{"type":93,"tag":295,"props":333,"children":334},{"style":301},[335],{"type":98,"value":336}," xdp_program",{"type":93,"tag":295,"props":338,"children":339},{"style":307},[340],{"type":98,"value":310},{"type":93,"tag":295,"props":342,"children":343},{"style":328},[344],{"type":98,"value":345},"struct",{"type":93,"tag":295,"props":347,"children":348},{"style":307},[349],{"type":98,"value":350}," xdp_md ",{"type":93,"tag":295,"props":352,"children":354},{"style":353},"--shiki-default:#D4D4D4",[355],{"type":98,"value":356},"*",{"type":93,"tag":295,"props":358,"children":360},{"style":359},"--shiki-default:#9CDCFE",[361],{"type":98,"value":362},"ctx",{"type":93,"tag":295,"props":364,"children":365},{"style":307},[366],{"type":98,"value":367},") {\n",{"type":93,"tag":295,"props":369,"children":371},{"class":297,"line":370},3,[372,377,382,387,392,397,402,406,411,416,421,425,430,434,439,444],{"type":93,"tag":295,"props":373,"children":374},{"style":328},[375],{"type":98,"value":376},"    void",{"type":93,"tag":295,"props":378,"children":379},{"style":353},[380],{"type":98,"value":381}," *",{"type":93,"tag":295,"props":383,"children":384},{"style":307},[385],{"type":98,"value":386},"data_end ",{"type":93,"tag":295,"props":388,"children":389},{"style":353},[390],{"type":98,"value":391},"=",{"type":93,"tag":295,"props":393,"children":394},{"style":307},[395],{"type":98,"value":396}," (",{"type":93,"tag":295,"props":398,"children":399},{"style":328},[400],{"type":98,"value":401},"void",{"type":93,"tag":295,"props":403,"children":404},{"style":353},[405],{"type":98,"value":381},{"type":93,"tag":295,"props":407,"children":408},{"style":307},[409],{"type":98,"value":410},")(",{"type":93,"tag":295,"props":412,"children":413},{"style":328},[414],{"type":98,"value":415},"unsigned",{"type":93,"tag":295,"props":417,"children":418},{"style":328},[419],{"type":98,"value":420}," long",{"type":93,"tag":295,"props":422,"children":423},{"style":328},[424],{"type":98,"value":420},{"type":93,"tag":295,"props":426,"children":427},{"style":307},[428],{"type":98,"value":429},")",{"type":93,"tag":295,"props":431,"children":432},{"style":359},[433],{"type":98,"value":362},{"type":93,"tag":295,"props":435,"children":436},{"style":307},[437],{"type":98,"value":438},"->",{"type":93,"tag":295,"props":440,"children":441},{"style":359},[442],{"type":98,"value":443},"data_end",{"type":93,"tag":295,"props":445,"children":446},{"style":307},[447],{"type":98,"value":448},";\n",{"type":93,"tag":295,"props":450,"children":451},{"class":297,"line":42},[452,456,460,465,469,473,477,481,485,489,493,497,501,505,509,514],{"type":93,"tag":295,"props":453,"children":454},{"style":328},[455],{"type":98,"value":376},{"type":93,"tag":295,"props":457,"children":458},{"style":353},[459],{"type":98,"value":381},{"type":93,"tag":295,"props":461,"children":462},{"style":307},[463],{"type":98,"value":464},"data ",{"type":93,"tag":295,"props":466,"children":467},{"style":353},[468],{"type":98,"value":391},{"type":93,"tag":295,"props":470,"children":471},{"style":307},[472],{"type":98,"value":396},{"type":93,"tag":295,"props":474,"children":475},{"style":328},[476],{"type":98,"value":401},{"type":93,"tag":295,"props":478,"children":479},{"style":353},[480],{"type":98,"value":381},{"type":93,"tag":295,"props":482,"children":483},{"style":307},[484],{"type":98,"value":410},{"type":93,"tag":295,"props":486,"children":487},{"style":328},[488],{"type":98,"value":415},{"type":93,"tag":295,"props":490,"children":491},{"style":328},[492],{"type":98,"value":420},{"type":93,"tag":295,"props":494,"children":495},{"style":328},[496],{"type":98,"value":420},{"type":93,"tag":295,"props":498,"children":499},{"style":307},[500],{"type":98,"value":429},{"type":93,"tag":295,"props":502,"children":503},{"style":359},[504],{"type":98,"value":362},{"type":93,"tag":295,"props":506,"children":507},{"style":307},[508],{"type":98,"value":438},{"type":93,"tag":295,"props":510,"children":511},{"style":359},[512],{"type":98,"value":513},"data",{"type":93,"tag":295,"props":515,"children":516},{"style":307},[517],{"type":98,"value":448},{"type":93,"tag":295,"props":519,"children":521},{"class":297,"line":520},5,[522,527],{"type":93,"tag":295,"props":523,"children":524},{"style":328},[525],{"type":98,"value":526},"    struct",{"type":93,"tag":295,"props":528,"children":529},{"style":307},[530],{"type":98,"value":531}," hdr_cursor nh;\n",{"type":93,"tag":295,"props":533,"children":535},{"class":297,"line":534},6,[536,541,546,551,556],{"type":93,"tag":295,"props":537,"children":538},{"style":359},[539],{"type":98,"value":540},"    nh",{"type":93,"tag":295,"props":542,"children":543},{"style":307},[544],{"type":98,"value":545},".",{"type":93,"tag":295,"props":547,"children":548},{"style":359},[549],{"type":98,"value":550},"pos",{"type":93,"tag":295,"props":552,"children":553},{"style":353},[554],{"type":98,"value":555}," =",{"type":93,"tag":295,"props":557,"children":558},{"style":307},[559],{"type":98,"value":560}," data;\n",{"type":93,"tag":295,"props":562,"children":564},{"class":297,"line":563},7,[565],{"type":93,"tag":295,"props":566,"children":567},{"emptyLinePlaceholder":11},[568],{"type":98,"value":569},"\n",{"type":93,"tag":295,"props":571,"children":573},{"class":297,"line":572},8,[574],{"type":93,"tag":295,"props":575,"children":577},{"style":576},"--shiki-default:#6A9955",[578],{"type":98,"value":579},"    // For simplicity we only showcase IPv6 ICMP rate-limiting\n",{"type":93,"tag":295,"props":581,"children":583},{"class":297,"line":582},9,[584,588,593,597],{"type":93,"tag":295,"props":585,"children":586},{"style":328},[587],{"type":98,"value":526},{"type":93,"tag":295,"props":589,"children":590},{"style":307},[591],{"type":98,"value":592}," ethhdr ",{"type":93,"tag":295,"props":594,"children":595},{"style":353},[596],{"type":98,"value":356},{"type":93,"tag":295,"props":598,"children":599},{"style":307},[600],{"type":98,"value":601},"eth;\n",{"type":93,"tag":295,"props":603,"children":606},{"class":604,"line":261},[297,605],"highlight",[607,612,617,621,626,630,635,640,644],{"type":93,"tag":295,"props":608,"children":609},{"style":328},[610],{"type":98,"value":611},"    int",{"type":93,"tag":295,"props":613,"children":614},{"style":307},[615],{"type":98,"value":616}," eth_type ",{"type":93,"tag":295,"props":618,"children":619},{"style":353},[620],{"type":98,"value":391},{"type":93,"tag":295,"props":622,"children":623},{"style":301},[624],{"type":98,"value":625}," parse_ethhdr",{"type":93,"tag":295,"props":627,"children":628},{"style":307},[629],{"type":98,"value":310},{"type":93,"tag":295,"props":631,"children":632},{"style":353},[633],{"type":98,"value":634},"&",{"type":93,"tag":295,"props":636,"children":637},{"style":307},[638],{"type":98,"value":639},"nh, data_end, ",{"type":93,"tag":295,"props":641,"children":642},{"style":353},[643],{"type":98,"value":634},{"type":93,"tag":295,"props":645,"children":646},{"style":307},[647],{"type":98,"value":648},"eth);\n",{"type":93,"tag":295,"props":650,"children":652},{"class":651,"line":262},[297,605],[653,659,664,669,674],{"type":93,"tag":295,"props":654,"children":656},{"style":655},"--shiki-default:#C586C0",[657],{"type":98,"value":658},"    if",{"type":93,"tag":295,"props":660,"children":661},{"style":307},[662],{"type":98,"value":663}," (eth_type ",{"type":93,"tag":295,"props":665,"children":666},{"style":353},[667],{"type":98,"value":668},"==",{"type":93,"tag":295,"props":670,"children":671},{"style":301},[672],{"type":98,"value":673}," bpf_htons",{"type":93,"tag":295,"props":675,"children":676},{"style":307},[677],{"type":98,"value":678},"(ETH_P_IPV6)) {\n",{"type":93,"tag":295,"props":680,"children":682},{"class":681,"line":263},[297,605],[683,688,693,697],{"type":93,"tag":295,"props":684,"children":685},{"style":328},[686],{"type":98,"value":687},"        struct",{"type":93,"tag":295,"props":689,"children":690},{"style":307},[691],{"type":98,"value":692}," ipv6hdr ",{"type":93,"tag":295,"props":694,"children":695},{"style":353},[696],{"type":98,"value":356},{"type":93,"tag":295,"props":698,"children":699},{"style":307},[700],{"type":98,"value":701},"ipv6;\n",{"type":93,"tag":295,"props":703,"children":705},{"class":704,"line":264},[297,605],[706,711,716,720,725,729,733,737,741],{"type":93,"tag":295,"props":707,"children":708},{"style":328},[709],{"type":98,"value":710},"        int",{"type":93,"tag":295,"props":712,"children":713},{"style":307},[714],{"type":98,"value":715}," ip_type ",{"type":93,"tag":295,"props":717,"children":718},{"style":353},[719],{"type":98,"value":391},{"type":93,"tag":295,"props":721,"children":722},{"style":301},[723],{"type":98,"value":724}," parse_ip6hdr",{"type":93,"tag":295,"props":726,"children":727},{"style":307},[728],{"type":98,"value":310},{"type":93,"tag":295,"props":730,"children":731},{"style":353},[732],{"type":98,"value":634},{"type":93,"tag":295,"props":734,"children":735},{"style":307},[736],{"type":98,"value":639},{"type":93,"tag":295,"props":738,"children":739},{"style":353},[740],{"type":98,"value":634},{"type":93,"tag":295,"props":742,"children":743},{"style":307},[744],{"type":98,"value":745},"ipv6);\n",{"type":93,"tag":295,"props":747,"children":749},{"class":297,"line":748},14,[750],{"type":93,"tag":295,"props":751,"children":752},{"style":307},[753],{"type":98,"value":754},"        ...\n",{"type":93,"tag":295,"props":756,"children":758},{"class":757,"line":265},[297,605],[759,764,769,773],{"type":93,"tag":295,"props":760,"children":761},{"style":655},[762],{"type":98,"value":763},"        if",{"type":93,"tag":295,"props":765,"children":766},{"style":307},[767],{"type":98,"value":768}," (ip_type ",{"type":93,"tag":295,"props":770,"children":771},{"style":353},[772],{"type":98,"value":668},{"type":93,"tag":295,"props":774,"children":775},{"style":307},[776],{"type":98,"value":777}," IPPROTO_ICMPV6) {\n",{"type":93,"tag":295,"props":779,"children":781},{"class":780,"line":266},[297,605],[782],{"type":93,"tag":295,"props":783,"children":784},{"style":576},[785],{"type":98,"value":786},"            // Parse ICMP header\n",{"type":93,"tag":295,"props":788,"children":790},{"class":789,"line":267},[297,605],[791,796,801,805],{"type":93,"tag":295,"props":792,"children":793},{"style":328},[794],{"type":98,"value":795},"            struct",{"type":93,"tag":295,"props":797,"children":798},{"style":307},[799],{"type":98,"value":800}," icmp6hdr ",{"type":93,"tag":295,"props":802,"children":803},{"style":353},[804],{"type":98,"value":356},{"type":93,"tag":295,"props":806,"children":807},{"style":307},[808],{"type":98,"value":809},"icmp6;\n",{"type":93,"tag":295,"props":811,"children":813},{"class":812,"line":268},[297,605],[814,819,824,828,833,837,841,845,849],{"type":93,"tag":295,"props":815,"children":816},{"style":328},[817],{"type":98,"value":818},"            int",{"type":93,"tag":295,"props":820,"children":821},{"style":307},[822],{"type":98,"value":823}," icmp6_type ",{"type":93,"tag":295,"props":825,"children":826},{"style":353},[827],{"type":98,"value":391},{"type":93,"tag":295,"props":829,"children":830},{"style":301},[831],{"type":98,"value":832}," parse_icmp6hdr",{"type":93,"tag":295,"props":834,"children":835},{"style":307},[836],{"type":98,"value":310},{"type":93,"tag":295,"props":838,"children":839},{"style":353},[840],{"type":98,"value":634},{"type":93,"tag":295,"props":842,"children":843},{"style":307},[844],{"type":98,"value":639},{"type":93,"tag":295,"props":846,"children":847},{"style":353},[848],{"type":98,"value":634},{"type":93,"tag":295,"props":850,"children":851},{"style":307},[852],{"type":98,"value":853},"icmp6);\n",{"type":93,"tag":295,"props":855,"children":857},{"class":856,"line":269},[297,605],[858],{"type":93,"tag":295,"props":859,"children":860},{"style":307},[861],{"type":98,"value":862},"            ...\n",{"type":93,"tag":295,"props":864,"children":866},{"class":865,"line":270},[297,605],[867,872,876,881,885,890,895],{"type":93,"tag":295,"props":868,"children":869},{"style":655},[870],{"type":98,"value":871},"            if",{"type":93,"tag":295,"props":873,"children":874},{"style":307},[875],{"type":98,"value":396},{"type":93,"tag":295,"props":877,"children":878},{"style":359},[879],{"type":98,"value":880},"icmp6",{"type":93,"tag":295,"props":882,"children":883},{"style":307},[884],{"type":98,"value":438},{"type":93,"tag":295,"props":886,"children":887},{"style":359},[888],{"type":98,"value":889},"icmp6_type",{"type":93,"tag":295,"props":891,"children":892},{"style":353},[893],{"type":98,"value":894}," ==",{"type":93,"tag":295,"props":896,"children":897},{"style":307},[898],{"type":98,"value":899}," ICMPV6_ECHO_REQUEST) {\n",{"type":93,"tag":295,"props":901,"children":903},{"class":902,"line":271},[297,605],[904,909,913,918],{"type":93,"tag":295,"props":905,"children":906},{"style":301},[907],{"type":98,"value":908},"                bpf_printk",{"type":93,"tag":295,"props":910,"children":911},{"style":307},[912],{"type":98,"value":310},{"type":93,"tag":295,"props":914,"children":915},{"style":313},[916],{"type":98,"value":917},"\"We have captured an ICMPv6 packet\"",{"type":93,"tag":295,"props":919,"children":920},{"style":307},[921],{"type":98,"value":922},");\n",{"type":93,"tag":295,"props":924,"children":926},{"class":925,"line":41},[297,605],[927,931,935,940],{"type":93,"tag":295,"props":928,"children":929},{"style":301},[930],{"type":98,"value":908},{"type":93,"tag":295,"props":932,"children":933},{"style":307},[934],{"type":98,"value":310},{"type":93,"tag":295,"props":936,"children":937},{"style":313},[938],{"type":98,"value":939},"\"IPv6 src: %x:%x:%x:%x:%x:%x:%x:%x\"",{"type":93,"tag":295,"props":941,"children":942},{"style":307},[943],{"type":98,"value":944},",\n",{"type":93,"tag":295,"props":946,"children":948},{"class":947,"line":272},[297,605],[949,954,958,963,967,972,976,981,985,990,995,1001],{"type":93,"tag":295,"props":950,"children":951},{"style":301},[952],{"type":98,"value":953},"                  bpf_ntohs",{"type":93,"tag":295,"props":955,"children":956},{"style":307},[957],{"type":98,"value":310},{"type":93,"tag":295,"props":959,"children":960},{"style":359},[961],{"type":98,"value":962},"ipv6",{"type":93,"tag":295,"props":964,"children":965},{"style":307},[966],{"type":98,"value":438},{"type":93,"tag":295,"props":968,"children":969},{"style":359},[970],{"type":98,"value":971},"saddr",{"type":93,"tag":295,"props":973,"children":974},{"style":307},[975],{"type":98,"value":545},{"type":93,"tag":295,"props":977,"children":978},{"style":359},[979],{"type":98,"value":980},"in6_u",{"type":93,"tag":295,"props":982,"children":983},{"style":307},[984],{"type":98,"value":545},{"type":93,"tag":295,"props":986,"children":987},{"style":359},[988],{"type":98,"value":989},"u6_addr16",{"type":93,"tag":295,"props":991,"children":992},{"style":307},[993],{"type":98,"value":994},"[",{"type":93,"tag":295,"props":996,"children":998},{"style":997},"--shiki-default:#B5CEA8",[999],{"type":98,"value":1000},"0",{"type":93,"tag":295,"props":1002,"children":1003},{"style":307},[1004],{"type":98,"value":1005},"]),\n",{"type":93,"tag":295,"props":1007,"children":1009},{"class":1008,"line":273},[297,605],[1010,1014,1018,1022,1026,1030,1034,1038,1042,1046,1050,1055],{"type":93,"tag":295,"props":1011,"children":1012},{"style":301},[1013],{"type":98,"value":953},{"type":93,"tag":295,"props":1015,"children":1016},{"style":307},[1017],{"type":98,"value":310},{"type":93,"tag":295,"props":1019,"children":1020},{"style":359},[1021],{"type":98,"value":962},{"type":93,"tag":295,"props":1023,"children":1024},{"style":307},[1025],{"type":98,"value":438},{"type":93,"tag":295,"props":1027,"children":1028},{"style":359},[1029],{"type":98,"value":971},{"type":93,"tag":295,"props":1031,"children":1032},{"style":307},[1033],{"type":98,"value":545},{"type":93,"tag":295,"props":1035,"children":1036},{"style":359},[1037],{"type":98,"value":980},{"type":93,"tag":295,"props":1039,"children":1040},{"style":307},[1041],{"type":98,"value":545},{"type":93,"tag":295,"props":1043,"children":1044},{"style":359},[1045],{"type":98,"value":989},{"type":93,"tag":295,"props":1047,"children":1048},{"style":307},[1049],{"type":98,"value":994},{"type":93,"tag":295,"props":1051,"children":1052},{"style":997},[1053],{"type":98,"value":1054},"1",{"type":93,"tag":295,"props":1056,"children":1057},{"style":307},[1058],{"type":98,"value":1005},{"type":93,"tag":295,"props":1060,"children":1062},{"class":1061,"line":274},[297,605],[1063,1067,1071,1075,1079,1083,1087,1091,1095,1099,1103,1108],{"type":93,"tag":295,"props":1064,"children":1065},{"style":301},[1066],{"type":98,"value":953},{"type":93,"tag":295,"props":1068,"children":1069},{"style":307},[1070],{"type":98,"value":310},{"type":93,"tag":295,"props":1072,"children":1073},{"style":359},[1074],{"type":98,"value":962},{"type":93,"tag":295,"props":1076,"children":1077},{"style":307},[1078],{"type":98,"value":438},{"type":93,"tag":295,"props":1080,"children":1081},{"style":359},[1082],{"type":98,"value":971},{"type":93,"tag":295,"props":1084,"children":1085},{"style":307},[1086],{"type":98,"value":545},{"type":93,"tag":295,"props":1088,"children":1089},{"style":359},[1090],{"type":98,"value":980},{"type":93,"tag":295,"props":1092,"children":1093},{"style":307},[1094],{"type":98,"value":545},{"type":93,"tag":295,"props":1096,"children":1097},{"style":359},[1098],{"type":98,"value":989},{"type":93,"tag":295,"props":1100,"children":1101},{"style":307},[1102],{"type":98,"value":994},{"type":93,"tag":295,"props":1104,"children":1105},{"style":997},[1106],{"type":98,"value":1107},"2",{"type":93,"tag":295,"props":1109,"children":1110},{"style":307},[1111],{"type":98,"value":1005},{"type":93,"tag":295,"props":1113,"children":1115},{"class":1114,"line":275},[297,605],[1116,1120,1124,1128,1132,1136,1140,1144,1148,1152,1156,1161],{"type":93,"tag":295,"props":1117,"children":1118},{"style":301},[1119],{"type":98,"value":953},{"type":93,"tag":295,"props":1121,"children":1122},{"style":307},[1123],{"type":98,"value":310},{"type":93,"tag":295,"props":1125,"children":1126},{"style":359},[1127],{"type":98,"value":962},{"type":93,"tag":295,"props":1129,"children":1130},{"style":307},[1131],{"type":98,"value":438},{"type":93,"tag":295,"props":1133,"children":1134},{"style":359},[1135],{"type":98,"value":971},{"type":93,"tag":295,"props":1137,"children":1138},{"style":307},[1139],{"type":98,"value":545},{"type":93,"tag":295,"props":1141,"children":1142},{"style":359},[1143],{"type":98,"value":980},{"type":93,"tag":295,"props":1145,"children":1146},{"style":307},[1147],{"type":98,"value":545},{"type":93,"tag":295,"props":1149,"children":1150},{"style":359},[1151],{"type":98,"value":989},{"type":93,"tag":295,"props":1153,"children":1154},{"style":307},[1155],{"type":98,"value":994},{"type":93,"tag":295,"props":1157,"children":1158},{"style":997},[1159],{"type":98,"value":1160},"3",{"type":93,"tag":295,"props":1162,"children":1163},{"style":307},[1164],{"type":98,"value":1005},{"type":93,"tag":295,"props":1166,"children":1168},{"class":1167,"line":276},[297,605],[1169,1173,1177,1181,1185,1189,1193,1197,1201,1205,1209,1214],{"type":93,"tag":295,"props":1170,"children":1171},{"style":301},[1172],{"type":98,"value":953},{"type":93,"tag":295,"props":1174,"children":1175},{"style":307},[1176],{"type":98,"value":310},{"type":93,"tag":295,"props":1178,"children":1179},{"style":359},[1180],{"type":98,"value":962},{"type":93,"tag":295,"props":1182,"children":1183},{"style":307},[1184],{"type":98,"value":438},{"type":93,"tag":295,"props":1186,"children":1187},{"style":359},[1188],{"type":98,"value":971},{"type":93,"tag":295,"props":1190,"children":1191},{"style":307},[1192],{"type":98,"value":545},{"type":93,"tag":295,"props":1194,"children":1195},{"style":359},[1196],{"type":98,"value":980},{"type":93,"tag":295,"props":1198,"children":1199},{"style":307},[1200],{"type":98,"value":545},{"type":93,"tag":295,"props":1202,"children":1203},{"style":359},[1204],{"type":98,"value":989},{"type":93,"tag":295,"props":1206,"children":1207},{"style":307},[1208],{"type":98,"value":994},{"type":93,"tag":295,"props":1210,"children":1211},{"style":997},[1212],{"type":98,"value":1213},"4",{"type":93,"tag":295,"props":1215,"children":1216},{"style":307},[1217],{"type":98,"value":1005},{"type":93,"tag":295,"props":1219,"children":1221},{"class":1220,"line":277},[297,605],[1222,1226,1230,1234,1238,1242,1246,1250,1254,1258,1262,1267],{"type":93,"tag":295,"props":1223,"children":1224},{"style":301},[1225],{"type":98,"value":953},{"type":93,"tag":295,"props":1227,"children":1228},{"style":307},[1229],{"type":98,"value":310},{"type":93,"tag":295,"props":1231,"children":1232},{"style":359},[1233],{"type":98,"value":962},{"type":93,"tag":295,"props":1235,"children":1236},{"style":307},[1237],{"type":98,"value":438},{"type":93,"tag":295,"props":1239,"children":1240},{"style":359},[1241],{"type":98,"value":971},{"type":93,"tag":295,"props":1243,"children":1244},{"style":307},[1245],{"type":98,"value":545},{"type":93,"tag":295,"props":1247,"children":1248},{"style":359},[1249],{"type":98,"value":980},{"type":93,"tag":295,"props":1251,"children":1252},{"style":307},[1253],{"type":98,"value":545},{"type":93,"tag":295,"props":1255,"children":1256},{"style":359},[1257],{"type":98,"value":989},{"type":93,"tag":295,"props":1259,"children":1260},{"style":307},[1261],{"type":98,"value":994},{"type":93,"tag":295,"props":1263,"children":1264},{"style":997},[1265],{"type":98,"value":1266},"5",{"type":93,"tag":295,"props":1268,"children":1269},{"style":307},[1270],{"type":98,"value":1005},{"type":93,"tag":295,"props":1272,"children":1274},{"class":1273,"line":278},[297,605],[1275,1279,1283,1287,1291,1295,1299,1303,1307,1311,1315,1320],{"type":93,"tag":295,"props":1276,"children":1277},{"style":301},[1278],{"type":98,"value":953},{"type":93,"tag":295,"props":1280,"children":1281},{"style":307},[1282],{"type":98,"value":310},{"type":93,"tag":295,"props":1284,"children":1285},{"style":359},[1286],{"type":98,"value":962},{"type":93,"tag":295,"props":1288,"children":1289},{"style":307},[1290],{"type":98,"value":438},{"type":93,"tag":295,"props":1292,"children":1293},{"style":359},[1294],{"type":98,"value":971},{"type":93,"tag":295,"props":1296,"children":1297},{"style":307},[1298],{"type":98,"value":545},{"type":93,"tag":295,"props":1300,"children":1301},{"style":359},[1302],{"type":98,"value":980},{"type":93,"tag":295,"props":1304,"children":1305},{"style":307},[1306],{"type":98,"value":545},{"type":93,"tag":295,"props":1308,"children":1309},{"style":359},[1310],{"type":98,"value":989},{"type":93,"tag":295,"props":1312,"children":1313},{"style":307},[1314],{"type":98,"value":994},{"type":93,"tag":295,"props":1316,"children":1317},{"style":997},[1318],{"type":98,"value":1319},"6",{"type":93,"tag":295,"props":1321,"children":1322},{"style":307},[1323],{"type":98,"value":1005},{"type":93,"tag":295,"props":1325,"children":1327},{"class":1326,"line":279},[297,605],[1328,1332,1336,1340,1344,1348,1352,1356,1360,1364,1368,1373],{"type":93,"tag":295,"props":1329,"children":1330},{"style":301},[1331],{"type":98,"value":953},{"type":93,"tag":295,"props":1333,"children":1334},{"style":307},[1335],{"type":98,"value":310},{"type":93,"tag":295,"props":1337,"children":1338},{"style":359},[1339],{"type":98,"value":962},{"type":93,"tag":295,"props":1341,"children":1342},{"style":307},[1343],{"type":98,"value":438},{"type":93,"tag":295,"props":1345,"children":1346},{"style":359},[1347],{"type":98,"value":971},{"type":93,"tag":295,"props":1349,"children":1350},{"style":307},[1351],{"type":98,"value":545},{"type":93,"tag":295,"props":1353,"children":1354},{"style":359},[1355],{"type":98,"value":980},{"type":93,"tag":295,"props":1357,"children":1358},{"style":307},[1359],{"type":98,"value":545},{"type":93,"tag":295,"props":1361,"children":1362},{"style":359},[1363],{"type":98,"value":989},{"type":93,"tag":295,"props":1365,"children":1366},{"style":307},[1367],{"type":98,"value":994},{"type":93,"tag":295,"props":1369,"children":1370},{"style":997},[1371],{"type":98,"value":1372},"7",{"type":93,"tag":295,"props":1374,"children":1375},{"style":307},[1376],{"type":98,"value":1377},"]));\n",{"type":93,"tag":295,"props":1379,"children":1381},{"class":1380,"line":280},[297,605],[1382,1386,1390,1395],{"type":93,"tag":295,"props":1383,"children":1384},{"style":301},[1385],{"type":98,"value":908},{"type":93,"tag":295,"props":1387,"children":1388},{"style":307},[1389],{"type":98,"value":310},{"type":93,"tag":295,"props":1391,"children":1392},{"style":313},[1393],{"type":98,"value":1394},"\"Echo id=%d seq=%d\"",{"type":93,"tag":295,"props":1396,"children":1397},{"style":307},[1398],{"type":98,"value":944},{"type":93,"tag":295,"props":1400,"children":1402},{"class":1401,"line":281},[297,605],[1403,1407,1411,1415,1419,1424,1428,1433,1437,1442],{"type":93,"tag":295,"props":1404,"children":1405},{"style":301},[1406],{"type":98,"value":953},{"type":93,"tag":295,"props":1408,"children":1409},{"style":307},[1410],{"type":98,"value":310},{"type":93,"tag":295,"props":1412,"children":1413},{"style":359},[1414],{"type":98,"value":880},{"type":93,"tag":295,"props":1416,"children":1417},{"style":307},[1418],{"type":98,"value":438},{"type":93,"tag":295,"props":1420,"children":1421},{"style":359},[1422],{"type":98,"value":1423},"icmp6_dataun",{"type":93,"tag":295,"props":1425,"children":1426},{"style":307},[1427],{"type":98,"value":545},{"type":93,"tag":295,"props":1429,"children":1430},{"style":359},[1431],{"type":98,"value":1432},"u_echo",{"type":93,"tag":295,"props":1434,"children":1435},{"style":307},[1436],{"type":98,"value":545},{"type":93,"tag":295,"props":1438,"children":1439},{"style":359},[1440],{"type":98,"value":1441},"identifier",{"type":93,"tag":295,"props":1443,"children":1444},{"style":307},[1445],{"type":98,"value":1446},"),\n",{"type":93,"tag":295,"props":1448,"children":1450},{"class":1449,"line":282},[297,605],[1451,1455,1459,1463,1467,1471,1475,1479,1483,1488],{"type":93,"tag":295,"props":1452,"children":1453},{"style":301},[1454],{"type":98,"value":953},{"type":93,"tag":295,"props":1456,"children":1457},{"style":307},[1458],{"type":98,"value":310},{"type":93,"tag":295,"props":1460,"children":1461},{"style":359},[1462],{"type":98,"value":880},{"type":93,"tag":295,"props":1464,"children":1465},{"style":307},[1466],{"type":98,"value":438},{"type":93,"tag":295,"props":1468,"children":1469},{"style":359},[1470],{"type":98,"value":1423},{"type":93,"tag":295,"props":1472,"children":1473},{"style":307},[1474],{"type":98,"value":545},{"type":93,"tag":295,"props":1476,"children":1477},{"style":359},[1478],{"type":98,"value":1432},{"type":93,"tag":295,"props":1480,"children":1481},{"style":307},[1482],{"type":98,"value":545},{"type":93,"tag":295,"props":1484,"children":1485},{"style":359},[1486],{"type":98,"value":1487},"sequence",{"type":93,"tag":295,"props":1489,"children":1490},{"style":307},[1491],{"type":98,"value":1492},"));\n",{"type":93,"tag":1494,"props":1495,"children":1497},"details-box",{":summary":1496},"More information about ICMPv6 network traffic",[1498,1525,1635,1676,1718,1735,1747],{"type":93,"tag":94,"props":1499,"children":1500},{},[1501,1503,1508,1510,1515,1517,1523],{"type":98,"value":1502},"💡 For ICMP network traffic, we need to distinguish between ",{"type":93,"tag":190,"props":1504,"children":1505},{},[1506],{"type":98,"value":1507},"echo request",{"type":98,"value":1509}," and ",{"type":93,"tag":190,"props":1511,"children":1512},{},[1513],{"type":98,"value":1514},"echo reply",{"type":98,"value":1516}," packets. We can do this using the ",{"type":93,"tag":291,"props":1518,"children":1520},{"className":1519},[],[1521],{"type":98,"value":1522},"icmp6->icmp6_type",{"type":98,"value":1524}," field:",{"type":93,"tag":255,"props":1526,"children":1528},{"className":257,"code":1527,"filename":259,"language":287,"meta":288,"style":288},"int icmp6_type = parse_icmp6hdr(&nh, data_end, &icmp6);\n...\nif (icmp6->icmp6_type == ICMPV6_ECHO_REQUEST) {\n  // handle echo request\n}\n",[1529],{"type":93,"tag":291,"props":1530,"children":1531},{"__ignoreMap":288},[1532,1581,1589,1619,1627],{"type":93,"tag":295,"props":1533,"children":1534},{"class":297,"line":74},[1535,1539,1543,1547,1551,1555,1559,1564,1569,1573,1577],{"type":93,"tag":295,"props":1536,"children":1537},{"style":328},[1538],{"type":98,"value":331},{"type":93,"tag":295,"props":1540,"children":1541},{"style":307},[1542],{"type":98,"value":823},{"type":93,"tag":295,"props":1544,"children":1545},{"style":353},[1546],{"type":98,"value":391},{"type":93,"tag":295,"props":1548,"children":1549},{"style":301},[1550],{"type":98,"value":832},{"type":93,"tag":295,"props":1552,"children":1553},{"style":307},[1554],{"type":98,"value":310},{"type":93,"tag":295,"props":1556,"children":1557},{"style":353},[1558],{"type":98,"value":634},{"type":93,"tag":295,"props":1560,"children":1561},{"style":359},[1562],{"type":98,"value":1563},"nh",{"type":93,"tag":295,"props":1565,"children":1566},{"style":307},[1567],{"type":98,"value":1568},", data_end, ",{"type":93,"tag":295,"props":1570,"children":1571},{"style":353},[1572],{"type":98,"value":634},{"type":93,"tag":295,"props":1574,"children":1575},{"style":359},[1576],{"type":98,"value":880},{"type":93,"tag":295,"props":1578,"children":1579},{"style":307},[1580],{"type":98,"value":922},{"type":93,"tag":295,"props":1582,"children":1583},{"class":297,"line":324},[1584],{"type":93,"tag":295,"props":1585,"children":1586},{"style":307},[1587],{"type":98,"value":1588},"...\n",{"type":93,"tag":295,"props":1590,"children":1591},{"class":297,"line":370},[1592,1597,1602,1606,1611,1615],{"type":93,"tag":295,"props":1593,"children":1594},{"style":655},[1595],{"type":98,"value":1596},"if",{"type":93,"tag":295,"props":1598,"children":1599},{"style":307},[1600],{"type":98,"value":1601}," (icmp6",{"type":93,"tag":295,"props":1603,"children":1604},{"style":353},[1605],{"type":98,"value":438},{"type":93,"tag":295,"props":1607,"children":1608},{"style":307},[1609],{"type":98,"value":1610},"icmp6_type ",{"type":93,"tag":295,"props":1612,"children":1613},{"style":353},[1614],{"type":98,"value":668},{"type":93,"tag":295,"props":1616,"children":1617},{"style":307},[1618],{"type":98,"value":899},{"type":93,"tag":295,"props":1620,"children":1621},{"class":297,"line":42},[1622],{"type":93,"tag":295,"props":1623,"children":1624},{"style":576},[1625],{"type":98,"value":1626},"  // handle echo request\n",{"type":93,"tag":295,"props":1628,"children":1629},{"class":297,"line":520},[1630],{"type":93,"tag":295,"props":1631,"children":1632},{"style":307},[1633],{"type":98,"value":1634},"}\n",{"type":93,"tag":94,"props":1636,"children":1637},{},[1638,1640,1646,1647,1653,1655,1666,1668,1674],{"type":98,"value":1639},"For simplicity, I’ve hard-coded the ",{"type":93,"tag":291,"props":1641,"children":1643},{"className":1642},[],[1644],{"type":98,"value":1645},"ICMPV6_ECHO_REQUEST",{"type":98,"value":1509},{"type":93,"tag":291,"props":1648,"children":1650},{"className":1649},[],[1651],{"type":98,"value":1652},"ICMPV6_ECHO_REPLY",{"type":98,"value":1654}," values (from ",{"type":93,"tag":101,"props":1656,"children":1659},{"href":1657,"rel":1658},"https://github.com/torvalds/linux/blob/master/include/uapi/linux/icmpv6.h",[105],[1660],{"type":93,"tag":291,"props":1661,"children":1663},{"className":1662},[],[1664],{"type":98,"value":1665},"linux/icmpv6.h",{"type":98,"value":1667},") inside ",{"type":93,"tag":291,"props":1669,"children":1671},{"className":1670},[],[1672],{"type":98,"value":1673},"parse_helpers.h",{"type":98,"value":1675}," file:",{"type":93,"tag":255,"props":1677,"children":1679},{"className":257,"code":1678,"filename":1673,"language":287,"meta":288,"style":288},"#define ICMPV6_ECHO_REQUEST 128\n#define ICMPV6_ECHO_REPLY 129\n",[1680],{"type":93,"tag":291,"props":1681,"children":1682},{"__ignoreMap":288},[1683,1701],{"type":93,"tag":295,"props":1684,"children":1685},{"class":297,"line":74},[1686,1691,1696],{"type":93,"tag":295,"props":1687,"children":1688},{"style":655},[1689],{"type":98,"value":1690},"#define",{"type":93,"tag":295,"props":1692,"children":1693},{"style":301},[1694],{"type":98,"value":1695}," ICMPV6_ECHO_REQUEST",{"type":93,"tag":295,"props":1697,"children":1698},{"style":997},[1699],{"type":98,"value":1700}," 128\n",{"type":93,"tag":295,"props":1702,"children":1703},{"class":297,"line":324},[1704,1708,1713],{"type":93,"tag":295,"props":1705,"children":1706},{"style":655},[1707],{"type":98,"value":1690},{"type":93,"tag":295,"props":1709,"children":1710},{"style":301},[1711],{"type":98,"value":1712}," ICMPV6_ECHO_REPLY",{"type":93,"tag":295,"props":1714,"children":1715},{"style":997},[1716],{"type":98,"value":1717}," 129\n",{"type":93,"tag":94,"props":1719,"children":1720},{},[1721,1723],{"type":98,"value":1722},"Someone who remembers from the first tutorial that an eBPF/XDP program only runs on the ingress path might wonder - ",{"type":93,"tag":190,"props":1724,"children":1725},{},[1726,1728,1733],{"type":98,"value":1727},"Why do we even need to check for ",{"type":93,"tag":291,"props":1729,"children":1731},{"className":1730},[],[1732],{"type":98,"value":1645},{"type":98,"value":1734},"? Isn’t the host only receiving requests anyways?",{"type":93,"tag":94,"props":1736,"children":1737},{},[1738,1740,1745],{"type":98,"value":1739},"It’s true that in our case the server is only gonna be receiving echo requests from a client. But imagine if you'd ping the client from the server, the server’s XDP program would receive the echo reply (",{"type":93,"tag":291,"props":1741,"children":1743},{"className":1742},[],[1744],{"type":98,"value":1652},{"type":98,"value":1746},"). Without checking the type, the program could mistakenly handle replies using the logic meant for echo requests.",{"type":93,"tag":94,"props":1748,"children":1749},{},[1750],{"type":98,"value":1751},"That’s why we’re a bit more explicit in the program and check the packet type.",{"type":93,"tag":94,"props":1753,"children":1754},{},[1755],{"type":98,"value":1756},"If you’ve followed along with the last tutorial, this logic shouldn’t surprise you in any way.",{"type":93,"tag":94,"props":1758,"children":1759},{},[1760,1762,1767],{"type":98,"value":1761},"Now, to implement rate limiting like ",{"type":93,"tag":190,"props":1763,"children":1764},{},[1765],{"type":98,"value":1766},"allowing 1 ICMPv6 packet per 2 seconds",{"type":98,"value":1768},", we need to store each client’s IPv6 address along with the timestamp of their last packet. For this, we’ll use:",{"type":93,"tag":159,"props":1770,"children":1771},{},[1772],{"type":93,"tag":163,"props":1773,"children":1774},{},[1775,1777,1788],{"type":98,"value":1776},"an eBPF map of type ",{"type":93,"tag":101,"props":1778,"children":1781},{"href":1779,"rel":1780},"https://docs.ebpf.io/linux/map-type/BPF_MAP_TYPE_LRU_HASH/",[105],[1782],{"type":93,"tag":291,"props":1783,"children":1785},{"className":1784},[],[1786],{"type":98,"value":1787},"BPF_MAP_TYPE_LRU_HASH",{"type":98,"value":1789},", which stores, in our case, the client’s IPv6 address as the key and the last packet timestamp as the value.",{"type":93,"tag":255,"props":1791,"children":1794},{"className":257,"code":1792,"filename":259,"highlights":1793,"language":287,"meta":288,"style":288},"struct {\n    __uint(type, BPF_MAP_TYPE_LRU_HASH);\n    __uint(max_entries, 65536);\n    __type(key, struct ipv6_key);   // IPv6 address\n    __type(value, __u64); // last allowed ts (ns)\n} last_time SEC(\".maps\");\n",[74,324,370,42,520,534],[1795],{"type":93,"tag":291,"props":1796,"children":1797},{"__ignoreMap":288},[1798,1811,1825,1847,1875,1893],{"type":93,"tag":295,"props":1799,"children":1801},{"class":1800,"line":74},[297,605],[1802,1806],{"type":93,"tag":295,"props":1803,"children":1804},{"style":328},[1805],{"type":98,"value":345},{"type":93,"tag":295,"props":1807,"children":1808},{"style":307},[1809],{"type":98,"value":1810}," {\n",{"type":93,"tag":295,"props":1812,"children":1814},{"class":1813,"line":324},[297,605],[1815,1820],{"type":93,"tag":295,"props":1816,"children":1817},{"style":301},[1818],{"type":98,"value":1819},"    __uint",{"type":93,"tag":295,"props":1821,"children":1822},{"style":307},[1823],{"type":98,"value":1824},"(type, BPF_MAP_TYPE_LRU_HASH);\n",{"type":93,"tag":295,"props":1826,"children":1828},{"class":1827,"line":370},[297,605],[1829,1833,1838,1843],{"type":93,"tag":295,"props":1830,"children":1831},{"style":301},[1832],{"type":98,"value":1819},{"type":93,"tag":295,"props":1834,"children":1835},{"style":307},[1836],{"type":98,"value":1837},"(max_entries, ",{"type":93,"tag":295,"props":1839,"children":1840},{"style":997},[1841],{"type":98,"value":1842},"65536",{"type":93,"tag":295,"props":1844,"children":1845},{"style":307},[1846],{"type":98,"value":922},{"type":93,"tag":295,"props":1848,"children":1850},{"class":1849,"line":42},[297,605],[1851,1856,1861,1865,1870],{"type":93,"tag":295,"props":1852,"children":1853},{"style":301},[1854],{"type":98,"value":1855},"    __type",{"type":93,"tag":295,"props":1857,"children":1858},{"style":307},[1859],{"type":98,"value":1860},"(key, ",{"type":93,"tag":295,"props":1862,"children":1863},{"style":328},[1864],{"type":98,"value":345},{"type":93,"tag":295,"props":1866,"children":1867},{"style":307},[1868],{"type":98,"value":1869}," ipv6_key);",{"type":93,"tag":295,"props":1871,"children":1872},{"style":576},[1873],{"type":98,"value":1874},"   // IPv6 address\n",{"type":93,"tag":295,"props":1876,"children":1878},{"class":1877,"line":520},[297,605],[1879,1883,1888],{"type":93,"tag":295,"props":1880,"children":1881},{"style":301},[1882],{"type":98,"value":1855},{"type":93,"tag":295,"props":1884,"children":1885},{"style":307},[1886],{"type":98,"value":1887},"(value, __u64);",{"type":93,"tag":295,"props":1889,"children":1890},{"style":576},[1891],{"type":98,"value":1892}," // last allowed ts (ns)\n",{"type":93,"tag":295,"props":1894,"children":1896},{"class":1895,"line":534},[297,605],[1897,1902,1906,1910,1915],{"type":93,"tag":295,"props":1898,"children":1899},{"style":307},[1900],{"type":98,"value":1901},"} last_time ",{"type":93,"tag":295,"props":1903,"children":1904},{"style":301},[1905],{"type":98,"value":304},{"type":93,"tag":295,"props":1907,"children":1908},{"style":307},[1909],{"type":98,"value":310},{"type":93,"tag":295,"props":1911,"children":1912},{"style":313},[1913],{"type":98,"value":1914},"\".maps\"",{"type":93,"tag":295,"props":1916,"children":1917},{"style":307},[1918],{"type":98,"value":922},{"type":93,"tag":1920,"props":1921,"children":1923},"remark-box",{"kind":1922},"info",[1924],{"type":93,"tag":94,"props":1925,"children":1926},{},[1927,1929,1935],{"type":98,"value":1928},"💡 This eBPF map is similar to ",{"type":93,"tag":291,"props":1930,"children":1932},{"className":1931},[],[1933],{"type":98,"value":1934},"BPF_MAP_TYPE_HASH",{"type":98,"value":1936},", except the LRU behavior automatically removes old entries when the map is full, ensuring we don’t get stuck with no room for new clients.",{"type":93,"tag":159,"props":1938,"children":1939},{},[1940],{"type":93,"tag":163,"props":1941,"children":1942},{},[1943,1945,1951],{"type":98,"value":1944},"the ",{"type":93,"tag":291,"props":1946,"children":1948},{"className":1947},[],[1949],{"type":98,"value":1950},"bpf_ktime_get_ns()",{"type":98,"value":1952}," helper function, which returns the time elapsed since system boot in nanoseconds and later allows us to calculate how much time has passed since the last packet from a given client.",{"type":93,"tag":255,"props":1954,"children":1957},{"className":257,"code":1955,"filename":259,"highlights":1956,"language":287,"meta":288,"style":288},"  ...\n  if (icmp6->icmp6_type == ICMPV6_ECHO_REQUEST) {\n    ...\n    struct ipv6_key key = {};\n    __builtin_memcpy(&key.addr, &ipv6->saddr, sizeof(key.addr)); // copy 16 bytes of IPv6 into key\n\n    __u64 now = bpf_ktime_get_ns(); // Get current time from boot in ns\n    __u64 *lastp = bpf_map_lookup_elem(&last_time, &key); // Check last packet timestamp from this\n    if (lastp) {\n      if (now - *lastp \u003C TWO_SECONDS_NS) {\n        return XDP_DROP; // rate-limit this client by dropping it's packet\n      }\n      *lastp = now; // update allowed timestamp\n    } else {\n      bpf_map_update_elem(&last_time, &key, &now, BPF_ANY); // First time we see this client: allow it and set timestamp\n    }\n  }\n  ...\n",[42,520,534,563,572,582,261,262,263,264,748,265,266],[1958],{"type":93,"tag":291,"props":1959,"children":1960},{"__ignoreMap":288},[1961,1969,1997,2005,2027,2114,2122,2150,2204,2217,2254,2273,2282,2309,2327,2371,2380,2388],{"type":93,"tag":295,"props":1962,"children":1963},{"class":297,"line":74},[1964],{"type":93,"tag":295,"props":1965,"children":1966},{"style":307},[1967],{"type":98,"value":1968},"  ...\n",{"type":93,"tag":295,"props":1970,"children":1971},{"class":297,"line":324},[1972,1977,1981,1985,1989,1993],{"type":93,"tag":295,"props":1973,"children":1974},{"style":655},[1975],{"type":98,"value":1976},"  if",{"type":93,"tag":295,"props":1978,"children":1979},{"style":307},[1980],{"type":98,"value":1601},{"type":93,"tag":295,"props":1982,"children":1983},{"style":353},[1984],{"type":98,"value":438},{"type":93,"tag":295,"props":1986,"children":1987},{"style":307},[1988],{"type":98,"value":1610},{"type":93,"tag":295,"props":1990,"children":1991},{"style":353},[1992],{"type":98,"value":668},{"type":93,"tag":295,"props":1994,"children":1995},{"style":307},[1996],{"type":98,"value":899},{"type":93,"tag":295,"props":1998,"children":1999},{"class":297,"line":370},[2000],{"type":93,"tag":295,"props":2001,"children":2002},{"style":307},[2003],{"type":98,"value":2004},"    ...\n",{"type":93,"tag":295,"props":2006,"children":2008},{"class":2007,"line":42},[297,605],[2009,2013,2018,2022],{"type":93,"tag":295,"props":2010,"children":2011},{"style":328},[2012],{"type":98,"value":526},{"type":93,"tag":295,"props":2014,"children":2015},{"style":307},[2016],{"type":98,"value":2017}," ipv6_key key ",{"type":93,"tag":295,"props":2019,"children":2020},{"style":353},[2021],{"type":98,"value":391},{"type":93,"tag":295,"props":2023,"children":2024},{"style":307},[2025],{"type":98,"value":2026}," {};\n",{"type":93,"tag":295,"props":2028,"children":2030},{"class":2029,"line":520},[297,605],[2031,2036,2040,2044,2049,2053,2058,2063,2067,2071,2075,2079,2083,2088,2092,2096,2100,2104,2109],{"type":93,"tag":295,"props":2032,"children":2033},{"style":301},[2034],{"type":98,"value":2035},"    __builtin_memcpy",{"type":93,"tag":295,"props":2037,"children":2038},{"style":307},[2039],{"type":98,"value":310},{"type":93,"tag":295,"props":2041,"children":2042},{"style":353},[2043],{"type":98,"value":634},{"type":93,"tag":295,"props":2045,"children":2046},{"style":359},[2047],{"type":98,"value":2048},"key",{"type":93,"tag":295,"props":2050,"children":2051},{"style":307},[2052],{"type":98,"value":545},{"type":93,"tag":295,"props":2054,"children":2055},{"style":359},[2056],{"type":98,"value":2057},"addr",{"type":93,"tag":295,"props":2059,"children":2060},{"style":307},[2061],{"type":98,"value":2062},", ",{"type":93,"tag":295,"props":2064,"children":2065},{"style":353},[2066],{"type":98,"value":634},{"type":93,"tag":295,"props":2068,"children":2069},{"style":359},[2070],{"type":98,"value":962},{"type":93,"tag":295,"props":2072,"children":2073},{"style":307},[2074],{"type":98,"value":438},{"type":93,"tag":295,"props":2076,"children":2077},{"style":359},[2078],{"type":98,"value":971},{"type":93,"tag":295,"props":2080,"children":2081},{"style":307},[2082],{"type":98,"value":2062},{"type":93,"tag":295,"props":2084,"children":2085},{"style":328},[2086],{"type":98,"value":2087},"sizeof",{"type":93,"tag":295,"props":2089,"children":2090},{"style":307},[2091],{"type":98,"value":310},{"type":93,"tag":295,"props":2093,"children":2094},{"style":359},[2095],{"type":98,"value":2048},{"type":93,"tag":295,"props":2097,"children":2098},{"style":307},[2099],{"type":98,"value":545},{"type":93,"tag":295,"props":2101,"children":2102},{"style":359},[2103],{"type":98,"value":2057},{"type":93,"tag":295,"props":2105,"children":2106},{"style":307},[2107],{"type":98,"value":2108},"));",{"type":93,"tag":295,"props":2110,"children":2111},{"style":576},[2112],{"type":98,"value":2113}," // copy 16 bytes of IPv6 into key\n",{"type":93,"tag":295,"props":2115,"children":2117},{"class":2116,"line":534},[297,605],[2118],{"type":93,"tag":295,"props":2119,"children":2120},{"emptyLinePlaceholder":11},[2121],{"type":98,"value":569},{"type":93,"tag":295,"props":2123,"children":2125},{"class":2124,"line":563},[297,605],[2126,2131,2135,2140,2145],{"type":93,"tag":295,"props":2127,"children":2128},{"style":307},[2129],{"type":98,"value":2130},"    __u64 now ",{"type":93,"tag":295,"props":2132,"children":2133},{"style":353},[2134],{"type":98,"value":391},{"type":93,"tag":295,"props":2136,"children":2137},{"style":301},[2138],{"type":98,"value":2139}," bpf_ktime_get_ns",{"type":93,"tag":295,"props":2141,"children":2142},{"style":307},[2143],{"type":98,"value":2144},"();",{"type":93,"tag":295,"props":2146,"children":2147},{"style":576},[2148],{"type":98,"value":2149}," // Get current time from boot in ns\n",{"type":93,"tag":295,"props":2151,"children":2153},{"class":2152,"line":572},[297,605],[2154,2159,2163,2168,2172,2177,2181,2185,2190,2194,2199],{"type":93,"tag":295,"props":2155,"children":2156},{"style":307},[2157],{"type":98,"value":2158},"    __u64 ",{"type":93,"tag":295,"props":2160,"children":2161},{"style":353},[2162],{"type":98,"value":356},{"type":93,"tag":295,"props":2164,"children":2165},{"style":307},[2166],{"type":98,"value":2167},"lastp ",{"type":93,"tag":295,"props":2169,"children":2170},{"style":353},[2171],{"type":98,"value":391},{"type":93,"tag":295,"props":2173,"children":2174},{"style":301},[2175],{"type":98,"value":2176}," bpf_map_lookup_elem",{"type":93,"tag":295,"props":2178,"children":2179},{"style":307},[2180],{"type":98,"value":310},{"type":93,"tag":295,"props":2182,"children":2183},{"style":353},[2184],{"type":98,"value":634},{"type":93,"tag":295,"props":2186,"children":2187},{"style":307},[2188],{"type":98,"value":2189},"last_time, ",{"type":93,"tag":295,"props":2191,"children":2192},{"style":353},[2193],{"type":98,"value":634},{"type":93,"tag":295,"props":2195,"children":2196},{"style":307},[2197],{"type":98,"value":2198},"key);",{"type":93,"tag":295,"props":2200,"children":2201},{"style":576},[2202],{"type":98,"value":2203}," // Check last packet timestamp from this\n",{"type":93,"tag":295,"props":2205,"children":2207},{"class":2206,"line":582},[297,605],[2208,2212],{"type":93,"tag":295,"props":2209,"children":2210},{"style":655},[2211],{"type":98,"value":658},{"type":93,"tag":295,"props":2213,"children":2214},{"style":307},[2215],{"type":98,"value":2216}," (lastp) {\n",{"type":93,"tag":295,"props":2218,"children":2220},{"class":2219,"line":261},[297,605],[2221,2226,2231,2236,2240,2244,2249],{"type":93,"tag":295,"props":2222,"children":2223},{"style":655},[2224],{"type":98,"value":2225},"      if",{"type":93,"tag":295,"props":2227,"children":2228},{"style":307},[2229],{"type":98,"value":2230}," (now ",{"type":93,"tag":295,"props":2232,"children":2233},{"style":353},[2234],{"type":98,"value":2235},"-",{"type":93,"tag":295,"props":2237,"children":2238},{"style":353},[2239],{"type":98,"value":381},{"type":93,"tag":295,"props":2241,"children":2242},{"style":307},[2243],{"type":98,"value":2167},{"type":93,"tag":295,"props":2245,"children":2246},{"style":353},[2247],{"type":98,"value":2248},"\u003C",{"type":93,"tag":295,"props":2250,"children":2251},{"style":307},[2252],{"type":98,"value":2253}," TWO_SECONDS_NS) {\n",{"type":93,"tag":295,"props":2255,"children":2257},{"class":2256,"line":262},[297,605],[2258,2263,2268],{"type":93,"tag":295,"props":2259,"children":2260},{"style":655},[2261],{"type":98,"value":2262},"        return",{"type":93,"tag":295,"props":2264,"children":2265},{"style":307},[2266],{"type":98,"value":2267}," XDP_DROP;",{"type":93,"tag":295,"props":2269,"children":2270},{"style":576},[2271],{"type":98,"value":2272}," // rate-limit this client by dropping it's packet\n",{"type":93,"tag":295,"props":2274,"children":2276},{"class":2275,"line":263},[297,605],[2277],{"type":93,"tag":295,"props":2278,"children":2279},{"style":307},[2280],{"type":98,"value":2281},"      }\n",{"type":93,"tag":295,"props":2283,"children":2285},{"class":2284,"line":264},[297,605],[2286,2291,2295,2299,2304],{"type":93,"tag":295,"props":2287,"children":2288},{"style":353},[2289],{"type":98,"value":2290},"      *",{"type":93,"tag":295,"props":2292,"children":2293},{"style":307},[2294],{"type":98,"value":2167},{"type":93,"tag":295,"props":2296,"children":2297},{"style":353},[2298],{"type":98,"value":391},{"type":93,"tag":295,"props":2300,"children":2301},{"style":307},[2302],{"type":98,"value":2303}," now;",{"type":93,"tag":295,"props":2305,"children":2306},{"style":576},[2307],{"type":98,"value":2308}," // update allowed timestamp\n",{"type":93,"tag":295,"props":2310,"children":2312},{"class":2311,"line":748},[297,605],[2313,2318,2323],{"type":93,"tag":295,"props":2314,"children":2315},{"style":307},[2316],{"type":98,"value":2317},"    } ",{"type":93,"tag":295,"props":2319,"children":2320},{"style":655},[2321],{"type":98,"value":2322},"else",{"type":93,"tag":295,"props":2324,"children":2325},{"style":307},[2326],{"type":98,"value":1810},{"type":93,"tag":295,"props":2328,"children":2330},{"class":2329,"line":265},[297,605],[2331,2336,2340,2344,2348,2352,2357,2361,2366],{"type":93,"tag":295,"props":2332,"children":2333},{"style":301},[2334],{"type":98,"value":2335},"      bpf_map_update_elem",{"type":93,"tag":295,"props":2337,"children":2338},{"style":307},[2339],{"type":98,"value":310},{"type":93,"tag":295,"props":2341,"children":2342},{"style":353},[2343],{"type":98,"value":634},{"type":93,"tag":295,"props":2345,"children":2346},{"style":307},[2347],{"type":98,"value":2189},{"type":93,"tag":295,"props":2349,"children":2350},{"style":353},[2351],{"type":98,"value":634},{"type":93,"tag":295,"props":2353,"children":2354},{"style":307},[2355],{"type":98,"value":2356},"key, ",{"type":93,"tag":295,"props":2358,"children":2359},{"style":353},[2360],{"type":98,"value":634},{"type":93,"tag":295,"props":2362,"children":2363},{"style":307},[2364],{"type":98,"value":2365},"now, BPF_ANY);",{"type":93,"tag":295,"props":2367,"children":2368},{"style":576},[2369],{"type":98,"value":2370}," // First time we see this client: allow it and set timestamp\n",{"type":93,"tag":295,"props":2372,"children":2374},{"class":2373,"line":266},[297,605],[2375],{"type":93,"tag":295,"props":2376,"children":2377},{"style":307},[2378],{"type":98,"value":2379},"    }\n",{"type":93,"tag":295,"props":2381,"children":2382},{"class":297,"line":267},[2383],{"type":93,"tag":295,"props":2384,"children":2385},{"style":307},[2386],{"type":98,"value":2387},"  }\n",{"type":93,"tag":295,"props":2389,"children":2390},{"class":297,"line":268},[2391],{"type":93,"tag":295,"props":2392,"children":2393},{"style":307},[2394],{"type":98,"value":1968},{"type":93,"tag":1920,"props":2396,"children":2397},{"kind":1922},[2398,2411],{"type":93,"tag":94,"props":2399,"children":2400},{},[2401,2403,2409],{"type":98,"value":2402},"💡 Notice also how we use ",{"type":93,"tag":291,"props":2404,"children":2406},{"className":2405},[],[2407],{"type":98,"value":2408},"XDP_DROP",{"type":98,"value":2410}," to discard the packet.",{"type":93,"tag":94,"props":2412,"children":2413},{},[2414,2415,2421,2423,2429],{"type":98,"value":99},{"type":93,"tag":291,"props":2416,"children":2418},{"className":2417},[],[2419],{"type":98,"value":2420},"lab/xdp.c",{"type":98,"value":2422}," eBPF program, you’ll also see an ",{"type":93,"tag":291,"props":2424,"children":2426},{"className":2425},[],[2427],{"type":98,"value":2428},"XDP_PASS",{"type":98,"value":2430}," action at the end, which simply hands the packet off to the kernel’s network stack as usual.",{"type":93,"tag":94,"props":2432,"children":2433},{},[2434],{"type":98,"value":2435},"And that’s really all there is to it. Let's see it in action.",{"type":93,"tag":147,"props":2437,"children":2439},{"id":2438},"lets-run-it",[2440],{"type":98,"value":2441},"Let's Run It",{"type":93,"tag":94,"props":2443,"children":2444},{},[2445,2447,2452,2453,2458],{"type":98,"value":2446},"Current playground has two nodes, ",{"type":93,"tag":291,"props":2448,"children":2450},{"className":2449},[],[2451],{"type":98,"value":38},{"type":98,"value":1509},{"type":93,"tag":291,"props":2454,"children":2456},{"className":2455},[],[2457],{"type":98,"value":77},{"type":98,"value":2459}," respectively.",{"type":93,"tag":127,"props":2461,"children":2464},{":alt":2462,":src":2463},"XDP IPv6 Packet Rate Limiting","/content/files/tutorials/ebpf-ratelimiting-dbc12915/__static__/ipv6-play.png",[],{"type":93,"tag":94,"props":2466,"children":2467},{},[2468],{"type":98,"value":2469},"I can’t really hardcode an IPv6 address in the playground (for now), but you can easily find yours using:",{"type":93,"tag":255,"props":2471,"children":2475},{"className":2472,"code":2473,"language":2474,"meta":288,"style":288},"language-bash shiki shiki-themes slack-dark","ip address show eth0\n","bash",[2476],{"type":93,"tag":291,"props":2477,"children":2478},{"__ignoreMap":288},[2479],{"type":93,"tag":295,"props":2480,"children":2481},{"class":297,"line":74},[2482,2487,2492,2497],{"type":93,"tag":295,"props":2483,"children":2484},{"style":301},[2485],{"type":98,"value":2486},"ip",{"type":93,"tag":295,"props":2488,"children":2489},{"style":313},[2490],{"type":98,"value":2491}," address",{"type":93,"tag":295,"props":2493,"children":2494},{"style":313},[2495],{"type":98,"value":2496}," show",{"type":93,"tag":295,"props":2498,"children":2499},{"style":313},[2500],{"type":98,"value":2501}," eth0\n",{"type":93,"tag":255,"props":2503,"children":2507},{"className":2504,"code":2506,"language":98},[2505],"language-text","4: eth0: \u003CBROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 02:ab:7b:0f:6e:d5 brd ff:ff:ff:ff:ff:ff\n    inet 172.16.0.10/24 brd 172.16.0.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::f858:faff:fe56:1301/64 scope link # \u003C- HERE!\n       valid_lft forever preferred_lft forever\n",[2508],{"type":93,"tag":291,"props":2509,"children":2510},{"__ignoreMap":288},[2511],{"type":98,"value":2506},{"type":93,"tag":94,"props":2513,"children":2514},{},[2515,2517,2523,2525,2530],{"type":98,"value":2516},"Then compile and run the eBPF program in the ",{"type":93,"tag":291,"props":2518,"children":2520},{"className":2519},[],[2521],{"type":98,"value":2522},"lab",{"type":98,"value":2524}," directory, from the ",{"type":93,"tag":291,"props":2526,"children":2528},{"className":2527},[],[2529],{"type":98,"value":38},{"type":98,"value":2531}," tab:",{"type":93,"tag":255,"props":2533,"children":2535},{"className":2472,"code":2534,"language":2474,"meta":288,"style":288},"go generate\ngo build\nsudo ./xdp -i eth0\n",[2536],{"type":93,"tag":291,"props":2537,"children":2538},{"__ignoreMap":288},[2539,2552,2564],{"type":93,"tag":295,"props":2540,"children":2541},{"class":297,"line":74},[2542,2547],{"type":93,"tag":295,"props":2543,"children":2544},{"style":301},[2545],{"type":98,"value":2546},"go",{"type":93,"tag":295,"props":2548,"children":2549},{"style":313},[2550],{"type":98,"value":2551}," generate\n",{"type":93,"tag":295,"props":2553,"children":2554},{"class":297,"line":324},[2555,2559],{"type":93,"tag":295,"props":2556,"children":2557},{"style":301},[2558],{"type":98,"value":2546},{"type":93,"tag":295,"props":2560,"children":2561},{"style":313},[2562],{"type":98,"value":2563}," build\n",{"type":93,"tag":295,"props":2565,"children":2566},{"class":297,"line":370},[2567,2572,2577,2582],{"type":93,"tag":295,"props":2568,"children":2569},{"style":301},[2570],{"type":98,"value":2571},"sudo",{"type":93,"tag":295,"props":2573,"children":2574},{"style":313},[2575],{"type":98,"value":2576}," ./xdp",{"type":93,"tag":295,"props":2578,"children":2579},{"style":313},[2580],{"type":98,"value":2581}," -i",{"type":93,"tag":295,"props":2583,"children":2584},{"style":313},[2585],{"type":98,"value":2501},{"type":93,"tag":1494,"props":2587,"children":2589},{":summary":2588},"What is the `-i eth0` flag?",[2590,2603],{"type":93,"tag":94,"props":2591,"children":2592},{},[2593,2595,2601],{"type":98,"value":2594},"💡 The input argument (",{"type":93,"tag":291,"props":2596,"children":2598},{"className":2597},[],[2599],{"type":98,"value":2600},"-i eth0",{"type":98,"value":2602},") specifies the network interface where the eBPF/XDP program will be attached.",{"type":93,"tag":255,"props":2604,"children":2609},{"className":2605,"code":2606,"filename":2607,"highlights":2608,"language":2546,"meta":288,"style":288},"language-go shiki shiki-themes slack-dark","iface, err := net.InterfaceByName(ifname)\nif err != nil {\n    log.Fatalf(\"Getting interface %s: %s\", ifname, err)\n}\n\nxdplink, err := link.AttachXDP(link.XDPOptions{\n            Program:   objs.XdpProgram,\n            Interface: iface.Index,\n            Flags: link.XDPGenericMode,\n})\n","lab/main.go",[74,572],[2610],{"type":93,"tag":291,"props":2611,"children":2612},{"__ignoreMap":288},[2613,2664,2690,2736,2743,2750,2808,2839,2870,2899],{"type":93,"tag":295,"props":2614,"children":2616},{"class":2615,"line":74},[297,605],[2617,2622,2626,2631,2636,2641,2645,2650,2654,2659],{"type":93,"tag":295,"props":2618,"children":2619},{"style":359},[2620],{"type":98,"value":2621},"iface",{"type":93,"tag":295,"props":2623,"children":2624},{"style":307},[2625],{"type":98,"value":2062},{"type":93,"tag":295,"props":2627,"children":2628},{"style":359},[2629],{"type":98,"value":2630},"err",{"type":93,"tag":295,"props":2632,"children":2633},{"style":353},[2634],{"type":98,"value":2635}," :=",{"type":93,"tag":295,"props":2637,"children":2638},{"style":359},[2639],{"type":98,"value":2640}," net",{"type":93,"tag":295,"props":2642,"children":2643},{"style":307},[2644],{"type":98,"value":545},{"type":93,"tag":295,"props":2646,"children":2647},{"style":301},[2648],{"type":98,"value":2649},"InterfaceByName",{"type":93,"tag":295,"props":2651,"children":2652},{"style":307},[2653],{"type":98,"value":310},{"type":93,"tag":295,"props":2655,"children":2656},{"style":359},[2657],{"type":98,"value":2658},"ifname",{"type":93,"tag":295,"props":2660,"children":2661},{"style":307},[2662],{"type":98,"value":2663},")\n",{"type":93,"tag":295,"props":2665,"children":2666},{"class":297,"line":324},[2667,2671,2676,2681,2686],{"type":93,"tag":295,"props":2668,"children":2669},{"style":655},[2670],{"type":98,"value":1596},{"type":93,"tag":295,"props":2672,"children":2673},{"style":359},[2674],{"type":98,"value":2675}," err",{"type":93,"tag":295,"props":2677,"children":2678},{"style":353},[2679],{"type":98,"value":2680}," !=",{"type":93,"tag":295,"props":2682,"children":2683},{"style":328},[2684],{"type":98,"value":2685}," nil",{"type":93,"tag":295,"props":2687,"children":2688},{"style":307},[2689],{"type":98,"value":1810},{"type":93,"tag":295,"props":2691,"children":2692},{"class":297,"line":370},[2693,2698,2702,2707,2711,2716,2720,2724,2728,2732],{"type":93,"tag":295,"props":2694,"children":2695},{"style":359},[2696],{"type":98,"value":2697},"    log",{"type":93,"tag":295,"props":2699,"children":2700},{"style":307},[2701],{"type":98,"value":545},{"type":93,"tag":295,"props":2703,"children":2704},{"style":301},[2705],{"type":98,"value":2706},"Fatalf",{"type":93,"tag":295,"props":2708,"children":2709},{"style":307},[2710],{"type":98,"value":310},{"type":93,"tag":295,"props":2712,"children":2713},{"style":313},[2714],{"type":98,"value":2715},"\"Getting interface %s: %s\"",{"type":93,"tag":295,"props":2717,"children":2718},{"style":307},[2719],{"type":98,"value":2062},{"type":93,"tag":295,"props":2721,"children":2722},{"style":359},[2723],{"type":98,"value":2658},{"type":93,"tag":295,"props":2725,"children":2726},{"style":307},[2727],{"type":98,"value":2062},{"type":93,"tag":295,"props":2729,"children":2730},{"style":359},[2731],{"type":98,"value":2630},{"type":93,"tag":295,"props":2733,"children":2734},{"style":307},[2735],{"type":98,"value":2663},{"type":93,"tag":295,"props":2737,"children":2738},{"class":297,"line":42},[2739],{"type":93,"tag":295,"props":2740,"children":2741},{"style":307},[2742],{"type":98,"value":1634},{"type":93,"tag":295,"props":2744,"children":2745},{"class":297,"line":520},[2746],{"type":93,"tag":295,"props":2747,"children":2748},{"emptyLinePlaceholder":11},[2749],{"type":98,"value":569},{"type":93,"tag":295,"props":2751,"children":2752},{"class":297,"line":534},[2753,2758,2762,2766,2770,2775,2779,2784,2788,2794,2798,2803],{"type":93,"tag":295,"props":2754,"children":2755},{"style":359},[2756],{"type":98,"value":2757},"xdplink",{"type":93,"tag":295,"props":2759,"children":2760},{"style":307},[2761],{"type":98,"value":2062},{"type":93,"tag":295,"props":2763,"children":2764},{"style":359},[2765],{"type":98,"value":2630},{"type":93,"tag":295,"props":2767,"children":2768},{"style":353},[2769],{"type":98,"value":2635},{"type":93,"tag":295,"props":2771,"children":2772},{"style":359},[2773],{"type":98,"value":2774}," link",{"type":93,"tag":295,"props":2776,"children":2777},{"style":307},[2778],{"type":98,"value":545},{"type":93,"tag":295,"props":2780,"children":2781},{"style":301},[2782],{"type":98,"value":2783},"AttachXDP",{"type":93,"tag":295,"props":2785,"children":2786},{"style":307},[2787],{"type":98,"value":310},{"type":93,"tag":295,"props":2789,"children":2791},{"style":2790},"--shiki-default:#4EC9B0",[2792],{"type":98,"value":2793},"link",{"type":93,"tag":295,"props":2795,"children":2796},{"style":307},[2797],{"type":98,"value":545},{"type":93,"tag":295,"props":2799,"children":2800},{"style":2790},[2801],{"type":98,"value":2802},"XDPOptions",{"type":93,"tag":295,"props":2804,"children":2805},{"style":307},[2806],{"type":98,"value":2807},"{\n",{"type":93,"tag":295,"props":2809,"children":2810},{"class":297,"line":563},[2811,2816,2821,2826,2830,2835],{"type":93,"tag":295,"props":2812,"children":2813},{"style":359},[2814],{"type":98,"value":2815},"            Program",{"type":93,"tag":295,"props":2817,"children":2818},{"style":307},[2819],{"type":98,"value":2820},":   ",{"type":93,"tag":295,"props":2822,"children":2823},{"style":359},[2824],{"type":98,"value":2825},"objs",{"type":93,"tag":295,"props":2827,"children":2828},{"style":307},[2829],{"type":98,"value":545},{"type":93,"tag":295,"props":2831,"children":2832},{"style":359},[2833],{"type":98,"value":2834},"XdpProgram",{"type":93,"tag":295,"props":2836,"children":2837},{"style":307},[2838],{"type":98,"value":944},{"type":93,"tag":295,"props":2840,"children":2842},{"class":2841,"line":572},[297,605],[2843,2848,2853,2857,2861,2866],{"type":93,"tag":295,"props":2844,"children":2845},{"style":359},[2846],{"type":98,"value":2847},"            Interface",{"type":93,"tag":295,"props":2849,"children":2850},{"style":307},[2851],{"type":98,"value":2852},": ",{"type":93,"tag":295,"props":2854,"children":2855},{"style":359},[2856],{"type":98,"value":2621},{"type":93,"tag":295,"props":2858,"children":2859},{"style":307},[2860],{"type":98,"value":545},{"type":93,"tag":295,"props":2862,"children":2863},{"style":359},[2864],{"type":98,"value":2865},"Index",{"type":93,"tag":295,"props":2867,"children":2868},{"style":307},[2869],{"type":98,"value":944},{"type":93,"tag":295,"props":2871,"children":2872},{"class":297,"line":582},[2873,2878,2882,2886,2890,2895],{"type":93,"tag":295,"props":2874,"children":2875},{"style":359},[2876],{"type":98,"value":2877},"            Flags",{"type":93,"tag":295,"props":2879,"children":2880},{"style":307},[2881],{"type":98,"value":2852},{"type":93,"tag":295,"props":2883,"children":2884},{"style":359},[2885],{"type":98,"value":2793},{"type":93,"tag":295,"props":2887,"children":2888},{"style":307},[2889],{"type":98,"value":545},{"type":93,"tag":295,"props":2891,"children":2892},{"style":359},[2893],{"type":98,"value":2894},"XDPGenericMode",{"type":93,"tag":295,"props":2896,"children":2897},{"style":307},[2898],{"type":98,"value":944},{"type":93,"tag":295,"props":2900,"children":2901},{"class":297,"line":261},[2902],{"type":93,"tag":295,"props":2903,"children":2904},{"style":307},[2905],{"type":98,"value":2906},"})\n",{"type":93,"tag":94,"props":2908,"children":2909},{},[2910,2912,2917],{"type":98,"value":2911},"Finally, ping the server from the client (",{"type":93,"tag":291,"props":2913,"children":2915},{"className":2914},[],[2916],{"type":98,"value":77},{"type":98,"value":2918}," tab) using it's IPv6 address:",{"type":93,"tag":255,"props":2920,"children":2922},{"className":2472,"code":2921,"language":2474,"meta":288,"style":288},"sudo ping -6 \u003CSERVER-IPv6>\n",[2923],{"type":93,"tag":291,"props":2924,"children":2925},{"__ignoreMap":288},[2926],{"type":93,"tag":295,"props":2927,"children":2928},{"class":297,"line":74},[2929,2933,2938,2943,2948,2953],{"type":93,"tag":295,"props":2930,"children":2931},{"style":301},[2932],{"type":98,"value":2571},{"type":93,"tag":295,"props":2934,"children":2935},{"style":313},[2936],{"type":98,"value":2937}," ping",{"type":93,"tag":295,"props":2939,"children":2940},{"style":313},[2941],{"type":98,"value":2942}," -6",{"type":93,"tag":295,"props":2944,"children":2945},{"style":353},[2946],{"type":98,"value":2947}," \u003C",{"type":93,"tag":295,"props":2949,"children":2950},{"style":313},[2951],{"type":98,"value":2952},"SERVER-IPv",{"type":93,"tag":295,"props":2954,"children":2955},{"style":353},[2956],{"type":98,"value":2957},"6>\n",{"type":93,"tag":94,"props":2959,"children":2960},{},[2961],{"type":98,"value":2962},"Since the rate limiter allows ICMPv6 packets from a specific client only once every 2 seconds, you should see roughly every other ping (default rate: 1 ping/s) succeed (and every second dropped):",{"type":93,"tag":255,"props":2964,"children":2967},{"className":2965,"code":2966,"language":98},[2505],"64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=1 ttl=64 time=0.821 ms\n64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=3 ttl=64 time=0.628 ms\n64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=5 ttl=64 time=0.627 ms\n64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=7 ttl=64 time=0.562 ms\n64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=9 ttl=64 time=0.534 ms\n64 bytes from fe80::c07d:5cff:fe2f:3096%eth0: icmp_seq=11 ttl=64 time=0.623 ms\n",[2968],{"type":93,"tag":291,"props":2969,"children":2970},{"__ignoreMap":288},[2971],{"type":98,"value":2966},{"type":93,"tag":94,"props":2973,"children":2974},{},[2975,2977,2982],{"type":98,"value":2976},"This was a rather short one, where we learned how eBPF maps and ",{"type":93,"tag":291,"props":2978,"children":2980},{"className":2979},[],[2981],{"type":98,"value":2408},{"type":98,"value":2983}," action can be utilized to rate-limit network traffic, but I really like examples like this because they require no interaction with user space — everything is detected and enforced directly in the kernel.",{"type":93,"tag":94,"props":2985,"children":2986},{},[2987,2988,2995,2997,3003],{"type":98,"value":99},{"type":93,"tag":101,"props":2989,"children":2992},{"href":2990,"rel":2991},"https://labs.iximiuz.com/tutorials/ebpf-firewall-ed03d648",[105],[2993],{"type":98,"value":2994},"next tutorial",{"type":98,"value":2996},", we’ll take it a step further and implement an eBPF/XDP firewall. Additionally, instead of blocking individual clients by IP, we’ll handle entire IP ranges using the ",{"type":93,"tag":291,"props":2998,"children":3000},{"className":2999},[],[3001],{"type":98,"value":3002},"BPF_MAP_TYPE_LPM_TRIE",{"type":98,"value":3004}," map type.",{"type":93,"tag":3006,"props":3007,"children":3008},"style",{},[3009],{"type":98,"value":3010},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":288,"searchDepth":324,"depth":324,"links":3013},[3014,3015],{"id":149,"depth":324,"text":152},{"id":2438,"depth":324,"text":2441},["Reactive",3017],{},["Reactive",3019],{},["Reactive",3021],{},"#ebpf-ratelimiting-dbc12915-server",{"left":40,"top":40,"width":273,"height":273,"rotate":40,"vFlip":3024,"hFlip":3024,"body":3025},false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":40,"top":40,"width":3027,"height":3027,"rotate":40,"vFlip":3024,"hFlip":3024,"body":3028},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",3030],{"$scurrentUser":3031,"$salerts":3035,"$scontentToggle":3036,"$ssite-config":3037},{"id":3032,"anonymous":11,"effectiveTier":3033,"hasEmailSubscription":3024},"697b5f64cc8f8f56faac74e1",{"name":3034},"free",[],{"/tutorials/ebpf-ratelimiting-dbc12915":11},{"_priority":3038,"env":3041,"name":3042,"url":3043},{"name":3039,"env":3040,"url":40},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",3046],{"tutorial-page-tutorial-ebpf-ratelimiting-dbc12915":-1,"content-tutorial-ebpf-ratelimiting-dbc12915-v1764263277958":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/ebpf-ratelimiting-dbc12915"]</script></body></html>