<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Hands-On with XDP: eBPF for High-Performance Networking</title><link nonce="" rel="stylesheet" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/inter.css"><link nonce="" rel="stylesheet" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="In this tutorial, you’ll learn the fundamentals of eBPF and XDP through example code that parses packets across different protocol layers, demonstrates how XDP actions work, and shows how these building blocks form the foundation for high-performance networking applications."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="Hands-On with XDP: eBPF for High-Performance Networking | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="Hands-On with XDP: eBPF for High-Performance Networking | iximiuz Labs"><meta property="og:description" content="In this tutorial, you’ll learn the fundamentals of eBPF and XDP through example code that parses packets across different protocol layers, demonstrates how XDP actions work, and shows how these building blocks form the foundation for high-performance networking applications."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/new-new-cover.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="Hands-On with XDP: eBPF for High-Performance Networking | iximiuz Labs"><meta name="twitter:description" content="In this tutorial, you’ll learn the fundamentals of eBPF and XDP through example code that parses packets across different protocol layers, demonstrates how XDP actions work, and shows how these building blocks form the foundation for high-performance networking applications."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/new-new-cover.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e"><link nonce="" rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/new-new-cover.png"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/_name_.BsyFxT4E.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseLi.BqrAa653.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseCodeInline.BhuXSD4-.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/ProsePre.B_fgAJq0.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/new-new-cover.png"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="Hands-On with XDP: eBPF for High-Performance Networking" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">Hands-On with XDP: eBPF for High-Performance Networking</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Febpf-xdp-fundamentals-6342d24e" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-xdp-fundamentals-6342d24e" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#ebpfxdp-program-type" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">eBPF/XDP Program Type</a><!----></li><li data-v-c294bba9=""><a href="#how-xdp-parses-ethernet-ip-ipv6-tcp-udp-and-icmp-headers" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">How XDP Parses Ethernet, IP, IPv6, TCP, UDP and ICMP Headers</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-xdp-fundamentals-6342d24e" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Programming</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="Hands-On with XDP: eBPF for High-Performance Networking"><meta itemprop="abstract" content="In this tutorial, you’ll learn the fundamentals of eBPF and XDP through example code that parses packets across different protocol layers, demonstrates how XDP actions work, and shows how these building blocks form the foundation for high-performance networking applications."><meta itemprop="dateCreated" content="2025-10-26T00:00:00.000Z"><meta itemprop="datePublished" content="2025-10-26T00:00:00.000Z"><meta itemprop="dateModified" content="2025-10-26T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:underline no-underline truncate">Programming</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Oct 26, 2025"><time datetime="createdAt"> Published: Oct 26, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">Hands-On with XDP: eBPF for High-Performance Networking</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->If
 you look at the Linux kernel’s networking stack code, it’s built to 
support a wide range of protocols and features — from IPv4/IPv6 and 
TCP/UDP to VLANs, tunnels such as VXLAN and GRE, as well as QoS and 
traffic shaping.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->However,
 every processing step a packet goes through adds microseconds of 
latency. It may sound small, but at millions of packets per second, this
 overhead quickly becomes a performance bottleneck that even modern 
hardware struggles to overcome.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->With this in mind, different kernel bypass techniques exist, such as <a href="https://www.dpdk.org/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->DPDK<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> or <a href="https://www.ntop.org/guides/pf_ring/index.html" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->PF_RING ZC<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.
 These frameworks let user-space applications receive packets directly 
from the network hardware instead of going through the kernel.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But
 since these frameworks bypass the kernel, applications must often 
reimplement many of its networking features—which adds complexity as 
well as weakens the security mechanism normally provided by the kernel.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/new.png" alt="XDP Fundamentals" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->To
 address these shortcomings, XDP (eXpress Data Path) was introduced. It 
enables in-kernel packet processing that reuses existing kernel 
networking and security features instead of reimplementing them in user 
space.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->That’s a
 rather rough comparison as DPDK can often be more performant, and XDP 
less complex to implement as it reuses many kernel features—but these 
are two technologies suited differently across environments, each with 
its own strengths and trade-offs.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To avoid making any enemies, in this skill path we’ll solely focus on:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->How XDP actually works?<!--]--></strong><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->What kinds of applications is it best suited for?<!--]--></strong><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->When should you consider using other eBPF program types higher up the stack?<!--]--></strong><!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->This
 tutorial marks the first step, where you’ll get hands-on experience 
parsing IPv4/IPv6, TCP/UDP, and ICMP traffic. In later tutorials, these 
fundamentals will be expanded with more advanced use cases such as 
packet rate-limiting, firewalling and load balancing.<!--]--></p><h2 id="ebpfxdp-program-type" class="prose-h2" data-v-b9b1576a=""><!--[-->eBPF/XDP Program Type<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->XDP
 (eXpress Data Path) is a type of eBPF program that attaches to the XDP 
hook point in the Linux kernel’s networking stack. As of now, there are 
three types of XDP hook points available (or I should say modes):<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Generic mode<!--]--></strong> – runs in the kernel network stack after the <code class="prose-code-inline" data-v-a031129a=""><!--[-->sk_buff<!--]--></code> allocation and is available on kernel versions v4.8+<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Native (driver) mode<!--]--></strong> – runs directly in the network driver before the <code class="prose-code-inline" data-v-a031129a=""><!--[-->sk_buff<!--]--></code> allocation, offering higher performance.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Hardware offload mode<!--]--></strong>
 – runs directly on the Network Interface Card (NIC) itself, achieving 
the highest performance but limited to supported hardware.<!--]--></li><!--]--></ul><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 Most common NICs, such as Intel i40e/ice/ixgbe and Mellanox mlx5, 
support XDP in native or driver mode, while hardware offload remains 
limited to Netronome SmartNICs.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->See the <a href="https://docs.ebpf.io/linux/program-type/BPF_PROG_TYPE_XDP/#driver-support" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> for the full list of supported drivers.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->The current playground you’re using only supports <strong class="prose-strong" data-v-24022f14=""><!--[-->Generic mode<!--]--></strong>, but it’s easy to imagine how <strong class="prose-strong" data-v-24022f14=""><!--[-->Native<!--]--></strong> or <strong class="prose-strong" data-v-24022f14=""><!--[-->HW Offload<!--]--></strong>
 modes could deliver better performance. For example, in an eBPF-based 
firewall, the earlier you capture a packet, the sooner you can drop 
it—reducing the overall system load and increasing throughput.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:600px;"><div class="text-center"><img src="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/netstackbetter.png" alt="XDP Modes in Network Stack" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 While we can't really compare the different modes of operations in this
 playground, one of the most costly operations in the kernel’s 
networking receive path is copying the packet data from the receive 
buffer (<code class="prose-code-inline" data-v-a031129a=""><!--[-->rx_ring<!--]--></code>) to a data structure called socket buffer (<code class="prose-code-inline" data-v-a031129a=""><!--[-->sk_buff<!--]--></code>).<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This
 is why you would see significant performance gains e.g. in load 
balancing or dropping high-volume of traffic when toggling between <strong class="prose-strong" data-v-24022f14=""><!--[-->Native/Driver<!--]--></strong> and <strong class="prose-strong" data-v-24022f14=""><!--[-->Generic<!--]--></strong> mode.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And
 it’s also why, if your program can be developed with XDP, it’s 
generally preferred over TC, since TC programs run after the socket 
buffer has already been allocated.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->In the case of the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-go<!--]--></code> framework we’re using, the mode can easily be toggled by specifying the desired option when attaching the XDP program:<!--]--></p><!--[--><div class="highlight-go prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/main.go</span><!--[--><pre class="language-go shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#9CDCFE">xdplink</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">AttachXDP</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#4EC9B0">link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#4EC9B0">XDPOptions</span><span style="--shiki-default:#E6E6E6">{
</span></span><span class="line" line="2"><span style="--shiki-default:#9CDCFE">            Program</span><span style="--shiki-default:#E6E6E6">:   </span><span style="--shiki-default:#9CDCFE">objs</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">XdpProgram</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="3"><span style="--shiki-default:#9CDCFE">            Interface</span><span style="--shiki-default:#E6E6E6">: </span><span style="--shiki-default:#9CDCFE">iface</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">Index</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="4"><span style="--shiki-default:#9CDCFE">            Flags</span><span style="--shiki-default:#E6E6E6">: </span><span style="--shiki-default:#9CDCFE">link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">XDPGenericMode</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">})
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Where you can set either <code class="prose-code-inline" data-v-a031129a=""><!--[-->XDPGenericMode<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->XDPDriverMode<!--]--></code>, or <code class="prose-code-inline" data-v-a031129a=""><!--[-->XDPOffloadMode<!--]--></code>, as defined in the <a href="https://pkg.go.dev/github.com/cilium/ebpf/link#XDPAttachFlags" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->ebpf-go documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 Important to mention is that we are also attaching this XDP program to a specific network interface.<!--]--></p><!--[--><div class="highlight-go prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/main.go</span><!--[--><pre class="language-go shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line highlight" line="1"><span style="--shiki-default:#9CDCFE">iface</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> net</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">InterfaceByName</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ifname</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0">if</span><span style="--shiki-default:#9CDCFE"> err</span><span style="--shiki-default:#D4D4D4"> !=</span><span style="--shiki-default:#569CD6"> nil</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="3"><span style="--shiki-default:#9CDCFE">    log</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">Fatalf</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Getting interface %s: %s"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">ifname</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">}
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#9CDCFE">xdplink</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">AttachXDP</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#4EC9B0">link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#4EC9B0">XDPOptions</span><span style="--shiki-default:#E6E6E6">{
</span></span><span class="line" line="7"><span style="--shiki-default:#9CDCFE">            Program</span><span style="--shiki-default:#E6E6E6">:   </span><span style="--shiki-default:#9CDCFE">objs</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">XdpProgram</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#9CDCFE">            Interface</span><span style="--shiki-default:#E6E6E6">: </span><span style="--shiki-default:#9CDCFE">iface</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">Index</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="9"><span style="--shiki-default:#9CDCFE">            Flags</span><span style="--shiki-default:#E6E6E6">: </span><span style="--shiki-default:#9CDCFE">link</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">XDPGenericMode</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="10"><span style="--shiki-default:#E6E6E6">})
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Different network interfaces can have different XDP programs attached.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->It’s
 even possible to load multiple XDP programs on a single network 
interface, but we’ll cover that in a later tutorial. If you want to get 
ahead, check out <a href="https://docs.ebpf.io/ebpf-library/libxdp/libxdp/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->libxdp<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Regardless of mode you set, most XDP programs follow the same pattern:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Parse the packet<!--]--></strong> — parse L2/L3/L4 headers and extract the fields your application care about.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Work with metadata<!--]--></strong> — process extracted fields (and lookup or update eBPF maps).<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Modify the packet (less common)<!--]--></strong> — rewrite headers or payload; adjust headroom/tailroom (e.g., <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_xdp_adjust_head/tail<!--]--></code>) for e.g. IPIP encapsulation or decapsulation.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Return a verdict<!--]--></strong> — exit with an action code that tells the kernel what to do next with the packet.<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 light of the last point, XDP supports several actions — or return 
codes, to be more precise — that define how your program behaves:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->XDP_PASS<!--]--></strong> – allow the packet to continue through the networking stack (as usual)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->XDP_DROP<!--]--></strong> – drop/discard the packet immediately<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->XDP_TX<!--]--></strong> – transmit the packet back out the same interface<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->XDP_REDIRECT<!--]--></strong> – send the packet to another network interface, CPU or special user-space socket (AF_XDP)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->XDP_ABORTED<!--]--></strong> – used for aborting the program execution due to an error<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->We'll
 learn how these actions/return codes are utilized in different use 
cases in this skill path - but they are here for reference.<!--]--></p><h2 id="how-xdp-parses-ethernet-ip-ipv6-tcp-udp-and-icmp-headers" class="prose-h2" data-v-b9b1576a=""><!--[-->How XDP Parses Ethernet, IP, IPv6, TCP, UDP and ICMP Headers<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->Enough
 theory — the goal of this tutorial is to understand how we can access 
the network packet metadata — the ground truth for any application 
you’ll see out there in the wild.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To start off, let’s first look at what kind of kernel context structure is passed to our eBPF/XDP program:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> xdp_md {
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u32 data;
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __u32 data_end;
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">    __u32 data_meta;
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    __u32 ingress_ifindex;
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">    __u32 rx_queue_index;
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">    __u32 egress_ifindex;
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Where fields represents:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->data<!--]--></strong> - Pointer to the start of the packet data (the beginning of the readable memory region)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->data_end<!--]--></strong> - Pointer to the end of the packet data (the end of the readable memory region)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->data_meta<!--]--></strong> - Optional space before data for custom metadata passed from XDP to later stages like TC - see <a href="https://docs.ebpf.io/linux/helper-function/bpf_xdp_adjust_meta/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->bpf_xdp_adjust_meta<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> for more info.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->ingress_ifindex<!--]--></strong> - Index of the network interface packet was received on<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->rx_queue_index<!--]--></strong> - Index of the receive queue on that interface where the packet was queued<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->egress_ifindex<!--]--></strong> - Set to the network interface index the packet was redirected out of, but only when the redirect happened<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->Most of the time, programs only use the <code class="prose-code-inline" data-v-a031129a=""><!--[-->data<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->data_end<!--]--></code>
 pointers — not only to access packet data but also to satisfy the eBPF 
verifier and ensure that all memory access stays within the packet’s 
boundaries.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In my opinion, making the verifier happy is also one of the hardest parts of XDP development.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To keep things simple, we’ll use the <code class="prose-code-inline" data-v-a031129a=""><!--[-->parse_helpers.h<!--]--></code> header file (originally from the <a href="https://github.com/xdp-project/xdp-tutorial" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->xdp-project/xdp-tutorial<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> repository), which simplifies much of the parsing logic for us.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 short, this header file provides a set of helper functions that safely 
access packet data and extract Ethernet, IPv4/IPv6, and TCP/UDP headers.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line highlight" line="2"><span style="--shiki-default:#C586C0">#include</span><span style="--shiki-default:#CE9178"> "parse_helpers.h"
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"xdp"</span><span style="--shiki-default:#E6E6E6">) 
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> xdp_program</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> xdp_md </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="6"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data_end </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data_end</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="7"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="8"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> hdr_cursor nh;
</span></span><span class="line" line="9"><span style="--shiki-default:#9CDCFE">    nh</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">pos</span><span style="--shiki-default:#D4D4D4"> =</span><span style="--shiki-default:#E6E6E6"> data;
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> ip_type;
</span></span><span class="line" line="12"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> ethhdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">eth;
</span></span><span class="line highlight" line="13"><span style="--shiki-default:#6A9955">    // Parse Ethernet header
</span></span><span class="line highlight" line="14"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> eth_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ethhdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">eth);
</span></span><span class="line" line="15"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IP)) { 
</span></span><span class="line" line="16"><span style="--shiki-default:#6A9955">        // We have captured an IPv4 packet
</span></span><span class="line" line="17"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> iphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ip;
</span></span><span class="line highlight" line="18"><span style="--shiki-default:#6A9955">        // Parse IPv4 header
</span></span><span class="line highlight" line="19"><span style="--shiki-default:#E6E6E6">        ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_iphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ip);
</span></span><span class="line" line="20"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line" line="21"><span emptylineplaceholder="true">
</span></span><span class="line" line="22"><span style="--shiki-default:#C586C0">        if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_ICMP) {
</span></span><span class="line" line="23"><span style="--shiki-default:#6A9955">            // We have captured an ICMP packet
</span></span><span class="line" line="24"><span style="--shiki-default:#569CD6">            struct</span><span style="--shiki-default:#E6E6E6"> icmphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">icmp;
</span></span><span class="line highlight" line="25"><span style="--shiki-default:#6A9955">            // Parse ICMP header
</span></span><span class="line highlight" line="26"><span style="--shiki-default:#569CD6">            int</span><span style="--shiki-default:#E6E6E6"> icmp_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_icmphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">icmp);
</span></span><span class="line" line="27"><span style="--shiki-default:#E6E6E6">            ...
</span></span><span class="line" line="28"><span style="--shiki-default:#E6E6E6">        }
</span></span><span class="line" line="29"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#C586C0"> if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IPV6)) {
</span></span><span class="line" line="30"><span style="--shiki-default:#6A9955">        // We have captured an IPv6 packet
</span></span><span class="line" line="31"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> ipv6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ipv6;
</span></span><span class="line highlight" line="32"><span style="--shiki-default:#6A9955">        // Parse IPv6 header
</span></span><span class="line highlight" line="33"><span style="--shiki-default:#E6E6E6">        ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ip6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ipv6);
</span></span><span class="line" line="34"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line" line="35"><span emptylineplaceholder="true">
</span></span><span class="line" line="36"><span style="--shiki-default:#C586C0">        if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_ICMPV6) {
</span></span><span class="line" line="37"><span style="--shiki-default:#6A9955">            // We have captured an ICMPv6 packet
</span></span><span class="line" line="38"><span style="--shiki-default:#569CD6">            struct</span><span style="--shiki-default:#E6E6E6"> icmp6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">icmp6;
</span></span><span class="line highlight" line="39"><span style="--shiki-default:#6A9955">            // Parse ICMPv6 header
</span></span><span class="line highlight" line="40"><span style="--shiki-default:#569CD6">            int</span><span style="--shiki-default:#E6E6E6"> icmp6_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_icmp6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">icmp6);
</span></span><span class="line" line="41"><span style="--shiki-default:#E6E6E6">            ...
</span></span><span class="line" line="42"><span style="--shiki-default:#E6E6E6">        }
</span></span><span class="line" line="43"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="44"><span emptylineplaceholder="true">
</span></span><span class="line" line="45"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_TCP) {
</span></span><span class="line" line="46"><span style="--shiki-default:#6A9955">        // We have captured a TCP packet
</span></span><span class="line" line="47"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> tcphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">tcp;
</span></span><span class="line highlight" line="48"><span style="--shiki-default:#6A9955">        // Parse TCP header
</span></span><span class="line highlight" line="49"><span style="--shiki-default:#569CD6">        int</span><span style="--shiki-default:#E6E6E6"> tcp_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_tcphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">tcp);
</span></span><span class="line" line="50"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line" line="51"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#C586C0"> if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_UDP) {
</span></span><span class="line" line="52"><span style="--shiki-default:#6A9955">        // We have captured a UDP packet
</span></span><span class="line" line="53"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> udphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">udp;
</span></span><span class="line highlight" line="54"><span style="--shiki-default:#6A9955">        // Parse UDP header
</span></span><span class="line highlight" line="55"><span style="--shiki-default:#569CD6">        int</span><span style="--shiki-default:#E6E6E6"> udp_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_udphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">udp);
</span></span><span class="line" line="56"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line" line="57"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="58"><span style="--shiki-default:#E6E6E6">    ...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->All of these helpers functions take in:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->struct hdr_cursor *nh<!--]--></code><!--]--></strong> — a moving “cursor” that is initialy pointing to the beginning of that packet data (<code class="prose-code-inline" data-v-a031129a=""><!--[-->nh.pos = data;<!--]--></code>). Each helper then advances <code class="prose-code-inline" data-v-a031129a=""><!--[-->nh-&gt;pos<!--]--></code> past the header it successfully parses, so subsequent parsing helpers start at the right place.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->void *data_end<!--]--></code><!--]--></strong> — the end of the valid packet region to perform bounds checks so you never read past the packet.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->&lt;header&gt; **out<!--]--></code><!--]--></strong> — an output pointer that points to the parsed header (e.g., <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct ethhdr<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct iphdr<!--]--></code>, etc.).<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->If
 we look at each stage in a bit more details, by parsing the Ethernet 
header we can distinguish between IPv4 and IPv6 protocol and extract 
header information accordingly.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"xdp"</span><span style="--shiki-default:#E6E6E6">) 
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> xdp_program</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> xdp_md </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data_end </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data_end</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> hdr_cursor nh;
</span></span><span class="line" line="6"><span style="--shiki-default:#9CDCFE">    nh</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">pos</span><span style="--shiki-default:#D4D4D4"> =</span><span style="--shiki-default:#E6E6E6"> data;
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> ip_type;
</span></span><span class="line" line="9"><span style="--shiki-default:#6A9955">    // Parse Ethernet header
</span></span><span class="line" line="10"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> ethhdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">eth;
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> eth_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ethhdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">eth);
</span></span><span class="line highlight" line="12"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IP)) { 
</span></span><span class="line" line="13"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an IPv4 packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="14"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> iphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ip;
</span></span><span class="line highlight" line="15"><span style="--shiki-default:#6A9955">        // Parse IPv4 header
</span></span><span class="line highlight" line="16"><span style="--shiki-default:#E6E6E6">        ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_iphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ip);
</span></span><span class="line highlight" line="17"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="18"><span style="--shiki-default:#E6E6E6">        __u32 src </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_ntohl</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ip</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="19"><span style="--shiki-default:#E6E6E6">        __u32 dst </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_ntohl</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ip</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="20"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"IPv4 src: %d.%d.%d.%d"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="21"><span style="--shiki-default:#E6E6E6">            (src </span><span style="--shiki-default:#D4D4D4">&gt;&gt;</span><span style="--shiki-default:#B5CEA8"> 24</span><span style="--shiki-default:#E6E6E6">) </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="22"><span style="--shiki-default:#E6E6E6">            (src </span><span style="--shiki-default:#D4D4D4">&gt;&gt;</span><span style="--shiki-default:#B5CEA8"> 16</span><span style="--shiki-default:#E6E6E6">) </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="23"><span style="--shiki-default:#E6E6E6">            (src </span><span style="--shiki-default:#D4D4D4">&gt;&gt;</span><span style="--shiki-default:#B5CEA8"> 8</span><span style="--shiki-default:#E6E6E6">)  </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="24"><span style="--shiki-default:#E6E6E6">            src </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="25"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"IPv4 dst: %d.%d.%d.%d"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="26"><span style="--shiki-default:#E6E6E6">            (dst </span><span style="--shiki-default:#D4D4D4">&gt;&gt;</span><span style="--shiki-default:#B5CEA8"> 24</span><span style="--shiki-default:#E6E6E6">) </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="27"><span style="--shiki-default:#E6E6E6">            (dst </span><span style="--shiki-default:#D4D4D4">&gt;&gt;</span><span style="--shiki-default:#B5CEA8"> 16</span><span style="--shiki-default:#E6E6E6">) </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="28"><span style="--shiki-default:#E6E6E6">            (dst </span><span style="--shiki-default:#D4D4D4">&gt;&gt;</span><span style="--shiki-default:#B5CEA8"> 8</span><span style="--shiki-default:#E6E6E6">)  </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="29"><span style="--shiki-default:#E6E6E6">            dst </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#B5CEA8"> 0xFF</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="30"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="31"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#C586C0"> if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IPV6)) {
</span></span><span class="line" line="32"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an IPv6 packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="33"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> ipv6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ipv6;
</span></span><span class="line highlight" line="34"><span style="--shiki-default:#6A9955">        // Parse IPv6 header
</span></span><span class="line highlight" line="35"><span style="--shiki-default:#E6E6E6">        ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ip6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ipv6);
</span></span><span class="line highlight" line="36"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="37"><span style="--shiki-default:#6A9955">        // Print as 4x32-bit chunks (hex)
</span></span><span class="line highlight" line="38"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"IPv6 src: %x:%x:%x:%x:%x:%x:%x:%x"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="39"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="40"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="41"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">2</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="42"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">3</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="43"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">4</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="44"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">5</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="45"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">6</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="46"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">7</span><span style="--shiki-default:#E6E6E6">]));
</span></span><span class="line highlight" line="47"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"IPv6 dst: %x:%x:%x:%x:%x:%x:%x:%x"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="48"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="49"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="50"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">2</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="51"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">3</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="52"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">4</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="53"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">5</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="54"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">6</span><span style="--shiki-default:#E6E6E6">]),
</span></span><span class="line highlight" line="55"><span style="--shiki-default:#DCDCAA">            bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">ipv6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">daddr</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">in6_u</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u6_addr16</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">7</span><span style="--shiki-default:#E6E6E6">]));
</span></span><span class="line" line="56"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line" line="57"><span style="--shiki-default:#E6E6E6">    }
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 If you look closely at the code, you’ll notice that we’re using eBPF helpers like <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_ntohs()<!--]--></code> to convert values from network byte order to host byte order and make them easier to interpret in the program.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For more information about these eBPF helpers and their usage, refer to the <a href="https://docs.ebpf.io/ebpf-library/libbpf/ebpf/bpf_ntohs/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->official eBPF documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->At a minimum, this gives us access to the <strong class="prose-strong" data-v-24022f14=""><!--[-->source and destination IPv4/IPv6 addresses<!--]--></strong>, which can be used to identify clients (by IP), useful for rate limiting or firewall applications.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 The IP header also exposes other useful fields — such as TTL, protocol 
type (TCP/UDP), fragment offset, and total length — that can be 
leveraged for deeper packet analysis.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Check out <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct iphdr<!--]--></code> or <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct ipv6hdr<!--]--></code> in the <code class="prose-code-inline" data-v-a031129a=""><!--[-->lab/vmlinux.h<!--]--></code> file to see all the packet header fields available to us.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->There's that, but our XDP program also showcases how to parse TCP, UDP and ICMP protocols:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"xdp"</span><span style="--shiki-default:#E6E6E6">) 
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> xdp_program</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> xdp_md </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data_end </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data_end</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">    void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">data </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">void</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#569CD6">unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">data</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> hdr_cursor nh;
</span></span><span class="line" line="6"><span style="--shiki-default:#9CDCFE">    nh</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">pos</span><span style="--shiki-default:#D4D4D4"> =</span><span style="--shiki-default:#E6E6E6"> data;
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> ip_type;
</span></span><span class="line" line="9"><span style="--shiki-default:#6A9955">    // Parse Ethernet header
</span></span><span class="line" line="10"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> ethhdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">eth;
</span></span><span class="line" line="11"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> eth_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ethhdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">eth);
</span></span><span class="line" line="12"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IP)) { 
</span></span><span class="line" line="13"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an IPv4 packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="14"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> iphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ip;
</span></span><span class="line highlight" line="15"><span style="--shiki-default:#6A9955">        // Parse IPv4 header
</span></span><span class="line highlight" line="16"><span style="--shiki-default:#E6E6E6">        ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_iphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ip);
</span></span><span class="line" line="17"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="18"><span style="--shiki-default:#C586C0">        if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_ICMP) {
</span></span><span class="line" line="19"><span style="--shiki-default:#DCDCAA">            bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an ICMP packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="20"><span style="--shiki-default:#6A9955">            // Parse ICMP header
</span></span><span class="line" line="21"><span style="--shiki-default:#569CD6">            struct</span><span style="--shiki-default:#E6E6E6"> icmphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">icmp;
</span></span><span class="line highlight" line="22"><span style="--shiki-default:#569CD6">            int</span><span style="--shiki-default:#E6E6E6"> icmp_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_icmphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">icmp);
</span></span><span class="line highlight" line="23"><span style="--shiki-default:#E6E6E6">            ...
</span></span><span class="line highlight" line="24"><span style="--shiki-default:#DCDCAA">            bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Type: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">icmp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">type</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="25"><span style="--shiki-default:#DCDCAA">            bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Code: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">icmp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">code</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="26"><span style="--shiki-default:#C586C0">            if</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#9CDCFE">icmp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">type</span><span style="--shiki-default:#D4D4D4"> ==</span><span style="--shiki-default:#E6E6E6"> ICMP_ECHO </span><span style="--shiki-default:#D4D4D4">||</span><span style="--shiki-default:#9CDCFE"> icmp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">type</span><span style="--shiki-default:#D4D4D4"> ==</span><span style="--shiki-default:#E6E6E6"> ICMP_ECHOREPLY) {
</span></span><span class="line highlight" line="27"><span style="--shiki-default:#DCDCAA">                bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Echo id=%d seq=%d</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="28"><span style="--shiki-default:#DCDCAA">                bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">icmp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">un</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">echo</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">id</span><span style="--shiki-default:#E6E6E6">),
</span></span><span class="line highlight" line="29"><span style="--shiki-default:#DCDCAA">                bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">icmp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">un</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">echo</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">sequence</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="30"><span style="--shiki-default:#E6E6E6">            }
</span></span><span class="line" line="31"><span style="--shiki-default:#E6E6E6">        }
</span></span><span class="line highlight" line="32"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#C586C0"> if</span><span style="--shiki-default:#E6E6E6"> (eth_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#DCDCAA"> bpf_htons</span><span style="--shiki-default:#E6E6E6">(ETH_P_IPV6)) {
</span></span><span class="line" line="33"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an IPv6 packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="34"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> ipv6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">ipv6;
</span></span><span class="line highlight" line="35"><span style="--shiki-default:#6A9955">        // Parse IPv6 header
</span></span><span class="line highlight" line="36"><span style="--shiki-default:#E6E6E6">        ip_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_ip6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">ipv6);
</span></span><span class="line" line="37"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="38"><span style="--shiki-default:#C586C0">        if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_ICMPV6) {
</span></span><span class="line highlight" line="39"><span style="--shiki-default:#DCDCAA">            bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured an ICMP packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="40"><span style="--shiki-default:#569CD6">            struct</span><span style="--shiki-default:#E6E6E6"> icmp6hdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">icmp6;
</span></span><span class="line highlight" line="41"><span style="--shiki-default:#6A9955">            // Parse ICMP header
</span></span><span class="line highlight" line="42"><span style="--shiki-default:#569CD6">            int</span><span style="--shiki-default:#E6E6E6"> icmp6_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_icmp6hdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">icmp6);
</span></span><span class="line highlight" line="43"><span style="--shiki-default:#E6E6E6">            ...
</span></span><span class="line highlight" line="44"><span style="--shiki-default:#DCDCAA">            bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Type: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_type</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="45"><span style="--shiki-default:#DCDCAA">            bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Code: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_code</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="46"><span style="--shiki-default:#C586C0">            if</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_type</span><span style="--shiki-default:#D4D4D4"> ==</span><span style="--shiki-default:#E6E6E6"> ICMPV6_ECHO_REQUEST </span><span style="--shiki-default:#D4D4D4">||</span><span style="--shiki-default:#9CDCFE"> icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_type</span><span style="--shiki-default:#D4D4D4"> ==</span><span style="--shiki-default:#E6E6E6"> ICMPV6_ECHO_REPLY) {
</span></span><span class="line highlight" line="47"><span style="--shiki-default:#DCDCAA">                bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Echo id=%d seq=%d</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="48"><span style="--shiki-default:#DCDCAA">                bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_dataun</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u_echo</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">identifier</span><span style="--shiki-default:#E6E6E6">),
</span></span><span class="line highlight" line="49"><span style="--shiki-default:#DCDCAA">                bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">icmp6</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">icmp6_dataun</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">u_echo</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">sequence</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="50"><span style="--shiki-default:#E6E6E6">            }
</span></span><span class="line highlight" line="51"><span style="--shiki-default:#E6E6E6">        }
</span></span><span class="line" line="52"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="53"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="54"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_TCP) {
</span></span><span class="line highlight" line="55"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured a TCP packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="56"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> tcphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">tcp;
</span></span><span class="line highlight" line="57"><span style="--shiki-default:#6A9955">        // Parse TCP header
</span></span><span class="line highlight" line="58"><span style="--shiki-default:#569CD6">        int</span><span style="--shiki-default:#E6E6E6"> tcp_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_tcphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">tcp);
</span></span><span class="line highlight" line="59"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="60"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Source port: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">source</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="61"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Destination port: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">dest</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="62"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Sequence number: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">seq</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="63"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Acknowledgment number: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">ack_seq</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="64"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Flags: SYN=%d ACK=%d FIN=%d RST=%d PSH=%d URG=%d ECE=%d CWR=%d"</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line highlight" line="65"><span style="--shiki-default:#9CDCFE">                tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">syn</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">ack</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">fin</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">rst</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">psh</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">urg</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">ece</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">tcp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">cwr</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="66"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#C586C0"> if</span><span style="--shiki-default:#E6E6E6"> (ip_type </span><span style="--shiki-default:#D4D4D4">==</span><span style="--shiki-default:#E6E6E6"> IPPROTO_UDP) {
</span></span><span class="line highlight" line="67"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"We have captured a UDP packet"</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line highlight" line="68"><span style="--shiki-default:#6A9955">        // Parse UDP header
</span></span><span class="line highlight" line="69"><span style="--shiki-default:#569CD6">        struct</span><span style="--shiki-default:#E6E6E6"> udphdr </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">udp;
</span></span><span class="line highlight" line="70"><span style="--shiki-default:#569CD6">        int</span><span style="--shiki-default:#E6E6E6"> udp_type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> parse_udphdr</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">nh, data_end, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">udp);
</span></span><span class="line highlight" line="71"><span style="--shiki-default:#E6E6E6">        ...
</span></span><span class="line highlight" line="72"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Source port: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">udp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">source</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="73"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Destination port: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">udp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">dest</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="74"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Length of the UDP datagram: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">udp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">len</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="75"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Checksum for error detection: %d"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#DCDCAA">bpf_ntohs</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">udp</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">check</span><span style="--shiki-default:#E6E6E6">));
</span></span><span class="line highlight" line="76"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="77"><span style="--shiki-default:#E6E6E6">    ...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->This way, we can access different fields depending on the type of network packet we’ve captured:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->TCP<!--]--></strong><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->Extracts
 source and destination ports, sequence and acknowledgment numbers, and 
flags such as SYN, ACK, FIN, RST, PSH, URG, ECE, and CWR.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Useful for tracking client connections, detecting SYN floods, and analyzing general TCP traffic (e.g., RTT, retransmissions).<!--]--></li><!--]--></ul><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->UDP<!--]--></strong><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->Extracts source and destination ports, datagram length, and checksum.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Useful for monitoring UDP-based protocols such as DNS or QUIC.<!--]--></li><!--]--></ul><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->ICMP / ICMPv6<!--]--></strong><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->Extracts type, code, and—for echo messages—the identifier and sequence fields.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Useful for monitoring network health, detecting ping sweeps or DoS attempts, and diagnosing connectivity issues.<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->It
 should now be much easier to understand how different protocols can be 
parsed, and how the program can branch into separate code paths—each 
capable of triggering specific XDP actions and enabling one to develop 
different types of applications.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Let’s see this in action by observing a simple HTTP request from a client to a server.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Hands-On%20with%20XDP_%20eBPF%20for%20High-Performance%20Networking_files/client-server.png" alt="Playground Setup" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->First, start an HTTP server in the <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> tab:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">python3</span><span style="--shiki-default:#CE9178"> -m</span><span style="--shiki-default:#CE9178"> http.server</span><span style="--shiki-default:#B5CEA8"> 8000
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Next, open another <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> tab (click <code class="prose-code-inline" data-v-a031129a=""><!--[-->+<!--]--></code> → select <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code>), then build and run our XDP program inside the <code class="prose-code-inline" data-v-a031129a=""><!--[-->lab<!--]--></code> folder:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> generate
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> build
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ./xdp</span><span style="--shiki-default:#CE9178"> -i</span><span style="--shiki-default:#CE9178"> eth0
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->For
 simplicity, the program prints packet header information directly to 
the eBPF trace logs. While we could forward this data to user space, we 
avoid that complexity for now. Open another <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> tab and run:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> prog</span><span style="--shiki-default:#CE9178"> trace
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Finally, from the <code class="prose-code-inline" data-v-a031129a=""><!--[-->client<!--]--></code> tab, send a request to the server:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">curl</span><span style="--shiki-default:#CE9178"> http://172.16.0.10:8000/
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->You should now see your XDP program printing parsed Ethernet, IP and TCP-related packet details in real time.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->You’ll notice that the logs contain a lot of network traffic—not just clients' <code class="prose-code-inline" data-v-a031129a=""><!--[-->curl<!--]--></code>
 request. As a small challenge, try modifying the code so that only 
packets with TCP destination port 8000 (the HTTP server’s listening 
port) are printed.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Or, if you prefer a quicker workaround, simply use <code class="prose-code-inline" data-v-a031129a=""><!--[-->grep<!--]--></code>:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> prog</span><span style="--shiki-default:#CE9178"> trace</span><span style="--shiki-default:#D4D4D4"> |</span><span style="--shiki-default:#DCDCAA"> grep</span><span style="--shiki-default:#B5CEA8"> 8000</span><span style="--shiki-default:#CE9178"> -A</span><span style="--shiki-default:#B5CEA8"> 4</span><span style="--shiki-default:#CE9178"> -B</span><span style="--shiki-default:#B5CEA8"> 4
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->But so far, we’ve only looked at the headers — what about application data like HTTP in our case?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->XDP
 can only access the raw packet data that fits within a single MTU-sized
 frame, so it can’t always reliably parse application-layer protocols 
like HTTP. For that, eBPF hooks higher up the stack that operate on 
reassembled packet streams are more suitable.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->We’ll
 cover those soon, but this limitation is a key reason why developers 
often combine XDP with other program types—even though XDP is the most 
performant option and seems ideal for many networking tasks.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Instead
 of only describing use cases, the upcoming tutorials will walk through 
building real eBPF applications like packet rate limiting, firewalling 
and load balancing with XDP.<!--]--></p><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game — Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-ebpf-xdp-fundamentals-6342d24e" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10"> ✕ </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial ebpf-xdp-fundamentals-6342d24e<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">ebpf-xdp-fundamentals-6342d24e</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial ebpf-xdp-fundamentals-6342d24e<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-xdp-fundamentals-6342d24e" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":7000,"once":7015,"_errors":7016,"serverRendered":11,"path":7018},["ShallowReactive",3],{"tutorial-page-tutorial-ebpf-xdp-fundamentals-6342d24e":4,"content-tutorial-ebpf-xdp-fundamentals-6342d24e-v1764319325996":49,"i-material-symbols-light:expand-content":6994,"i-ph:copy":6997},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":40,"completionCount":41,"accessControl":42,"userAccess":48},"68fe17d1c1566565df8ada99","tutorial","ebpf-xdp-fundamentals-6342d24e","Hands-On with XDP: eBPF for High-Performance Networking","In this tutorial, you’ll learn the fundamentals of eBPF and XDP through example code that parses packets across different protocol layers, demonstrates how XDP actions work, and shows how these building blocks form the foundation for high-performance networking applications.","2025-10-26T00:00:00.000Z",true,"flexbox",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#ebpf-xdp-fundamentals-6342d24e","2025-10-26","tutorials/ebpf-xdp-fundamentals-6342d24e/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1764319325996,"https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e","/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/new-new-cover.png",[30,31],"linux","programming",[33],"eBPF","todo",{"clone_hello_world":36},{"init":11,"user":37,"name":38,"status":39},"laborant","clone_hello_world",0,52,13,{"canList":43,"canPreview":45,"canRead":46,"canStart":47},[44],"anyone",[44],[44],[44],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[50],{"title":8,"description":51,"kind":6,"playground":52,"categories":90,"tagz":91,"createdAt":10,"updatedAt":10,"cover":28,"type":92,"children":93,"hash":15,"preview":-1,"pageUrl":27,"tasks":6982,"toc":6983,"tutorials":6987,"challenges":6989,"courses":6991,"key":6993},"In this tutorial, you’ll learn the fundamentals of eBPF and XDP through example code that parses packets across different protocol layers, demonstrates how XDP actions work, and shows how these building blocks form the foundation for high-performance networking applications.\n",{"name":12,"networks":53,"machines":57},[54],{"name":55,"subnet":56},"net-1","172.16.0.0/24",[58,77],{"name":59,"kernel":60,"drives":62,"users":67,"network":70,"resources":74},"server",{"source":61},"6.1",[63],{"source":64,"mount":65,"size":66},"oci://ghcr.io/dorkamotorka/ebpf-labs:latest","/","10GiB",[68],{"name":37,"default":11,"welcome":69},"This is the server node.\n\nIP: 172.16.0.10/24\n",{"interfaces":71},[72],{"network":55,"address":73},"172.16.0.10",{"cpuCount":75,"ramSize":76},4,"8GiB",{"name":78,"kernel":79,"drives":80,"users":82,"network":85,"resources":89},"client",{"source":61},[81],{"source":64,"mount":65,"size":66},[83],{"name":37,"default":11,"welcome":84},"This is a client node.\n\nIP: 172.16.0.11/24\n",{"interfaces":86},[87],{"network":55,"address":88},"172.16.0.11",{"cpuCount":75,"ramSize":76},[30,31],[33],"root",[94,102,107,132,137,143,148,153,158,188,193,200,205,254,278,302,308,355,368,556,591,911,916,967,972,1025,1030,1036,1041,1046,1124,1129,1201,1219,1224,1246,1251,2418,2423,2499,2504,4341,4370,4382,4417,4422,6569,6574,6640,6645,6650,6655,6667,6699,6734,6788,6800,6829,6841,6861,6866,6878,6891,6953,6961,6966,6971,6976],{"type":95,"tag":96,"props":97,"children":98},"element","p",{},[99],{"type":100,"value":101},"text","If you look at the Linux kernel’s networking stack code, it’s built to support a wide range of protocols and features — from IPv4/IPv6 and TCP/UDP to VLANs, tunnels such as VXLAN and GRE, as well as QoS and traffic shaping.",{"type":95,"tag":96,"props":103,"children":104},{},[105],{"type":100,"value":106},"However, every processing step a packet goes through adds microseconds of latency. It may sound small, but at millions of packets per second, this overhead quickly becomes a performance bottleneck that even modern hardware struggles to overcome.",{"type":95,"tag":96,"props":108,"children":109},{},[110,112,121,123,130],{"type":100,"value":111},"With this in mind, different kernel bypass techniques exist, such as ",{"type":95,"tag":113,"props":114,"children":118},"a",{"href":115,"rel":116},"https://www.dpdk.org/",[117],"nofollow",[119],{"type":100,"value":120},"DPDK",{"type":100,"value":122}," or ",{"type":95,"tag":113,"props":124,"children":127},{"href":125,"rel":126},"https://www.ntop.org/guides/pf_ring/index.html",[117],[128],{"type":100,"value":129},"PF_RING ZC",{"type":100,"value":131},". These frameworks let user-space applications receive packets directly from the network hardware instead of going through the kernel.",{"type":95,"tag":96,"props":133,"children":134},{},[135],{"type":100,"value":136},"But since these frameworks bypass the kernel, applications must often reimplement many of its networking features—which adds complexity as well as weakens the security mechanism normally provided by the kernel.",{"type":95,"tag":138,"props":139,"children":142},"image-box",{":alt":140,":src":141},"XDP Fundamentals","/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/new.png",[],{"type":95,"tag":96,"props":144,"children":145},{},[146],{"type":100,"value":147},"To address these shortcomings, XDP (eXpress Data Path) was introduced. It enables in-kernel packet processing that reuses existing kernel networking and security features instead of reimplementing them in user space.",{"type":95,"tag":96,"props":149,"children":150},{},[151],{"type":100,"value":152},"That’s a rather rough comparison as DPDK can often be more performant, and XDP less complex to implement as it reuses many kernel features—but these are two technologies suited differently across environments, each with its own strengths and trade-offs.",{"type":95,"tag":96,"props":154,"children":155},{},[156],{"type":100,"value":157},"To avoid making any enemies, in this skill path we’ll solely focus on:",{"type":95,"tag":159,"props":160,"children":161},"ul",{},[162,172,180],{"type":95,"tag":163,"props":164,"children":165},"li",{},[166],{"type":95,"tag":167,"props":168,"children":169},"strong",{},[170],{"type":100,"value":171},"How XDP actually works?",{"type":95,"tag":163,"props":173,"children":174},{},[175],{"type":95,"tag":167,"props":176,"children":177},{},[178],{"type":100,"value":179},"What kinds of applications is it best suited for?",{"type":95,"tag":163,"props":181,"children":182},{},[183],{"type":95,"tag":167,"props":184,"children":185},{},[186],{"type":100,"value":187},"When should you consider using other eBPF program types higher up the stack?",{"type":95,"tag":96,"props":189,"children":190},{},[191],{"type":100,"value":192},"This tutorial marks the first step, where you’ll get hands-on experience parsing IPv4/IPv6, TCP/UDP, and ICMP traffic. In later tutorials, these fundamentals will be expanded with more advanced use cases such as packet rate-limiting, firewalling and load balancing.",{"type":95,"tag":194,"props":195,"children":197},"h2",{"id":196},"ebpfxdp-program-type",[198],{"type":100,"value":199},"eBPF/XDP Program Type",{"type":95,"tag":96,"props":201,"children":202},{},[203],{"type":100,"value":204},"XDP (eXpress Data Path) is a type of eBPF program that attaches to the XDP hook point in the Linux kernel’s networking stack. As of now, there are three types of XDP hook points available (or I should say modes):",{"type":95,"tag":159,"props":206,"children":207},{},[208,227,244],{"type":95,"tag":163,"props":209,"children":210},{},[211,216,218,225],{"type":95,"tag":167,"props":212,"children":213},{},[214],{"type":100,"value":215},"Generic mode",{"type":100,"value":217}," – runs in the kernel network stack after the ",{"type":95,"tag":219,"props":220,"children":222},"code",{"className":221},[],[223],{"type":100,"value":224},"sk_buff",{"type":100,"value":226}," allocation and is available on kernel versions v4.8+",{"type":95,"tag":163,"props":228,"children":229},{},[230,235,237,242],{"type":95,"tag":167,"props":231,"children":232},{},[233],{"type":100,"value":234},"Native (driver) mode",{"type":100,"value":236}," – runs directly in the network driver before the ",{"type":95,"tag":219,"props":238,"children":240},{"className":239},[],[241],{"type":100,"value":224},{"type":100,"value":243}," allocation, offering higher performance.",{"type":95,"tag":163,"props":245,"children":246},{},[247,252],{"type":95,"tag":167,"props":248,"children":249},{},[250],{"type":100,"value":251},"Hardware offload mode",{"type":100,"value":253}," – runs directly on the Network Interface Card (NIC) itself, achieving the highest performance but limited to supported hardware.",{"type":95,"tag":255,"props":256,"children":258},"remark-box",{"kind":257},"info",[259,264],{"type":95,"tag":96,"props":260,"children":261},{},[262],{"type":100,"value":263},"💡 Most common NICs, such as Intel i40e/ice/ixgbe and Mellanox mlx5, support XDP in native or driver mode, while hardware offload remains limited to Netronome SmartNICs.",{"type":95,"tag":96,"props":265,"children":266},{},[267,269,276],{"type":100,"value":268},"See the ",{"type":95,"tag":113,"props":270,"children":273},{"href":271,"rel":272},"https://docs.ebpf.io/linux/program-type/BPF_PROG_TYPE_XDP/#driver-support",[117],[274],{"type":100,"value":275},"documentation",{"type":100,"value":277}," for the full list of supported drivers.",{"type":95,"tag":96,"props":279,"children":280},{},[281,283,287,289,294,295,300],{"type":100,"value":282},"The current playground you’re using only supports ",{"type":95,"tag":167,"props":284,"children":285},{},[286],{"type":100,"value":215},{"type":100,"value":288},", but it’s easy to imagine how ",{"type":95,"tag":167,"props":290,"children":291},{},[292],{"type":100,"value":293},"Native",{"type":100,"value":122},{"type":95,"tag":167,"props":296,"children":297},{},[298],{"type":100,"value":299},"HW Offload",{"type":100,"value":301}," modes could deliver better performance. For example, in an eBPF-based firewall, the earlier you capture a packet, the sooner you can drop it—reducing the overall system load and increasing throughput.",{"type":95,"tag":138,"props":303,"children":307},{":alt":304,":src":305,":max-width":306},"XDP Modes in Network Stack","/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/netstackbetter.png","600px",[],{"type":95,"tag":255,"props":309,"children":310},{"kind":257},[311,331,350],{"type":95,"tag":96,"props":312,"children":313},{},[314,316,322,324,329],{"type":100,"value":315},"💡 While we can't really compare the different modes of operations in this playground, one of the most costly operations in the kernel’s networking receive path is copying the packet data from the receive buffer (",{"type":95,"tag":219,"props":317,"children":319},{"className":318},[],[320],{"type":100,"value":321},"rx_ring",{"type":100,"value":323},") to a data structure called socket buffer (",{"type":95,"tag":219,"props":325,"children":327},{"className":326},[],[328],{"type":100,"value":224},{"type":100,"value":330},").",{"type":95,"tag":96,"props":332,"children":333},{},[334,336,341,343,348],{"type":100,"value":335},"This is why you would see significant performance gains e.g. in load balancing or dropping high-volume of traffic when toggling between ",{"type":95,"tag":167,"props":337,"children":338},{},[339],{"type":100,"value":340},"Native/Driver",{"type":100,"value":342}," and ",{"type":95,"tag":167,"props":344,"children":345},{},[346],{"type":100,"value":347},"Generic",{"type":100,"value":349}," mode.",{"type":95,"tag":96,"props":351,"children":352},{},[353],{"type":100,"value":354},"And it’s also why, if your program can be developed with XDP, it’s generally preferred over TC, since TC programs run after the socket buffer has already been allocated.",{"type":95,"tag":96,"props":356,"children":357},{},[358,360,366],{"type":100,"value":359},"In the case of the ",{"type":95,"tag":219,"props":361,"children":363},{"className":362},[],[364],{"type":100,"value":365},"ebpf-go",{"type":100,"value":367}," framework we’re using, the mode can easily be toggled by specifying the desired option when attaching the XDP program:",{"type":95,"tag":369,"props":370,"children":377},"pre",{"className":371,"code":372,"filename":373,"highlights":374,"language":375,"meta":376,"style":376},"language-go shiki shiki-themes slack-dark","xdplink, err := link.AttachXDP(link.XDPOptions{\n            Program:   objs.XdpProgram,\n            Interface: iface.Index,\n            Flags: link.XDPGenericMode,\n})\n","lab/main.go",[75],"go","",[378],{"type":95,"tag":219,"props":379,"children":380},{"__ignoreMap":376},[381,451,484,516,547],{"type":95,"tag":382,"props":383,"children":386},"span",{"class":384,"line":385},"line",1,[387,393,399,404,410,415,420,426,431,437,441,446],{"type":95,"tag":382,"props":388,"children":390},{"style":389},"--shiki-default:#9CDCFE",[391],{"type":100,"value":392},"xdplink",{"type":95,"tag":382,"props":394,"children":396},{"style":395},"--shiki-default:#E6E6E6",[397],{"type":100,"value":398},", ",{"type":95,"tag":382,"props":400,"children":401},{"style":389},[402],{"type":100,"value":403},"err",{"type":95,"tag":382,"props":405,"children":407},{"style":406},"--shiki-default:#D4D4D4",[408],{"type":100,"value":409}," :=",{"type":95,"tag":382,"props":411,"children":412},{"style":389},[413],{"type":100,"value":414}," link",{"type":95,"tag":382,"props":416,"children":417},{"style":395},[418],{"type":100,"value":419},".",{"type":95,"tag":382,"props":421,"children":423},{"style":422},"--shiki-default:#DCDCAA",[424],{"type":100,"value":425},"AttachXDP",{"type":95,"tag":382,"props":427,"children":428},{"style":395},[429],{"type":100,"value":430},"(",{"type":95,"tag":382,"props":432,"children":434},{"style":433},"--shiki-default:#4EC9B0",[435],{"type":100,"value":436},"link",{"type":95,"tag":382,"props":438,"children":439},{"style":395},[440],{"type":100,"value":419},{"type":95,"tag":382,"props":442,"children":443},{"style":433},[444],{"type":100,"value":445},"XDPOptions",{"type":95,"tag":382,"props":447,"children":448},{"style":395},[449],{"type":100,"value":450},"{\n",{"type":95,"tag":382,"props":452,"children":454},{"class":384,"line":453},2,[455,460,465,470,474,479],{"type":95,"tag":382,"props":456,"children":457},{"style":389},[458],{"type":100,"value":459},"            Program",{"type":95,"tag":382,"props":461,"children":462},{"style":395},[463],{"type":100,"value":464},":   ",{"type":95,"tag":382,"props":466,"children":467},{"style":389},[468],{"type":100,"value":469},"objs",{"type":95,"tag":382,"props":471,"children":472},{"style":395},[473],{"type":100,"value":419},{"type":95,"tag":382,"props":475,"children":476},{"style":389},[477],{"type":100,"value":478},"XdpProgram",{"type":95,"tag":382,"props":480,"children":481},{"style":395},[482],{"type":100,"value":483},",\n",{"type":95,"tag":382,"props":485,"children":487},{"class":384,"line":486},3,[488,493,498,503,507,512],{"type":95,"tag":382,"props":489,"children":490},{"style":389},[491],{"type":100,"value":492},"            Interface",{"type":95,"tag":382,"props":494,"children":495},{"style":395},[496],{"type":100,"value":497},": ",{"type":95,"tag":382,"props":499,"children":500},{"style":389},[501],{"type":100,"value":502},"iface",{"type":95,"tag":382,"props":504,"children":505},{"style":395},[506],{"type":100,"value":419},{"type":95,"tag":382,"props":508,"children":509},{"style":389},[510],{"type":100,"value":511},"Index",{"type":95,"tag":382,"props":513,"children":514},{"style":395},[515],{"type":100,"value":483},{"type":95,"tag":382,"props":517,"children":520},{"class":518,"line":75},[384,519],"highlight",[521,526,530,534,538,543],{"type":95,"tag":382,"props":522,"children":523},{"style":389},[524],{"type":100,"value":525},"            Flags",{"type":95,"tag":382,"props":527,"children":528},{"style":395},[529],{"type":100,"value":497},{"type":95,"tag":382,"props":531,"children":532},{"style":389},[533],{"type":100,"value":436},{"type":95,"tag":382,"props":535,"children":536},{"style":395},[537],{"type":100,"value":419},{"type":95,"tag":382,"props":539,"children":540},{"style":389},[541],{"type":100,"value":542},"XDPGenericMode",{"type":95,"tag":382,"props":544,"children":545},{"style":395},[546],{"type":100,"value":483},{"type":95,"tag":382,"props":548,"children":550},{"class":384,"line":549},5,[551],{"type":95,"tag":382,"props":552,"children":553},{"style":395},[554],{"type":100,"value":555},"})\n",{"type":95,"tag":96,"props":557,"children":558},{},[559,561,566,567,573,575,581,583,590],{"type":100,"value":560},"Where you can set either ",{"type":95,"tag":219,"props":562,"children":564},{"className":563},[],[565],{"type":100,"value":542},{"type":100,"value":398},{"type":95,"tag":219,"props":568,"children":570},{"className":569},[],[571],{"type":100,"value":572},"XDPDriverMode",{"type":100,"value":574},", or ",{"type":95,"tag":219,"props":576,"children":578},{"className":577},[],[579],{"type":100,"value":580},"XDPOffloadMode",{"type":100,"value":582},", as defined in the ",{"type":95,"tag":113,"props":584,"children":587},{"href":585,"rel":586},"https://pkg.go.dev/github.com/cilium/ebpf/link#XDPAttachFlags",[117],[588],{"type":100,"value":589},"ebpf-go documentation",{"type":100,"value":419},{"type":95,"tag":255,"props":592,"children":593},{"kind":257},[594,599,893,898],{"type":95,"tag":96,"props":595,"children":596},{},[597],{"type":100,"value":598},"💡 Important to mention is that we are also attaching this XDP program to a specific network interface.",{"type":95,"tag":369,"props":600,"children":604},{"className":371,"code":601,"filename":373,"highlights":602,"language":375,"meta":376,"style":376},"iface, err := net.InterfaceByName(ifname)\nif err != nil {\n    log.Fatalf(\"Getting interface %s: %s\", ifname, err)\n}\n\nxdplink, err := link.AttachXDP(link.XDPOptions{\n            Program:   objs.XdpProgram,\n            Interface: iface.Index,\n            Flags: link.XDPGenericMode,\n})\n",[385,603],8,[605],{"type":95,"tag":219,"props":606,"children":607},{"__ignoreMap":376},[608,656,686,733,741,749,801,829,857,885],{"type":95,"tag":382,"props":609,"children":611},{"class":610,"line":385},[384,519],[612,616,620,624,628,633,637,642,646,651],{"type":95,"tag":382,"props":613,"children":614},{"style":389},[615],{"type":100,"value":502},{"type":95,"tag":382,"props":617,"children":618},{"style":395},[619],{"type":100,"value":398},{"type":95,"tag":382,"props":621,"children":622},{"style":389},[623],{"type":100,"value":403},{"type":95,"tag":382,"props":625,"children":626},{"style":406},[627],{"type":100,"value":409},{"type":95,"tag":382,"props":629,"children":630},{"style":389},[631],{"type":100,"value":632}," net",{"type":95,"tag":382,"props":634,"children":635},{"style":395},[636],{"type":100,"value":419},{"type":95,"tag":382,"props":638,"children":639},{"style":422},[640],{"type":100,"value":641},"InterfaceByName",{"type":95,"tag":382,"props":643,"children":644},{"style":395},[645],{"type":100,"value":430},{"type":95,"tag":382,"props":647,"children":648},{"style":389},[649],{"type":100,"value":650},"ifname",{"type":95,"tag":382,"props":652,"children":653},{"style":395},[654],{"type":100,"value":655},")\n",{"type":95,"tag":382,"props":657,"children":658},{"class":384,"line":453},[659,665,670,675,681],{"type":95,"tag":382,"props":660,"children":662},{"style":661},"--shiki-default:#C586C0",[663],{"type":100,"value":664},"if",{"type":95,"tag":382,"props":666,"children":667},{"style":389},[668],{"type":100,"value":669}," err",{"type":95,"tag":382,"props":671,"children":672},{"style":406},[673],{"type":100,"value":674}," !=",{"type":95,"tag":382,"props":676,"children":678},{"style":677},"--shiki-default:#569CD6",[679],{"type":100,"value":680}," nil",{"type":95,"tag":382,"props":682,"children":683},{"style":395},[684],{"type":100,"value":685}," {\n",{"type":95,"tag":382,"props":687,"children":688},{"class":384,"line":486},[689,694,698,703,707,713,717,721,725,729],{"type":95,"tag":382,"props":690,"children":691},{"style":389},[692],{"type":100,"value":693},"    log",{"type":95,"tag":382,"props":695,"children":696},{"style":395},[697],{"type":100,"value":419},{"type":95,"tag":382,"props":699,"children":700},{"style":422},[701],{"type":100,"value":702},"Fatalf",{"type":95,"tag":382,"props":704,"children":705},{"style":395},[706],{"type":100,"value":430},{"type":95,"tag":382,"props":708,"children":710},{"style":709},"--shiki-default:#CE9178",[711],{"type":100,"value":712},"\"Getting interface %s: %s\"",{"type":95,"tag":382,"props":714,"children":715},{"style":395},[716],{"type":100,"value":398},{"type":95,"tag":382,"props":718,"children":719},{"style":389},[720],{"type":100,"value":650},{"type":95,"tag":382,"props":722,"children":723},{"style":395},[724],{"type":100,"value":398},{"type":95,"tag":382,"props":726,"children":727},{"style":389},[728],{"type":100,"value":403},{"type":95,"tag":382,"props":730,"children":731},{"style":395},[732],{"type":100,"value":655},{"type":95,"tag":382,"props":734,"children":735},{"class":384,"line":75},[736],{"type":95,"tag":382,"props":737,"children":738},{"style":395},[739],{"type":100,"value":740},"}\n",{"type":95,"tag":382,"props":742,"children":743},{"class":384,"line":549},[744],{"type":95,"tag":382,"props":745,"children":746},{"emptyLinePlaceholder":11},[747],{"type":100,"value":748},"\n",{"type":95,"tag":382,"props":750,"children":752},{"class":384,"line":751},6,[753,757,761,765,769,773,777,781,785,789,793,797],{"type":95,"tag":382,"props":754,"children":755},{"style":389},[756],{"type":100,"value":392},{"type":95,"tag":382,"props":758,"children":759},{"style":395},[760],{"type":100,"value":398},{"type":95,"tag":382,"props":762,"children":763},{"style":389},[764],{"type":100,"value":403},{"type":95,"tag":382,"props":766,"children":767},{"style":406},[768],{"type":100,"value":409},{"type":95,"tag":382,"props":770,"children":771},{"style":389},[772],{"type":100,"value":414},{"type":95,"tag":382,"props":774,"children":775},{"style":395},[776],{"type":100,"value":419},{"type":95,"tag":382,"props":778,"children":779},{"style":422},[780],{"type":100,"value":425},{"type":95,"tag":382,"props":782,"children":783},{"style":395},[784],{"type":100,"value":430},{"type":95,"tag":382,"props":786,"children":787},{"style":433},[788],{"type":100,"value":436},{"type":95,"tag":382,"props":790,"children":791},{"style":395},[792],{"type":100,"value":419},{"type":95,"tag":382,"props":794,"children":795},{"style":433},[796],{"type":100,"value":445},{"type":95,"tag":382,"props":798,"children":799},{"style":395},[800],{"type":100,"value":450},{"type":95,"tag":382,"props":802,"children":804},{"class":384,"line":803},7,[805,809,813,817,821,825],{"type":95,"tag":382,"props":806,"children":807},{"style":389},[808],{"type":100,"value":459},{"type":95,"tag":382,"props":810,"children":811},{"style":395},[812],{"type":100,"value":464},{"type":95,"tag":382,"props":814,"children":815},{"style":389},[816],{"type":100,"value":469},{"type":95,"tag":382,"props":818,"children":819},{"style":395},[820],{"type":100,"value":419},{"type":95,"tag":382,"props":822,"children":823},{"style":389},[824],{"type":100,"value":478},{"type":95,"tag":382,"props":826,"children":827},{"style":395},[828],{"type":100,"value":483},{"type":95,"tag":382,"props":830,"children":832},{"class":831,"line":603},[384,519],[833,837,841,845,849,853],{"type":95,"tag":382,"props":834,"children":835},{"style":389},[836],{"type":100,"value":492},{"type":95,"tag":382,"props":838,"children":839},{"style":395},[840],{"type":100,"value":497},{"type":95,"tag":382,"props":842,"children":843},{"style":389},[844],{"type":100,"value":502},{"type":95,"tag":382,"props":846,"children":847},{"style":395},[848],{"type":100,"value":419},{"type":95,"tag":382,"props":850,"children":851},{"style":389},[852],{"type":100,"value":511},{"type":95,"tag":382,"props":854,"children":855},{"style":395},[856],{"type":100,"value":483},{"type":95,"tag":382,"props":858,"children":860},{"class":384,"line":859},9,[861,865,869,873,877,881],{"type":95,"tag":382,"props":862,"children":863},{"style":389},[864],{"type":100,"value":525},{"type":95,"tag":382,"props":866,"children":867},{"style":395},[868],{"type":100,"value":497},{"type":95,"tag":382,"props":870,"children":871},{"style":389},[872],{"type":100,"value":436},{"type":95,"tag":382,"props":874,"children":875},{"style":395},[876],{"type":100,"value":419},{"type":95,"tag":382,"props":878,"children":879},{"style":389},[880],{"type":100,"value":542},{"type":95,"tag":382,"props":882,"children":883},{"style":395},[884],{"type":100,"value":483},{"type":95,"tag":382,"props":886,"children":888},{"class":384,"line":887},10,[889],{"type":95,"tag":382,"props":890,"children":891},{"style":395},[892],{"type":100,"value":555},{"type":95,"tag":96,"props":894,"children":895},{},[896],{"type":100,"value":897},"Different network interfaces can have different XDP programs attached.",{"type":95,"tag":96,"props":899,"children":900},{},[901,903,910],{"type":100,"value":902},"It’s even possible to load multiple XDP programs on a single network interface, but we’ll cover that in a later tutorial. If you want to get ahead, check out ",{"type":95,"tag":113,"props":904,"children":907},{"href":905,"rel":906},"https://docs.ebpf.io/ebpf-library/libxdp/libxdp/",[117],[908],{"type":100,"value":909},"libxdp",{"type":100,"value":419},{"type":95,"tag":96,"props":912,"children":913},{},[914],{"type":100,"value":915},"Regardless of mode you set, most XDP programs follow the same pattern:",{"type":95,"tag":159,"props":917,"children":918},{},[919,929,939,957],{"type":95,"tag":163,"props":920,"children":921},{},[922,927],{"type":95,"tag":167,"props":923,"children":924},{},[925],{"type":100,"value":926},"Parse the packet",{"type":100,"value":928}," — parse L2/L3/L4 headers and extract the fields your application care about.",{"type":95,"tag":163,"props":930,"children":931},{},[932,937],{"type":95,"tag":167,"props":933,"children":934},{},[935],{"type":100,"value":936},"Work with metadata",{"type":100,"value":938}," — process extracted fields (and lookup or update eBPF maps).",{"type":95,"tag":163,"props":940,"children":941},{},[942,947,949,955],{"type":95,"tag":167,"props":943,"children":944},{},[945],{"type":100,"value":946},"Modify the packet (less common)",{"type":100,"value":948}," — rewrite headers or payload; adjust headroom/tailroom (e.g., ",{"type":95,"tag":219,"props":950,"children":952},{"className":951},[],[953],{"type":100,"value":954},"bpf_xdp_adjust_head/tail",{"type":100,"value":956},") for e.g. IPIP encapsulation or decapsulation.",{"type":95,"tag":163,"props":958,"children":959},{},[960,965],{"type":95,"tag":167,"props":961,"children":962},{},[963],{"type":100,"value":964},"Return a verdict",{"type":100,"value":966}," — exit with an action code that tells the kernel what to do next with the packet.",{"type":95,"tag":96,"props":968,"children":969},{},[970],{"type":100,"value":971},"In light of the last point, XDP supports several actions — or return codes, to be more precise — that define how your program behaves:",{"type":95,"tag":159,"props":973,"children":974},{},[975,985,995,1005,1015],{"type":95,"tag":163,"props":976,"children":977},{},[978,983],{"type":95,"tag":167,"props":979,"children":980},{},[981],{"type":100,"value":982},"XDP_PASS",{"type":100,"value":984}," – allow the packet to continue through the networking stack (as usual)",{"type":95,"tag":163,"props":986,"children":987},{},[988,993],{"type":95,"tag":167,"props":989,"children":990},{},[991],{"type":100,"value":992},"XDP_DROP",{"type":100,"value":994}," – drop/discard the packet immediately",{"type":95,"tag":163,"props":996,"children":997},{},[998,1003],{"type":95,"tag":167,"props":999,"children":1000},{},[1001],{"type":100,"value":1002},"XDP_TX",{"type":100,"value":1004}," – transmit the packet back out the same interface",{"type":95,"tag":163,"props":1006,"children":1007},{},[1008,1013],{"type":95,"tag":167,"props":1009,"children":1010},{},[1011],{"type":100,"value":1012},"XDP_REDIRECT",{"type":100,"value":1014}," – send the packet to another network interface, CPU or special user-space socket (AF_XDP)",{"type":95,"tag":163,"props":1016,"children":1017},{},[1018,1023],{"type":95,"tag":167,"props":1019,"children":1020},{},[1021],{"type":100,"value":1022},"XDP_ABORTED",{"type":100,"value":1024}," – used for aborting the program execution due to an error",{"type":95,"tag":96,"props":1026,"children":1027},{},[1028],{"type":100,"value":1029},"We'll learn how these actions/return codes are utilized in different use cases in this skill path - but they are here for reference.",{"type":95,"tag":194,"props":1031,"children":1033},{"id":1032},"how-xdp-parses-ethernet-ip-ipv6-tcp-udp-and-icmp-headers",[1034],{"type":100,"value":1035},"How XDP Parses Ethernet, IP, IPv6, TCP, UDP and ICMP Headers",{"type":95,"tag":96,"props":1037,"children":1038},{},[1039],{"type":100,"value":1040},"Enough theory — the goal of this tutorial is to understand how we can access the network packet metadata — the ground truth for any application you’ll see out there in the wild.",{"type":95,"tag":96,"props":1042,"children":1043},{},[1044],{"type":100,"value":1045},"To start off, let’s first look at what kind of kernel context structure is passed to our eBPF/XDP program:",{"type":95,"tag":369,"props":1047,"children":1051},{"className":1048,"code":1049,"language":1050,"meta":376,"style":376},"language-c shiki shiki-themes slack-dark","struct xdp_md {\n    __u32 data;\n    __u32 data_end;\n    __u32 data_meta;\n    __u32 ingress_ifindex;\n    __u32 rx_queue_index;\n    __u32 egress_ifindex;\n};\n","c",[1052],{"type":95,"tag":219,"props":1053,"children":1054},{"__ignoreMap":376},[1055,1068,1076,1084,1092,1100,1108,1116],{"type":95,"tag":382,"props":1056,"children":1057},{"class":384,"line":385},[1058,1063],{"type":95,"tag":382,"props":1059,"children":1060},{"style":677},[1061],{"type":100,"value":1062},"struct",{"type":95,"tag":382,"props":1064,"children":1065},{"style":395},[1066],{"type":100,"value":1067}," xdp_md {\n",{"type":95,"tag":382,"props":1069,"children":1070},{"class":384,"line":453},[1071],{"type":95,"tag":382,"props":1072,"children":1073},{"style":395},[1074],{"type":100,"value":1075},"    __u32 data;\n",{"type":95,"tag":382,"props":1077,"children":1078},{"class":384,"line":486},[1079],{"type":95,"tag":382,"props":1080,"children":1081},{"style":395},[1082],{"type":100,"value":1083},"    __u32 data_end;\n",{"type":95,"tag":382,"props":1085,"children":1086},{"class":384,"line":75},[1087],{"type":95,"tag":382,"props":1088,"children":1089},{"style":395},[1090],{"type":100,"value":1091},"    __u32 data_meta;\n",{"type":95,"tag":382,"props":1093,"children":1094},{"class":384,"line":549},[1095],{"type":95,"tag":382,"props":1096,"children":1097},{"style":395},[1098],{"type":100,"value":1099},"    __u32 ingress_ifindex;\n",{"type":95,"tag":382,"props":1101,"children":1102},{"class":384,"line":751},[1103],{"type":95,"tag":382,"props":1104,"children":1105},{"style":395},[1106],{"type":100,"value":1107},"    __u32 rx_queue_index;\n",{"type":95,"tag":382,"props":1109,"children":1110},{"class":384,"line":803},[1111],{"type":95,"tag":382,"props":1112,"children":1113},{"style":395},[1114],{"type":100,"value":1115},"    __u32 egress_ifindex;\n",{"type":95,"tag":382,"props":1117,"children":1118},{"class":384,"line":603},[1119],{"type":95,"tag":382,"props":1120,"children":1121},{"style":395},[1122],{"type":100,"value":1123},"};\n",{"type":95,"tag":96,"props":1125,"children":1126},{},[1127],{"type":100,"value":1128},"Where fields represents:",{"type":95,"tag":159,"props":1130,"children":1131},{},[1132,1142,1152,1171,1181,1191],{"type":95,"tag":163,"props":1133,"children":1134},{},[1135,1140],{"type":95,"tag":167,"props":1136,"children":1137},{},[1138],{"type":100,"value":1139},"data",{"type":100,"value":1141}," - Pointer to the start of the packet data (the beginning of the readable memory region)",{"type":95,"tag":163,"props":1143,"children":1144},{},[1145,1150],{"type":95,"tag":167,"props":1146,"children":1147},{},[1148],{"type":100,"value":1149},"data_end",{"type":100,"value":1151}," - Pointer to the end of the packet data (the end of the readable memory region)",{"type":95,"tag":163,"props":1153,"children":1154},{},[1155,1160,1162,1169],{"type":95,"tag":167,"props":1156,"children":1157},{},[1158],{"type":100,"value":1159},"data_meta",{"type":100,"value":1161}," - Optional space before data for custom metadata passed from XDP to later stages like TC - see ",{"type":95,"tag":113,"props":1163,"children":1166},{"href":1164,"rel":1165},"https://docs.ebpf.io/linux/helper-function/bpf_xdp_adjust_meta/",[117],[1167],{"type":100,"value":1168},"bpf_xdp_adjust_meta",{"type":100,"value":1170}," for more info.",{"type":95,"tag":163,"props":1172,"children":1173},{},[1174,1179],{"type":95,"tag":167,"props":1175,"children":1176},{},[1177],{"type":100,"value":1178},"ingress_ifindex",{"type":100,"value":1180}," - Index of the network interface packet was received on",{"type":95,"tag":163,"props":1182,"children":1183},{},[1184,1189],{"type":95,"tag":167,"props":1185,"children":1186},{},[1187],{"type":100,"value":1188},"rx_queue_index",{"type":100,"value":1190}," - Index of the receive queue on that interface where the packet was queued",{"type":95,"tag":163,"props":1192,"children":1193},{},[1194,1199],{"type":95,"tag":167,"props":1195,"children":1196},{},[1197],{"type":100,"value":1198},"egress_ifindex",{"type":100,"value":1200}," - Set to the network interface index the packet was redirected out of, but only when the redirect happened",{"type":95,"tag":96,"props":1202,"children":1203},{},[1204,1206,1211,1212,1217],{"type":100,"value":1205},"Most of the time, programs only use the ",{"type":95,"tag":219,"props":1207,"children":1209},{"className":1208},[],[1210],{"type":100,"value":1139},{"type":100,"value":342},{"type":95,"tag":219,"props":1213,"children":1215},{"className":1214},[],[1216],{"type":100,"value":1149},{"type":100,"value":1218}," pointers — not only to access packet data but also to satisfy the eBPF verifier and ensure that all memory access stays within the packet’s boundaries.",{"type":95,"tag":96,"props":1220,"children":1221},{},[1222],{"type":100,"value":1223},"In my opinion, making the verifier happy is also one of the hardest parts of XDP development.",{"type":95,"tag":96,"props":1225,"children":1226},{},[1227,1229,1235,1237,1244],{"type":100,"value":1228},"To keep things simple, we’ll use the ",{"type":95,"tag":219,"props":1230,"children":1232},{"className":1231},[],[1233],{"type":100,"value":1234},"parse_helpers.h",{"type":100,"value":1236}," header file (originally from the ",{"type":95,"tag":113,"props":1238,"children":1241},{"href":1239,"rel":1240},"https://github.com/xdp-project/xdp-tutorial",[117],[1242],{"type":100,"value":1243},"xdp-project/xdp-tutorial",{"type":100,"value":1245}," repository), which simplifies much of the parsing logic for us.",{"type":95,"tag":96,"props":1247,"children":1248},{},[1249],{"type":100,"value":1250},"In short, this header file provides a set of helper functions that safely access packet data and extract Ethernet, IPv4/IPv6, and TCP/UDP headers.",{"type":95,"tag":369,"props":1252,"children":1269},{"className":1048,"code":1253,"filename":1254,"highlights":1255,"language":1050,"meta":376,"style":376},"...\n#include \"parse_helpers.h\"\n\nSEC(\"xdp\") \nint xdp_program(struct xdp_md *ctx) {\n    void *data_end = (void *)(unsigned long long)ctx->data_end;\n    void *data = (void *)(unsigned long long)ctx->data;\n    struct hdr_cursor nh;\n    nh.pos = data;\n\n    int ip_type;\n    struct ethhdr *eth;\n    // Parse Ethernet header\n    int eth_type = parse_ethhdr(&nh, data_end, &eth);\n    if (eth_type == bpf_htons(ETH_P_IP)) { \n        // We have captured an IPv4 packet\n        struct iphdr *ip;\n        // Parse IPv4 header\n        ip_type = parse_iphdr(&nh, data_end, &ip);\n        ...\n\n        if (ip_type == IPPROTO_ICMP) {\n            // We have captured an ICMP packet\n            struct icmphdr *icmp;\n            // Parse ICMP header\n            int icmp_type = parse_icmphdr(&nh, data_end, &icmp);\n            ...\n        }\n    } else if (eth_type == bpf_htons(ETH_P_IPV6)) {\n        // We have captured an IPv6 packet\n        struct ipv6hdr *ipv6;\n        // Parse IPv6 header\n        ip_type = parse_ip6hdr(&nh, data_end, &ipv6);\n        ...\n\n        if (ip_type == IPPROTO_ICMPV6) {\n            // We have captured an ICMPv6 packet\n            struct icmp6hdr *icmp6;\n            // Parse ICMPv6 header\n            int icmp6_type = parse_icmp6hdr(&nh, data_end, &icmp6);\n            ...\n        }\n    }\n\n    if (ip_type == IPPROTO_TCP) {\n        // We have captured a TCP packet\n        struct tcphdr *tcp;\n        // Parse TCP header\n        int tcp_type = parse_tcphdr(&nh, data_end, &tcp);\n        ...\n    } else if (ip_type == IPPROTO_UDP) {\n        // We have captured a UDP packet\n        struct udphdr *udp;\n        // Parse UDP header\n        int udp_type = parse_udphdr(&nh, data_end, &udp);\n        ...\n    }\n    ...\n","lab/xdp.c",[453,41,1256,1257,1258,1259,1260,1261,1262,1263,1264,1265,1266,1267,1268],14,18,19,25,26,32,33,39,40,48,49,54,55,[1270],{"type":95,"tag":219,"props":1271,"children":1272},{"__ignoreMap":376},[1273,1281,1295,1302,1324,1365,1444,1512,1525,1552,1559,1573,1595,1605,1650,1679,1688,1711,1720,1759,1768,1776,1799,1808,1831,1840,1884,1893,1902,1938,1947,1969,1978,2016,2024,2032,2053,2062,2084,2093,2136,2144,2152,2161,2169,2190,2199,2221,2230,2274,2282,2311,2319,2341,2350,2393,2401,2409],{"type":95,"tag":382,"props":1274,"children":1275},{"class":384,"line":385},[1276],{"type":95,"tag":382,"props":1277,"children":1278},{"style":395},[1279],{"type":100,"value":1280},"...\n",{"type":95,"tag":382,"props":1282,"children":1284},{"class":1283,"line":453},[384,519],[1285,1290],{"type":95,"tag":382,"props":1286,"children":1287},{"style":661},[1288],{"type":100,"value":1289},"#include",{"type":95,"tag":382,"props":1291,"children":1292},{"style":709},[1293],{"type":100,"value":1294}," \"parse_helpers.h\"\n",{"type":95,"tag":382,"props":1296,"children":1297},{"class":384,"line":486},[1298],{"type":95,"tag":382,"props":1299,"children":1300},{"emptyLinePlaceholder":11},[1301],{"type":100,"value":748},{"type":95,"tag":382,"props":1303,"children":1304},{"class":384,"line":75},[1305,1310,1314,1319],{"type":95,"tag":382,"props":1306,"children":1307},{"style":422},[1308],{"type":100,"value":1309},"SEC",{"type":95,"tag":382,"props":1311,"children":1312},{"style":395},[1313],{"type":100,"value":430},{"type":95,"tag":382,"props":1315,"children":1316},{"style":709},[1317],{"type":100,"value":1318},"\"xdp\"",{"type":95,"tag":382,"props":1320,"children":1321},{"style":395},[1322],{"type":100,"value":1323},") \n",{"type":95,"tag":382,"props":1325,"children":1326},{"class":384,"line":549},[1327,1332,1337,1341,1345,1350,1355,1360],{"type":95,"tag":382,"props":1328,"children":1329},{"style":677},[1330],{"type":100,"value":1331},"int",{"type":95,"tag":382,"props":1333,"children":1334},{"style":422},[1335],{"type":100,"value":1336}," xdp_program",{"type":95,"tag":382,"props":1338,"children":1339},{"style":395},[1340],{"type":100,"value":430},{"type":95,"tag":382,"props":1342,"children":1343},{"style":677},[1344],{"type":100,"value":1062},{"type":95,"tag":382,"props":1346,"children":1347},{"style":395},[1348],{"type":100,"value":1349}," xdp_md ",{"type":95,"tag":382,"props":1351,"children":1352},{"style":406},[1353],{"type":100,"value":1354},"*",{"type":95,"tag":382,"props":1356,"children":1357},{"style":389},[1358],{"type":100,"value":1359},"ctx",{"type":95,"tag":382,"props":1361,"children":1362},{"style":395},[1363],{"type":100,"value":1364},") {\n",{"type":95,"tag":382,"props":1366,"children":1367},{"class":384,"line":751},[1368,1373,1378,1383,1388,1393,1398,1402,1407,1412,1417,1421,1426,1430,1435,1439],{"type":95,"tag":382,"props":1369,"children":1370},{"style":677},[1371],{"type":100,"value":1372},"    void",{"type":95,"tag":382,"props":1374,"children":1375},{"style":406},[1376],{"type":100,"value":1377}," *",{"type":95,"tag":382,"props":1379,"children":1380},{"style":395},[1381],{"type":100,"value":1382},"data_end ",{"type":95,"tag":382,"props":1384,"children":1385},{"style":406},[1386],{"type":100,"value":1387},"=",{"type":95,"tag":382,"props":1389,"children":1390},{"style":395},[1391],{"type":100,"value":1392}," (",{"type":95,"tag":382,"props":1394,"children":1395},{"style":677},[1396],{"type":100,"value":1397},"void",{"type":95,"tag":382,"props":1399,"children":1400},{"style":406},[1401],{"type":100,"value":1377},{"type":95,"tag":382,"props":1403,"children":1404},{"style":395},[1405],{"type":100,"value":1406},")(",{"type":95,"tag":382,"props":1408,"children":1409},{"style":677},[1410],{"type":100,"value":1411},"unsigned",{"type":95,"tag":382,"props":1413,"children":1414},{"style":677},[1415],{"type":100,"value":1416}," long",{"type":95,"tag":382,"props":1418,"children":1419},{"style":677},[1420],{"type":100,"value":1416},{"type":95,"tag":382,"props":1422,"children":1423},{"style":395},[1424],{"type":100,"value":1425},")",{"type":95,"tag":382,"props":1427,"children":1428},{"style":389},[1429],{"type":100,"value":1359},{"type":95,"tag":382,"props":1431,"children":1432},{"style":395},[1433],{"type":100,"value":1434},"->",{"type":95,"tag":382,"props":1436,"children":1437},{"style":389},[1438],{"type":100,"value":1149},{"type":95,"tag":382,"props":1440,"children":1441},{"style":395},[1442],{"type":100,"value":1443},";\n",{"type":95,"tag":382,"props":1445,"children":1446},{"class":384,"line":803},[1447,1451,1455,1460,1464,1468,1472,1476,1480,1484,1488,1492,1496,1500,1504,1508],{"type":95,"tag":382,"props":1448,"children":1449},{"style":677},[1450],{"type":100,"value":1372},{"type":95,"tag":382,"props":1452,"children":1453},{"style":406},[1454],{"type":100,"value":1377},{"type":95,"tag":382,"props":1456,"children":1457},{"style":395},[1458],{"type":100,"value":1459},"data ",{"type":95,"tag":382,"props":1461,"children":1462},{"style":406},[1463],{"type":100,"value":1387},{"type":95,"tag":382,"props":1465,"children":1466},{"style":395},[1467],{"type":100,"value":1392},{"type":95,"tag":382,"props":1469,"children":1470},{"style":677},[1471],{"type":100,"value":1397},{"type":95,"tag":382,"props":1473,"children":1474},{"style":406},[1475],{"type":100,"value":1377},{"type":95,"tag":382,"props":1477,"children":1478},{"style":395},[1479],{"type":100,"value":1406},{"type":95,"tag":382,"props":1481,"children":1482},{"style":677},[1483],{"type":100,"value":1411},{"type":95,"tag":382,"props":1485,"children":1486},{"style":677},[1487],{"type":100,"value":1416},{"type":95,"tag":382,"props":1489,"children":1490},{"style":677},[1491],{"type":100,"value":1416},{"type":95,"tag":382,"props":1493,"children":1494},{"style":395},[1495],{"type":100,"value":1425},{"type":95,"tag":382,"props":1497,"children":1498},{"style":389},[1499],{"type":100,"value":1359},{"type":95,"tag":382,"props":1501,"children":1502},{"style":395},[1503],{"type":100,"value":1434},{"type":95,"tag":382,"props":1505,"children":1506},{"style":389},[1507],{"type":100,"value":1139},{"type":95,"tag":382,"props":1509,"children":1510},{"style":395},[1511],{"type":100,"value":1443},{"type":95,"tag":382,"props":1513,"children":1514},{"class":384,"line":603},[1515,1520],{"type":95,"tag":382,"props":1516,"children":1517},{"style":677},[1518],{"type":100,"value":1519},"    struct",{"type":95,"tag":382,"props":1521,"children":1522},{"style":395},[1523],{"type":100,"value":1524}," hdr_cursor nh;\n",{"type":95,"tag":382,"props":1526,"children":1527},{"class":384,"line":859},[1528,1533,1537,1542,1547],{"type":95,"tag":382,"props":1529,"children":1530},{"style":389},[1531],{"type":100,"value":1532},"    nh",{"type":95,"tag":382,"props":1534,"children":1535},{"style":395},[1536],{"type":100,"value":419},{"type":95,"tag":382,"props":1538,"children":1539},{"style":389},[1540],{"type":100,"value":1541},"pos",{"type":95,"tag":382,"props":1543,"children":1544},{"style":406},[1545],{"type":100,"value":1546}," =",{"type":95,"tag":382,"props":1548,"children":1549},{"style":395},[1550],{"type":100,"value":1551}," data;\n",{"type":95,"tag":382,"props":1553,"children":1554},{"class":384,"line":887},[1555],{"type":95,"tag":382,"props":1556,"children":1557},{"emptyLinePlaceholder":11},[1558],{"type":100,"value":748},{"type":95,"tag":382,"props":1560,"children":1562},{"class":384,"line":1561},11,[1563,1568],{"type":95,"tag":382,"props":1564,"children":1565},{"style":677},[1566],{"type":100,"value":1567},"    int",{"type":95,"tag":382,"props":1569,"children":1570},{"style":395},[1571],{"type":100,"value":1572}," ip_type;\n",{"type":95,"tag":382,"props":1574,"children":1576},{"class":384,"line":1575},12,[1577,1581,1586,1590],{"type":95,"tag":382,"props":1578,"children":1579},{"style":677},[1580],{"type":100,"value":1519},{"type":95,"tag":382,"props":1582,"children":1583},{"style":395},[1584],{"type":100,"value":1585}," ethhdr ",{"type":95,"tag":382,"props":1587,"children":1588},{"style":406},[1589],{"type":100,"value":1354},{"type":95,"tag":382,"props":1591,"children":1592},{"style":395},[1593],{"type":100,"value":1594},"eth;\n",{"type":95,"tag":382,"props":1596,"children":1598},{"class":1597,"line":41},[384,519],[1599],{"type":95,"tag":382,"props":1600,"children":1602},{"style":1601},"--shiki-default:#6A9955",[1603],{"type":100,"value":1604},"    // Parse Ethernet header\n",{"type":95,"tag":382,"props":1606,"children":1608},{"class":1607,"line":1256},[384,519],[1609,1613,1618,1622,1627,1631,1636,1641,1645],{"type":95,"tag":382,"props":1610,"children":1611},{"style":677},[1612],{"type":100,"value":1567},{"type":95,"tag":382,"props":1614,"children":1615},{"style":395},[1616],{"type":100,"value":1617}," eth_type ",{"type":95,"tag":382,"props":1619,"children":1620},{"style":406},[1621],{"type":100,"value":1387},{"type":95,"tag":382,"props":1623,"children":1624},{"style":422},[1625],{"type":100,"value":1626}," parse_ethhdr",{"type":95,"tag":382,"props":1628,"children":1629},{"style":395},[1630],{"type":100,"value":430},{"type":95,"tag":382,"props":1632,"children":1633},{"style":406},[1634],{"type":100,"value":1635},"&",{"type":95,"tag":382,"props":1637,"children":1638},{"style":395},[1639],{"type":100,"value":1640},"nh, data_end, ",{"type":95,"tag":382,"props":1642,"children":1643},{"style":406},[1644],{"type":100,"value":1635},{"type":95,"tag":382,"props":1646,"children":1647},{"style":395},[1648],{"type":100,"value":1649},"eth);\n",{"type":95,"tag":382,"props":1651,"children":1653},{"class":384,"line":1652},15,[1654,1659,1664,1669,1674],{"type":95,"tag":382,"props":1655,"children":1656},{"style":661},[1657],{"type":100,"value":1658},"    if",{"type":95,"tag":382,"props":1660,"children":1661},{"style":395},[1662],{"type":100,"value":1663}," (eth_type ",{"type":95,"tag":382,"props":1665,"children":1666},{"style":406},[1667],{"type":100,"value":1668},"==",{"type":95,"tag":382,"props":1670,"children":1671},{"style":422},[1672],{"type":100,"value":1673}," bpf_htons",{"type":95,"tag":382,"props":1675,"children":1676},{"style":395},[1677],{"type":100,"value":1678},"(ETH_P_IP)) { \n",{"type":95,"tag":382,"props":1680,"children":1682},{"class":384,"line":1681},16,[1683],{"type":95,"tag":382,"props":1684,"children":1685},{"style":1601},[1686],{"type":100,"value":1687},"        // We have captured an IPv4 packet\n",{"type":95,"tag":382,"props":1689,"children":1691},{"class":384,"line":1690},17,[1692,1697,1702,1706],{"type":95,"tag":382,"props":1693,"children":1694},{"style":677},[1695],{"type":100,"value":1696},"        struct",{"type":95,"tag":382,"props":1698,"children":1699},{"style":395},[1700],{"type":100,"value":1701}," iphdr ",{"type":95,"tag":382,"props":1703,"children":1704},{"style":406},[1705],{"type":100,"value":1354},{"type":95,"tag":382,"props":1707,"children":1708},{"style":395},[1709],{"type":100,"value":1710},"ip;\n",{"type":95,"tag":382,"props":1712,"children":1714},{"class":1713,"line":1257},[384,519],[1715],{"type":95,"tag":382,"props":1716,"children":1717},{"style":1601},[1718],{"type":100,"value":1719},"        // Parse IPv4 header\n",{"type":95,"tag":382,"props":1721,"children":1723},{"class":1722,"line":1258},[384,519],[1724,1729,1733,1738,1742,1746,1750,1754],{"type":95,"tag":382,"props":1725,"children":1726},{"style":395},[1727],{"type":100,"value":1728},"        ip_type ",{"type":95,"tag":382,"props":1730,"children":1731},{"style":406},[1732],{"type":100,"value":1387},{"type":95,"tag":382,"props":1734,"children":1735},{"style":422},[1736],{"type":100,"value":1737}," parse_iphdr",{"type":95,"tag":382,"props":1739,"children":1740},{"style":395},[1741],{"type":100,"value":430},{"type":95,"tag":382,"props":1743,"children":1744},{"style":406},[1745],{"type":100,"value":1635},{"type":95,"tag":382,"props":1747,"children":1748},{"style":395},[1749],{"type":100,"value":1640},{"type":95,"tag":382,"props":1751,"children":1752},{"style":406},[1753],{"type":100,"value":1635},{"type":95,"tag":382,"props":1755,"children":1756},{"style":395},[1757],{"type":100,"value":1758},"ip);\n",{"type":95,"tag":382,"props":1760,"children":1762},{"class":384,"line":1761},20,[1763],{"type":95,"tag":382,"props":1764,"children":1765},{"style":395},[1766],{"type":100,"value":1767},"        ...\n",{"type":95,"tag":382,"props":1769,"children":1771},{"class":384,"line":1770},21,[1772],{"type":95,"tag":382,"props":1773,"children":1774},{"emptyLinePlaceholder":11},[1775],{"type":100,"value":748},{"type":95,"tag":382,"props":1777,"children":1779},{"class":384,"line":1778},22,[1780,1785,1790,1794],{"type":95,"tag":382,"props":1781,"children":1782},{"style":661},[1783],{"type":100,"value":1784},"        if",{"type":95,"tag":382,"props":1786,"children":1787},{"style":395},[1788],{"type":100,"value":1789}," (ip_type ",{"type":95,"tag":382,"props":1791,"children":1792},{"style":406},[1793],{"type":100,"value":1668},{"type":95,"tag":382,"props":1795,"children":1796},{"style":395},[1797],{"type":100,"value":1798}," IPPROTO_ICMP) {\n",{"type":95,"tag":382,"props":1800,"children":1802},{"class":384,"line":1801},23,[1803],{"type":95,"tag":382,"props":1804,"children":1805},{"style":1601},[1806],{"type":100,"value":1807},"            // We have captured an ICMP packet\n",{"type":95,"tag":382,"props":1809,"children":1811},{"class":384,"line":1810},24,[1812,1817,1822,1826],{"type":95,"tag":382,"props":1813,"children":1814},{"style":677},[1815],{"type":100,"value":1816},"            struct",{"type":95,"tag":382,"props":1818,"children":1819},{"style":395},[1820],{"type":100,"value":1821}," icmphdr ",{"type":95,"tag":382,"props":1823,"children":1824},{"style":406},[1825],{"type":100,"value":1354},{"type":95,"tag":382,"props":1827,"children":1828},{"style":395},[1829],{"type":100,"value":1830},"icmp;\n",{"type":95,"tag":382,"props":1832,"children":1834},{"class":1833,"line":1259},[384,519],[1835],{"type":95,"tag":382,"props":1836,"children":1837},{"style":1601},[1838],{"type":100,"value":1839},"            // Parse ICMP header\n",{"type":95,"tag":382,"props":1841,"children":1843},{"class":1842,"line":1260},[384,519],[1844,1849,1854,1858,1863,1867,1871,1875,1879],{"type":95,"tag":382,"props":1845,"children":1846},{"style":677},[1847],{"type":100,"value":1848},"            int",{"type":95,"tag":382,"props":1850,"children":1851},{"style":395},[1852],{"type":100,"value":1853}," icmp_type ",{"type":95,"tag":382,"props":1855,"children":1856},{"style":406},[1857],{"type":100,"value":1387},{"type":95,"tag":382,"props":1859,"children":1860},{"style":422},[1861],{"type":100,"value":1862}," parse_icmphdr",{"type":95,"tag":382,"props":1864,"children":1865},{"style":395},[1866],{"type":100,"value":430},{"type":95,"tag":382,"props":1868,"children":1869},{"style":406},[1870],{"type":100,"value":1635},{"type":95,"tag":382,"props":1872,"children":1873},{"style":395},[1874],{"type":100,"value":1640},{"type":95,"tag":382,"props":1876,"children":1877},{"style":406},[1878],{"type":100,"value":1635},{"type":95,"tag":382,"props":1880,"children":1881},{"style":395},[1882],{"type":100,"value":1883},"icmp);\n",{"type":95,"tag":382,"props":1885,"children":1887},{"class":384,"line":1886},27,[1888],{"type":95,"tag":382,"props":1889,"children":1890},{"style":395},[1891],{"type":100,"value":1892},"            ...\n",{"type":95,"tag":382,"props":1894,"children":1896},{"class":384,"line":1895},28,[1897],{"type":95,"tag":382,"props":1898,"children":1899},{"style":395},[1900],{"type":100,"value":1901},"        }\n",{"type":95,"tag":382,"props":1903,"children":1905},{"class":384,"line":1904},29,[1906,1911,1916,1921,1925,1929,1933],{"type":95,"tag":382,"props":1907,"children":1908},{"style":395},[1909],{"type":100,"value":1910},"    } ",{"type":95,"tag":382,"props":1912,"children":1913},{"style":661},[1914],{"type":100,"value":1915},"else",{"type":95,"tag":382,"props":1917,"children":1918},{"style":661},[1919],{"type":100,"value":1920}," if",{"type":95,"tag":382,"props":1922,"children":1923},{"style":395},[1924],{"type":100,"value":1663},{"type":95,"tag":382,"props":1926,"children":1927},{"style":406},[1928],{"type":100,"value":1668},{"type":95,"tag":382,"props":1930,"children":1931},{"style":422},[1932],{"type":100,"value":1673},{"type":95,"tag":382,"props":1934,"children":1935},{"style":395},[1936],{"type":100,"value":1937},"(ETH_P_IPV6)) {\n",{"type":95,"tag":382,"props":1939,"children":1941},{"class":384,"line":1940},30,[1942],{"type":95,"tag":382,"props":1943,"children":1944},{"style":1601},[1945],{"type":100,"value":1946},"        // We have captured an IPv6 packet\n",{"type":95,"tag":382,"props":1948,"children":1950},{"class":384,"line":1949},31,[1951,1955,1960,1964],{"type":95,"tag":382,"props":1952,"children":1953},{"style":677},[1954],{"type":100,"value":1696},{"type":95,"tag":382,"props":1956,"children":1957},{"style":395},[1958],{"type":100,"value":1959}," ipv6hdr ",{"type":95,"tag":382,"props":1961,"children":1962},{"style":406},[1963],{"type":100,"value":1354},{"type":95,"tag":382,"props":1965,"children":1966},{"style":395},[1967],{"type":100,"value":1968},"ipv6;\n",{"type":95,"tag":382,"props":1970,"children":1972},{"class":1971,"line":1261},[384,519],[1973],{"type":95,"tag":382,"props":1974,"children":1975},{"style":1601},[1976],{"type":100,"value":1977},"        // Parse IPv6 header\n",{"type":95,"tag":382,"props":1979,"children":1981},{"class":1980,"line":1262},[384,519],[1982,1986,1990,1995,1999,2003,2007,2011],{"type":95,"tag":382,"props":1983,"children":1984},{"style":395},[1985],{"type":100,"value":1728},{"type":95,"tag":382,"props":1987,"children":1988},{"style":406},[1989],{"type":100,"value":1387},{"type":95,"tag":382,"props":1991,"children":1992},{"style":422},[1993],{"type":100,"value":1994}," parse_ip6hdr",{"type":95,"tag":382,"props":1996,"children":1997},{"style":395},[1998],{"type":100,"value":430},{"type":95,"tag":382,"props":2000,"children":2001},{"style":406},[2002],{"type":100,"value":1635},{"type":95,"tag":382,"props":2004,"children":2005},{"style":395},[2006],{"type":100,"value":1640},{"type":95,"tag":382,"props":2008,"children":2009},{"style":406},[2010],{"type":100,"value":1635},{"type":95,"tag":382,"props":2012,"children":2013},{"style":395},[2014],{"type":100,"value":2015},"ipv6);\n",{"type":95,"tag":382,"props":2017,"children":2019},{"class":384,"line":2018},34,[2020],{"type":95,"tag":382,"props":2021,"children":2022},{"style":395},[2023],{"type":100,"value":1767},{"type":95,"tag":382,"props":2025,"children":2027},{"class":384,"line":2026},35,[2028],{"type":95,"tag":382,"props":2029,"children":2030},{"emptyLinePlaceholder":11},[2031],{"type":100,"value":748},{"type":95,"tag":382,"props":2033,"children":2035},{"class":384,"line":2034},36,[2036,2040,2044,2048],{"type":95,"tag":382,"props":2037,"children":2038},{"style":661},[2039],{"type":100,"value":1784},{"type":95,"tag":382,"props":2041,"children":2042},{"style":395},[2043],{"type":100,"value":1789},{"type":95,"tag":382,"props":2045,"children":2046},{"style":406},[2047],{"type":100,"value":1668},{"type":95,"tag":382,"props":2049,"children":2050},{"style":395},[2051],{"type":100,"value":2052}," IPPROTO_ICMPV6) {\n",{"type":95,"tag":382,"props":2054,"children":2056},{"class":384,"line":2055},37,[2057],{"type":95,"tag":382,"props":2058,"children":2059},{"style":1601},[2060],{"type":100,"value":2061},"            // We have captured an ICMPv6 packet\n",{"type":95,"tag":382,"props":2063,"children":2065},{"class":384,"line":2064},38,[2066,2070,2075,2079],{"type":95,"tag":382,"props":2067,"children":2068},{"style":677},[2069],{"type":100,"value":1816},{"type":95,"tag":382,"props":2071,"children":2072},{"style":395},[2073],{"type":100,"value":2074}," icmp6hdr ",{"type":95,"tag":382,"props":2076,"children":2077},{"style":406},[2078],{"type":100,"value":1354},{"type":95,"tag":382,"props":2080,"children":2081},{"style":395},[2082],{"type":100,"value":2083},"icmp6;\n",{"type":95,"tag":382,"props":2085,"children":2087},{"class":2086,"line":1263},[384,519],[2088],{"type":95,"tag":382,"props":2089,"children":2090},{"style":1601},[2091],{"type":100,"value":2092},"            // Parse ICMPv6 header\n",{"type":95,"tag":382,"props":2094,"children":2096},{"class":2095,"line":1264},[384,519],[2097,2101,2106,2110,2115,2119,2123,2127,2131],{"type":95,"tag":382,"props":2098,"children":2099},{"style":677},[2100],{"type":100,"value":1848},{"type":95,"tag":382,"props":2102,"children":2103},{"style":395},[2104],{"type":100,"value":2105}," icmp6_type ",{"type":95,"tag":382,"props":2107,"children":2108},{"style":406},[2109],{"type":100,"value":1387},{"type":95,"tag":382,"props":2111,"children":2112},{"style":422},[2113],{"type":100,"value":2114}," parse_icmp6hdr",{"type":95,"tag":382,"props":2116,"children":2117},{"style":395},[2118],{"type":100,"value":430},{"type":95,"tag":382,"props":2120,"children":2121},{"style":406},[2122],{"type":100,"value":1635},{"type":95,"tag":382,"props":2124,"children":2125},{"style":395},[2126],{"type":100,"value":1640},{"type":95,"tag":382,"props":2128,"children":2129},{"style":406},[2130],{"type":100,"value":1635},{"type":95,"tag":382,"props":2132,"children":2133},{"style":395},[2134],{"type":100,"value":2135},"icmp6);\n",{"type":95,"tag":382,"props":2137,"children":2139},{"class":384,"line":2138},41,[2140],{"type":95,"tag":382,"props":2141,"children":2142},{"style":395},[2143],{"type":100,"value":1892},{"type":95,"tag":382,"props":2145,"children":2147},{"class":384,"line":2146},42,[2148],{"type":95,"tag":382,"props":2149,"children":2150},{"style":395},[2151],{"type":100,"value":1901},{"type":95,"tag":382,"props":2153,"children":2155},{"class":384,"line":2154},43,[2156],{"type":95,"tag":382,"props":2157,"children":2158},{"style":395},[2159],{"type":100,"value":2160},"    }\n",{"type":95,"tag":382,"props":2162,"children":2164},{"class":384,"line":2163},44,[2165],{"type":95,"tag":382,"props":2166,"children":2167},{"emptyLinePlaceholder":11},[2168],{"type":100,"value":748},{"type":95,"tag":382,"props":2170,"children":2172},{"class":384,"line":2171},45,[2173,2177,2181,2185],{"type":95,"tag":382,"props":2174,"children":2175},{"style":661},[2176],{"type":100,"value":1658},{"type":95,"tag":382,"props":2178,"children":2179},{"style":395},[2180],{"type":100,"value":1789},{"type":95,"tag":382,"props":2182,"children":2183},{"style":406},[2184],{"type":100,"value":1668},{"type":95,"tag":382,"props":2186,"children":2187},{"style":395},[2188],{"type":100,"value":2189}," IPPROTO_TCP) {\n",{"type":95,"tag":382,"props":2191,"children":2193},{"class":384,"line":2192},46,[2194],{"type":95,"tag":382,"props":2195,"children":2196},{"style":1601},[2197],{"type":100,"value":2198},"        // We have captured a TCP packet\n",{"type":95,"tag":382,"props":2200,"children":2202},{"class":384,"line":2201},47,[2203,2207,2212,2216],{"type":95,"tag":382,"props":2204,"children":2205},{"style":677},[2206],{"type":100,"value":1696},{"type":95,"tag":382,"props":2208,"children":2209},{"style":395},[2210],{"type":100,"value":2211}," tcphdr ",{"type":95,"tag":382,"props":2213,"children":2214},{"style":406},[2215],{"type":100,"value":1354},{"type":95,"tag":382,"props":2217,"children":2218},{"style":395},[2219],{"type":100,"value":2220},"tcp;\n",{"type":95,"tag":382,"props":2222,"children":2224},{"class":2223,"line":1265},[384,519],[2225],{"type":95,"tag":382,"props":2226,"children":2227},{"style":1601},[2228],{"type":100,"value":2229},"        // Parse TCP header\n",{"type":95,"tag":382,"props":2231,"children":2233},{"class":2232,"line":1266},[384,519],[2234,2239,2244,2248,2253,2257,2261,2265,2269],{"type":95,"tag":382,"props":2235,"children":2236},{"style":677},[2237],{"type":100,"value":2238},"        int",{"type":95,"tag":382,"props":2240,"children":2241},{"style":395},[2242],{"type":100,"value":2243}," tcp_type ",{"type":95,"tag":382,"props":2245,"children":2246},{"style":406},[2247],{"type":100,"value":1387},{"type":95,"tag":382,"props":2249,"children":2250},{"style":422},[2251],{"type":100,"value":2252}," parse_tcphdr",{"type":95,"tag":382,"props":2254,"children":2255},{"style":395},[2256],{"type":100,"value":430},{"type":95,"tag":382,"props":2258,"children":2259},{"style":406},[2260],{"type":100,"value":1635},{"type":95,"tag":382,"props":2262,"children":2263},{"style":395},[2264],{"type":100,"value":1640},{"type":95,"tag":382,"props":2266,"children":2267},{"style":406},[2268],{"type":100,"value":1635},{"type":95,"tag":382,"props":2270,"children":2271},{"style":395},[2272],{"type":100,"value":2273},"tcp);\n",{"type":95,"tag":382,"props":2275,"children":2277},{"class":384,"line":2276},50,[2278],{"type":95,"tag":382,"props":2279,"children":2280},{"style":395},[2281],{"type":100,"value":1767},{"type":95,"tag":382,"props":2283,"children":2285},{"class":384,"line":2284},51,[2286,2290,2294,2298,2302,2306],{"type":95,"tag":382,"props":2287,"children":2288},{"style":395},[2289],{"type":100,"value":1910},{"type":95,"tag":382,"props":2291,"children":2292},{"style":661},[2293],{"type":100,"value":1915},{"type":95,"tag":382,"props":2295,"children":2296},{"style":661},[2297],{"type":100,"value":1920},{"type":95,"tag":382,"props":2299,"children":2300},{"style":395},[2301],{"type":100,"value":1789},{"type":95,"tag":382,"props":2303,"children":2304},{"style":406},[2305],{"type":100,"value":1668},{"type":95,"tag":382,"props":2307,"children":2308},{"style":395},[2309],{"type":100,"value":2310}," IPPROTO_UDP) {\n",{"type":95,"tag":382,"props":2312,"children":2313},{"class":384,"line":40},[2314],{"type":95,"tag":382,"props":2315,"children":2316},{"style":1601},[2317],{"type":100,"value":2318},"        // We have captured a UDP packet\n",{"type":95,"tag":382,"props":2320,"children":2322},{"class":384,"line":2321},53,[2323,2327,2332,2336],{"type":95,"tag":382,"props":2324,"children":2325},{"style":677},[2326],{"type":100,"value":1696},{"type":95,"tag":382,"props":2328,"children":2329},{"style":395},[2330],{"type":100,"value":2331}," udphdr ",{"type":95,"tag":382,"props":2333,"children":2334},{"style":406},[2335],{"type":100,"value":1354},{"type":95,"tag":382,"props":2337,"children":2338},{"style":395},[2339],{"type":100,"value":2340},"udp;\n",{"type":95,"tag":382,"props":2342,"children":2344},{"class":2343,"line":1267},[384,519],[2345],{"type":95,"tag":382,"props":2346,"children":2347},{"style":1601},[2348],{"type":100,"value":2349},"        // Parse UDP header\n",{"type":95,"tag":382,"props":2351,"children":2353},{"class":2352,"line":1268},[384,519],[2354,2358,2363,2367,2372,2376,2380,2384,2388],{"type":95,"tag":382,"props":2355,"children":2356},{"style":677},[2357],{"type":100,"value":2238},{"type":95,"tag":382,"props":2359,"children":2360},{"style":395},[2361],{"type":100,"value":2362}," udp_type ",{"type":95,"tag":382,"props":2364,"children":2365},{"style":406},[2366],{"type":100,"value":1387},{"type":95,"tag":382,"props":2368,"children":2369},{"style":422},[2370],{"type":100,"value":2371}," parse_udphdr",{"type":95,"tag":382,"props":2373,"children":2374},{"style":395},[2375],{"type":100,"value":430},{"type":95,"tag":382,"props":2377,"children":2378},{"style":406},[2379],{"type":100,"value":1635},{"type":95,"tag":382,"props":2381,"children":2382},{"style":395},[2383],{"type":100,"value":1640},{"type":95,"tag":382,"props":2385,"children":2386},{"style":406},[2387],{"type":100,"value":1635},{"type":95,"tag":382,"props":2389,"children":2390},{"style":395},[2391],{"type":100,"value":2392},"udp);\n",{"type":95,"tag":382,"props":2394,"children":2396},{"class":384,"line":2395},56,[2397],{"type":95,"tag":382,"props":2398,"children":2399},{"style":395},[2400],{"type":100,"value":1767},{"type":95,"tag":382,"props":2402,"children":2404},{"class":384,"line":2403},57,[2405],{"type":95,"tag":382,"props":2406,"children":2407},{"style":395},[2408],{"type":100,"value":2160},{"type":95,"tag":382,"props":2410,"children":2412},{"class":384,"line":2411},58,[2413],{"type":95,"tag":382,"props":2414,"children":2415},{"style":395},[2416],{"type":100,"value":2417},"    ...\n",{"type":95,"tag":96,"props":2419,"children":2420},{},[2421],{"type":100,"value":2422},"All of these helpers functions take in:",{"type":95,"tag":159,"props":2424,"children":2425},{},[2426,2456,2470],{"type":95,"tag":163,"props":2427,"children":2428},{},[2429,2438,2440,2446,2448,2454],{"type":95,"tag":167,"props":2430,"children":2431},{},[2432],{"type":95,"tag":219,"props":2433,"children":2435},{"className":2434},[],[2436],{"type":100,"value":2437},"struct hdr_cursor *nh",{"type":100,"value":2439}," — a moving “cursor” that is initialy pointing to the beginning of that packet data (",{"type":95,"tag":219,"props":2441,"children":2443},{"className":2442},[],[2444],{"type":100,"value":2445},"nh.pos = data;",{"type":100,"value":2447},"). Each helper then advances ",{"type":95,"tag":219,"props":2449,"children":2451},{"className":2450},[],[2452],{"type":100,"value":2453},"nh->pos",{"type":100,"value":2455}," past the header it successfully parses, so subsequent parsing helpers start at the right place.",{"type":95,"tag":163,"props":2457,"children":2458},{},[2459,2468],{"type":95,"tag":167,"props":2460,"children":2461},{},[2462],{"type":95,"tag":219,"props":2463,"children":2465},{"className":2464},[],[2466],{"type":100,"value":2467},"void *data_end",{"type":100,"value":2469}," — the end of the valid packet region to perform bounds checks so you never read past the packet.",{"type":95,"tag":163,"props":2471,"children":2472},{},[2473,2482,2484,2490,2491,2497],{"type":95,"tag":167,"props":2474,"children":2475},{},[2476],{"type":95,"tag":219,"props":2477,"children":2479},{"className":2478},[],[2480],{"type":100,"value":2481},"\u003Cheader> **out",{"type":100,"value":2483}," — an output pointer that points to the parsed header (e.g., ",{"type":95,"tag":219,"props":2485,"children":2487},{"className":2486},[],[2488],{"type":100,"value":2489},"struct ethhdr",{"type":100,"value":398},{"type":95,"tag":219,"props":2492,"children":2494},{"className":2493},[],[2495],{"type":100,"value":2496},"struct iphdr",{"type":100,"value":2498},", etc.).",{"type":95,"tag":96,"props":2500,"children":2501},{},[2502],{"type":100,"value":2503},"If we look at each stage in a bit more details, by parsing the Ethernet header we can distinguish between IPv4 and IPv6 protocol and extract header information accordingly.",{"type":95,"tag":369,"props":2505,"children":2508},{"className":1048,"code":2506,"filename":1254,"highlights":2507,"language":1050,"meta":376,"style":376},"SEC(\"xdp\") \nint xdp_program(struct xdp_md *ctx) {\n    void *data_end = (void *)(unsigned long long)ctx->data_end;\n    void *data = (void *)(unsigned long long)ctx->data;\n    struct hdr_cursor nh;\n    nh.pos = data;\n\n    int ip_type;\n    // Parse Ethernet header\n    struct ethhdr *eth;\n    int eth_type = parse_ethhdr(&nh, data_end, &eth);\n    if (eth_type == bpf_htons(ETH_P_IP)) { \n        bpf_printk(\"We have captured an IPv4 packet\");\n        struct iphdr *ip;\n        // Parse IPv4 header\n        ip_type = parse_iphdr(&nh, data_end, &ip);\n        ...\n        __u32 src = bpf_ntohl(ip->saddr);\n        __u32 dst = bpf_ntohl(ip->daddr);\n        bpf_printk(\"IPv4 src: %d.%d.%d.%d\",\n            (src >> 24) & 0xFF,\n            (src >> 16) & 0xFF,\n            (src >> 8)  & 0xFF,\n            src & 0xFF);\n        bpf_printk(\"IPv4 dst: %d.%d.%d.%d\",\n            (dst >> 24) & 0xFF,\n            (dst >> 16) & 0xFF,\n            (dst >> 8)  & 0xFF,\n            dst & 0xFF);\n        ...\n    } else if (eth_type == bpf_htons(ETH_P_IPV6)) {\n        bpf_printk(\"We have captured an IPv6 packet\");\n        struct ipv6hdr *ipv6;\n        // Parse IPv6 header\n        ip_type = parse_ip6hdr(&nh, data_end, &ipv6);\n        ...\n        // Print as 4x32-bit chunks (hex)\n        bpf_printk(\"IPv6 src: %x:%x:%x:%x:%x:%x:%x:%x\",\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[0]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[1]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[2]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[3]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[4]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[5]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[6]),\n            bpf_ntohs(ipv6->saddr.in6_u.u6_addr16[7]));\n        bpf_printk(\"IPv6 dst: %x:%x:%x:%x:%x:%x:%x:%x\",\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[0]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[1]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[2]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[3]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[4]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[5]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[6]),\n            bpf_ntohs(ipv6->daddr.in6_u.u6_addr16[7]));\n        ...\n    }\n",[1561,1575,1652,1681,1690,1257,1258,1761,1770,1778,1801,1810,1259,1260,1886,1895,1904,1949,2018,2026,2034,2055,2064,1263,1264,2138,2146,2154,2163,2171,2192,2201,1265,1266,2276,2284,40,2321,1267,1268],[2509],{"type":95,"tag":219,"props":2510,"children":2511},{"__ignoreMap":376},[2512,2531,2566,2633,2700,2711,2734,2741,2752,2759,2778,2818,2842,2864,2883,2891,2927,2935,2975,3013,3034,3072,3105,3139,3160,3181,3214,3246,3278,3299,3306,3338,3358,3377,3385,3421,3429,3438,3459,3518,3571,3624,3677,3730,3783,3836,3890,3911,3963,4015,4067,4119,4171,4223,4275,4327,4334],{"type":95,"tag":382,"props":2513,"children":2514},{"class":384,"line":385},[2515,2519,2523,2527],{"type":95,"tag":382,"props":2516,"children":2517},{"style":422},[2518],{"type":100,"value":1309},{"type":95,"tag":382,"props":2520,"children":2521},{"style":395},[2522],{"type":100,"value":430},{"type":95,"tag":382,"props":2524,"children":2525},{"style":709},[2526],{"type":100,"value":1318},{"type":95,"tag":382,"props":2528,"children":2529},{"style":395},[2530],{"type":100,"value":1323},{"type":95,"tag":382,"props":2532,"children":2533},{"class":384,"line":453},[2534,2538,2542,2546,2550,2554,2558,2562],{"type":95,"tag":382,"props":2535,"children":2536},{"style":677},[2537],{"type":100,"value":1331},{"type":95,"tag":382,"props":2539,"children":2540},{"style":422},[2541],{"type":100,"value":1336},{"type":95,"tag":382,"props":2543,"children":2544},{"style":395},[2545],{"type":100,"value":430},{"type":95,"tag":382,"props":2547,"children":2548},{"style":677},[2549],{"type":100,"value":1062},{"type":95,"tag":382,"props":2551,"children":2552},{"style":395},[2553],{"type":100,"value":1349},{"type":95,"tag":382,"props":2555,"children":2556},{"style":406},[2557],{"type":100,"value":1354},{"type":95,"tag":382,"props":2559,"children":2560},{"style":389},[2561],{"type":100,"value":1359},{"type":95,"tag":382,"props":2563,"children":2564},{"style":395},[2565],{"type":100,"value":1364},{"type":95,"tag":382,"props":2567,"children":2568},{"class":384,"line":486},[2569,2573,2577,2581,2585,2589,2593,2597,2601,2605,2609,2613,2617,2621,2625,2629],{"type":95,"tag":382,"props":2570,"children":2571},{"style":677},[2572],{"type":100,"value":1372},{"type":95,"tag":382,"props":2574,"children":2575},{"style":406},[2576],{"type":100,"value":1377},{"type":95,"tag":382,"props":2578,"children":2579},{"style":395},[2580],{"type":100,"value":1382},{"type":95,"tag":382,"props":2582,"children":2583},{"style":406},[2584],{"type":100,"value":1387},{"type":95,"tag":382,"props":2586,"children":2587},{"style":395},[2588],{"type":100,"value":1392},{"type":95,"tag":382,"props":2590,"children":2591},{"style":677},[2592],{"type":100,"value":1397},{"type":95,"tag":382,"props":2594,"children":2595},{"style":406},[2596],{"type":100,"value":1377},{"type":95,"tag":382,"props":2598,"children":2599},{"style":395},[2600],{"type":100,"value":1406},{"type":95,"tag":382,"props":2602,"children":2603},{"style":677},[2604],{"type":100,"value":1411},{"type":95,"tag":382,"props":2606,"children":2607},{"style":677},[2608],{"type":100,"value":1416},{"type":95,"tag":382,"props":2610,"children":2611},{"style":677},[2612],{"type":100,"value":1416},{"type":95,"tag":382,"props":2614,"children":2615},{"style":395},[2616],{"type":100,"value":1425},{"type":95,"tag":382,"props":2618,"children":2619},{"style":389},[2620],{"type":100,"value":1359},{"type":95,"tag":382,"props":2622,"children":2623},{"style":395},[2624],{"type":100,"value":1434},{"type":95,"tag":382,"props":2626,"children":2627},{"style":389},[2628],{"type":100,"value":1149},{"type":95,"tag":382,"props":2630,"children":2631},{"style":395},[2632],{"type":100,"value":1443},{"type":95,"tag":382,"props":2634,"children":2635},{"class":384,"line":75},[2636,2640,2644,2648,2652,2656,2660,2664,2668,2672,2676,2680,2684,2688,2692,2696],{"type":95,"tag":382,"props":2637,"children":2638},{"style":677},[2639],{"type":100,"value":1372},{"type":95,"tag":382,"props":2641,"children":2642},{"style":406},[2643],{"type":100,"value":1377},{"type":95,"tag":382,"props":2645,"children":2646},{"style":395},[2647],{"type":100,"value":1459},{"type":95,"tag":382,"props":2649,"children":2650},{"style":406},[2651],{"type":100,"value":1387},{"type":95,"tag":382,"props":2653,"children":2654},{"style":395},[2655],{"type":100,"value":1392},{"type":95,"tag":382,"props":2657,"children":2658},{"style":677},[2659],{"type":100,"value":1397},{"type":95,"tag":382,"props":2661,"children":2662},{"style":406},[2663],{"type":100,"value":1377},{"type":95,"tag":382,"props":2665,"children":2666},{"style":395},[2667],{"type":100,"value":1406},{"type":95,"tag":382,"props":2669,"children":2670},{"style":677},[2671],{"type":100,"value":1411},{"type":95,"tag":382,"props":2673,"children":2674},{"style":677},[2675],{"type":100,"value":1416},{"type":95,"tag":382,"props":2677,"children":2678},{"style":677},[2679],{"type":100,"value":1416},{"type":95,"tag":382,"props":2681,"children":2682},{"style":395},[2683],{"type":100,"value":1425},{"type":95,"tag":382,"props":2685,"children":2686},{"style":389},[2687],{"type":100,"value":1359},{"type":95,"tag":382,"props":2689,"children":2690},{"style":395},[2691],{"type":100,"value":1434},{"type":95,"tag":382,"props":2693,"children":2694},{"style":389},[2695],{"type":100,"value":1139},{"type":95,"tag":382,"props":2697,"children":2698},{"style":395},[2699],{"type":100,"value":1443},{"type":95,"tag":382,"props":2701,"children":2702},{"class":384,"line":549},[2703,2707],{"type":95,"tag":382,"props":2704,"children":2705},{"style":677},[2706],{"type":100,"value":1519},{"type":95,"tag":382,"props":2708,"children":2709},{"style":395},[2710],{"type":100,"value":1524},{"type":95,"tag":382,"props":2712,"children":2713},{"class":384,"line":751},[2714,2718,2722,2726,2730],{"type":95,"tag":382,"props":2715,"children":2716},{"style":389},[2717],{"type":100,"value":1532},{"type":95,"tag":382,"props":2719,"children":2720},{"style":395},[2721],{"type":100,"value":419},{"type":95,"tag":382,"props":2723,"children":2724},{"style":389},[2725],{"type":100,"value":1541},{"type":95,"tag":382,"props":2727,"children":2728},{"style":406},[2729],{"type":100,"value":1546},{"type":95,"tag":382,"props":2731,"children":2732},{"style":395},[2733],{"type":100,"value":1551},{"type":95,"tag":382,"props":2735,"children":2736},{"class":384,"line":803},[2737],{"type":95,"tag":382,"props":2738,"children":2739},{"emptyLinePlaceholder":11},[2740],{"type":100,"value":748},{"type":95,"tag":382,"props":2742,"children":2743},{"class":384,"line":603},[2744,2748],{"type":95,"tag":382,"props":2745,"children":2746},{"style":677},[2747],{"type":100,"value":1567},{"type":95,"tag":382,"props":2749,"children":2750},{"style":395},[2751],{"type":100,"value":1572},{"type":95,"tag":382,"props":2753,"children":2754},{"class":384,"line":859},[2755],{"type":95,"tag":382,"props":2756,"children":2757},{"style":1601},[2758],{"type":100,"value":1604},{"type":95,"tag":382,"props":2760,"children":2761},{"class":384,"line":887},[2762,2766,2770,2774],{"type":95,"tag":382,"props":2763,"children":2764},{"style":677},[2765],{"type":100,"value":1519},{"type":95,"tag":382,"props":2767,"children":2768},{"style":395},[2769],{"type":100,"value":1585},{"type":95,"tag":382,"props":2771,"children":2772},{"style":406},[2773],{"type":100,"value":1354},{"type":95,"tag":382,"props":2775,"children":2776},{"style":395},[2777],{"type":100,"value":1594},{"type":95,"tag":382,"props":2779,"children":2781},{"class":2780,"line":1561},[384,519],[2782,2786,2790,2794,2798,2802,2806,2810,2814],{"type":95,"tag":382,"props":2783,"children":2784},{"style":677},[2785],{"type":100,"value":1567},{"type":95,"tag":382,"props":2787,"children":2788},{"style":395},[2789],{"type":100,"value":1617},{"type":95,"tag":382,"props":2791,"children":2792},{"style":406},[2793],{"type":100,"value":1387},{"type":95,"tag":382,"props":2795,"children":2796},{"style":422},[2797],{"type":100,"value":1626},{"type":95,"tag":382,"props":2799,"children":2800},{"style":395},[2801],{"type":100,"value":430},{"type":95,"tag":382,"props":2803,"children":2804},{"style":406},[2805],{"type":100,"value":1635},{"type":95,"tag":382,"props":2807,"children":2808},{"style":395},[2809],{"type":100,"value":1640},{"type":95,"tag":382,"props":2811,"children":2812},{"style":406},[2813],{"type":100,"value":1635},{"type":95,"tag":382,"props":2815,"children":2816},{"style":395},[2817],{"type":100,"value":1649},{"type":95,"tag":382,"props":2819,"children":2821},{"class":2820,"line":1575},[384,519],[2822,2826,2830,2834,2838],{"type":95,"tag":382,"props":2823,"children":2824},{"style":661},[2825],{"type":100,"value":1658},{"type":95,"tag":382,"props":2827,"children":2828},{"style":395},[2829],{"type":100,"value":1663},{"type":95,"tag":382,"props":2831,"children":2832},{"style":406},[2833],{"type":100,"value":1668},{"type":95,"tag":382,"props":2835,"children":2836},{"style":422},[2837],{"type":100,"value":1673},{"type":95,"tag":382,"props":2839,"children":2840},{"style":395},[2841],{"type":100,"value":1678},{"type":95,"tag":382,"props":2843,"children":2844},{"class":384,"line":41},[2845,2850,2854,2859],{"type":95,"tag":382,"props":2846,"children":2847},{"style":422},[2848],{"type":100,"value":2849},"        bpf_printk",{"type":95,"tag":382,"props":2851,"children":2852},{"style":395},[2853],{"type":100,"value":430},{"type":95,"tag":382,"props":2855,"children":2856},{"style":709},[2857],{"type":100,"value":2858},"\"We have captured an IPv4 packet\"",{"type":95,"tag":382,"props":2860,"children":2861},{"style":395},[2862],{"type":100,"value":2863},");\n",{"type":95,"tag":382,"props":2865,"children":2866},{"class":384,"line":1256},[2867,2871,2875,2879],{"type":95,"tag":382,"props":2868,"children":2869},{"style":677},[2870],{"type":100,"value":1696},{"type":95,"tag":382,"props":2872,"children":2873},{"style":395},[2874],{"type":100,"value":1701},{"type":95,"tag":382,"props":2876,"children":2877},{"style":406},[2878],{"type":100,"value":1354},{"type":95,"tag":382,"props":2880,"children":2881},{"style":395},[2882],{"type":100,"value":1710},{"type":95,"tag":382,"props":2884,"children":2886},{"class":2885,"line":1652},[384,519],[2887],{"type":95,"tag":382,"props":2888,"children":2889},{"style":1601},[2890],{"type":100,"value":1719},{"type":95,"tag":382,"props":2892,"children":2894},{"class":2893,"line":1681},[384,519],[2895,2899,2903,2907,2911,2915,2919,2923],{"type":95,"tag":382,"props":2896,"children":2897},{"style":395},[2898],{"type":100,"value":1728},{"type":95,"tag":382,"props":2900,"children":2901},{"style":406},[2902],{"type":100,"value":1387},{"type":95,"tag":382,"props":2904,"children":2905},{"style":422},[2906],{"type":100,"value":1737},{"type":95,"tag":382,"props":2908,"children":2909},{"style":395},[2910],{"type":100,"value":430},{"type":95,"tag":382,"props":2912,"children":2913},{"style":406},[2914],{"type":100,"value":1635},{"type":95,"tag":382,"props":2916,"children":2917},{"style":395},[2918],{"type":100,"value":1640},{"type":95,"tag":382,"props":2920,"children":2921},{"style":406},[2922],{"type":100,"value":1635},{"type":95,"tag":382,"props":2924,"children":2925},{"style":395},[2926],{"type":100,"value":1758},{"type":95,"tag":382,"props":2928,"children":2930},{"class":2929,"line":1690},[384,519],[2931],{"type":95,"tag":382,"props":2932,"children":2933},{"style":395},[2934],{"type":100,"value":1767},{"type":95,"tag":382,"props":2936,"children":2938},{"class":2937,"line":1257},[384,519],[2939,2944,2948,2953,2957,2962,2966,2971],{"type":95,"tag":382,"props":2940,"children":2941},{"style":395},[2942],{"type":100,"value":2943},"        __u32 src ",{"type":95,"tag":382,"props":2945,"children":2946},{"style":406},[2947],{"type":100,"value":1387},{"type":95,"tag":382,"props":2949,"children":2950},{"style":422},[2951],{"type":100,"value":2952}," bpf_ntohl",{"type":95,"tag":382,"props":2954,"children":2955},{"style":395},[2956],{"type":100,"value":430},{"type":95,"tag":382,"props":2958,"children":2959},{"style":389},[2960],{"type":100,"value":2961},"ip",{"type":95,"tag":382,"props":2963,"children":2964},{"style":395},[2965],{"type":100,"value":1434},{"type":95,"tag":382,"props":2967,"children":2968},{"style":389},[2969],{"type":100,"value":2970},"saddr",{"type":95,"tag":382,"props":2972,"children":2973},{"style":395},[2974],{"type":100,"value":2863},{"type":95,"tag":382,"props":2976,"children":2978},{"class":2977,"line":1258},[384,519],[2979,2984,2988,2992,2996,3000,3004,3009],{"type":95,"tag":382,"props":2980,"children":2981},{"style":395},[2982],{"type":100,"value":2983},"        __u32 dst ",{"type":95,"tag":382,"props":2985,"children":2986},{"style":406},[2987],{"type":100,"value":1387},{"type":95,"tag":382,"props":2989,"children":2990},{"style":422},[2991],{"type":100,"value":2952},{"type":95,"tag":382,"props":2993,"children":2994},{"style":395},[2995],{"type":100,"value":430},{"type":95,"tag":382,"props":2997,"children":2998},{"style":389},[2999],{"type":100,"value":2961},{"type":95,"tag":382,"props":3001,"children":3002},{"style":395},[3003],{"type":100,"value":1434},{"type":95,"tag":382,"props":3005,"children":3006},{"style":389},[3007],{"type":100,"value":3008},"daddr",{"type":95,"tag":382,"props":3010,"children":3011},{"style":395},[3012],{"type":100,"value":2863},{"type":95,"tag":382,"props":3014,"children":3016},{"class":3015,"line":1761},[384,519],[3017,3021,3025,3030],{"type":95,"tag":382,"props":3018,"children":3019},{"style":422},[3020],{"type":100,"value":2849},{"type":95,"tag":382,"props":3022,"children":3023},{"style":395},[3024],{"type":100,"value":430},{"type":95,"tag":382,"props":3026,"children":3027},{"style":709},[3028],{"type":100,"value":3029},"\"IPv4 src: %d.%d.%d.%d\"",{"type":95,"tag":382,"props":3031,"children":3032},{"style":395},[3033],{"type":100,"value":483},{"type":95,"tag":382,"props":3035,"children":3037},{"class":3036,"line":1770},[384,519],[3038,3043,3048,3054,3059,3063,3068],{"type":95,"tag":382,"props":3039,"children":3040},{"style":395},[3041],{"type":100,"value":3042},"            (src ",{"type":95,"tag":382,"props":3044,"children":3045},{"style":406},[3046],{"type":100,"value":3047},">>",{"type":95,"tag":382,"props":3049,"children":3051},{"style":3050},"--shiki-default:#B5CEA8",[3052],{"type":100,"value":3053}," 24",{"type":95,"tag":382,"props":3055,"children":3056},{"style":395},[3057],{"type":100,"value":3058},") ",{"type":95,"tag":382,"props":3060,"children":3061},{"style":406},[3062],{"type":100,"value":1635},{"type":95,"tag":382,"props":3064,"children":3065},{"style":3050},[3066],{"type":100,"value":3067}," 0xFF",{"type":95,"tag":382,"props":3069,"children":3070},{"style":395},[3071],{"type":100,"value":483},{"type":95,"tag":382,"props":3073,"children":3075},{"class":3074,"line":1778},[384,519],[3076,3080,3084,3089,3093,3097,3101],{"type":95,"tag":382,"props":3077,"children":3078},{"style":395},[3079],{"type":100,"value":3042},{"type":95,"tag":382,"props":3081,"children":3082},{"style":406},[3083],{"type":100,"value":3047},{"type":95,"tag":382,"props":3085,"children":3086},{"style":3050},[3087],{"type":100,"value":3088}," 16",{"type":95,"tag":382,"props":3090,"children":3091},{"style":395},[3092],{"type":100,"value":3058},{"type":95,"tag":382,"props":3094,"children":3095},{"style":406},[3096],{"type":100,"value":1635},{"type":95,"tag":382,"props":3098,"children":3099},{"style":3050},[3100],{"type":100,"value":3067},{"type":95,"tag":382,"props":3102,"children":3103},{"style":395},[3104],{"type":100,"value":483},{"type":95,"tag":382,"props":3106,"children":3108},{"class":3107,"line":1801},[384,519],[3109,3113,3117,3122,3127,3131,3135],{"type":95,"tag":382,"props":3110,"children":3111},{"style":395},[3112],{"type":100,"value":3042},{"type":95,"tag":382,"props":3114,"children":3115},{"style":406},[3116],{"type":100,"value":3047},{"type":95,"tag":382,"props":3118,"children":3119},{"style":3050},[3120],{"type":100,"value":3121}," 8",{"type":95,"tag":382,"props":3123,"children":3124},{"style":395},[3125],{"type":100,"value":3126},")  ",{"type":95,"tag":382,"props":3128,"children":3129},{"style":406},[3130],{"type":100,"value":1635},{"type":95,"tag":382,"props":3132,"children":3133},{"style":3050},[3134],{"type":100,"value":3067},{"type":95,"tag":382,"props":3136,"children":3137},{"style":395},[3138],{"type":100,"value":483},{"type":95,"tag":382,"props":3140,"children":3142},{"class":3141,"line":1810},[384,519],[3143,3148,3152,3156],{"type":95,"tag":382,"props":3144,"children":3145},{"style":395},[3146],{"type":100,"value":3147},"            src ",{"type":95,"tag":382,"props":3149,"children":3150},{"style":406},[3151],{"type":100,"value":1635},{"type":95,"tag":382,"props":3153,"children":3154},{"style":3050},[3155],{"type":100,"value":3067},{"type":95,"tag":382,"props":3157,"children":3158},{"style":395},[3159],{"type":100,"value":2863},{"type":95,"tag":382,"props":3161,"children":3163},{"class":3162,"line":1259},[384,519],[3164,3168,3172,3177],{"type":95,"tag":382,"props":3165,"children":3166},{"style":422},[3167],{"type":100,"value":2849},{"type":95,"tag":382,"props":3169,"children":3170},{"style":395},[3171],{"type":100,"value":430},{"type":95,"tag":382,"props":3173,"children":3174},{"style":709},[3175],{"type":100,"value":3176},"\"IPv4 dst: %d.%d.%d.%d\"",{"type":95,"tag":382,"props":3178,"children":3179},{"style":395},[3180],{"type":100,"value":483},{"type":95,"tag":382,"props":3182,"children":3184},{"class":3183,"line":1260},[384,519],[3185,3190,3194,3198,3202,3206,3210],{"type":95,"tag":382,"props":3186,"children":3187},{"style":395},[3188],{"type":100,"value":3189},"            (dst ",{"type":95,"tag":382,"props":3191,"children":3192},{"style":406},[3193],{"type":100,"value":3047},{"type":95,"tag":382,"props":3195,"children":3196},{"style":3050},[3197],{"type":100,"value":3053},{"type":95,"tag":382,"props":3199,"children":3200},{"style":395},[3201],{"type":100,"value":3058},{"type":95,"tag":382,"props":3203,"children":3204},{"style":406},[3205],{"type":100,"value":1635},{"type":95,"tag":382,"props":3207,"children":3208},{"style":3050},[3209],{"type":100,"value":3067},{"type":95,"tag":382,"props":3211,"children":3212},{"style":395},[3213],{"type":100,"value":483},{"type":95,"tag":382,"props":3215,"children":3217},{"class":3216,"line":1886},[384,519],[3218,3222,3226,3230,3234,3238,3242],{"type":95,"tag":382,"props":3219,"children":3220},{"style":395},[3221],{"type":100,"value":3189},{"type":95,"tag":382,"props":3223,"children":3224},{"style":406},[3225],{"type":100,"value":3047},{"type":95,"tag":382,"props":3227,"children":3228},{"style":3050},[3229],{"type":100,"value":3088},{"type":95,"tag":382,"props":3231,"children":3232},{"style":395},[3233],{"type":100,"value":3058},{"type":95,"tag":382,"props":3235,"children":3236},{"style":406},[3237],{"type":100,"value":1635},{"type":95,"tag":382,"props":3239,"children":3240},{"style":3050},[3241],{"type":100,"value":3067},{"type":95,"tag":382,"props":3243,"children":3244},{"style":395},[3245],{"type":100,"value":483},{"type":95,"tag":382,"props":3247,"children":3249},{"class":3248,"line":1895},[384,519],[3250,3254,3258,3262,3266,3270,3274],{"type":95,"tag":382,"props":3251,"children":3252},{"style":395},[3253],{"type":100,"value":3189},{"type":95,"tag":382,"props":3255,"children":3256},{"style":406},[3257],{"type":100,"value":3047},{"type":95,"tag":382,"props":3259,"children":3260},{"style":3050},[3261],{"type":100,"value":3121},{"type":95,"tag":382,"props":3263,"children":3264},{"style":395},[3265],{"type":100,"value":3126},{"type":95,"tag":382,"props":3267,"children":3268},{"style":406},[3269],{"type":100,"value":1635},{"type":95,"tag":382,"props":3271,"children":3272},{"style":3050},[3273],{"type":100,"value":3067},{"type":95,"tag":382,"props":3275,"children":3276},{"style":395},[3277],{"type":100,"value":483},{"type":95,"tag":382,"props":3279,"children":3281},{"class":3280,"line":1904},[384,519],[3282,3287,3291,3295],{"type":95,"tag":382,"props":3283,"children":3284},{"style":395},[3285],{"type":100,"value":3286},"            dst ",{"type":95,"tag":382,"props":3288,"children":3289},{"style":406},[3290],{"type":100,"value":1635},{"type":95,"tag":382,"props":3292,"children":3293},{"style":3050},[3294],{"type":100,"value":3067},{"type":95,"tag":382,"props":3296,"children":3297},{"style":395},[3298],{"type":100,"value":2863},{"type":95,"tag":382,"props":3300,"children":3301},{"class":384,"line":1940},[3302],{"type":95,"tag":382,"props":3303,"children":3304},{"style":395},[3305],{"type":100,"value":1767},{"type":95,"tag":382,"props":3307,"children":3309},{"class":3308,"line":1949},[384,519],[3310,3314,3318,3322,3326,3330,3334],{"type":95,"tag":382,"props":3311,"children":3312},{"style":395},[3313],{"type":100,"value":1910},{"type":95,"tag":382,"props":3315,"children":3316},{"style":661},[3317],{"type":100,"value":1915},{"type":95,"tag":382,"props":3319,"children":3320},{"style":661},[3321],{"type":100,"value":1920},{"type":95,"tag":382,"props":3323,"children":3324},{"style":395},[3325],{"type":100,"value":1663},{"type":95,"tag":382,"props":3327,"children":3328},{"style":406},[3329],{"type":100,"value":1668},{"type":95,"tag":382,"props":3331,"children":3332},{"style":422},[3333],{"type":100,"value":1673},{"type":95,"tag":382,"props":3335,"children":3336},{"style":395},[3337],{"type":100,"value":1937},{"type":95,"tag":382,"props":3339,"children":3340},{"class":384,"line":1261},[3341,3345,3349,3354],{"type":95,"tag":382,"props":3342,"children":3343},{"style":422},[3344],{"type":100,"value":2849},{"type":95,"tag":382,"props":3346,"children":3347},{"style":395},[3348],{"type":100,"value":430},{"type":95,"tag":382,"props":3350,"children":3351},{"style":709},[3352],{"type":100,"value":3353},"\"We have captured an IPv6 packet\"",{"type":95,"tag":382,"props":3355,"children":3356},{"style":395},[3357],{"type":100,"value":2863},{"type":95,"tag":382,"props":3359,"children":3360},{"class":384,"line":1262},[3361,3365,3369,3373],{"type":95,"tag":382,"props":3362,"children":3363},{"style":677},[3364],{"type":100,"value":1696},{"type":95,"tag":382,"props":3366,"children":3367},{"style":395},[3368],{"type":100,"value":1959},{"type":95,"tag":382,"props":3370,"children":3371},{"style":406},[3372],{"type":100,"value":1354},{"type":95,"tag":382,"props":3374,"children":3375},{"style":395},[3376],{"type":100,"value":1968},{"type":95,"tag":382,"props":3378,"children":3380},{"class":3379,"line":2018},[384,519],[3381],{"type":95,"tag":382,"props":3382,"children":3383},{"style":1601},[3384],{"type":100,"value":1977},{"type":95,"tag":382,"props":3386,"children":3388},{"class":3387,"line":2026},[384,519],[3389,3393,3397,3401,3405,3409,3413,3417],{"type":95,"tag":382,"props":3390,"children":3391},{"style":395},[3392],{"type":100,"value":1728},{"type":95,"tag":382,"props":3394,"children":3395},{"style":406},[3396],{"type":100,"value":1387},{"type":95,"tag":382,"props":3398,"children":3399},{"style":422},[3400],{"type":100,"value":1994},{"type":95,"tag":382,"props":3402,"children":3403},{"style":395},[3404],{"type":100,"value":430},{"type":95,"tag":382,"props":3406,"children":3407},{"style":406},[3408],{"type":100,"value":1635},{"type":95,"tag":382,"props":3410,"children":3411},{"style":395},[3412],{"type":100,"value":1640},{"type":95,"tag":382,"props":3414,"children":3415},{"style":406},[3416],{"type":100,"value":1635},{"type":95,"tag":382,"props":3418,"children":3419},{"style":395},[3420],{"type":100,"value":2015},{"type":95,"tag":382,"props":3422,"children":3424},{"class":3423,"line":2034},[384,519],[3425],{"type":95,"tag":382,"props":3426,"children":3427},{"style":395},[3428],{"type":100,"value":1767},{"type":95,"tag":382,"props":3430,"children":3432},{"class":3431,"line":2055},[384,519],[3433],{"type":95,"tag":382,"props":3434,"children":3435},{"style":1601},[3436],{"type":100,"value":3437},"        // Print as 4x32-bit chunks (hex)\n",{"type":95,"tag":382,"props":3439,"children":3441},{"class":3440,"line":2064},[384,519],[3442,3446,3450,3455],{"type":95,"tag":382,"props":3443,"children":3444},{"style":422},[3445],{"type":100,"value":2849},{"type":95,"tag":382,"props":3447,"children":3448},{"style":395},[3449],{"type":100,"value":430},{"type":95,"tag":382,"props":3451,"children":3452},{"style":709},[3453],{"type":100,"value":3454},"\"IPv6 src: %x:%x:%x:%x:%x:%x:%x:%x\"",{"type":95,"tag":382,"props":3456,"children":3457},{"style":395},[3458],{"type":100,"value":483},{"type":95,"tag":382,"props":3460,"children":3462},{"class":3461,"line":1263},[384,519],[3463,3468,3472,3477,3481,3485,3489,3494,3498,3503,3508,3513],{"type":95,"tag":382,"props":3464,"children":3465},{"style":422},[3466],{"type":100,"value":3467},"            bpf_ntohs",{"type":95,"tag":382,"props":3469,"children":3470},{"style":395},[3471],{"type":100,"value":430},{"type":95,"tag":382,"props":3473,"children":3474},{"style":389},[3475],{"type":100,"value":3476},"ipv6",{"type":95,"tag":382,"props":3478,"children":3479},{"style":395},[3480],{"type":100,"value":1434},{"type":95,"tag":382,"props":3482,"children":3483},{"style":389},[3484],{"type":100,"value":2970},{"type":95,"tag":382,"props":3486,"children":3487},{"style":395},[3488],{"type":100,"value":419},{"type":95,"tag":382,"props":3490,"children":3491},{"style":389},[3492],{"type":100,"value":3493},"in6_u",{"type":95,"tag":382,"props":3495,"children":3496},{"style":395},[3497],{"type":100,"value":419},{"type":95,"tag":382,"props":3499,"children":3500},{"style":389},[3501],{"type":100,"value":3502},"u6_addr16",{"type":95,"tag":382,"props":3504,"children":3505},{"style":395},[3506],{"type":100,"value":3507},"[",{"type":95,"tag":382,"props":3509,"children":3510},{"style":3050},[3511],{"type":100,"value":3512},"0",{"type":95,"tag":382,"props":3514,"children":3515},{"style":395},[3516],{"type":100,"value":3517},"]),\n",{"type":95,"tag":382,"props":3519,"children":3521},{"class":3520,"line":1264},[384,519],[3522,3526,3530,3534,3538,3542,3546,3550,3554,3558,3562,3567],{"type":95,"tag":382,"props":3523,"children":3524},{"style":422},[3525],{"type":100,"value":3467},{"type":95,"tag":382,"props":3527,"children":3528},{"style":395},[3529],{"type":100,"value":430},{"type":95,"tag":382,"props":3531,"children":3532},{"style":389},[3533],{"type":100,"value":3476},{"type":95,"tag":382,"props":3535,"children":3536},{"style":395},[3537],{"type":100,"value":1434},{"type":95,"tag":382,"props":3539,"children":3540},{"style":389},[3541],{"type":100,"value":2970},{"type":95,"tag":382,"props":3543,"children":3544},{"style":395},[3545],{"type":100,"value":419},{"type":95,"tag":382,"props":3547,"children":3548},{"style":389},[3549],{"type":100,"value":3493},{"type":95,"tag":382,"props":3551,"children":3552},{"style":395},[3553],{"type":100,"value":419},{"type":95,"tag":382,"props":3555,"children":3556},{"style":389},[3557],{"type":100,"value":3502},{"type":95,"tag":382,"props":3559,"children":3560},{"style":395},[3561],{"type":100,"value":3507},{"type":95,"tag":382,"props":3563,"children":3564},{"style":3050},[3565],{"type":100,"value":3566},"1",{"type":95,"tag":382,"props":3568,"children":3569},{"style":395},[3570],{"type":100,"value":3517},{"type":95,"tag":382,"props":3572,"children":3574},{"class":3573,"line":2138},[384,519],[3575,3579,3583,3587,3591,3595,3599,3603,3607,3611,3615,3620],{"type":95,"tag":382,"props":3576,"children":3577},{"style":422},[3578],{"type":100,"value":3467},{"type":95,"tag":382,"props":3580,"children":3581},{"style":395},[3582],{"type":100,"value":430},{"type":95,"tag":382,"props":3584,"children":3585},{"style":389},[3586],{"type":100,"value":3476},{"type":95,"tag":382,"props":3588,"children":3589},{"style":395},[3590],{"type":100,"value":1434},{"type":95,"tag":382,"props":3592,"children":3593},{"style":389},[3594],{"type":100,"value":2970},{"type":95,"tag":382,"props":3596,"children":3597},{"style":395},[3598],{"type":100,"value":419},{"type":95,"tag":382,"props":3600,"children":3601},{"style":389},[3602],{"type":100,"value":3493},{"type":95,"tag":382,"props":3604,"children":3605},{"style":395},[3606],{"type":100,"value":419},{"type":95,"tag":382,"props":3608,"children":3609},{"style":389},[3610],{"type":100,"value":3502},{"type":95,"tag":382,"props":3612,"children":3613},{"style":395},[3614],{"type":100,"value":3507},{"type":95,"tag":382,"props":3616,"children":3617},{"style":3050},[3618],{"type":100,"value":3619},"2",{"type":95,"tag":382,"props":3621,"children":3622},{"style":395},[3623],{"type":100,"value":3517},{"type":95,"tag":382,"props":3625,"children":3627},{"class":3626,"line":2146},[384,519],[3628,3632,3636,3640,3644,3648,3652,3656,3660,3664,3668,3673],{"type":95,"tag":382,"props":3629,"children":3630},{"style":422},[3631],{"type":100,"value":3467},{"type":95,"tag":382,"props":3633,"children":3634},{"style":395},[3635],{"type":100,"value":430},{"type":95,"tag":382,"props":3637,"children":3638},{"style":389},[3639],{"type":100,"value":3476},{"type":95,"tag":382,"props":3641,"children":3642},{"style":395},[3643],{"type":100,"value":1434},{"type":95,"tag":382,"props":3645,"children":3646},{"style":389},[3647],{"type":100,"value":2970},{"type":95,"tag":382,"props":3649,"children":3650},{"style":395},[3651],{"type":100,"value":419},{"type":95,"tag":382,"props":3653,"children":3654},{"style":389},[3655],{"type":100,"value":3493},{"type":95,"tag":382,"props":3657,"children":3658},{"style":395},[3659],{"type":100,"value":419},{"type":95,"tag":382,"props":3661,"children":3662},{"style":389},[3663],{"type":100,"value":3502},{"type":95,"tag":382,"props":3665,"children":3666},{"style":395},[3667],{"type":100,"value":3507},{"type":95,"tag":382,"props":3669,"children":3670},{"style":3050},[3671],{"type":100,"value":3672},"3",{"type":95,"tag":382,"props":3674,"children":3675},{"style":395},[3676],{"type":100,"value":3517},{"type":95,"tag":382,"props":3678,"children":3680},{"class":3679,"line":2154},[384,519],[3681,3685,3689,3693,3697,3701,3705,3709,3713,3717,3721,3726],{"type":95,"tag":382,"props":3682,"children":3683},{"style":422},[3684],{"type":100,"value":3467},{"type":95,"tag":382,"props":3686,"children":3687},{"style":395},[3688],{"type":100,"value":430},{"type":95,"tag":382,"props":3690,"children":3691},{"style":389},[3692],{"type":100,"value":3476},{"type":95,"tag":382,"props":3694,"children":3695},{"style":395},[3696],{"type":100,"value":1434},{"type":95,"tag":382,"props":3698,"children":3699},{"style":389},[3700],{"type":100,"value":2970},{"type":95,"tag":382,"props":3702,"children":3703},{"style":395},[3704],{"type":100,"value":419},{"type":95,"tag":382,"props":3706,"children":3707},{"style":389},[3708],{"type":100,"value":3493},{"type":95,"tag":382,"props":3710,"children":3711},{"style":395},[3712],{"type":100,"value":419},{"type":95,"tag":382,"props":3714,"children":3715},{"style":389},[3716],{"type":100,"value":3502},{"type":95,"tag":382,"props":3718,"children":3719},{"style":395},[3720],{"type":100,"value":3507},{"type":95,"tag":382,"props":3722,"children":3723},{"style":3050},[3724],{"type":100,"value":3725},"4",{"type":95,"tag":382,"props":3727,"children":3728},{"style":395},[3729],{"type":100,"value":3517},{"type":95,"tag":382,"props":3731,"children":3733},{"class":3732,"line":2163},[384,519],[3734,3738,3742,3746,3750,3754,3758,3762,3766,3770,3774,3779],{"type":95,"tag":382,"props":3735,"children":3736},{"style":422},[3737],{"type":100,"value":3467},{"type":95,"tag":382,"props":3739,"children":3740},{"style":395},[3741],{"type":100,"value":430},{"type":95,"tag":382,"props":3743,"children":3744},{"style":389},[3745],{"type":100,"value":3476},{"type":95,"tag":382,"props":3747,"children":3748},{"style":395},[3749],{"type":100,"value":1434},{"type":95,"tag":382,"props":3751,"children":3752},{"style":389},[3753],{"type":100,"value":2970},{"type":95,"tag":382,"props":3755,"children":3756},{"style":395},[3757],{"type":100,"value":419},{"type":95,"tag":382,"props":3759,"children":3760},{"style":389},[3761],{"type":100,"value":3493},{"type":95,"tag":382,"props":3763,"children":3764},{"style":395},[3765],{"type":100,"value":419},{"type":95,"tag":382,"props":3767,"children":3768},{"style":389},[3769],{"type":100,"value":3502},{"type":95,"tag":382,"props":3771,"children":3772},{"style":395},[3773],{"type":100,"value":3507},{"type":95,"tag":382,"props":3775,"children":3776},{"style":3050},[3777],{"type":100,"value":3778},"5",{"type":95,"tag":382,"props":3780,"children":3781},{"style":395},[3782],{"type":100,"value":3517},{"type":95,"tag":382,"props":3784,"children":3786},{"class":3785,"line":2171},[384,519],[3787,3791,3795,3799,3803,3807,3811,3815,3819,3823,3827,3832],{"type":95,"tag":382,"props":3788,"children":3789},{"style":422},[3790],{"type":100,"value":3467},{"type":95,"tag":382,"props":3792,"children":3793},{"style":395},[3794],{"type":100,"value":430},{"type":95,"tag":382,"props":3796,"children":3797},{"style":389},[3798],{"type":100,"value":3476},{"type":95,"tag":382,"props":3800,"children":3801},{"style":395},[3802],{"type":100,"value":1434},{"type":95,"tag":382,"props":3804,"children":3805},{"style":389},[3806],{"type":100,"value":2970},{"type":95,"tag":382,"props":3808,"children":3809},{"style":395},[3810],{"type":100,"value":419},{"type":95,"tag":382,"props":3812,"children":3813},{"style":389},[3814],{"type":100,"value":3493},{"type":95,"tag":382,"props":3816,"children":3817},{"style":395},[3818],{"type":100,"value":419},{"type":95,"tag":382,"props":3820,"children":3821},{"style":389},[3822],{"type":100,"value":3502},{"type":95,"tag":382,"props":3824,"children":3825},{"style":395},[3826],{"type":100,"value":3507},{"type":95,"tag":382,"props":3828,"children":3829},{"style":3050},[3830],{"type":100,"value":3831},"6",{"type":95,"tag":382,"props":3833,"children":3834},{"style":395},[3835],{"type":100,"value":3517},{"type":95,"tag":382,"props":3837,"children":3839},{"class":3838,"line":2192},[384,519],[3840,3844,3848,3852,3856,3860,3864,3868,3872,3876,3880,3885],{"type":95,"tag":382,"props":3841,"children":3842},{"style":422},[3843],{"type":100,"value":3467},{"type":95,"tag":382,"props":3845,"children":3846},{"style":395},[3847],{"type":100,"value":430},{"type":95,"tag":382,"props":3849,"children":3850},{"style":389},[3851],{"type":100,"value":3476},{"type":95,"tag":382,"props":3853,"children":3854},{"style":395},[3855],{"type":100,"value":1434},{"type":95,"tag":382,"props":3857,"children":3858},{"style":389},[3859],{"type":100,"value":2970},{"type":95,"tag":382,"props":3861,"children":3862},{"style":395},[3863],{"type":100,"value":419},{"type":95,"tag":382,"props":3865,"children":3866},{"style":389},[3867],{"type":100,"value":3493},{"type":95,"tag":382,"props":3869,"children":3870},{"style":395},[3871],{"type":100,"value":419},{"type":95,"tag":382,"props":3873,"children":3874},{"style":389},[3875],{"type":100,"value":3502},{"type":95,"tag":382,"props":3877,"children":3878},{"style":395},[3879],{"type":100,"value":3507},{"type":95,"tag":382,"props":3881,"children":3882},{"style":3050},[3883],{"type":100,"value":3884},"7",{"type":95,"tag":382,"props":3886,"children":3887},{"style":395},[3888],{"type":100,"value":3889},"]));\n",{"type":95,"tag":382,"props":3891,"children":3893},{"class":3892,"line":2201},[384,519],[3894,3898,3902,3907],{"type":95,"tag":382,"props":3895,"children":3896},{"style":422},[3897],{"type":100,"value":2849},{"type":95,"tag":382,"props":3899,"children":3900},{"style":395},[3901],{"type":100,"value":430},{"type":95,"tag":382,"props":3903,"children":3904},{"style":709},[3905],{"type":100,"value":3906},"\"IPv6 dst: %x:%x:%x:%x:%x:%x:%x:%x\"",{"type":95,"tag":382,"props":3908,"children":3909},{"style":395},[3910],{"type":100,"value":483},{"type":95,"tag":382,"props":3912,"children":3914},{"class":3913,"line":1265},[384,519],[3915,3919,3923,3927,3931,3935,3939,3943,3947,3951,3955,3959],{"type":95,"tag":382,"props":3916,"children":3917},{"style":422},[3918],{"type":100,"value":3467},{"type":95,"tag":382,"props":3920,"children":3921},{"style":395},[3922],{"type":100,"value":430},{"type":95,"tag":382,"props":3924,"children":3925},{"style":389},[3926],{"type":100,"value":3476},{"type":95,"tag":382,"props":3928,"children":3929},{"style":395},[3930],{"type":100,"value":1434},{"type":95,"tag":382,"props":3932,"children":3933},{"style":389},[3934],{"type":100,"value":3008},{"type":95,"tag":382,"props":3936,"children":3937},{"style":395},[3938],{"type":100,"value":419},{"type":95,"tag":382,"props":3940,"children":3941},{"style":389},[3942],{"type":100,"value":3493},{"type":95,"tag":382,"props":3944,"children":3945},{"style":395},[3946],{"type":100,"value":419},{"type":95,"tag":382,"props":3948,"children":3949},{"style":389},[3950],{"type":100,"value":3502},{"type":95,"tag":382,"props":3952,"children":3953},{"style":395},[3954],{"type":100,"value":3507},{"type":95,"tag":382,"props":3956,"children":3957},{"style":3050},[3958],{"type":100,"value":3512},{"type":95,"tag":382,"props":3960,"children":3961},{"style":395},[3962],{"type":100,"value":3517},{"type":95,"tag":382,"props":3964,"children":3966},{"class":3965,"line":1266},[384,519],[3967,3971,3975,3979,3983,3987,3991,3995,3999,4003,4007,4011],{"type":95,"tag":382,"props":3968,"children":3969},{"style":422},[3970],{"type":100,"value":3467},{"type":95,"tag":382,"props":3972,"children":3973},{"style":395},[3974],{"type":100,"value":430},{"type":95,"tag":382,"props":3976,"children":3977},{"style":389},[3978],{"type":100,"value":3476},{"type":95,"tag":382,"props":3980,"children":3981},{"style":395},[3982],{"type":100,"value":1434},{"type":95,"tag":382,"props":3984,"children":3985},{"style":389},[3986],{"type":100,"value":3008},{"type":95,"tag":382,"props":3988,"children":3989},{"style":395},[3990],{"type":100,"value":419},{"type":95,"tag":382,"props":3992,"children":3993},{"style":389},[3994],{"type":100,"value":3493},{"type":95,"tag":382,"props":3996,"children":3997},{"style":395},[3998],{"type":100,"value":419},{"type":95,"tag":382,"props":4000,"children":4001},{"style":389},[4002],{"type":100,"value":3502},{"type":95,"tag":382,"props":4004,"children":4005},{"style":395},[4006],{"type":100,"value":3507},{"type":95,"tag":382,"props":4008,"children":4009},{"style":3050},[4010],{"type":100,"value":3566},{"type":95,"tag":382,"props":4012,"children":4013},{"style":395},[4014],{"type":100,"value":3517},{"type":95,"tag":382,"props":4016,"children":4018},{"class":4017,"line":2276},[384,519],[4019,4023,4027,4031,4035,4039,4043,4047,4051,4055,4059,4063],{"type":95,"tag":382,"props":4020,"children":4021},{"style":422},[4022],{"type":100,"value":3467},{"type":95,"tag":382,"props":4024,"children":4025},{"style":395},[4026],{"type":100,"value":430},{"type":95,"tag":382,"props":4028,"children":4029},{"style":389},[4030],{"type":100,"value":3476},{"type":95,"tag":382,"props":4032,"children":4033},{"style":395},[4034],{"type":100,"value":1434},{"type":95,"tag":382,"props":4036,"children":4037},{"style":389},[4038],{"type":100,"value":3008},{"type":95,"tag":382,"props":4040,"children":4041},{"style":395},[4042],{"type":100,"value":419},{"type":95,"tag":382,"props":4044,"children":4045},{"style":389},[4046],{"type":100,"value":3493},{"type":95,"tag":382,"props":4048,"children":4049},{"style":395},[4050],{"type":100,"value":419},{"type":95,"tag":382,"props":4052,"children":4053},{"style":389},[4054],{"type":100,"value":3502},{"type":95,"tag":382,"props":4056,"children":4057},{"style":395},[4058],{"type":100,"value":3507},{"type":95,"tag":382,"props":4060,"children":4061},{"style":3050},[4062],{"type":100,"value":3619},{"type":95,"tag":382,"props":4064,"children":4065},{"style":395},[4066],{"type":100,"value":3517},{"type":95,"tag":382,"props":4068,"children":4070},{"class":4069,"line":2284},[384,519],[4071,4075,4079,4083,4087,4091,4095,4099,4103,4107,4111,4115],{"type":95,"tag":382,"props":4072,"children":4073},{"style":422},[4074],{"type":100,"value":3467},{"type":95,"tag":382,"props":4076,"children":4077},{"style":395},[4078],{"type":100,"value":430},{"type":95,"tag":382,"props":4080,"children":4081},{"style":389},[4082],{"type":100,"value":3476},{"type":95,"tag":382,"props":4084,"children":4085},{"style":395},[4086],{"type":100,"value":1434},{"type":95,"tag":382,"props":4088,"children":4089},{"style":389},[4090],{"type":100,"value":3008},{"type":95,"tag":382,"props":4092,"children":4093},{"style":395},[4094],{"type":100,"value":419},{"type":95,"tag":382,"props":4096,"children":4097},{"style":389},[4098],{"type":100,"value":3493},{"type":95,"tag":382,"props":4100,"children":4101},{"style":395},[4102],{"type":100,"value":419},{"type":95,"tag":382,"props":4104,"children":4105},{"style":389},[4106],{"type":100,"value":3502},{"type":95,"tag":382,"props":4108,"children":4109},{"style":395},[4110],{"type":100,"value":3507},{"type":95,"tag":382,"props":4112,"children":4113},{"style":3050},[4114],{"type":100,"value":3672},{"type":95,"tag":382,"props":4116,"children":4117},{"style":395},[4118],{"type":100,"value":3517},{"type":95,"tag":382,"props":4120,"children":4122},{"class":4121,"line":40},[384,519],[4123,4127,4131,4135,4139,4143,4147,4151,4155,4159,4163,4167],{"type":95,"tag":382,"props":4124,"children":4125},{"style":422},[4126],{"type":100,"value":3467},{"type":95,"tag":382,"props":4128,"children":4129},{"style":395},[4130],{"type":100,"value":430},{"type":95,"tag":382,"props":4132,"children":4133},{"style":389},[4134],{"type":100,"value":3476},{"type":95,"tag":382,"props":4136,"children":4137},{"style":395},[4138],{"type":100,"value":1434},{"type":95,"tag":382,"props":4140,"children":4141},{"style":389},[4142],{"type":100,"value":3008},{"type":95,"tag":382,"props":4144,"children":4145},{"style":395},[4146],{"type":100,"value":419},{"type":95,"tag":382,"props":4148,"children":4149},{"style":389},[4150],{"type":100,"value":3493},{"type":95,"tag":382,"props":4152,"children":4153},{"style":395},[4154],{"type":100,"value":419},{"type":95,"tag":382,"props":4156,"children":4157},{"style":389},[4158],{"type":100,"value":3502},{"type":95,"tag":382,"props":4160,"children":4161},{"style":395},[4162],{"type":100,"value":3507},{"type":95,"tag":382,"props":4164,"children":4165},{"style":3050},[4166],{"type":100,"value":3725},{"type":95,"tag":382,"props":4168,"children":4169},{"style":395},[4170],{"type":100,"value":3517},{"type":95,"tag":382,"props":4172,"children":4174},{"class":4173,"line":2321},[384,519],[4175,4179,4183,4187,4191,4195,4199,4203,4207,4211,4215,4219],{"type":95,"tag":382,"props":4176,"children":4177},{"style":422},[4178],{"type":100,"value":3467},{"type":95,"tag":382,"props":4180,"children":4181},{"style":395},[4182],{"type":100,"value":430},{"type":95,"tag":382,"props":4184,"children":4185},{"style":389},[4186],{"type":100,"value":3476},{"type":95,"tag":382,"props":4188,"children":4189},{"style":395},[4190],{"type":100,"value":1434},{"type":95,"tag":382,"props":4192,"children":4193},{"style":389},[4194],{"type":100,"value":3008},{"type":95,"tag":382,"props":4196,"children":4197},{"style":395},[4198],{"type":100,"value":419},{"type":95,"tag":382,"props":4200,"children":4201},{"style":389},[4202],{"type":100,"value":3493},{"type":95,"tag":382,"props":4204,"children":4205},{"style":395},[4206],{"type":100,"value":419},{"type":95,"tag":382,"props":4208,"children":4209},{"style":389},[4210],{"type":100,"value":3502},{"type":95,"tag":382,"props":4212,"children":4213},{"style":395},[4214],{"type":100,"value":3507},{"type":95,"tag":382,"props":4216,"children":4217},{"style":3050},[4218],{"type":100,"value":3778},{"type":95,"tag":382,"props":4220,"children":4221},{"style":395},[4222],{"type":100,"value":3517},{"type":95,"tag":382,"props":4224,"children":4226},{"class":4225,"line":1267},[384,519],[4227,4231,4235,4239,4243,4247,4251,4255,4259,4263,4267,4271],{"type":95,"tag":382,"props":4228,"children":4229},{"style":422},[4230],{"type":100,"value":3467},{"type":95,"tag":382,"props":4232,"children":4233},{"style":395},[4234],{"type":100,"value":430},{"type":95,"tag":382,"props":4236,"children":4237},{"style":389},[4238],{"type":100,"value":3476},{"type":95,"tag":382,"props":4240,"children":4241},{"style":395},[4242],{"type":100,"value":1434},{"type":95,"tag":382,"props":4244,"children":4245},{"style":389},[4246],{"type":100,"value":3008},{"type":95,"tag":382,"props":4248,"children":4249},{"style":395},[4250],{"type":100,"value":419},{"type":95,"tag":382,"props":4252,"children":4253},{"style":389},[4254],{"type":100,"value":3493},{"type":95,"tag":382,"props":4256,"children":4257},{"style":395},[4258],{"type":100,"value":419},{"type":95,"tag":382,"props":4260,"children":4261},{"style":389},[4262],{"type":100,"value":3502},{"type":95,"tag":382,"props":4264,"children":4265},{"style":395},[4266],{"type":100,"value":3507},{"type":95,"tag":382,"props":4268,"children":4269},{"style":3050},[4270],{"type":100,"value":3831},{"type":95,"tag":382,"props":4272,"children":4273},{"style":395},[4274],{"type":100,"value":3517},{"type":95,"tag":382,"props":4276,"children":4278},{"class":4277,"line":1268},[384,519],[4279,4283,4287,4291,4295,4299,4303,4307,4311,4315,4319,4323],{"type":95,"tag":382,"props":4280,"children":4281},{"style":422},[4282],{"type":100,"value":3467},{"type":95,"tag":382,"props":4284,"children":4285},{"style":395},[4286],{"type":100,"value":430},{"type":95,"tag":382,"props":4288,"children":4289},{"style":389},[4290],{"type":100,"value":3476},{"type":95,"tag":382,"props":4292,"children":4293},{"style":395},[4294],{"type":100,"value":1434},{"type":95,"tag":382,"props":4296,"children":4297},{"style":389},[4298],{"type":100,"value":3008},{"type":95,"tag":382,"props":4300,"children":4301},{"style":395},[4302],{"type":100,"value":419},{"type":95,"tag":382,"props":4304,"children":4305},{"style":389},[4306],{"type":100,"value":3493},{"type":95,"tag":382,"props":4308,"children":4309},{"style":395},[4310],{"type":100,"value":419},{"type":95,"tag":382,"props":4312,"children":4313},{"style":389},[4314],{"type":100,"value":3502},{"type":95,"tag":382,"props":4316,"children":4317},{"style":395},[4318],{"type":100,"value":3507},{"type":95,"tag":382,"props":4320,"children":4321},{"style":3050},[4322],{"type":100,"value":3884},{"type":95,"tag":382,"props":4324,"children":4325},{"style":395},[4326],{"type":100,"value":3889},{"type":95,"tag":382,"props":4328,"children":4329},{"class":384,"line":2395},[4330],{"type":95,"tag":382,"props":4331,"children":4332},{"style":395},[4333],{"type":100,"value":1767},{"type":95,"tag":382,"props":4335,"children":4336},{"class":384,"line":2403},[4337],{"type":95,"tag":382,"props":4338,"children":4339},{"style":395},[4340],{"type":100,"value":2160},{"type":95,"tag":255,"props":4342,"children":4343},{"kind":257},[4344,4357],{"type":95,"tag":96,"props":4345,"children":4346},{},[4347,4349,4355],{"type":100,"value":4348},"💡 If you look closely at the code, you’ll notice that we’re using eBPF helpers like ",{"type":95,"tag":219,"props":4350,"children":4352},{"className":4351},[],[4353],{"type":100,"value":4354},"bpf_ntohs()",{"type":100,"value":4356}," to convert values from network byte order to host byte order and make them easier to interpret in the program.",{"type":95,"tag":96,"props":4358,"children":4359},{},[4360,4362,4369],{"type":100,"value":4361},"For more information about these eBPF helpers and their usage, refer to the ",{"type":95,"tag":113,"props":4363,"children":4366},{"href":4364,"rel":4365},"https://docs.ebpf.io/ebpf-library/libbpf/ebpf/bpf_ntohs/",[117],[4367],{"type":100,"value":4368},"official eBPF documentation",{"type":100,"value":419},{"type":95,"tag":96,"props":4371,"children":4372},{},[4373,4375,4380],{"type":100,"value":4374},"At a minimum, this gives us access to the ",{"type":95,"tag":167,"props":4376,"children":4377},{},[4378],{"type":100,"value":4379},"source and destination IPv4/IPv6 addresses",{"type":100,"value":4381},", which can be used to identify clients (by IP), useful for rate limiting or firewall applications.",{"type":95,"tag":255,"props":4383,"children":4384},{"kind":257},[4385,4390],{"type":95,"tag":96,"props":4386,"children":4387},{},[4388],{"type":100,"value":4389},"💡 The IP header also exposes other useful fields — such as TTL, protocol type (TCP/UDP), fragment offset, and total length — that can be leveraged for deeper packet analysis.",{"type":95,"tag":96,"props":4391,"children":4392},{},[4393,4395,4400,4401,4407,4409,4415],{"type":100,"value":4394},"Check out ",{"type":95,"tag":219,"props":4396,"children":4398},{"className":4397},[],[4399],{"type":100,"value":2496},{"type":100,"value":122},{"type":95,"tag":219,"props":4402,"children":4404},{"className":4403},[],[4405],{"type":100,"value":4406},"struct ipv6hdr",{"type":100,"value":4408}," in the ",{"type":95,"tag":219,"props":4410,"children":4412},{"className":4411},[],[4413],{"type":100,"value":4414},"lab/vmlinux.h",{"type":100,"value":4416}," file to see all the packet header fields available to us.",{"type":95,"tag":96,"props":4418,"children":4419},{},[4420],{"type":100,"value":4421},"There's that, but our XDP program also showcases how to parse TCP, UDP and ICMP protocols:",{"type":95,"tag":369,"props":4423,"children":4444},{"className":1048,"code":4424,"filename":1254,"highlights":4425,"language":1050,"meta":376,"style":376},"SEC(\"xdp\") \nint xdp_program(struct xdp_md *ctx) {\n    void *data_end = (void *)(unsigned long long)ctx->data_end;\n    void *data = (void *)(unsigned long long)ctx->data;\n    struct hdr_cursor nh;\n    nh.pos = data;\n\n    int ip_type;\n    // Parse Ethernet header\n    struct ethhdr *eth;\n    int eth_type = parse_ethhdr(&nh, data_end, &eth);\n    if (eth_type == bpf_htons(ETH_P_IP)) { \n        bpf_printk(\"We have captured an IPv4 packet\");\n        struct iphdr *ip;\n        // Parse IPv4 header\n        ip_type = parse_iphdr(&nh, data_end, &ip);\n        ...\n        if (ip_type == IPPROTO_ICMP) {\n            bpf_printk(\"We have captured an ICMP packet\");\n            // Parse ICMP header\n            struct icmphdr *icmp;\n            int icmp_type = parse_icmphdr(&nh, data_end, &icmp);\n            ...\n            bpf_printk(\"Type: %d\", icmp->type);\n            bpf_printk(\"Code: %d\", icmp->code);\n            if (icmp->type == ICMP_ECHO || icmp->type == ICMP_ECHOREPLY) {\n                bpf_printk(\"Echo id=%d seq=%d\\n\",\n                bpf_ntohs(icmp->un.echo.id),\n                bpf_ntohs(icmp->un.echo.sequence));\n            }\n        }\n    } else if (eth_type == bpf_htons(ETH_P_IPV6)) {\n        bpf_printk(\"We have captured an IPv6 packet\");\n        struct ipv6hdr *ipv6;\n        // Parse IPv6 header\n        ip_type = parse_ip6hdr(&nh, data_end, &ipv6);\n        ...\n        if (ip_type == IPPROTO_ICMPV6) {\n            bpf_printk(\"We have captured an ICMP packet\");\n            struct icmp6hdr *icmp6;\n            // Parse ICMP header\n            int icmp6_type = parse_icmp6hdr(&nh, data_end, &icmp6);\n            ...\n            bpf_printk(\"Type: %d\", icmp6->icmp6_type);\n            bpf_printk(\"Code: %d\", icmp6->icmp6_code);\n            if (icmp6->icmp6_type == ICMPV6_ECHO_REQUEST || icmp6->icmp6_type == ICMPV6_ECHO_REPLY) {\n                bpf_printk(\"Echo id=%d seq=%d\\n\",\n                bpf_ntohs(icmp6->icmp6_dataun.u_echo.identifier),\n                bpf_ntohs(icmp6->icmp6_dataun.u_echo.sequence));\n            }\n        }\n    }\n\n    if (ip_type == IPPROTO_TCP) {\n        bpf_printk(\"We have captured a TCP packet\");\n        struct tcphdr *tcp;\n        // Parse TCP header\n        int tcp_type = parse_tcphdr(&nh, data_end, &tcp);\n        ...\n        bpf_printk(\"Source port: %d\", bpf_ntohs(tcp->source));\n        bpf_printk(\"Destination port: %d\", bpf_ntohs(tcp->dest));\n        bpf_printk(\"Sequence number: %d\", bpf_ntohs(tcp->seq));\n        bpf_printk(\"Acknowledgment number: %d\", bpf_ntohs(tcp->ack_seq));\n        bpf_printk(\"Flags: SYN=%d ACK=%d FIN=%d RST=%d PSH=%d URG=%d ECE=%d CWR=%d\",\n                tcp->syn, tcp->ack, tcp->fin, tcp->rst, tcp->psh, tcp->urg, tcp->ece, tcp->cwr);\n    } else if (ip_type == IPPROTO_UDP) {\n        bpf_printk(\"We have captured a UDP packet\");\n        // Parse UDP header\n        struct udphdr *udp;\n        int udp_type = parse_udphdr(&nh, data_end, &udp);\n        ...\n        bpf_printk(\"Source port: %d\", bpf_ntohs(udp->source));\n        bpf_printk(\"Destination port: %d\", bpf_ntohs(udp->dest));\n        bpf_printk(\"Length of the UDP datagram: %d\", bpf_ntohs(udp->len));\n        bpf_printk(\"Checksum for error detection: %d\", bpf_ntohs(udp->check));\n    }\n    ...\n",[1652,1681,1257,1778,1801,1810,1259,1260,1886,1895,1904,1940,1261,2026,2034,2064,1263,1264,2138,2146,2154,2163,2171,2192,2201,1265,1266,2276,2284,1267,1268,2395,2403,2411,4426,4427,4428,4429,4430,4431,4432,4433,4434,4435,4436,4437,4438,4439,4440,4441,4442,4443],59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,[4445],{"type":95,"tag":219,"props":4446,"children":4447},{"__ignoreMap":376},[4448,4467,4502,4569,4636,4647,4670,4677,4688,4695,4714,4753,4776,4795,4814,4822,4858,4865,4885,4906,4913,4932,4972,4980,5019,5056,5118,5151,5200,5246,5255,5262,5294,5313,5332,5340,5376,5383,5403,5423,5443,5451,5491,5499,5537,5574,5633,5661,5708,5752,5760,5768,5775,5782,5802,5823,5843,5851,5891,5899,5947,5993,6039,6085,6106,6247,6275,6296,6304,6324,6364,6372,6417,6461,6507,6553,6561],{"type":95,"tag":382,"props":4449,"children":4450},{"class":384,"line":385},[4451,4455,4459,4463],{"type":95,"tag":382,"props":4452,"children":4453},{"style":422},[4454],{"type":100,"value":1309},{"type":95,"tag":382,"props":4456,"children":4457},{"style":395},[4458],{"type":100,"value":430},{"type":95,"tag":382,"props":4460,"children":4461},{"style":709},[4462],{"type":100,"value":1318},{"type":95,"tag":382,"props":4464,"children":4465},{"style":395},[4466],{"type":100,"value":1323},{"type":95,"tag":382,"props":4468,"children":4469},{"class":384,"line":453},[4470,4474,4478,4482,4486,4490,4494,4498],{"type":95,"tag":382,"props":4471,"children":4472},{"style":677},[4473],{"type":100,"value":1331},{"type":95,"tag":382,"props":4475,"children":4476},{"style":422},[4477],{"type":100,"value":1336},{"type":95,"tag":382,"props":4479,"children":4480},{"style":395},[4481],{"type":100,"value":430},{"type":95,"tag":382,"props":4483,"children":4484},{"style":677},[4485],{"type":100,"value":1062},{"type":95,"tag":382,"props":4487,"children":4488},{"style":395},[4489],{"type":100,"value":1349},{"type":95,"tag":382,"props":4491,"children":4492},{"style":406},[4493],{"type":100,"value":1354},{"type":95,"tag":382,"props":4495,"children":4496},{"style":389},[4497],{"type":100,"value":1359},{"type":95,"tag":382,"props":4499,"children":4500},{"style":395},[4501],{"type":100,"value":1364},{"type":95,"tag":382,"props":4503,"children":4504},{"class":384,"line":486},[4505,4509,4513,4517,4521,4525,4529,4533,4537,4541,4545,4549,4553,4557,4561,4565],{"type":95,"tag":382,"props":4506,"children":4507},{"style":677},[4508],{"type":100,"value":1372},{"type":95,"tag":382,"props":4510,"children":4511},{"style":406},[4512],{"type":100,"value":1377},{"type":95,"tag":382,"props":4514,"children":4515},{"style":395},[4516],{"type":100,"value":1382},{"type":95,"tag":382,"props":4518,"children":4519},{"style":406},[4520],{"type":100,"value":1387},{"type":95,"tag":382,"props":4522,"children":4523},{"style":395},[4524],{"type":100,"value":1392},{"type":95,"tag":382,"props":4526,"children":4527},{"style":677},[4528],{"type":100,"value":1397},{"type":95,"tag":382,"props":4530,"children":4531},{"style":406},[4532],{"type":100,"value":1377},{"type":95,"tag":382,"props":4534,"children":4535},{"style":395},[4536],{"type":100,"value":1406},{"type":95,"tag":382,"props":4538,"children":4539},{"style":677},[4540],{"type":100,"value":1411},{"type":95,"tag":382,"props":4542,"children":4543},{"style":677},[4544],{"type":100,"value":1416},{"type":95,"tag":382,"props":4546,"children":4547},{"style":677},[4548],{"type":100,"value":1416},{"type":95,"tag":382,"props":4550,"children":4551},{"style":395},[4552],{"type":100,"value":1425},{"type":95,"tag":382,"props":4554,"children":4555},{"style":389},[4556],{"type":100,"value":1359},{"type":95,"tag":382,"props":4558,"children":4559},{"style":395},[4560],{"type":100,"value":1434},{"type":95,"tag":382,"props":4562,"children":4563},{"style":389},[4564],{"type":100,"value":1149},{"type":95,"tag":382,"props":4566,"children":4567},{"style":395},[4568],{"type":100,"value":1443},{"type":95,"tag":382,"props":4570,"children":4571},{"class":384,"line":75},[4572,4576,4580,4584,4588,4592,4596,4600,4604,4608,4612,4616,4620,4624,4628,4632],{"type":95,"tag":382,"props":4573,"children":4574},{"style":677},[4575],{"type":100,"value":1372},{"type":95,"tag":382,"props":4577,"children":4578},{"style":406},[4579],{"type":100,"value":1377},{"type":95,"tag":382,"props":4581,"children":4582},{"style":395},[4583],{"type":100,"value":1459},{"type":95,"tag":382,"props":4585,"children":4586},{"style":406},[4587],{"type":100,"value":1387},{"type":95,"tag":382,"props":4589,"children":4590},{"style":395},[4591],{"type":100,"value":1392},{"type":95,"tag":382,"props":4593,"children":4594},{"style":677},[4595],{"type":100,"value":1397},{"type":95,"tag":382,"props":4597,"children":4598},{"style":406},[4599],{"type":100,"value":1377},{"type":95,"tag":382,"props":4601,"children":4602},{"style":395},[4603],{"type":100,"value":1406},{"type":95,"tag":382,"props":4605,"children":4606},{"style":677},[4607],{"type":100,"value":1411},{"type":95,"tag":382,"props":4609,"children":4610},{"style":677},[4611],{"type":100,"value":1416},{"type":95,"tag":382,"props":4613,"children":4614},{"style":677},[4615],{"type":100,"value":1416},{"type":95,"tag":382,"props":4617,"children":4618},{"style":395},[4619],{"type":100,"value":1425},{"type":95,"tag":382,"props":4621,"children":4622},{"style":389},[4623],{"type":100,"value":1359},{"type":95,"tag":382,"props":4625,"children":4626},{"style":395},[4627],{"type":100,"value":1434},{"type":95,"tag":382,"props":4629,"children":4630},{"style":389},[4631],{"type":100,"value":1139},{"type":95,"tag":382,"props":4633,"children":4634},{"style":395},[4635],{"type":100,"value":1443},{"type":95,"tag":382,"props":4637,"children":4638},{"class":384,"line":549},[4639,4643],{"type":95,"tag":382,"props":4640,"children":4641},{"style":677},[4642],{"type":100,"value":1519},{"type":95,"tag":382,"props":4644,"children":4645},{"style":395},[4646],{"type":100,"value":1524},{"type":95,"tag":382,"props":4648,"children":4649},{"class":384,"line":751},[4650,4654,4658,4662,4666],{"type":95,"tag":382,"props":4651,"children":4652},{"style":389},[4653],{"type":100,"value":1532},{"type":95,"tag":382,"props":4655,"children":4656},{"style":395},[4657],{"type":100,"value":419},{"type":95,"tag":382,"props":4659,"children":4660},{"style":389},[4661],{"type":100,"value":1541},{"type":95,"tag":382,"props":4663,"children":4664},{"style":406},[4665],{"type":100,"value":1546},{"type":95,"tag":382,"props":4667,"children":4668},{"style":395},[4669],{"type":100,"value":1551},{"type":95,"tag":382,"props":4671,"children":4672},{"class":384,"line":803},[4673],{"type":95,"tag":382,"props":4674,"children":4675},{"emptyLinePlaceholder":11},[4676],{"type":100,"value":748},{"type":95,"tag":382,"props":4678,"children":4679},{"class":384,"line":603},[4680,4684],{"type":95,"tag":382,"props":4681,"children":4682},{"style":677},[4683],{"type":100,"value":1567},{"type":95,"tag":382,"props":4685,"children":4686},{"style":395},[4687],{"type":100,"value":1572},{"type":95,"tag":382,"props":4689,"children":4690},{"class":384,"line":859},[4691],{"type":95,"tag":382,"props":4692,"children":4693},{"style":1601},[4694],{"type":100,"value":1604},{"type":95,"tag":382,"props":4696,"children":4697},{"class":384,"line":887},[4698,4702,4706,4710],{"type":95,"tag":382,"props":4699,"children":4700},{"style":677},[4701],{"type":100,"value":1519},{"type":95,"tag":382,"props":4703,"children":4704},{"style":395},[4705],{"type":100,"value":1585},{"type":95,"tag":382,"props":4707,"children":4708},{"style":406},[4709],{"type":100,"value":1354},{"type":95,"tag":382,"props":4711,"children":4712},{"style":395},[4713],{"type":100,"value":1594},{"type":95,"tag":382,"props":4715,"children":4716},{"class":384,"line":1561},[4717,4721,4725,4729,4733,4737,4741,4745,4749],{"type":95,"tag":382,"props":4718,"children":4719},{"style":677},[4720],{"type":100,"value":1567},{"type":95,"tag":382,"props":4722,"children":4723},{"style":395},[4724],{"type":100,"value":1617},{"type":95,"tag":382,"props":4726,"children":4727},{"style":406},[4728],{"type":100,"value":1387},{"type":95,"tag":382,"props":4730,"children":4731},{"style":422},[4732],{"type":100,"value":1626},{"type":95,"tag":382,"props":4734,"children":4735},{"style":395},[4736],{"type":100,"value":430},{"type":95,"tag":382,"props":4738,"children":4739},{"style":406},[4740],{"type":100,"value":1635},{"type":95,"tag":382,"props":4742,"children":4743},{"style":395},[4744],{"type":100,"value":1640},{"type":95,"tag":382,"props":4746,"children":4747},{"style":406},[4748],{"type":100,"value":1635},{"type":95,"tag":382,"props":4750,"children":4751},{"style":395},[4752],{"type":100,"value":1649},{"type":95,"tag":382,"props":4754,"children":4755},{"class":384,"line":1575},[4756,4760,4764,4768,4772],{"type":95,"tag":382,"props":4757,"children":4758},{"style":661},[4759],{"type":100,"value":1658},{"type":95,"tag":382,"props":4761,"children":4762},{"style":395},[4763],{"type":100,"value":1663},{"type":95,"tag":382,"props":4765,"children":4766},{"style":406},[4767],{"type":100,"value":1668},{"type":95,"tag":382,"props":4769,"children":4770},{"style":422},[4771],{"type":100,"value":1673},{"type":95,"tag":382,"props":4773,"children":4774},{"style":395},[4775],{"type":100,"value":1678},{"type":95,"tag":382,"props":4777,"children":4778},{"class":384,"line":41},[4779,4783,4787,4791],{"type":95,"tag":382,"props":4780,"children":4781},{"style":422},[4782],{"type":100,"value":2849},{"type":95,"tag":382,"props":4784,"children":4785},{"style":395},[4786],{"type":100,"value":430},{"type":95,"tag":382,"props":4788,"children":4789},{"style":709},[4790],{"type":100,"value":2858},{"type":95,"tag":382,"props":4792,"children":4793},{"style":395},[4794],{"type":100,"value":2863},{"type":95,"tag":382,"props":4796,"children":4797},{"class":384,"line":1256},[4798,4802,4806,4810],{"type":95,"tag":382,"props":4799,"children":4800},{"style":677},[4801],{"type":100,"value":1696},{"type":95,"tag":382,"props":4803,"children":4804},{"style":395},[4805],{"type":100,"value":1701},{"type":95,"tag":382,"props":4807,"children":4808},{"style":406},[4809],{"type":100,"value":1354},{"type":95,"tag":382,"props":4811,"children":4812},{"style":395},[4813],{"type":100,"value":1710},{"type":95,"tag":382,"props":4815,"children":4817},{"class":4816,"line":1652},[384,519],[4818],{"type":95,"tag":382,"props":4819,"children":4820},{"style":1601},[4821],{"type":100,"value":1719},{"type":95,"tag":382,"props":4823,"children":4825},{"class":4824,"line":1681},[384,519],[4826,4830,4834,4838,4842,4846,4850,4854],{"type":95,"tag":382,"props":4827,"children":4828},{"style":395},[4829],{"type":100,"value":1728},{"type":95,"tag":382,"props":4831,"children":4832},{"style":406},[4833],{"type":100,"value":1387},{"type":95,"tag":382,"props":4835,"children":4836},{"style":422},[4837],{"type":100,"value":1737},{"type":95,"tag":382,"props":4839,"children":4840},{"style":395},[4841],{"type":100,"value":430},{"type":95,"tag":382,"props":4843,"children":4844},{"style":406},[4845],{"type":100,"value":1635},{"type":95,"tag":382,"props":4847,"children":4848},{"style":395},[4849],{"type":100,"value":1640},{"type":95,"tag":382,"props":4851,"children":4852},{"style":406},[4853],{"type":100,"value":1635},{"type":95,"tag":382,"props":4855,"children":4856},{"style":395},[4857],{"type":100,"value":1758},{"type":95,"tag":382,"props":4859,"children":4860},{"class":384,"line":1690},[4861],{"type":95,"tag":382,"props":4862,"children":4863},{"style":395},[4864],{"type":100,"value":1767},{"type":95,"tag":382,"props":4866,"children":4868},{"class":4867,"line":1257},[384,519],[4869,4873,4877,4881],{"type":95,"tag":382,"props":4870,"children":4871},{"style":661},[4872],{"type":100,"value":1784},{"type":95,"tag":382,"props":4874,"children":4875},{"style":395},[4876],{"type":100,"value":1789},{"type":95,"tag":382,"props":4878,"children":4879},{"style":406},[4880],{"type":100,"value":1668},{"type":95,"tag":382,"props":4882,"children":4883},{"style":395},[4884],{"type":100,"value":1798},{"type":95,"tag":382,"props":4886,"children":4887},{"class":384,"line":1258},[4888,4893,4897,4902],{"type":95,"tag":382,"props":4889,"children":4890},{"style":422},[4891],{"type":100,"value":4892},"            bpf_printk",{"type":95,"tag":382,"props":4894,"children":4895},{"style":395},[4896],{"type":100,"value":430},{"type":95,"tag":382,"props":4898,"children":4899},{"style":709},[4900],{"type":100,"value":4901},"\"We have captured an ICMP packet\"",{"type":95,"tag":382,"props":4903,"children":4904},{"style":395},[4905],{"type":100,"value":2863},{"type":95,"tag":382,"props":4907,"children":4908},{"class":384,"line":1761},[4909],{"type":95,"tag":382,"props":4910,"children":4911},{"style":1601},[4912],{"type":100,"value":1839},{"type":95,"tag":382,"props":4914,"children":4915},{"class":384,"line":1770},[4916,4920,4924,4928],{"type":95,"tag":382,"props":4917,"children":4918},{"style":677},[4919],{"type":100,"value":1816},{"type":95,"tag":382,"props":4921,"children":4922},{"style":395},[4923],{"type":100,"value":1821},{"type":95,"tag":382,"props":4925,"children":4926},{"style":406},[4927],{"type":100,"value":1354},{"type":95,"tag":382,"props":4929,"children":4930},{"style":395},[4931],{"type":100,"value":1830},{"type":95,"tag":382,"props":4933,"children":4935},{"class":4934,"line":1778},[384,519],[4936,4940,4944,4948,4952,4956,4960,4964,4968],{"type":95,"tag":382,"props":4937,"children":4938},{"style":677},[4939],{"type":100,"value":1848},{"type":95,"tag":382,"props":4941,"children":4942},{"style":395},[4943],{"type":100,"value":1853},{"type":95,"tag":382,"props":4945,"children":4946},{"style":406},[4947],{"type":100,"value":1387},{"type":95,"tag":382,"props":4949,"children":4950},{"style":422},[4951],{"type":100,"value":1862},{"type":95,"tag":382,"props":4953,"children":4954},{"style":395},[4955],{"type":100,"value":430},{"type":95,"tag":382,"props":4957,"children":4958},{"style":406},[4959],{"type":100,"value":1635},{"type":95,"tag":382,"props":4961,"children":4962},{"style":395},[4963],{"type":100,"value":1640},{"type":95,"tag":382,"props":4965,"children":4966},{"style":406},[4967],{"type":100,"value":1635},{"type":95,"tag":382,"props":4969,"children":4970},{"style":395},[4971],{"type":100,"value":1883},{"type":95,"tag":382,"props":4973,"children":4975},{"class":4974,"line":1801},[384,519],[4976],{"type":95,"tag":382,"props":4977,"children":4978},{"style":395},[4979],{"type":100,"value":1892},{"type":95,"tag":382,"props":4981,"children":4983},{"class":4982,"line":1810},[384,519],[4984,4988,4992,4997,5001,5006,5010,5015],{"type":95,"tag":382,"props":4985,"children":4986},{"style":422},[4987],{"type":100,"value":4892},{"type":95,"tag":382,"props":4989,"children":4990},{"style":395},[4991],{"type":100,"value":430},{"type":95,"tag":382,"props":4993,"children":4994},{"style":709},[4995],{"type":100,"value":4996},"\"Type: %d\"",{"type":95,"tag":382,"props":4998,"children":4999},{"style":395},[5000],{"type":100,"value":398},{"type":95,"tag":382,"props":5002,"children":5003},{"style":389},[5004],{"type":100,"value":5005},"icmp",{"type":95,"tag":382,"props":5007,"children":5008},{"style":395},[5009],{"type":100,"value":1434},{"type":95,"tag":382,"props":5011,"children":5012},{"style":389},[5013],{"type":100,"value":5014},"type",{"type":95,"tag":382,"props":5016,"children":5017},{"style":395},[5018],{"type":100,"value":2863},{"type":95,"tag":382,"props":5020,"children":5022},{"class":5021,"line":1259},[384,519],[5023,5027,5031,5036,5040,5044,5048,5052],{"type":95,"tag":382,"props":5024,"children":5025},{"style":422},[5026],{"type":100,"value":4892},{"type":95,"tag":382,"props":5028,"children":5029},{"style":395},[5030],{"type":100,"value":430},{"type":95,"tag":382,"props":5032,"children":5033},{"style":709},[5034],{"type":100,"value":5035},"\"Code: %d\"",{"type":95,"tag":382,"props":5037,"children":5038},{"style":395},[5039],{"type":100,"value":398},{"type":95,"tag":382,"props":5041,"children":5042},{"style":389},[5043],{"type":100,"value":5005},{"type":95,"tag":382,"props":5045,"children":5046},{"style":395},[5047],{"type":100,"value":1434},{"type":95,"tag":382,"props":5049,"children":5050},{"style":389},[5051],{"type":100,"value":219},{"type":95,"tag":382,"props":5053,"children":5054},{"style":395},[5055],{"type":100,"value":2863},{"type":95,"tag":382,"props":5057,"children":5059},{"class":5058,"line":1260},[384,519],[5060,5065,5069,5073,5077,5081,5086,5091,5096,5101,5105,5109,5113],{"type":95,"tag":382,"props":5061,"children":5062},{"style":661},[5063],{"type":100,"value":5064},"            if",{"type":95,"tag":382,"props":5066,"children":5067},{"style":395},[5068],{"type":100,"value":1392},{"type":95,"tag":382,"props":5070,"children":5071},{"style":389},[5072],{"type":100,"value":5005},{"type":95,"tag":382,"props":5074,"children":5075},{"style":395},[5076],{"type":100,"value":1434},{"type":95,"tag":382,"props":5078,"children":5079},{"style":389},[5080],{"type":100,"value":5014},{"type":95,"tag":382,"props":5082,"children":5083},{"style":406},[5084],{"type":100,"value":5085}," ==",{"type":95,"tag":382,"props":5087,"children":5088},{"style":395},[5089],{"type":100,"value":5090}," ICMP_ECHO ",{"type":95,"tag":382,"props":5092,"children":5093},{"style":406},[5094],{"type":100,"value":5095},"||",{"type":95,"tag":382,"props":5097,"children":5098},{"style":389},[5099],{"type":100,"value":5100}," icmp",{"type":95,"tag":382,"props":5102,"children":5103},{"style":395},[5104],{"type":100,"value":1434},{"type":95,"tag":382,"props":5106,"children":5107},{"style":389},[5108],{"type":100,"value":5014},{"type":95,"tag":382,"props":5110,"children":5111},{"style":406},[5112],{"type":100,"value":5085},{"type":95,"tag":382,"props":5114,"children":5115},{"style":395},[5116],{"type":100,"value":5117}," ICMP_ECHOREPLY) {\n",{"type":95,"tag":382,"props":5119,"children":5121},{"class":5120,"line":1886},[384,519],[5122,5127,5131,5136,5142,5147],{"type":95,"tag":382,"props":5123,"children":5124},{"style":422},[5125],{"type":100,"value":5126},"                bpf_printk",{"type":95,"tag":382,"props":5128,"children":5129},{"style":395},[5130],{"type":100,"value":430},{"type":95,"tag":382,"props":5132,"children":5133},{"style":709},[5134],{"type":100,"value":5135},"\"Echo id=%d seq=%d",{"type":95,"tag":382,"props":5137,"children":5139},{"style":5138},"--shiki-default:#D7BA7D",[5140],{"type":100,"value":5141},"\\n",{"type":95,"tag":382,"props":5143,"children":5144},{"style":709},[5145],{"type":100,"value":5146},"\"",{"type":95,"tag":382,"props":5148,"children":5149},{"style":395},[5150],{"type":100,"value":483},{"type":95,"tag":382,"props":5152,"children":5154},{"class":5153,"line":1895},[384,519],[5155,5160,5164,5168,5172,5177,5181,5186,5190,5195],{"type":95,"tag":382,"props":5156,"children":5157},{"style":422},[5158],{"type":100,"value":5159},"                bpf_ntohs",{"type":95,"tag":382,"props":5161,"children":5162},{"style":395},[5163],{"type":100,"value":430},{"type":95,"tag":382,"props":5165,"children":5166},{"style":389},[5167],{"type":100,"value":5005},{"type":95,"tag":382,"props":5169,"children":5170},{"style":395},[5171],{"type":100,"value":1434},{"type":95,"tag":382,"props":5173,"children":5174},{"style":389},[5175],{"type":100,"value":5176},"un",{"type":95,"tag":382,"props":5178,"children":5179},{"style":395},[5180],{"type":100,"value":419},{"type":95,"tag":382,"props":5182,"children":5183},{"style":389},[5184],{"type":100,"value":5185},"echo",{"type":95,"tag":382,"props":5187,"children":5188},{"style":395},[5189],{"type":100,"value":419},{"type":95,"tag":382,"props":5191,"children":5192},{"style":389},[5193],{"type":100,"value":5194},"id",{"type":95,"tag":382,"props":5196,"children":5197},{"style":395},[5198],{"type":100,"value":5199},"),\n",{"type":95,"tag":382,"props":5201,"children":5203},{"class":5202,"line":1904},[384,519],[5204,5208,5212,5216,5220,5224,5228,5232,5236,5241],{"type":95,"tag":382,"props":5205,"children":5206},{"style":422},[5207],{"type":100,"value":5159},{"type":95,"tag":382,"props":5209,"children":5210},{"style":395},[5211],{"type":100,"value":430},{"type":95,"tag":382,"props":5213,"children":5214},{"style":389},[5215],{"type":100,"value":5005},{"type":95,"tag":382,"props":5217,"children":5218},{"style":395},[5219],{"type":100,"value":1434},{"type":95,"tag":382,"props":5221,"children":5222},{"style":389},[5223],{"type":100,"value":5176},{"type":95,"tag":382,"props":5225,"children":5226},{"style":395},[5227],{"type":100,"value":419},{"type":95,"tag":382,"props":5229,"children":5230},{"style":389},[5231],{"type":100,"value":5185},{"type":95,"tag":382,"props":5233,"children":5234},{"style":395},[5235],{"type":100,"value":419},{"type":95,"tag":382,"props":5237,"children":5238},{"style":389},[5239],{"type":100,"value":5240},"sequence",{"type":95,"tag":382,"props":5242,"children":5243},{"style":395},[5244],{"type":100,"value":5245},"));\n",{"type":95,"tag":382,"props":5247,"children":5249},{"class":5248,"line":1940},[384,519],[5250],{"type":95,"tag":382,"props":5251,"children":5252},{"style":395},[5253],{"type":100,"value":5254},"            }\n",{"type":95,"tag":382,"props":5256,"children":5257},{"class":384,"line":1949},[5258],{"type":95,"tag":382,"props":5259,"children":5260},{"style":395},[5261],{"type":100,"value":1901},{"type":95,"tag":382,"props":5263,"children":5265},{"class":5264,"line":1261},[384,519],[5266,5270,5274,5278,5282,5286,5290],{"type":95,"tag":382,"props":5267,"children":5268},{"style":395},[5269],{"type":100,"value":1910},{"type":95,"tag":382,"props":5271,"children":5272},{"style":661},[5273],{"type":100,"value":1915},{"type":95,"tag":382,"props":5275,"children":5276},{"style":661},[5277],{"type":100,"value":1920},{"type":95,"tag":382,"props":5279,"children":5280},{"style":395},[5281],{"type":100,"value":1663},{"type":95,"tag":382,"props":5283,"children":5284},{"style":406},[5285],{"type":100,"value":1668},{"type":95,"tag":382,"props":5287,"children":5288},{"style":422},[5289],{"type":100,"value":1673},{"type":95,"tag":382,"props":5291,"children":5292},{"style":395},[5293],{"type":100,"value":1937},{"type":95,"tag":382,"props":5295,"children":5296},{"class":384,"line":1262},[5297,5301,5305,5309],{"type":95,"tag":382,"props":5298,"children":5299},{"style":422},[5300],{"type":100,"value":2849},{"type":95,"tag":382,"props":5302,"children":5303},{"style":395},[5304],{"type":100,"value":430},{"type":95,"tag":382,"props":5306,"children":5307},{"style":709},[5308],{"type":100,"value":3353},{"type":95,"tag":382,"props":5310,"children":5311},{"style":395},[5312],{"type":100,"value":2863},{"type":95,"tag":382,"props":5314,"children":5315},{"class":384,"line":2018},[5316,5320,5324,5328],{"type":95,"tag":382,"props":5317,"children":5318},{"style":677},[5319],{"type":100,"value":1696},{"type":95,"tag":382,"props":5321,"children":5322},{"style":395},[5323],{"type":100,"value":1959},{"type":95,"tag":382,"props":5325,"children":5326},{"style":406},[5327],{"type":100,"value":1354},{"type":95,"tag":382,"props":5329,"children":5330},{"style":395},[5331],{"type":100,"value":1968},{"type":95,"tag":382,"props":5333,"children":5335},{"class":5334,"line":2026},[384,519],[5336],{"type":95,"tag":382,"props":5337,"children":5338},{"style":1601},[5339],{"type":100,"value":1977},{"type":95,"tag":382,"props":5341,"children":5343},{"class":5342,"line":2034},[384,519],[5344,5348,5352,5356,5360,5364,5368,5372],{"type":95,"tag":382,"props":5345,"children":5346},{"style":395},[5347],{"type":100,"value":1728},{"type":95,"tag":382,"props":5349,"children":5350},{"style":406},[5351],{"type":100,"value":1387},{"type":95,"tag":382,"props":5353,"children":5354},{"style":422},[5355],{"type":100,"value":1994},{"type":95,"tag":382,"props":5357,"children":5358},{"style":395},[5359],{"type":100,"value":430},{"type":95,"tag":382,"props":5361,"children":5362},{"style":406},[5363],{"type":100,"value":1635},{"type":95,"tag":382,"props":5365,"children":5366},{"style":395},[5367],{"type":100,"value":1640},{"type":95,"tag":382,"props":5369,"children":5370},{"style":406},[5371],{"type":100,"value":1635},{"type":95,"tag":382,"props":5373,"children":5374},{"style":395},[5375],{"type":100,"value":2015},{"type":95,"tag":382,"props":5377,"children":5378},{"class":384,"line":2055},[5379],{"type":95,"tag":382,"props":5380,"children":5381},{"style":395},[5382],{"type":100,"value":1767},{"type":95,"tag":382,"props":5384,"children":5386},{"class":5385,"line":2064},[384,519],[5387,5391,5395,5399],{"type":95,"tag":382,"props":5388,"children":5389},{"style":661},[5390],{"type":100,"value":1784},{"type":95,"tag":382,"props":5392,"children":5393},{"style":395},[5394],{"type":100,"value":1789},{"type":95,"tag":382,"props":5396,"children":5397},{"style":406},[5398],{"type":100,"value":1668},{"type":95,"tag":382,"props":5400,"children":5401},{"style":395},[5402],{"type":100,"value":2052},{"type":95,"tag":382,"props":5404,"children":5406},{"class":5405,"line":1263},[384,519],[5407,5411,5415,5419],{"type":95,"tag":382,"props":5408,"children":5409},{"style":422},[5410],{"type":100,"value":4892},{"type":95,"tag":382,"props":5412,"children":5413},{"style":395},[5414],{"type":100,"value":430},{"type":95,"tag":382,"props":5416,"children":5417},{"style":709},[5418],{"type":100,"value":4901},{"type":95,"tag":382,"props":5420,"children":5421},{"style":395},[5422],{"type":100,"value":2863},{"type":95,"tag":382,"props":5424,"children":5426},{"class":5425,"line":1264},[384,519],[5427,5431,5435,5439],{"type":95,"tag":382,"props":5428,"children":5429},{"style":677},[5430],{"type":100,"value":1816},{"type":95,"tag":382,"props":5432,"children":5433},{"style":395},[5434],{"type":100,"value":2074},{"type":95,"tag":382,"props":5436,"children":5437},{"style":406},[5438],{"type":100,"value":1354},{"type":95,"tag":382,"props":5440,"children":5441},{"style":395},[5442],{"type":100,"value":2083},{"type":95,"tag":382,"props":5444,"children":5446},{"class":5445,"line":2138},[384,519],[5447],{"type":95,"tag":382,"props":5448,"children":5449},{"style":1601},[5450],{"type":100,"value":1839},{"type":95,"tag":382,"props":5452,"children":5454},{"class":5453,"line":2146},[384,519],[5455,5459,5463,5467,5471,5475,5479,5483,5487],{"type":95,"tag":382,"props":5456,"children":5457},{"style":677},[5458],{"type":100,"value":1848},{"type":95,"tag":382,"props":5460,"children":5461},{"style":395},[5462],{"type":100,"value":2105},{"type":95,"tag":382,"props":5464,"children":5465},{"style":406},[5466],{"type":100,"value":1387},{"type":95,"tag":382,"props":5468,"children":5469},{"style":422},[5470],{"type":100,"value":2114},{"type":95,"tag":382,"props":5472,"children":5473},{"style":395},[5474],{"type":100,"value":430},{"type":95,"tag":382,"props":5476,"children":5477},{"style":406},[5478],{"type":100,"value":1635},{"type":95,"tag":382,"props":5480,"children":5481},{"style":395},[5482],{"type":100,"value":1640},{"type":95,"tag":382,"props":5484,"children":5485},{"style":406},[5486],{"type":100,"value":1635},{"type":95,"tag":382,"props":5488,"children":5489},{"style":395},[5490],{"type":100,"value":2135},{"type":95,"tag":382,"props":5492,"children":5494},{"class":5493,"line":2154},[384,519],[5495],{"type":95,"tag":382,"props":5496,"children":5497},{"style":395},[5498],{"type":100,"value":1892},{"type":95,"tag":382,"props":5500,"children":5502},{"class":5501,"line":2163},[384,519],[5503,5507,5511,5515,5519,5524,5528,5533],{"type":95,"tag":382,"props":5504,"children":5505},{"style":422},[5506],{"type":100,"value":4892},{"type":95,"tag":382,"props":5508,"children":5509},{"style":395},[5510],{"type":100,"value":430},{"type":95,"tag":382,"props":5512,"children":5513},{"style":709},[5514],{"type":100,"value":4996},{"type":95,"tag":382,"props":5516,"children":5517},{"style":395},[5518],{"type":100,"value":398},{"type":95,"tag":382,"props":5520,"children":5521},{"style":389},[5522],{"type":100,"value":5523},"icmp6",{"type":95,"tag":382,"props":5525,"children":5526},{"style":395},[5527],{"type":100,"value":1434},{"type":95,"tag":382,"props":5529,"children":5530},{"style":389},[5531],{"type":100,"value":5532},"icmp6_type",{"type":95,"tag":382,"props":5534,"children":5535},{"style":395},[5536],{"type":100,"value":2863},{"type":95,"tag":382,"props":5538,"children":5540},{"class":5539,"line":2171},[384,519],[5541,5545,5549,5553,5557,5561,5565,5570],{"type":95,"tag":382,"props":5542,"children":5543},{"style":422},[5544],{"type":100,"value":4892},{"type":95,"tag":382,"props":5546,"children":5547},{"style":395},[5548],{"type":100,"value":430},{"type":95,"tag":382,"props":5550,"children":5551},{"style":709},[5552],{"type":100,"value":5035},{"type":95,"tag":382,"props":5554,"children":5555},{"style":395},[5556],{"type":100,"value":398},{"type":95,"tag":382,"props":5558,"children":5559},{"style":389},[5560],{"type":100,"value":5523},{"type":95,"tag":382,"props":5562,"children":5563},{"style":395},[5564],{"type":100,"value":1434},{"type":95,"tag":382,"props":5566,"children":5567},{"style":389},[5568],{"type":100,"value":5569},"icmp6_code",{"type":95,"tag":382,"props":5571,"children":5572},{"style":395},[5573],{"type":100,"value":2863},{"type":95,"tag":382,"props":5575,"children":5577},{"class":5576,"line":2192},[384,519],[5578,5582,5586,5590,5594,5598,5602,5607,5611,5616,5620,5624,5628],{"type":95,"tag":382,"props":5579,"children":5580},{"style":661},[5581],{"type":100,"value":5064},{"type":95,"tag":382,"props":5583,"children":5584},{"style":395},[5585],{"type":100,"value":1392},{"type":95,"tag":382,"props":5587,"children":5588},{"style":389},[5589],{"type":100,"value":5523},{"type":95,"tag":382,"props":5591,"children":5592},{"style":395},[5593],{"type":100,"value":1434},{"type":95,"tag":382,"props":5595,"children":5596},{"style":389},[5597],{"type":100,"value":5532},{"type":95,"tag":382,"props":5599,"children":5600},{"style":406},[5601],{"type":100,"value":5085},{"type":95,"tag":382,"props":5603,"children":5604},{"style":395},[5605],{"type":100,"value":5606}," ICMPV6_ECHO_REQUEST ",{"type":95,"tag":382,"props":5608,"children":5609},{"style":406},[5610],{"type":100,"value":5095},{"type":95,"tag":382,"props":5612,"children":5613},{"style":389},[5614],{"type":100,"value":5615}," icmp6",{"type":95,"tag":382,"props":5617,"children":5618},{"style":395},[5619],{"type":100,"value":1434},{"type":95,"tag":382,"props":5621,"children":5622},{"style":389},[5623],{"type":100,"value":5532},{"type":95,"tag":382,"props":5625,"children":5626},{"style":406},[5627],{"type":100,"value":5085},{"type":95,"tag":382,"props":5629,"children":5630},{"style":395},[5631],{"type":100,"value":5632}," ICMPV6_ECHO_REPLY) {\n",{"type":95,"tag":382,"props":5634,"children":5636},{"class":5635,"line":2201},[384,519],[5637,5641,5645,5649,5653,5657],{"type":95,"tag":382,"props":5638,"children":5639},{"style":422},[5640],{"type":100,"value":5126},{"type":95,"tag":382,"props":5642,"children":5643},{"style":395},[5644],{"type":100,"value":430},{"type":95,"tag":382,"props":5646,"children":5647},{"style":709},[5648],{"type":100,"value":5135},{"type":95,"tag":382,"props":5650,"children":5651},{"style":5138},[5652],{"type":100,"value":5141},{"type":95,"tag":382,"props":5654,"children":5655},{"style":709},[5656],{"type":100,"value":5146},{"type":95,"tag":382,"props":5658,"children":5659},{"style":395},[5660],{"type":100,"value":483},{"type":95,"tag":382,"props":5662,"children":5664},{"class":5663,"line":1265},[384,519],[5665,5669,5673,5677,5681,5686,5690,5695,5699,5704],{"type":95,"tag":382,"props":5666,"children":5667},{"style":422},[5668],{"type":100,"value":5159},{"type":95,"tag":382,"props":5670,"children":5671},{"style":395},[5672],{"type":100,"value":430},{"type":95,"tag":382,"props":5674,"children":5675},{"style":389},[5676],{"type":100,"value":5523},{"type":95,"tag":382,"props":5678,"children":5679},{"style":395},[5680],{"type":100,"value":1434},{"type":95,"tag":382,"props":5682,"children":5683},{"style":389},[5684],{"type":100,"value":5685},"icmp6_dataun",{"type":95,"tag":382,"props":5687,"children":5688},{"style":395},[5689],{"type":100,"value":419},{"type":95,"tag":382,"props":5691,"children":5692},{"style":389},[5693],{"type":100,"value":5694},"u_echo",{"type":95,"tag":382,"props":5696,"children":5697},{"style":395},[5698],{"type":100,"value":419},{"type":95,"tag":382,"props":5700,"children":5701},{"style":389},[5702],{"type":100,"value":5703},"identifier",{"type":95,"tag":382,"props":5705,"children":5706},{"style":395},[5707],{"type":100,"value":5199},{"type":95,"tag":382,"props":5709,"children":5711},{"class":5710,"line":1266},[384,519],[5712,5716,5720,5724,5728,5732,5736,5740,5744,5748],{"type":95,"tag":382,"props":5713,"children":5714},{"style":422},[5715],{"type":100,"value":5159},{"type":95,"tag":382,"props":5717,"children":5718},{"style":395},[5719],{"type":100,"value":430},{"type":95,"tag":382,"props":5721,"children":5722},{"style":389},[5723],{"type":100,"value":5523},{"type":95,"tag":382,"props":5725,"children":5726},{"style":395},[5727],{"type":100,"value":1434},{"type":95,"tag":382,"props":5729,"children":5730},{"style":389},[5731],{"type":100,"value":5685},{"type":95,"tag":382,"props":5733,"children":5734},{"style":395},[5735],{"type":100,"value":419},{"type":95,"tag":382,"props":5737,"children":5738},{"style":389},[5739],{"type":100,"value":5694},{"type":95,"tag":382,"props":5741,"children":5742},{"style":395},[5743],{"type":100,"value":419},{"type":95,"tag":382,"props":5745,"children":5746},{"style":389},[5747],{"type":100,"value":5240},{"type":95,"tag":382,"props":5749,"children":5750},{"style":395},[5751],{"type":100,"value":5245},{"type":95,"tag":382,"props":5753,"children":5755},{"class":5754,"line":2276},[384,519],[5756],{"type":95,"tag":382,"props":5757,"children":5758},{"style":395},[5759],{"type":100,"value":5254},{"type":95,"tag":382,"props":5761,"children":5763},{"class":5762,"line":2284},[384,519],[5764],{"type":95,"tag":382,"props":5765,"children":5766},{"style":395},[5767],{"type":100,"value":1901},{"type":95,"tag":382,"props":5769,"children":5770},{"class":384,"line":40},[5771],{"type":95,"tag":382,"props":5772,"children":5773},{"style":395},[5774],{"type":100,"value":2160},{"type":95,"tag":382,"props":5776,"children":5777},{"class":384,"line":2321},[5778],{"type":95,"tag":382,"props":5779,"children":5780},{"emptyLinePlaceholder":11},[5781],{"type":100,"value":748},{"type":95,"tag":382,"props":5783,"children":5785},{"class":5784,"line":1267},[384,519],[5786,5790,5794,5798],{"type":95,"tag":382,"props":5787,"children":5788},{"style":661},[5789],{"type":100,"value":1658},{"type":95,"tag":382,"props":5791,"children":5792},{"style":395},[5793],{"type":100,"value":1789},{"type":95,"tag":382,"props":5795,"children":5796},{"style":406},[5797],{"type":100,"value":1668},{"type":95,"tag":382,"props":5799,"children":5800},{"style":395},[5801],{"type":100,"value":2189},{"type":95,"tag":382,"props":5803,"children":5805},{"class":5804,"line":1268},[384,519],[5806,5810,5814,5819],{"type":95,"tag":382,"props":5807,"children":5808},{"style":422},[5809],{"type":100,"value":2849},{"type":95,"tag":382,"props":5811,"children":5812},{"style":395},[5813],{"type":100,"value":430},{"type":95,"tag":382,"props":5815,"children":5816},{"style":709},[5817],{"type":100,"value":5818},"\"We have captured a TCP packet\"",{"type":95,"tag":382,"props":5820,"children":5821},{"style":395},[5822],{"type":100,"value":2863},{"type":95,"tag":382,"props":5824,"children":5826},{"class":5825,"line":2395},[384,519],[5827,5831,5835,5839],{"type":95,"tag":382,"props":5828,"children":5829},{"style":677},[5830],{"type":100,"value":1696},{"type":95,"tag":382,"props":5832,"children":5833},{"style":395},[5834],{"type":100,"value":2211},{"type":95,"tag":382,"props":5836,"children":5837},{"style":406},[5838],{"type":100,"value":1354},{"type":95,"tag":382,"props":5840,"children":5841},{"style":395},[5842],{"type":100,"value":2220},{"type":95,"tag":382,"props":5844,"children":5846},{"class":5845,"line":2403},[384,519],[5847],{"type":95,"tag":382,"props":5848,"children":5849},{"style":1601},[5850],{"type":100,"value":2229},{"type":95,"tag":382,"props":5852,"children":5854},{"class":5853,"line":2411},[384,519],[5855,5859,5863,5867,5871,5875,5879,5883,5887],{"type":95,"tag":382,"props":5856,"children":5857},{"style":677},[5858],{"type":100,"value":2238},{"type":95,"tag":382,"props":5860,"children":5861},{"style":395},[5862],{"type":100,"value":2243},{"type":95,"tag":382,"props":5864,"children":5865},{"style":406},[5866],{"type":100,"value":1387},{"type":95,"tag":382,"props":5868,"children":5869},{"style":422},[5870],{"type":100,"value":2252},{"type":95,"tag":382,"props":5872,"children":5873},{"style":395},[5874],{"type":100,"value":430},{"type":95,"tag":382,"props":5876,"children":5877},{"style":406},[5878],{"type":100,"value":1635},{"type":95,"tag":382,"props":5880,"children":5881},{"style":395},[5882],{"type":100,"value":1640},{"type":95,"tag":382,"props":5884,"children":5885},{"style":406},[5886],{"type":100,"value":1635},{"type":95,"tag":382,"props":5888,"children":5889},{"style":395},[5890],{"type":100,"value":2273},{"type":95,"tag":382,"props":5892,"children":5894},{"class":5893,"line":4426},[384,519],[5895],{"type":95,"tag":382,"props":5896,"children":5897},{"style":395},[5898],{"type":100,"value":1767},{"type":95,"tag":382,"props":5900,"children":5902},{"class":5901,"line":4427},[384,519],[5903,5907,5911,5916,5920,5925,5929,5934,5938,5943],{"type":95,"tag":382,"props":5904,"children":5905},{"style":422},[5906],{"type":100,"value":2849},{"type":95,"tag":382,"props":5908,"children":5909},{"style":395},[5910],{"type":100,"value":430},{"type":95,"tag":382,"props":5912,"children":5913},{"style":709},[5914],{"type":100,"value":5915},"\"Source port: %d\"",{"type":95,"tag":382,"props":5917,"children":5918},{"style":395},[5919],{"type":100,"value":398},{"type":95,"tag":382,"props":5921,"children":5922},{"style":422},[5923],{"type":100,"value":5924},"bpf_ntohs",{"type":95,"tag":382,"props":5926,"children":5927},{"style":395},[5928],{"type":100,"value":430},{"type":95,"tag":382,"props":5930,"children":5931},{"style":389},[5932],{"type":100,"value":5933},"tcp",{"type":95,"tag":382,"props":5935,"children":5936},{"style":395},[5937],{"type":100,"value":1434},{"type":95,"tag":382,"props":5939,"children":5940},{"style":389},[5941],{"type":100,"value":5942},"source",{"type":95,"tag":382,"props":5944,"children":5945},{"style":395},[5946],{"type":100,"value":5245},{"type":95,"tag":382,"props":5948,"children":5950},{"class":5949,"line":4428},[384,519],[5951,5955,5959,5964,5968,5972,5976,5980,5984,5989],{"type":95,"tag":382,"props":5952,"children":5953},{"style":422},[5954],{"type":100,"value":2849},{"type":95,"tag":382,"props":5956,"children":5957},{"style":395},[5958],{"type":100,"value":430},{"type":95,"tag":382,"props":5960,"children":5961},{"style":709},[5962],{"type":100,"value":5963},"\"Destination port: %d\"",{"type":95,"tag":382,"props":5965,"children":5966},{"style":395},[5967],{"type":100,"value":398},{"type":95,"tag":382,"props":5969,"children":5970},{"style":422},[5971],{"type":100,"value":5924},{"type":95,"tag":382,"props":5973,"children":5974},{"style":395},[5975],{"type":100,"value":430},{"type":95,"tag":382,"props":5977,"children":5978},{"style":389},[5979],{"type":100,"value":5933},{"type":95,"tag":382,"props":5981,"children":5982},{"style":395},[5983],{"type":100,"value":1434},{"type":95,"tag":382,"props":5985,"children":5986},{"style":389},[5987],{"type":100,"value":5988},"dest",{"type":95,"tag":382,"props":5990,"children":5991},{"style":395},[5992],{"type":100,"value":5245},{"type":95,"tag":382,"props":5994,"children":5996},{"class":5995,"line":4429},[384,519],[5997,6001,6005,6010,6014,6018,6022,6026,6030,6035],{"type":95,"tag":382,"props":5998,"children":5999},{"style":422},[6000],{"type":100,"value":2849},{"type":95,"tag":382,"props":6002,"children":6003},{"style":395},[6004],{"type":100,"value":430},{"type":95,"tag":382,"props":6006,"children":6007},{"style":709},[6008],{"type":100,"value":6009},"\"Sequence number: %d\"",{"type":95,"tag":382,"props":6011,"children":6012},{"style":395},[6013],{"type":100,"value":398},{"type":95,"tag":382,"props":6015,"children":6016},{"style":422},[6017],{"type":100,"value":5924},{"type":95,"tag":382,"props":6019,"children":6020},{"style":395},[6021],{"type":100,"value":430},{"type":95,"tag":382,"props":6023,"children":6024},{"style":389},[6025],{"type":100,"value":5933},{"type":95,"tag":382,"props":6027,"children":6028},{"style":395},[6029],{"type":100,"value":1434},{"type":95,"tag":382,"props":6031,"children":6032},{"style":389},[6033],{"type":100,"value":6034},"seq",{"type":95,"tag":382,"props":6036,"children":6037},{"style":395},[6038],{"type":100,"value":5245},{"type":95,"tag":382,"props":6040,"children":6042},{"class":6041,"line":4430},[384,519],[6043,6047,6051,6056,6060,6064,6068,6072,6076,6081],{"type":95,"tag":382,"props":6044,"children":6045},{"style":422},[6046],{"type":100,"value":2849},{"type":95,"tag":382,"props":6048,"children":6049},{"style":395},[6050],{"type":100,"value":430},{"type":95,"tag":382,"props":6052,"children":6053},{"style":709},[6054],{"type":100,"value":6055},"\"Acknowledgment number: %d\"",{"type":95,"tag":382,"props":6057,"children":6058},{"style":395},[6059],{"type":100,"value":398},{"type":95,"tag":382,"props":6061,"children":6062},{"style":422},[6063],{"type":100,"value":5924},{"type":95,"tag":382,"props":6065,"children":6066},{"style":395},[6067],{"type":100,"value":430},{"type":95,"tag":382,"props":6069,"children":6070},{"style":389},[6071],{"type":100,"value":5933},{"type":95,"tag":382,"props":6073,"children":6074},{"style":395},[6075],{"type":100,"value":1434},{"type":95,"tag":382,"props":6077,"children":6078},{"style":389},[6079],{"type":100,"value":6080},"ack_seq",{"type":95,"tag":382,"props":6082,"children":6083},{"style":395},[6084],{"type":100,"value":5245},{"type":95,"tag":382,"props":6086,"children":6088},{"class":6087,"line":4431},[384,519],[6089,6093,6097,6102],{"type":95,"tag":382,"props":6090,"children":6091},{"style":422},[6092],{"type":100,"value":2849},{"type":95,"tag":382,"props":6094,"children":6095},{"style":395},[6096],{"type":100,"value":430},{"type":95,"tag":382,"props":6098,"children":6099},{"style":709},[6100],{"type":100,"value":6101},"\"Flags: SYN=%d ACK=%d FIN=%d RST=%d PSH=%d URG=%d ECE=%d CWR=%d\"",{"type":95,"tag":382,"props":6103,"children":6104},{"style":395},[6105],{"type":100,"value":483},{"type":95,"tag":382,"props":6107,"children":6109},{"class":6108,"line":4432},[384,519],[6110,6115,6119,6124,6128,6132,6136,6141,6145,6149,6153,6158,6162,6166,6170,6175,6179,6183,6187,6192,6196,6200,6204,6209,6213,6217,6221,6226,6230,6234,6238,6243],{"type":95,"tag":382,"props":6111,"children":6112},{"style":389},[6113],{"type":100,"value":6114},"                tcp",{"type":95,"tag":382,"props":6116,"children":6117},{"style":395},[6118],{"type":100,"value":1434},{"type":95,"tag":382,"props":6120,"children":6121},{"style":389},[6122],{"type":100,"value":6123},"syn",{"type":95,"tag":382,"props":6125,"children":6126},{"style":395},[6127],{"type":100,"value":398},{"type":95,"tag":382,"props":6129,"children":6130},{"style":389},[6131],{"type":100,"value":5933},{"type":95,"tag":382,"props":6133,"children":6134},{"style":395},[6135],{"type":100,"value":1434},{"type":95,"tag":382,"props":6137,"children":6138},{"style":389},[6139],{"type":100,"value":6140},"ack",{"type":95,"tag":382,"props":6142,"children":6143},{"style":395},[6144],{"type":100,"value":398},{"type":95,"tag":382,"props":6146,"children":6147},{"style":389},[6148],{"type":100,"value":5933},{"type":95,"tag":382,"props":6150,"children":6151},{"style":395},[6152],{"type":100,"value":1434},{"type":95,"tag":382,"props":6154,"children":6155},{"style":389},[6156],{"type":100,"value":6157},"fin",{"type":95,"tag":382,"props":6159,"children":6160},{"style":395},[6161],{"type":100,"value":398},{"type":95,"tag":382,"props":6163,"children":6164},{"style":389},[6165],{"type":100,"value":5933},{"type":95,"tag":382,"props":6167,"children":6168},{"style":395},[6169],{"type":100,"value":1434},{"type":95,"tag":382,"props":6171,"children":6172},{"style":389},[6173],{"type":100,"value":6174},"rst",{"type":95,"tag":382,"props":6176,"children":6177},{"style":395},[6178],{"type":100,"value":398},{"type":95,"tag":382,"props":6180,"children":6181},{"style":389},[6182],{"type":100,"value":5933},{"type":95,"tag":382,"props":6184,"children":6185},{"style":395},[6186],{"type":100,"value":1434},{"type":95,"tag":382,"props":6188,"children":6189},{"style":389},[6190],{"type":100,"value":6191},"psh",{"type":95,"tag":382,"props":6193,"children":6194},{"style":395},[6195],{"type":100,"value":398},{"type":95,"tag":382,"props":6197,"children":6198},{"style":389},[6199],{"type":100,"value":5933},{"type":95,"tag":382,"props":6201,"children":6202},{"style":395},[6203],{"type":100,"value":1434},{"type":95,"tag":382,"props":6205,"children":6206},{"style":389},[6207],{"type":100,"value":6208},"urg",{"type":95,"tag":382,"props":6210,"children":6211},{"style":395},[6212],{"type":100,"value":398},{"type":95,"tag":382,"props":6214,"children":6215},{"style":389},[6216],{"type":100,"value":5933},{"type":95,"tag":382,"props":6218,"children":6219},{"style":395},[6220],{"type":100,"value":1434},{"type":95,"tag":382,"props":6222,"children":6223},{"style":389},[6224],{"type":100,"value":6225},"ece",{"type":95,"tag":382,"props":6227,"children":6228},{"style":395},[6229],{"type":100,"value":398},{"type":95,"tag":382,"props":6231,"children":6232},{"style":389},[6233],{"type":100,"value":5933},{"type":95,"tag":382,"props":6235,"children":6236},{"style":395},[6237],{"type":100,"value":1434},{"type":95,"tag":382,"props":6239,"children":6240},{"style":389},[6241],{"type":100,"value":6242},"cwr",{"type":95,"tag":382,"props":6244,"children":6245},{"style":395},[6246],{"type":100,"value":2863},{"type":95,"tag":382,"props":6248,"children":6250},{"class":6249,"line":4433},[384,519],[6251,6255,6259,6263,6267,6271],{"type":95,"tag":382,"props":6252,"children":6253},{"style":395},[6254],{"type":100,"value":1910},{"type":95,"tag":382,"props":6256,"children":6257},{"style":661},[6258],{"type":100,"value":1915},{"type":95,"tag":382,"props":6260,"children":6261},{"style":661},[6262],{"type":100,"value":1920},{"type":95,"tag":382,"props":6264,"children":6265},{"style":395},[6266],{"type":100,"value":1789},{"type":95,"tag":382,"props":6268,"children":6269},{"style":406},[6270],{"type":100,"value":1668},{"type":95,"tag":382,"props":6272,"children":6273},{"style":395},[6274],{"type":100,"value":2310},{"type":95,"tag":382,"props":6276,"children":6278},{"class":6277,"line":4434},[384,519],[6279,6283,6287,6292],{"type":95,"tag":382,"props":6280,"children":6281},{"style":422},[6282],{"type":100,"value":2849},{"type":95,"tag":382,"props":6284,"children":6285},{"style":395},[6286],{"type":100,"value":430},{"type":95,"tag":382,"props":6288,"children":6289},{"style":709},[6290],{"type":100,"value":6291},"\"We have captured a UDP packet\"",{"type":95,"tag":382,"props":6293,"children":6294},{"style":395},[6295],{"type":100,"value":2863},{"type":95,"tag":382,"props":6297,"children":6299},{"class":6298,"line":4435},[384,519],[6300],{"type":95,"tag":382,"props":6301,"children":6302},{"style":1601},[6303],{"type":100,"value":2349},{"type":95,"tag":382,"props":6305,"children":6307},{"class":6306,"line":4436},[384,519],[6308,6312,6316,6320],{"type":95,"tag":382,"props":6309,"children":6310},{"style":677},[6311],{"type":100,"value":1696},{"type":95,"tag":382,"props":6313,"children":6314},{"style":395},[6315],{"type":100,"value":2331},{"type":95,"tag":382,"props":6317,"children":6318},{"style":406},[6319],{"type":100,"value":1354},{"type":95,"tag":382,"props":6321,"children":6322},{"style":395},[6323],{"type":100,"value":2340},{"type":95,"tag":382,"props":6325,"children":6327},{"class":6326,"line":4437},[384,519],[6328,6332,6336,6340,6344,6348,6352,6356,6360],{"type":95,"tag":382,"props":6329,"children":6330},{"style":677},[6331],{"type":100,"value":2238},{"type":95,"tag":382,"props":6333,"children":6334},{"style":395},[6335],{"type":100,"value":2362},{"type":95,"tag":382,"props":6337,"children":6338},{"style":406},[6339],{"type":100,"value":1387},{"type":95,"tag":382,"props":6341,"children":6342},{"style":422},[6343],{"type":100,"value":2371},{"type":95,"tag":382,"props":6345,"children":6346},{"style":395},[6347],{"type":100,"value":430},{"type":95,"tag":382,"props":6349,"children":6350},{"style":406},[6351],{"type":100,"value":1635},{"type":95,"tag":382,"props":6353,"children":6354},{"style":395},[6355],{"type":100,"value":1640},{"type":95,"tag":382,"props":6357,"children":6358},{"style":406},[6359],{"type":100,"value":1635},{"type":95,"tag":382,"props":6361,"children":6362},{"style":395},[6363],{"type":100,"value":2392},{"type":95,"tag":382,"props":6365,"children":6367},{"class":6366,"line":4438},[384,519],[6368],{"type":95,"tag":382,"props":6369,"children":6370},{"style":395},[6371],{"type":100,"value":1767},{"type":95,"tag":382,"props":6373,"children":6375},{"class":6374,"line":4439},[384,519],[6376,6380,6384,6388,6392,6396,6400,6405,6409,6413],{"type":95,"tag":382,"props":6377,"children":6378},{"style":422},[6379],{"type":100,"value":2849},{"type":95,"tag":382,"props":6381,"children":6382},{"style":395},[6383],{"type":100,"value":430},{"type":95,"tag":382,"props":6385,"children":6386},{"style":709},[6387],{"type":100,"value":5915},{"type":95,"tag":382,"props":6389,"children":6390},{"style":395},[6391],{"type":100,"value":398},{"type":95,"tag":382,"props":6393,"children":6394},{"style":422},[6395],{"type":100,"value":5924},{"type":95,"tag":382,"props":6397,"children":6398},{"style":395},[6399],{"type":100,"value":430},{"type":95,"tag":382,"props":6401,"children":6402},{"style":389},[6403],{"type":100,"value":6404},"udp",{"type":95,"tag":382,"props":6406,"children":6407},{"style":395},[6408],{"type":100,"value":1434},{"type":95,"tag":382,"props":6410,"children":6411},{"style":389},[6412],{"type":100,"value":5942},{"type":95,"tag":382,"props":6414,"children":6415},{"style":395},[6416],{"type":100,"value":5245},{"type":95,"tag":382,"props":6418,"children":6420},{"class":6419,"line":4440},[384,519],[6421,6425,6429,6433,6437,6441,6445,6449,6453,6457],{"type":95,"tag":382,"props":6422,"children":6423},{"style":422},[6424],{"type":100,"value":2849},{"type":95,"tag":382,"props":6426,"children":6427},{"style":395},[6428],{"type":100,"value":430},{"type":95,"tag":382,"props":6430,"children":6431},{"style":709},[6432],{"type":100,"value":5963},{"type":95,"tag":382,"props":6434,"children":6435},{"style":395},[6436],{"type":100,"value":398},{"type":95,"tag":382,"props":6438,"children":6439},{"style":422},[6440],{"type":100,"value":5924},{"type":95,"tag":382,"props":6442,"children":6443},{"style":395},[6444],{"type":100,"value":430},{"type":95,"tag":382,"props":6446,"children":6447},{"style":389},[6448],{"type":100,"value":6404},{"type":95,"tag":382,"props":6450,"children":6451},{"style":395},[6452],{"type":100,"value":1434},{"type":95,"tag":382,"props":6454,"children":6455},{"style":389},[6456],{"type":100,"value":5988},{"type":95,"tag":382,"props":6458,"children":6459},{"style":395},[6460],{"type":100,"value":5245},{"type":95,"tag":382,"props":6462,"children":6464},{"class":6463,"line":4441},[384,519],[6465,6469,6473,6478,6482,6486,6490,6494,6498,6503],{"type":95,"tag":382,"props":6466,"children":6467},{"style":422},[6468],{"type":100,"value":2849},{"type":95,"tag":382,"props":6470,"children":6471},{"style":395},[6472],{"type":100,"value":430},{"type":95,"tag":382,"props":6474,"children":6475},{"style":709},[6476],{"type":100,"value":6477},"\"Length of the UDP datagram: %d\"",{"type":95,"tag":382,"props":6479,"children":6480},{"style":395},[6481],{"type":100,"value":398},{"type":95,"tag":382,"props":6483,"children":6484},{"style":422},[6485],{"type":100,"value":5924},{"type":95,"tag":382,"props":6487,"children":6488},{"style":395},[6489],{"type":100,"value":430},{"type":95,"tag":382,"props":6491,"children":6492},{"style":389},[6493],{"type":100,"value":6404},{"type":95,"tag":382,"props":6495,"children":6496},{"style":395},[6497],{"type":100,"value":1434},{"type":95,"tag":382,"props":6499,"children":6500},{"style":389},[6501],{"type":100,"value":6502},"len",{"type":95,"tag":382,"props":6504,"children":6505},{"style":395},[6506],{"type":100,"value":5245},{"type":95,"tag":382,"props":6508,"children":6510},{"class":6509,"line":4442},[384,519],[6511,6515,6519,6524,6528,6532,6536,6540,6544,6549],{"type":95,"tag":382,"props":6512,"children":6513},{"style":422},[6514],{"type":100,"value":2849},{"type":95,"tag":382,"props":6516,"children":6517},{"style":395},[6518],{"type":100,"value":430},{"type":95,"tag":382,"props":6520,"children":6521},{"style":709},[6522],{"type":100,"value":6523},"\"Checksum for error detection: %d\"",{"type":95,"tag":382,"props":6525,"children":6526},{"style":395},[6527],{"type":100,"value":398},{"type":95,"tag":382,"props":6529,"children":6530},{"style":422},[6531],{"type":100,"value":5924},{"type":95,"tag":382,"props":6533,"children":6534},{"style":395},[6535],{"type":100,"value":430},{"type":95,"tag":382,"props":6537,"children":6538},{"style":389},[6539],{"type":100,"value":6404},{"type":95,"tag":382,"props":6541,"children":6542},{"style":395},[6543],{"type":100,"value":1434},{"type":95,"tag":382,"props":6545,"children":6546},{"style":389},[6547],{"type":100,"value":6548},"check",{"type":95,"tag":382,"props":6550,"children":6551},{"style":395},[6552],{"type":100,"value":5245},{"type":95,"tag":382,"props":6554,"children":6556},{"class":6555,"line":4443},[384,519],[6557],{"type":95,"tag":382,"props":6558,"children":6559},{"style":395},[6560],{"type":100,"value":2160},{"type":95,"tag":382,"props":6562,"children":6564},{"class":384,"line":6563},77,[6565],{"type":95,"tag":382,"props":6566,"children":6567},{"style":395},[6568],{"type":100,"value":2417},{"type":95,"tag":96,"props":6570,"children":6571},{},[6572],{"type":100,"value":6573},"This way, we can access different fields depending on the type of network packet we’ve captured:",{"type":95,"tag":159,"props":6575,"children":6576},{},[6577,6598,6619],{"type":95,"tag":163,"props":6578,"children":6579},{},[6580,6585],{"type":95,"tag":167,"props":6581,"children":6582},{},[6583],{"type":100,"value":6584},"TCP",{"type":95,"tag":159,"props":6586,"children":6587},{},[6588,6593],{"type":95,"tag":163,"props":6589,"children":6590},{},[6591],{"type":100,"value":6592},"Extracts source and destination ports, sequence and acknowledgment numbers, and flags such as SYN, ACK, FIN, RST, PSH, URG, ECE, and CWR.",{"type":95,"tag":163,"props":6594,"children":6595},{},[6596],{"type":100,"value":6597},"Useful for tracking client connections, detecting SYN floods, and analyzing general TCP traffic (e.g., RTT, retransmissions).",{"type":95,"tag":163,"props":6599,"children":6600},{},[6601,6606],{"type":95,"tag":167,"props":6602,"children":6603},{},[6604],{"type":100,"value":6605},"UDP",{"type":95,"tag":159,"props":6607,"children":6608},{},[6609,6614],{"type":95,"tag":163,"props":6610,"children":6611},{},[6612],{"type":100,"value":6613},"Extracts source and destination ports, datagram length, and checksum.",{"type":95,"tag":163,"props":6615,"children":6616},{},[6617],{"type":100,"value":6618},"Useful for monitoring UDP-based protocols such as DNS or QUIC.",{"type":95,"tag":163,"props":6620,"children":6621},{},[6622,6627],{"type":95,"tag":167,"props":6623,"children":6624},{},[6625],{"type":100,"value":6626},"ICMP / ICMPv6",{"type":95,"tag":159,"props":6628,"children":6629},{},[6630,6635],{"type":95,"tag":163,"props":6631,"children":6632},{},[6633],{"type":100,"value":6634},"Extracts type, code, and—for echo messages—the identifier and sequence fields.",{"type":95,"tag":163,"props":6636,"children":6637},{},[6638],{"type":100,"value":6639},"Useful for monitoring network health, detecting ping sweeps or DoS attempts, and diagnosing connectivity issues.",{"type":95,"tag":96,"props":6641,"children":6642},{},[6643],{"type":100,"value":6644},"It should now be much easier to understand how different protocols can be parsed, and how the program can branch into separate code paths—each capable of triggering specific XDP actions and enabling one to develop different types of applications.",{"type":95,"tag":96,"props":6646,"children":6647},{},[6648],{"type":100,"value":6649},"Let’s see this in action by observing a simple HTTP request from a client to a server.",{"type":95,"tag":138,"props":6651,"children":6654},{":alt":6652,":src":6653},"Playground Setup","/content/files/tutorials/ebpf-xdp-fundamentals-6342d24e/__static__/client-server.png",[],{"type":95,"tag":96,"props":6656,"children":6657},{},[6658,6660,6665],{"type":100,"value":6659},"First, start an HTTP server in the ",{"type":95,"tag":219,"props":6661,"children":6663},{"className":6662},[],[6664],{"type":100,"value":59},{"type":100,"value":6666}," tab:",{"type":95,"tag":369,"props":6668,"children":6672},{"className":6669,"code":6670,"language":6671,"meta":376,"style":376},"language-bash shiki shiki-themes slack-dark","python3 -m http.server 8000\n","bash",[6673],{"type":95,"tag":219,"props":6674,"children":6675},{"__ignoreMap":376},[6676],{"type":95,"tag":382,"props":6677,"children":6678},{"class":384,"line":385},[6679,6684,6689,6694],{"type":95,"tag":382,"props":6680,"children":6681},{"style":422},[6682],{"type":100,"value":6683},"python3",{"type":95,"tag":382,"props":6685,"children":6686},{"style":709},[6687],{"type":100,"value":6688}," -m",{"type":95,"tag":382,"props":6690,"children":6691},{"style":709},[6692],{"type":100,"value":6693}," http.server",{"type":95,"tag":382,"props":6695,"children":6696},{"style":3050},[6697],{"type":100,"value":6698}," 8000\n",{"type":95,"tag":96,"props":6700,"children":6701},{},[6702,6704,6709,6711,6717,6719,6724,6726,6732],{"type":100,"value":6703},"Next, open another ",{"type":95,"tag":219,"props":6705,"children":6707},{"className":6706},[],[6708],{"type":100,"value":59},{"type":100,"value":6710}," tab (click ",{"type":95,"tag":219,"props":6712,"children":6714},{"className":6713},[],[6715],{"type":100,"value":6716},"+",{"type":100,"value":6718}," → select ",{"type":95,"tag":219,"props":6720,"children":6722},{"className":6721},[],[6723],{"type":100,"value":59},{"type":100,"value":6725},"), then build and run our XDP program inside the ",{"type":95,"tag":219,"props":6727,"children":6729},{"className":6728},[],[6730],{"type":100,"value":6731},"lab",{"type":100,"value":6733}," folder:",{"type":95,"tag":369,"props":6735,"children":6737},{"className":6669,"code":6736,"language":6671,"meta":376,"style":376},"go generate\ngo build\nsudo ./xdp -i eth0\n",[6738],{"type":95,"tag":219,"props":6739,"children":6740},{"__ignoreMap":376},[6741,6753,6765],{"type":95,"tag":382,"props":6742,"children":6743},{"class":384,"line":385},[6744,6748],{"type":95,"tag":382,"props":6745,"children":6746},{"style":422},[6747],{"type":100,"value":375},{"type":95,"tag":382,"props":6749,"children":6750},{"style":709},[6751],{"type":100,"value":6752}," generate\n",{"type":95,"tag":382,"props":6754,"children":6755},{"class":384,"line":453},[6756,6760],{"type":95,"tag":382,"props":6757,"children":6758},{"style":422},[6759],{"type":100,"value":375},{"type":95,"tag":382,"props":6761,"children":6762},{"style":709},[6763],{"type":100,"value":6764}," build\n",{"type":95,"tag":382,"props":6766,"children":6767},{"class":384,"line":486},[6768,6773,6778,6783],{"type":95,"tag":382,"props":6769,"children":6770},{"style":422},[6771],{"type":100,"value":6772},"sudo",{"type":95,"tag":382,"props":6774,"children":6775},{"style":709},[6776],{"type":100,"value":6777}," ./xdp",{"type":95,"tag":382,"props":6779,"children":6780},{"style":709},[6781],{"type":100,"value":6782}," -i",{"type":95,"tag":382,"props":6784,"children":6785},{"style":709},[6786],{"type":100,"value":6787}," eth0\n",{"type":95,"tag":96,"props":6789,"children":6790},{},[6791,6793,6798],{"type":100,"value":6792},"For simplicity, the program prints packet header information directly to the eBPF trace logs. While we could forward this data to user space, we avoid that complexity for now. Open another ",{"type":95,"tag":219,"props":6794,"children":6796},{"className":6795},[],[6797],{"type":100,"value":59},{"type":100,"value":6799}," tab and run:",{"type":95,"tag":369,"props":6801,"children":6803},{"className":6669,"code":6802,"language":6671,"meta":376,"style":376},"sudo bpftool prog trace\n",[6804],{"type":95,"tag":219,"props":6805,"children":6806},{"__ignoreMap":376},[6807],{"type":95,"tag":382,"props":6808,"children":6809},{"class":384,"line":385},[6810,6814,6819,6824],{"type":95,"tag":382,"props":6811,"children":6812},{"style":422},[6813],{"type":100,"value":6772},{"type":95,"tag":382,"props":6815,"children":6816},{"style":709},[6817],{"type":100,"value":6818}," bpftool",{"type":95,"tag":382,"props":6820,"children":6821},{"style":709},[6822],{"type":100,"value":6823}," prog",{"type":95,"tag":382,"props":6825,"children":6826},{"style":709},[6827],{"type":100,"value":6828}," trace\n",{"type":95,"tag":96,"props":6830,"children":6831},{},[6832,6834,6839],{"type":100,"value":6833},"Finally, from the ",{"type":95,"tag":219,"props":6835,"children":6837},{"className":6836},[],[6838],{"type":100,"value":78},{"type":100,"value":6840}," tab, send a request to the server:",{"type":95,"tag":369,"props":6842,"children":6844},{"className":6669,"code":6843,"language":6671,"meta":376,"style":376},"curl http://172.16.0.10:8000/\n",[6845],{"type":95,"tag":219,"props":6846,"children":6847},{"__ignoreMap":376},[6848],{"type":95,"tag":382,"props":6849,"children":6850},{"class":384,"line":385},[6851,6856],{"type":95,"tag":382,"props":6852,"children":6853},{"style":422},[6854],{"type":100,"value":6855},"curl",{"type":95,"tag":382,"props":6857,"children":6858},{"style":709},[6859],{"type":100,"value":6860}," http://172.16.0.10:8000/\n",{"type":95,"tag":96,"props":6862,"children":6863},{},[6864],{"type":100,"value":6865},"You should now see your XDP program printing parsed Ethernet, IP and TCP-related packet details in real time.",{"type":95,"tag":96,"props":6867,"children":6868},{},[6869,6871,6876],{"type":100,"value":6870},"You’ll notice that the logs contain a lot of network traffic—not just clients' ",{"type":95,"tag":219,"props":6872,"children":6874},{"className":6873},[],[6875],{"type":100,"value":6855},{"type":100,"value":6877}," request. As a small challenge, try modifying the code so that only packets with TCP destination port 8000 (the HTTP server’s listening port) are printed.",{"type":95,"tag":96,"props":6879,"children":6880},{},[6881,6883,6889],{"type":100,"value":6882},"Or, if you prefer a quicker workaround, simply use ",{"type":95,"tag":219,"props":6884,"children":6886},{"className":6885},[],[6887],{"type":100,"value":6888},"grep",{"type":100,"value":6890},":",{"type":95,"tag":369,"props":6892,"children":6894},{"className":6669,"code":6893,"language":6671,"meta":376,"style":376},"sudo bpftool prog trace | grep 8000 -A 4 -B 4\n",[6895],{"type":95,"tag":219,"props":6896,"children":6897},{"__ignoreMap":376},[6898],{"type":95,"tag":382,"props":6899,"children":6900},{"class":384,"line":385},[6901,6905,6909,6913,6918,6923,6928,6933,6938,6943,6948],{"type":95,"tag":382,"props":6902,"children":6903},{"style":422},[6904],{"type":100,"value":6772},{"type":95,"tag":382,"props":6906,"children":6907},{"style":709},[6908],{"type":100,"value":6818},{"type":95,"tag":382,"props":6910,"children":6911},{"style":709},[6912],{"type":100,"value":6823},{"type":95,"tag":382,"props":6914,"children":6915},{"style":709},[6916],{"type":100,"value":6917}," trace",{"type":95,"tag":382,"props":6919,"children":6920},{"style":406},[6921],{"type":100,"value":6922}," |",{"type":95,"tag":382,"props":6924,"children":6925},{"style":422},[6926],{"type":100,"value":6927}," grep",{"type":95,"tag":382,"props":6929,"children":6930},{"style":3050},[6931],{"type":100,"value":6932}," 8000",{"type":95,"tag":382,"props":6934,"children":6935},{"style":709},[6936],{"type":100,"value":6937}," -A",{"type":95,"tag":382,"props":6939,"children":6940},{"style":3050},[6941],{"type":100,"value":6942}," 4",{"type":95,"tag":382,"props":6944,"children":6945},{"style":709},[6946],{"type":100,"value":6947}," -B",{"type":95,"tag":382,"props":6949,"children":6950},{"style":3050},[6951],{"type":100,"value":6952}," 4\n",{"type":95,"tag":96,"props":6954,"children":6955},{},[6956],{"type":95,"tag":167,"props":6957,"children":6958},{},[6959],{"type":100,"value":6960},"But so far, we’ve only looked at the headers — what about application data like HTTP in our case?",{"type":95,"tag":96,"props":6962,"children":6963},{},[6964],{"type":100,"value":6965},"XDP can only access the raw packet data that fits within a single MTU-sized frame, so it can’t always reliably parse application-layer protocols like HTTP. For that, eBPF hooks higher up the stack that operate on reassembled packet streams are more suitable.",{"type":95,"tag":96,"props":6967,"children":6968},{},[6969],{"type":100,"value":6970},"We’ll cover those soon, but this limitation is a key reason why developers often combine XDP with other program types—even though XDP is the most performant option and seems ideal for many networking tasks.",{"type":95,"tag":96,"props":6972,"children":6973},{},[6974],{"type":100,"value":6975},"Instead of only describing use cases, the upcoming tutorials will walk through building real eBPF applications like packet rate limiting, firewalling and load balancing with XDP.",{"type":95,"tag":6977,"props":6978,"children":6979},"style",{},[6980],{"type":100,"value":6981},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":376,"searchDepth":453,"depth":453,"links":6984},[6985,6986],{"id":196,"depth":453,"text":199},{"id":1032,"depth":453,"text":1035},["Reactive",6988],{},["Reactive",6990],{},["Reactive",6992],{},"#ebpf-xdp-fundamentals-6342d24e-server",{"left":39,"top":39,"width":1810,"height":1810,"rotate":39,"vFlip":6995,"hFlip":6995,"body":6996},false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":39,"top":39,"width":6998,"height":6998,"rotate":39,"vFlip":6995,"hFlip":6995,"body":6999},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",7001],{"$scurrentUser":7002,"$salerts":7006,"$scontentToggle":7007,"$ssite-config":7008},{"id":7003,"anonymous":11,"effectiveTier":7004,"hasEmailSubscription":6995},"697b5f64cc8f8f56faac74e1",{"name":7005},"free",[],{"/tutorials/ebpf-xdp-fundamentals-6342d24e":11},{"_priority":7009,"env":7012,"name":7013,"url":7014},{"name":7010,"env":7011,"url":39},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",7017],{"tutorial-page-tutorial-ebpf-xdp-fundamentals-6342d24e":-1,"content-tutorial-ebpf-xdp-fundamentals-6342d24e-v1764319325996":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/ebpf-xdp-fundamentals-6342d24e"]</script></body></html>