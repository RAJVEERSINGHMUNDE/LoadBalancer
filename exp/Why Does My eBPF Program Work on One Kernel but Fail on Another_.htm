<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Why Does My eBPF Program Work on One Kernel but Fail on Another?</title><link nonce="" rel="stylesheet" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/inter.css"><link nonce="" rel="stylesheet" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><style nonce="">details>summary[data-v-370f298d]{font-size:var(--prose-p-fontSize)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-dmAK1hhiumNXMs/NjWqR1YxMm3vyiMg16sggZx3HjlYKju1wCeiJzsSNr9NEW6TG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddhl0Rna.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="In this tutorial, we look at why eBPF programs can fail across kernel versions due to changes in structs, tracepoints, and function layouts. We look at examples of how these differences cause portability issues and how BPF CO-RE, BTF and vmlinux.h address them."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="Why Does My eBPF Program Work on One Kernel but Fail on Another? | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="Why Does My eBPF Program Work on One Kernel but Fail on Another? | iximiuz Labs"><meta property="og:description" content="In this tutorial, we look at why eBPF programs can fail across kernel versions due to changes in structs, tracepoints, and function layouts. We look at examples of how these differences cause portability issues and how BPF CO-RE, BTF and vmlinux.h address them."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/portable-ebpf-programs-46216e54"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/portable-ebpf-programs-46216e54/__static__/tracing.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="Why Does My eBPF Program Work on One Kernel but Fail on Another? | iximiuz Labs"><meta name="twitter:description" content="In this tutorial, we look at why eBPF programs can fail across kernel versions due to changes in structs, tracepoints, and function layouts. We look at examples of how these differences cause portability issues and how BPF CO-RE, BTF and vmlinux.h address them."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/portable-ebpf-programs-46216e54/__static__/tracing.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/portable-ebpf-programs-46216e54"><link nonce="" rel="image_src" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/tracing.webp"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/_name_.BsyFxT4E.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProsePre.B_fgAJq0.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseCodeInline.BhuXSD4-.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/DetailsBox.3wfYThLq.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/ProseLi.BqrAa653.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/tracing.webp"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/portable-ebpf-programs-46216e54" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="Why Does My eBPF Program Work on One Kernel but Fail on Another?" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">Why Does My eBPF Program Work on One Kernel but Fail on Another?</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Fportable-ebpf-programs-46216e54" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Fportable-ebpf-programs-46216e54" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#bpf-co-re-compile-once-run-everywhere" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">BPF CO-RE (Compile Once  Run Everywhere)</a><!----></li><li data-v-c294bba9=""><a href="#vmlinuxh-header-file" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">vmlinux.h Header file</a><!----></li><li data-v-c294bba9=""><a href="#bpf-type-format-btf" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">BPF Type Format (BTF)</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Fportable-ebpf-programs-46216e54" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Programming</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="Why Does My eBPF Program Work on One Kernel but Fail on Another?"><meta itemprop="abstract" content="In this tutorial, we look at why eBPF programs can fail across kernel versions due to changes in structs, tracepoints, and function layouts. We look at examples of how these differences cause portability issues and how BPF CO-RE, BTF and vmlinux.h address them."><meta itemprop="dateCreated" content="2025-09-10T00:00:00.000Z"><meta itemprop="datePublished" content="2025-09-10T00:00:00.000Z"><meta itemprop="dateModified" content="2025-09-10T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:underline no-underline truncate">Programming</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Sep 10, 2025"><time datetime="createdAt"> Published: Sep 10, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">Why Does My eBPF Program Work on One Kernel but Fail on Another?</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->In a perfect world, everyones systems would be fully updated, patched regularly, and running the latest kernel.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But lets be realthats rarely the case.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Some
 environments still rely on legacy versions of Ubuntu or Fedora, while 
others don't have their kernels compiled with BTF (BPF Type Format).<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And
 if youre maintaining any open-source tools, things get even messier. 
You have zero control over what kind of system your users will run your 
program on.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->All
 of this makes it tricky to ensure that your eBPF programs can run 
reliably across different distributions, ultimately affecting whether 
your eBPF tool gets adopted or not.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->So how do we make eBPF programs truly portable?<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:600px;"><div class="text-center"><img src="Why%20Does%20My%20eBPF%20Program%20Work%20on%20One%20Kernel%20but%20Fail%20on%20Another__files/tracing.webp" alt="eBPF Tracing" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->To better understand the problem, lets look at a hypothetical example.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Suppose you compile an eBPF program on kernel version 5.3, but it fails to run on 5.4.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Why would that happen?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Because
 each kernel version ships with its own kernel headers, which define 
structs and memory layouts. Even small changes in these definitions can 
break eBPF programs.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Take structs, for example. Lets say we have one representing a TCP header in kernel 5.3:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> tcphdr {</span><span style="--shiki-default:#6A9955">       /* Offset Size */
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __be16  source;</span><span style="--shiki-default:#6A9955">   /* 0      2    */
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __be16  dest;</span><span style="--shiki-default:#6A9955">     /* 2      2    */
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">    __be32  seq;</span><span style="--shiki-default:#6A9955">      /* 4      4    */
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    __be32  ack_seq;</span><span style="--shiki-default:#6A9955">  /* 8      4    */
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">    __be16  window;</span><span style="--shiki-default:#6A9955">   /* 12     2    */
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">    __sum16 check;</span><span style="--shiki-default:#6A9955">    /* 14     2    */
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">    __be16  urg_ptr;</span><span style="--shiki-default:#6A9955">  /* 16     2    */
</span></span><span class="line" line="9"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->In the next kernel release, 5.4, kernel developers might decide to place these fields into a new struct or rename the <code class="prose-code-inline" data-v-a031129a=""><!--[-->seq<!--]--></code> field to <code class="prose-code-inline" data-v-a031129a=""><!--[-->seque<!--]--></code> or perhaps move these fields up or down (changing their offset):<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> tcphdr {</span><span style="--shiki-default:#6A9955">       /* Offset Size */
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __be16  source;</span><span style="--shiki-default:#6A9955">   /* 0      2    */
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __be16  dest;</span><span style="--shiki-default:#6A9955">     /* 2      2    */
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">    __be32  ack_seq;</span><span style="--shiki-default:#6A9955">  /* 4      4    */
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    __be32  seque;</span><span style="--shiki-default:#6A9955">    /* 8      4    */
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">    __be16  window;</span><span style="--shiki-default:#6A9955">   /* 12     2    */
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">    __sum16 check;</span><span style="--shiki-default:#6A9955">    /* 14     2    */
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">    __be16  urg_ptr;</span><span style="--shiki-default:#6A9955">  /* 16     2    */
</span></span><span class="line" line="9"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->In this hypothetical struct, <code class="prose-code-inline" data-v-a031129a=""><!--[-->seq<!--]--></code> was renamed to <code class="prose-code-inline" data-v-a031129a=""><!--[-->seque<!--]--></code> and swapped with <code class="prose-code-inline" data-v-a031129a=""><!--[-->ack_seq<!--]--></code>, causing their offsets to change.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->See the problem?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Your code may rely on specific fields or offsets, which are likely to change across kernel versions.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Example of some real-world kernel struct changes</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->In <a href="https://git.kernel.org/pub/scm/linux/kernel/git/tip/tip.git/commit/?id=026842d148b920dc28f0499ede4950dcb098d4d5" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->this commit<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, the syscall tracepoint context was modified so that the field holding the syscall number was renamed from <code class="prose-code-inline" data-v-a031129a=""><!--[-->nr<!--]--></code> to <code class="prose-code-inline" data-v-a031129a=""><!--[-->__syscall_nr<!--]--></code>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And as explained <a href="https://tanelpoder.com/posts/ebpf-pt-regs-error-on-linux-blame-fred/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->here<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, the introduction of the <strong class="prose-strong" data-v-24022f14=""><!--[-->FRED<!--]--></strong> (Flexible Return and Event Delivery) mechanism on x86 (kernel v6.9) altered the way <code class="prose-code-inline" data-v-a031129a=""><!--[-->pt_regs<!--]--></code> are stored on the stack, adding padding and moving register offsets.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Since
 the eBPF program itself has no control over these changes, theres an 
inherent need for a solution to ensure the portability of eBPF programs.<!--]--></p><h2 id="bpf-co-re-compile-once-run-everywhere" class="prose-h2" data-v-b9b1576a=""><!--[-->BPF CO-RE (Compile Once  Run Everywhere)<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->If you search online, you'll find plenty of resources recommending the use of <a href="https://docs.ebpf.io/concepts/core/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->BPF CO-RE (Compile Once  Run Everywhere)<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to address this issue.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In other words, rather than writing the programs like this:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line highlight" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_sys_enter_execve {
</span></span><span class="line highlight" line="2"><span style="--shiki-default:#569CD6">    short</span><span style="--shiki-default:#E6E6E6"> common_type;
</span></span><span class="line highlight" line="3"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#E6E6E6"> common_flags;
</span></span><span class="line highlight" line="4"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#E6E6E6"> common_preempt_count;
</span></span><span class="line highlight" line="5"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> common_pid;
</span></span><span class="line highlight" line="6"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="7"><span style="--shiki-default:#E6E6E6">    s32 syscall_nr;</span><span style="--shiki-default:#6A9955">        // offset=8,  size=4
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#E6E6E6">    u32 pad;</span><span style="--shiki-default:#6A9955">               // offset=12, size=4 (pad)
</span></span><span class="line highlight" line="9"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#E6E6E6"> u8 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">filename;</span><span style="--shiki-default:#6A9955">    // offset=16, size=8
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#E6E6E6"> u8 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">argv;</span><span style="--shiki-default:#6A9955"> // offset=24, size=8
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#E6E6E6"> u8 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">envp;</span><span style="--shiki-default:#6A9955"> // offset=32, size=8
</span></span><span class="line highlight" line="12"><span style="--shiki-default:#E6E6E6">};
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tracepoint/syscalls/sys_enter_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line highlight" line="15"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_tp_non_core</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_sys_enter_execve </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line highlight" line="16"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename_ptr </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">filename</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span style="--shiki-default:#E6E6E6">    u8 </span><span style="--shiki-default:#9CDCFE">buf</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line highlight" line="19"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(buf, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(buf), filename_ptr);
</span></span><span class="line" line="20"><span emptylineplaceholder="true">
</span></span><span class="line" line="21"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Tracepoint triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, buf);
</span></span><span class="line" line="22"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="23"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->You should replace the lines of code that access the kernel struct context with the <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_*<!--]--></code> family of helper functions, which enables access to struct fields in a way that adapts across kernel versions:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tracepoint/syscalls/sys_enter_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line highlight" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_tp</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_event_raw_sys_enter </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line highlight" line="3"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename_ptr </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#DCDCAA">BPF_CORE_READ</span><span style="--shiki-default:#E6E6E6">(ctx, </span><span style="--shiki-default:#9CDCFE">args</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">]);
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    u8 </span><span style="--shiki-default:#9CDCFE">filename</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line highlight" line="6"><span style="--shiki-default:#DCDCAA">    bpf_core_read_user_str</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">filename, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(filename), filename_ptr);
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, filename);
</span></span><span class="line" line="9"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="10"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[--> If you look carefully, also the input context was changed. Instead of using the hardcoded <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct trace_sys_enter_execve<!--]--></code>, we use <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct trace_event_raw_sys_enter<!--]--></code>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Why is that? Read along.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->In short, the <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_*<!--]--></code> family of helpers enables relocatable reads of kernel structs.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->So if a certain struct field (like <code class="prose-code-inline" data-v-a031129a=""><!--[-->filename<!--]--></code> in the example) sits at a different offset in another kernel version, these helpers can still locate and read it correctly.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">More information about the `BPF_CORE_*` family of helpers</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->All <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_*<!--]--></code>
 helpers let your eBPF program read fields from kernel structs in a way 
that survives kernel changes (renames, field reordering, different 
offsets) using BTF-based CO-RE relocations:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_READ(src, field, [nested_field, ...])<!--]--></code>
  Reads the value of a (possibly nested) field from a kernel struct and
 on failure returns a zero value, which is not that ideal, since you 
cant distinguish real zero read from failed read.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_READ_INTO(&amp;dst, src, field, [nested_field, ...])<!--]--></code>  Reads into <code class="prose-code-inline" data-v-a031129a=""><!--[-->dst<!--]--></code> and returns a zero value on success and a negative value on error.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_READ_USER<!--]--></code> / <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_READ_USER_INTO<!--]--></code>  Same as above, but for user-memory pointers.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->and others..<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->You'll also see developers using <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_core_read()<!--]--></code> or similar lower-case helpers.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->These are low-level functions that copy bytes from a relocatable address into a buffer and return an error code. In contrast, <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_READ()<!--]--></code>
 is a macro built on top that automatically follows pointer chains and 
applies CO-RE relocations, making it especially convenient for accessing
 nested kernel structs.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> task_struct </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">task </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_get_current_task</span><span style="--shiki-default:#E6E6E6">();
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#6A9955">// Using BPF_CORE_READ: follows pointer chain automatically
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">u32 pid </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> BPF_CORE_READ</span><span style="--shiki-default:#E6E6E6">(task, real_parent, pid);
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#6A9955">// Using bpf_core_read: you must spell out the destination and size
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">u32 pid2 </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="8"><span style="--shiki-default:#DCDCAA">bpf_core_read</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">pid2</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(pid2), </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">task</span><span style="--shiki-default:#D4D4D4">-&gt;</span><span style="--shiki-default:#E6E6E6">real_parent</span><span style="--shiki-default:#D4D4D4">-&gt;</span><span style="--shiki-default:#9CDCFE">pid</span><span style="--shiki-default:#E6E6E6">);
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Under the hood, this is made possible by BPF CO-RE relocation information and BPF Type Format.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Wait, what? CO-RE relocation information? BTF?<!--]--></strong> Read along.<!--]--></p><h2 id="vmlinuxh-header-file" class="prose-h2" data-v-b9b1576a=""><!--[-->vmlinux.h Header file<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->If you peek into almost any production eBPF codebase, youll notice all of them include (or generate during the build-time) the <code class="prose-code-inline" data-v-a031129a=""><!--[-->vmlinux.h<!--]--></code> header.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->There's one also in our <code class="prose-code-inline" data-v-a031129a=""><!--[-->labs/lab2<!--]--></code> directory for this lab - open it.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This file contains definitions for all kernel structs (like <code class="prose-code-inline" data-v-a031129a=""><!--[-->trace_event_raw_sys_enter<!--]--></code> in the example above), generated based on the currently running kernel.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">How does one create a vmlinux.h file?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[--> You can generate this header file using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> btf</span><span style="--shiki-default:#CE9178"> dump</span><span style="--shiki-default:#CE9178"> file</span><span style="--shiki-default:#CE9178"> /sys/kernel/btf/vmlinux</span><span style="--shiki-default:#CE9178"> format</span><span style="--shiki-default:#CE9178"> c</span><span style="--shiki-default:#D4D4D4"> &gt;</span><span style="--shiki-default:#CE9178"> vmlinux.h
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->But as mentioned above, these files are usually build during build time, e.g. in the <code class="prose-code-inline" data-v-a031129a=""><!--[-->Makefile<!--]--></code>.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Heres where it gets interesting  this header includes a few special lines at both the top and bottom:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0">#ifndef</span><span style="--shiki-default:#DCDCAA"> BPF_NO_PRESERVE_ACCESS_INDEX
</span></span><span class="line" line="2"><span style="--shiki-default:#C586C0">#pragma</span><span style="--shiki-default:#9CDCFE"> clang</span><span style="--shiki-default:#9CDCFE"> attribute</span><span style="--shiki-default:#9CDCFE"> push</span><span style="--shiki-default:#569CD6"> (</span><span style="--shiki-default:#9CDCFE">__attribute__</span><span style="--shiki-default:#569CD6">((</span><span style="--shiki-default:#9CDCFE">preserve_access_index</span><span style="--shiki-default:#569CD6">)), </span><span style="--shiki-default:#9CDCFE">apply_to</span><span style="--shiki-default:#569CD6"> = </span><span style="--shiki-default:#9CDCFE">record</span><span style="--shiki-default:#569CD6">)
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0">#endif
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6"># Kernel Struct definitions
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="7"><span style="--shiki-default:#C586C0">#ifndef</span><span style="--shiki-default:#DCDCAA"> BPF_NO_PRESERVE_ACCESS_INDEX
</span></span><span class="line" line="8"><span style="--shiki-default:#C586C0">#pragma</span><span style="--shiki-default:#9CDCFE"> clang</span><span style="--shiki-default:#9CDCFE"> attribute</span><span style="--shiki-default:#9CDCFE"> pop
</span></span><span class="line" line="9"><span style="--shiki-default:#C586C0">#endif
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->The line <code class="prose-code-inline" data-v-a031129a=""><!--[-->__attribute__((preserve_access_index))<!--]--></code> at the top of <code class="prose-code-inline" data-v-a031129a=""><!--[-->vmlinux.h<!--]--></code>,
 tells the compiler to emit BPF CO-RE (Compile Once  Run Everywhere) 
relocation information (into the output binary) for every struct field 
your eBPF program accesses into your eBPF object file.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And the <code class="prose-code-inline" data-v-a031129a=""><!--[-->clang attribute push<!--]--></code> ensures this applies to all struct definitions until the matching <code class="prose-code-inline" data-v-a031129a=""><!--[-->clang attribute pop<!--]--></code> at the bottom of the file.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In other words, when you reference a field (like <code class="prose-code-inline" data-v-a031129a=""><!--[-->filename<!--]--></code> in the examples in <code class="prose-code-inline" data-v-a031129a=""><!--[-->labs/lab2/trace.c<!--]--></code>
 file) from a kernel struct, the compiler doesnt just hardcode its 
offset. Instead, it records metadatalike the fields name, type, 
offset, and parent struct.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tracepoint/syscalls/sys_enter_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_tp</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_event_raw_sys_enter </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line highlight" line="3"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename_ptr </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#DCDCAA">BPF_CORE_READ</span><span style="--shiki-default:#E6E6E6">(ctx, </span><span style="--shiki-default:#9CDCFE">args</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">]);
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    u8 </span><span style="--shiki-default:#9CDCFE">filename</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line highlight" line="6"><span style="--shiki-default:#DCDCAA">    bpf_core_read_user_str</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">filename, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(filename), filename_ptr);
</span></span><span class="line" line="7"><span emptylineplaceholder="true">
</span></span><span class="line" line="8"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, filename);
</span></span><span class="line" line="9"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="10"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">More information on the metadata record</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Compiler records the metadata within <a href="https://codebrowser.dev/linux/linux/include/uapi/linux/bpf.h.html#7501" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_core_relo struct<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> or so-called BPF CO-RE relocation structure, defined as:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> bpf_core_relo {
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u32 insn_off;
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __u32 type_id;
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">    __u32 access_str_off;
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">    enum</span><span style="--shiki-default:#E6E6E6"> bpf_core_relo_kind kind;
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->where the arguments are:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->insn_off<!--]--></code>: Identifies the instruction being relocated, such as one that sets a register to a specific value.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->type_id<!--]--></code>: References BTF (BPF Type Format) metadata, which describes the layout of the kernel structure.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->access_str_off<!--]--></code>: Specifies how a particular field is accessed relative to the structure.<!--]--></li><!--]--></ul><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->This metadata is recorded in <a href="https://docs.ebpf.io/concepts/btf/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->BPF Type Format (BTF)<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><h2 id="bpf-type-format-btf" class="prose-h2" data-v-b9b1576a=""><!--[-->BPF Type Format (BTF)<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->To understand how this metadata looks like, let's build and run the program from <code class="prose-code-inline" data-v-a031129a=""><!--[-->labs/lab2<!--]--></code> directory, using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> generate
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> build
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ./lab2
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->And then dump the recorded BTF information for the <code class="prose-code-inline" data-v-a031129a=""><!--[-->handle_execve_tp<!--]--></code> tracepoint program using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> prog</span><span style="--shiki-default:#6A9955"> # Find the BTF ID (`btf_id`) of the `handle_execve_tp` program
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> btf</span><span style="--shiki-default:#CE9178"> dump</span><span style="--shiki-default:#CE9178"> id</span><span style="--shiki-default:#D4D4D4"> &lt;</span><span style="--shiki-default:#CE9178">prog-btf-i</span><span style="--shiki-default:#E6E6E6">d</span><span style="--shiki-default:#D4D4D4">&gt;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>[1] FUNC 'handle_execve_tp' type_id=14 linkage=global
[2] INT 'int' size=4 bits_offset=0 nr_bits=32 encoding=SIGNED
[3] INT 'unsigned short' size=2 bits_offset=0 nr_bits=16 encoding=(none)
[4] INT 'unsigned char' size=1 bits_offset=0 nr_bits=8 encoding=(none)
[5] STRUCT 'trace_entry' size=8 vlen=4
        'type' type_id=3 bits_offset=0
        'flags' type_id=4 bits_offset=16
        'preempt_count' type_id=4 bits_offset=24
        'pid' type_id=2 bits_offset=32
[6] INT 'long' size=8 bits_offset=0 nr_bits=64 encoding=SIGNED
[7] INT '__ARRAY_SIZE_TYPE__' size=4 bits_offset=0 nr_bits=32 encoding=(none)
[8] INT 'unsigned long' size=8 bits_offset=0 nr_bits=64 encoding=(none)
[9] ARRAY '(anon)' type_id=8 index_type_id=7 nr_elems=6
[10] INT 'char' size=1 bits_offset=0 nr_bits=8 encoding=SIGNED
[11] ARRAY '(anon)' type_id=10 index_type_id=7 nr_elems=0
[12] STRUCT 'trace_event_raw_sys_enter' size=64 vlen=4
        'ent' type_id=5 bits_offset=0
        'id' type_id=6 bits_offset=64
        'args' type_id=9 bits_offset=128
        '__data' type_id=11 bits_offset=512
[13] PTR '(anon)' type_id=12
[14] FUNC_PROTO '(anon)' ret_type_id=2 vlen=1
        'ctx' type_id=13
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[--> To embed BTF information into the eBPF application binary, <code class="prose-code-inline" data-v-a031129a=""><!--[-->clang<!--]--></code> must be invoked with the <code class="prose-code-inline" data-v-a031129a=""><!--[-->-g<!--]--></code> flag. You dont see it explicitly because <code class="prose-code-inline" data-v-a031129a=""><!--[-->go generate<!--]--></code> runs <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf2go<!--]--></code>, which internally invokes <code class="prose-code-inline" data-v-a031129a=""><!--[-->clang<!--]--></code> with <a href="https://github.com/cilium/ebpf/blob/5ba3156ee1314afa3c3166e59d7775d674f57760/cmd/bpf2go/gen/compile.go#L92" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->the -g flag enabled by default<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Without <code class="prose-code-inline" data-v-a031129a=""><!--[-->-g<!--]--></code>, compiling eBPF programs that use <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE*<!--]--></code> helpers fails with:<!--]--></p><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>error: using builtin_preserve_access_index() without -g
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--]--></div><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Detailed explanation of the BTF output</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Each numbered entry corresponds to a type definition: integers, arrays, structs, pointers, function prototypes, and so on.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For example:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->[1] FUNC 'handle_execve_tp'<!--]--></code>  defines a global function named <code class="prose-code-inline" data-v-a031129a=""><!--[-->handle_execve_tp<!--]--></code>.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->[14] FUNC_PROTO<!--]--></code>  says this function returns an int <code class="prose-code-inline" data-v-a031129a=""><!--[-->(type_id=2)<!--]--></code> and takes one parameter called ctx.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->[13] PTR  [12] STRUCT 'trace_event_raw_sys_enter'<!--]--></code>  the ctx argument is a pointer to a <code class="prose-code-inline" data-v-a031129a=""><!--[-->trace_event_raw_sys_enter struct<!--]--></code>.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->[12] STRUCT 'trace_event_raw_sys_enter'<!--]--></code>  represents the syscall-enter tracepoint data:
<ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->ent<!--]--></code>  a trace_entry header (<code class="prose-code-inline" data-v-a031129a=""><!--[-->[5]<!--]--></code>) with fields like <code class="prose-code-inline" data-v-a031129a=""><!--[-->type<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->flags<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->preempt_count<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->pid<!--]--></code>.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->id<!--]--></code>  syscall ID (long).<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->args<!--]--></code>  array of six unsigned long values (syscall arguments).<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->__data<!--]--></code>  flexible array for extra data.<!--]--></li><!--]--></ul><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->[2][11]<!--]--></code>  supporting integer and array type definitions used to build the structs.<!--]--></li><!--]--></ul><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Well,
 this is quite a lot to take it, but what it really shows is the BTF 
(BPF Type Format) description of kernel structures/types your program is
 working with.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And
 for your eBPF program to work across kernel versionswhere struct 
layouts may differthe target kernel must also be compiled with BTF 
support. Without it, the program wont be able to resolve the correct 
fields offsets at runtime.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Still confused?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->
 The BTF data shown above is only a metadata record of kernel structs 
and their layout that our eBPF program uses. While the BTF information 
from the target kernel is different and can be inspected (on the target 
kernel) with:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> btf</span><span style="--shiki-default:#CE9178"> dump</span><span style="--shiki-default:#CE9178"> file</span><span style="--shiki-default:#CE9178"> /sys/kernel/btf/vmlinux
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>[1] FUNC_PROTO '(anon)' ret_type_id=0 vlen=0
[2] FUNC 'verify_cpu' type_id=1 linkage=static
[3] FUNC 'sev_verify_cbit' type_id=1 linkage=static
[4] INT 'long unsigned int' size=8 bits_offset=0 nr_bits=64 encoding=(none)
[5] CONST '(anon)' type_id=4
[6] ARRAY '(anon)' type_id=4 index_type_id=21 nr_elems=2
[7] PTR '(anon)' type_id=9
[8] INT 'char' size=1 bits_offset=0 nr_bits=8 encoding=SIGNED
[9] CONST '(anon)' type_id=8
[10] INT 'unsigned int' size=4 bits_offset=0 nr_bits=32 encoding=(none)
[11] CONST '(anon)' type_id=10
[12] INT 'signed char' size=1 bits_offset=0 nr_bits=8 encoding=SIGNED
[13] TYPEDEF '__u8' type_id=14
...
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Why is this necessary?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->When your eBPF program is loaded by a BPF loader like <a href="https://github.com/libbpf/libbpf" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->libbpf<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, the loader compares the programs BTF data with the target kernels BTF.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And
 since it's quite likely your program won't only run on the kernel it 
was compiled on, the loader needs to resolve types, updates offsets, and
 adjusts field accesses to ensure the program reads kernel structures 
correctly.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This process is known as <strong class="prose-strong" data-v-24022f14=""><!--[-->field offset relocation<!--]--></strong>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Although
 most eBPF kernels nowadays support BTF, it's not really something we 
can rely on when we want to design truly portable eBPF programs.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">How to check if your kernel is compiled with BTF support?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->You can verify this using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">grep</span><span style="--shiki-default:#CE9178"> CONFIG_DEBUG_INFO_BTF</span><span style="--shiki-default:#CE9178"> /boot/config-</span><span style="--shiki-default:#E6E6E6">$(</span><span style="--shiki-default:#DCDCAA">uname</span><span style="--shiki-default:#CE9178"> -r</span><span style="--shiki-default:#E6E6E6">)
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>CONFIG_DEBUG_INFO_BTF=y
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->In case it doesnt, then you have two options:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->Re-compile the kernel with the <code class="prose-code-inline" data-v-a031129a=""><!--[-->CONFIG_DEBUG_INFO_BTF=y<!--]--></code> option or upgrade the kernel, which is time-consuming, inconvenient  especially if the machine is in production.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Or
 better, provide the BTF information of that specific kernel alongside 
your program. We'll talk about this in the next tutorial<!--]--></li><!--]--></ul><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->But can we do something to avoid this dependency?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Actuallyyes, but we'll cover that in the next tutorial.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->If you havent checked it yet, the code in <code class="prose-code-inline" data-v-a031129a=""><!--[-->labs/lab2<!--]--></code>
 provides portable versions of Tracepoint, Raw Tracepoint, kprobe, 
fprobe and BTF-Enabled Raw Tracepoint eBPF programs for capturing <code class="prose-code-inline" data-v-a031129a=""><!--[-->execve<!--]--></code> syscall events.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-warning bg-[#fdeee5]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[--> Extra Insight <!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To ones surprise, you don't always need to use <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_CORE_*<!--]--></code> helpers to do CO-RE-relocatable reads.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->BTF-Enabled Raw Tracepoint<!--]--></strong> allow you to directly access kernel memory.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line highlight" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tp_btf/sys_enter"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_btf</span><span style="--shiki-default:#E6E6E6">(u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    long</span><span style="--shiki-default:#569CD6"> int</span><span style="--shiki-default:#E6E6E6"> syscall_id </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">long</span><span style="--shiki-default:#569CD6"> int</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">];
</span></span><span class="line" line="4"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (syscall_id </span><span style="--shiki-default:#D4D4D4">!=</span><span style="--shiki-default:#B5CEA8"> 59</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="5"><span style="--shiki-default:#C586C0">        return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="7"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">regs </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">];</span><span style="--shiki-default:#6A9955"> // No need to use BPF_CORE_READ helper
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#DCDCAA">PT_REGS_PARM1</span><span style="--shiki-default:#E6E6E6">(regs);</span><span style="--shiki-default:#6A9955"> // No need to use PT_REGS_PARM1_CORE helper
</span></span><span class="line" line="9"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#9CDCFE"> buf</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(buf, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(buf), filename);</span><span style="--shiki-default:#6A9955"> // No need to use bpf_core_read_user_str helper
</span></span><span class="line" line="11"><span emptylineplaceholder="true">
</span></span><span class="line" line="12"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"BTF-enabled tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, buf);
</span></span><span class="line" line="13"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="14"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->This makes the BTF-enabled tracepoint slightly more convenient to develop compared to the raw and regular tracepoints.<!--]--></p><!--]--></div><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game  Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-portable-ebpf-programs-46216e54" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10">  </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial portable-ebpf-programs-46216e54<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">portable-ebpf-programs-46216e54</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial portable-ebpf-programs-46216e54<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Fportable-ebpf-programs-46216e54" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":3445,"once":3460,"_errors":3461,"serverRendered":11,"path":3463},["ShallowReactive",3],{"tutorial-page-tutorial-portable-ebpf-programs-46216e54":4,"content-tutorial-portable-ebpf-programs-46216e54-v1762190214682":49,"i-material-symbols-light:expand-content":3438,"i-ph:copy":3442},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":40,"completionCount":41,"accessControl":42,"userAccess":48},"68c1aef2c2a4bad2d503d581","tutorial","portable-ebpf-programs-46216e54","Why Does My eBPF Program Work on One Kernel but Fail on Another?","In this tutorial, we look at why eBPF programs can fail across kernel versions due to changes in structs, tracepoints, and function layouts. We look at examples of how these differences cause portability issues and how BPF CO-RE, BTF and vmlinux.h address them.","2025-09-10T00:00:00.000Z",true,"ebpf-playground-2bd77c1c",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#portable-ebpf-programs-46216e54","2025-09-10","tutorials/portable-ebpf-programs-46216e54/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1762190214682,"https://labs.iximiuz.com/tutorials/portable-ebpf-programs-46216e54","/content/files/tutorials/portable-ebpf-programs-46216e54/__static__/tracing.png",[30,31],"linux","programming",[33],"eBPF","todo",{"clone_hello_world":36},{"init":11,"user":37,"name":38,"status":39},"laborant","clone_hello_world",0,10,6,{"canList":43,"canPreview":45,"canRead":46,"canStart":47},[44],"anyone",[44],[44],[44],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[50],{"title":8,"description":51,"kind":6,"playground":52,"categories":53,"tagz":54,"createdAt":10,"updatedAt":10,"cover":28,"type":55,"children":56,"hash":15,"preview":-1,"pageUrl":27,"tasks":3425,"toc":3426,"tutorials":3431,"challenges":3433,"courses":3435,"key":3437},"In this tutorial, we look at why eBPF programs can fail across kernel versions due to changes in structs, tracepoints, and function layouts. We look at examples of how these differences cause portability issues and how BPF CO-RE, BTF and vmlinux.h address them.\n",{"name":12},[30,31],[33],"root",[57,65,70,75,80,85,90,96,101,106,115,120,125,267,288,397,429,437,442,508,513,520,533,538,1032,1045,1290,1318,1330,1342,1623,1628,1638,1644,1657,1670,1683,1766,1771,1926,1946,1967,1987,2215,2341,2354,2359,2371,2415,2428,2500,2510,2594,2768,2773,2778,2831,2839,2853,2858,2869,2874,2962,2970,2975,2995,3419],{"type":58,"tag":59,"props":60,"children":61},"element","p",{},[62],{"type":63,"value":64},"text","In a perfect world, everyones systems would be fully updated, patched regularly, and running the latest kernel.",{"type":58,"tag":59,"props":66,"children":67},{},[68],{"type":63,"value":69},"But lets be realthats rarely the case.",{"type":58,"tag":59,"props":71,"children":72},{},[73],{"type":63,"value":74},"Some environments still rely on legacy versions of Ubuntu or Fedora, while others don't have their kernels compiled with BTF (BPF Type Format).",{"type":58,"tag":59,"props":76,"children":77},{},[78],{"type":63,"value":79},"And if youre maintaining any open-source tools, things get even messier. You have zero control over what kind of system your users will run your program on.",{"type":58,"tag":59,"props":81,"children":82},{},[83],{"type":63,"value":84},"All of this makes it tricky to ensure that your eBPF programs can run reliably across different distributions, ultimately affecting whether your eBPF tool gets adopted or not.",{"type":58,"tag":59,"props":86,"children":87},{},[88],{"type":63,"value":89},"So how do we make eBPF programs truly portable?",{"type":58,"tag":91,"props":92,"children":95},"image-box",{":alt":93,":max-width":94,":src":28},"eBPF Tracing","600px",[],{"type":58,"tag":59,"props":97,"children":98},{},[99],{"type":63,"value":100},"To better understand the problem, lets look at a hypothetical example.",{"type":58,"tag":59,"props":102,"children":103},{},[104],{"type":63,"value":105},"Suppose you compile an eBPF program on kernel version 5.3, but it fails to run on 5.4.",{"type":58,"tag":59,"props":107,"children":108},{},[109],{"type":58,"tag":110,"props":111,"children":112},"strong",{},[113],{"type":63,"value":114},"Why would that happen?",{"type":58,"tag":59,"props":116,"children":117},{},[118],{"type":63,"value":119},"Because each kernel version ships with its own kernel headers, which define structs and memory layouts. Even small changes in these definitions can break eBPF programs.",{"type":58,"tag":59,"props":121,"children":122},{},[123],{"type":63,"value":124},"Take structs, for example. Lets say we have one representing a TCP header in kernel 5.3:",{"type":58,"tag":126,"props":127,"children":132},"pre",{"className":128,"code":129,"language":130,"meta":131,"style":131},"language-c shiki shiki-themes slack-dark","struct tcphdr {       /* Offset Size */\n    __be16  source;   /* 0      2    */\n    __be16  dest;     /* 2      2    */\n    __be32  seq;      /* 4      4    */\n    __be32  ack_seq;  /* 8      4    */\n    __be16  window;   /* 12     2    */\n    __sum16 check;    /* 14     2    */\n    __be16  urg_ptr;  /* 16     2    */\n};\n","c","",[133],{"type":58,"tag":134,"props":135,"children":136},"code",{"__ignoreMap":131},[137,161,175,189,203,217,230,244,258],{"type":58,"tag":138,"props":139,"children":142},"span",{"class":140,"line":141},"line",1,[143,149,155],{"type":58,"tag":138,"props":144,"children":146},{"style":145},"--shiki-default:#569CD6",[147],{"type":63,"value":148},"struct",{"type":58,"tag":138,"props":150,"children":152},{"style":151},"--shiki-default:#E6E6E6",[153],{"type":63,"value":154}," tcphdr {",{"type":58,"tag":138,"props":156,"children":158},{"style":157},"--shiki-default:#6A9955",[159],{"type":63,"value":160},"       /* Offset Size */\n",{"type":58,"tag":138,"props":162,"children":164},{"class":140,"line":163},2,[165,170],{"type":58,"tag":138,"props":166,"children":167},{"style":151},[168],{"type":63,"value":169},"    __be16  source;",{"type":58,"tag":138,"props":171,"children":172},{"style":157},[173],{"type":63,"value":174},"   /* 0      2    */\n",{"type":58,"tag":138,"props":176,"children":178},{"class":140,"line":177},3,[179,184],{"type":58,"tag":138,"props":180,"children":181},{"style":151},[182],{"type":63,"value":183},"    __be16  dest;",{"type":58,"tag":138,"props":185,"children":186},{"style":157},[187],{"type":63,"value":188},"     /* 2      2    */\n",{"type":58,"tag":138,"props":190,"children":192},{"class":140,"line":191},4,[193,198],{"type":58,"tag":138,"props":194,"children":195},{"style":151},[196],{"type":63,"value":197},"    __be32  seq;",{"type":58,"tag":138,"props":199,"children":200},{"style":157},[201],{"type":63,"value":202},"      /* 4      4    */\n",{"type":58,"tag":138,"props":204,"children":206},{"class":140,"line":205},5,[207,212],{"type":58,"tag":138,"props":208,"children":209},{"style":151},[210],{"type":63,"value":211},"    __be32  ack_seq;",{"type":58,"tag":138,"props":213,"children":214},{"style":157},[215],{"type":63,"value":216},"  /* 8      4    */\n",{"type":58,"tag":138,"props":218,"children":219},{"class":140,"line":41},[220,225],{"type":58,"tag":138,"props":221,"children":222},{"style":151},[223],{"type":63,"value":224},"    __be16  window;",{"type":58,"tag":138,"props":226,"children":227},{"style":157},[228],{"type":63,"value":229},"   /* 12     2    */\n",{"type":58,"tag":138,"props":231,"children":233},{"class":140,"line":232},7,[234,239],{"type":58,"tag":138,"props":235,"children":236},{"style":151},[237],{"type":63,"value":238},"    __sum16 check;",{"type":58,"tag":138,"props":240,"children":241},{"style":157},[242],{"type":63,"value":243},"    /* 14     2    */\n",{"type":58,"tag":138,"props":245,"children":247},{"class":140,"line":246},8,[248,253],{"type":58,"tag":138,"props":249,"children":250},{"style":151},[251],{"type":63,"value":252},"    __be16  urg_ptr;",{"type":58,"tag":138,"props":254,"children":255},{"style":157},[256],{"type":63,"value":257},"  /* 16     2    */\n",{"type":58,"tag":138,"props":259,"children":261},{"class":140,"line":260},9,[262],{"type":58,"tag":138,"props":263,"children":264},{"style":151},[265],{"type":63,"value":266},"};\n",{"type":58,"tag":59,"props":268,"children":269},{},[270,272,278,280,286],{"type":63,"value":271},"In the next kernel release, 5.4, kernel developers might decide to place these fields into a new struct or rename the ",{"type":58,"tag":134,"props":273,"children":275},{"className":274},[],[276],{"type":63,"value":277},"seq",{"type":63,"value":279}," field to ",{"type":58,"tag":134,"props":281,"children":283},{"className":282},[],[284],{"type":63,"value":285},"seque",{"type":63,"value":287}," or perhaps move these fields up or down (changing their offset):",{"type":58,"tag":126,"props":289,"children":291},{"className":128,"code":290,"language":130,"meta":131,"style":131},"struct tcphdr {       /* Offset Size */\n    __be16  source;   /* 0      2    */\n    __be16  dest;     /* 2      2    */\n    __be32  ack_seq;  /* 4      4    */\n    __be32  seque;    /* 8      4    */\n    __be16  window;   /* 12     2    */\n    __sum16 check;    /* 14     2    */\n    __be16  urg_ptr;  /* 16     2    */\n};\n",[292],{"type":58,"tag":134,"props":293,"children":294},{"__ignoreMap":131},[295,310,321,332,344,357,368,379,390],{"type":58,"tag":138,"props":296,"children":297},{"class":140,"line":141},[298,302,306],{"type":58,"tag":138,"props":299,"children":300},{"style":145},[301],{"type":63,"value":148},{"type":58,"tag":138,"props":303,"children":304},{"style":151},[305],{"type":63,"value":154},{"type":58,"tag":138,"props":307,"children":308},{"style":157},[309],{"type":63,"value":160},{"type":58,"tag":138,"props":311,"children":312},{"class":140,"line":163},[313,317],{"type":58,"tag":138,"props":314,"children":315},{"style":151},[316],{"type":63,"value":169},{"type":58,"tag":138,"props":318,"children":319},{"style":157},[320],{"type":63,"value":174},{"type":58,"tag":138,"props":322,"children":323},{"class":140,"line":177},[324,328],{"type":58,"tag":138,"props":325,"children":326},{"style":151},[327],{"type":63,"value":183},{"type":58,"tag":138,"props":329,"children":330},{"style":157},[331],{"type":63,"value":188},{"type":58,"tag":138,"props":333,"children":334},{"class":140,"line":191},[335,339],{"type":58,"tag":138,"props":336,"children":337},{"style":151},[338],{"type":63,"value":211},{"type":58,"tag":138,"props":340,"children":341},{"style":157},[342],{"type":63,"value":343},"  /* 4      4    */\n",{"type":58,"tag":138,"props":345,"children":346},{"class":140,"line":205},[347,352],{"type":58,"tag":138,"props":348,"children":349},{"style":151},[350],{"type":63,"value":351},"    __be32  seque;",{"type":58,"tag":138,"props":353,"children":354},{"style":157},[355],{"type":63,"value":356},"    /* 8      4    */\n",{"type":58,"tag":138,"props":358,"children":359},{"class":140,"line":41},[360,364],{"type":58,"tag":138,"props":361,"children":362},{"style":151},[363],{"type":63,"value":224},{"type":58,"tag":138,"props":365,"children":366},{"style":157},[367],{"type":63,"value":229},{"type":58,"tag":138,"props":369,"children":370},{"class":140,"line":232},[371,375],{"type":58,"tag":138,"props":372,"children":373},{"style":151},[374],{"type":63,"value":238},{"type":58,"tag":138,"props":376,"children":377},{"style":157},[378],{"type":63,"value":243},{"type":58,"tag":138,"props":380,"children":381},{"class":140,"line":246},[382,386],{"type":58,"tag":138,"props":383,"children":384},{"style":151},[385],{"type":63,"value":252},{"type":58,"tag":138,"props":387,"children":388},{"style":157},[389],{"type":63,"value":257},{"type":58,"tag":138,"props":391,"children":392},{"class":140,"line":260},[393],{"type":58,"tag":138,"props":394,"children":395},{"style":151},[396],{"type":63,"value":266},{"type":58,"tag":398,"props":399,"children":401},"remark-box",{"kind":400},"info",[402],{"type":58,"tag":59,"props":403,"children":404},{},[405,407,412,414,419,421,427],{"type":63,"value":406},"In this hypothetical struct, ",{"type":58,"tag":134,"props":408,"children":410},{"className":409},[],[411],{"type":63,"value":277},{"type":63,"value":413}," was renamed to ",{"type":58,"tag":134,"props":415,"children":417},{"className":416},[],[418],{"type":63,"value":285},{"type":63,"value":420}," and swapped with ",{"type":58,"tag":134,"props":422,"children":424},{"className":423},[],[425],{"type":63,"value":426},"ack_seq",{"type":63,"value":428},", causing their offsets to change.",{"type":58,"tag":59,"props":430,"children":431},{},[432],{"type":58,"tag":110,"props":433,"children":434},{},[435],{"type":63,"value":436},"See the problem?",{"type":58,"tag":59,"props":438,"children":439},{},[440],{"type":63,"value":441},"Your code may rely on specific fields or offsets, which are likely to change across kernel versions.",{"type":58,"tag":443,"props":444,"children":446},"details-box",{":summary":445},"Example of some real-world kernel struct changes",[447,479],{"type":58,"tag":59,"props":448,"children":449},{},[450,452,461,463,469,471,477],{"type":63,"value":451},"In ",{"type":58,"tag":453,"props":454,"children":458},"a",{"href":455,"rel":456},"https://git.kernel.org/pub/scm/linux/kernel/git/tip/tip.git/commit/?id=026842d148b920dc28f0499ede4950dcb098d4d5",[457],"nofollow",[459],{"type":63,"value":460},"this commit",{"type":63,"value":462},", the syscall tracepoint context was modified so that the field holding the syscall number was renamed from ",{"type":58,"tag":134,"props":464,"children":466},{"className":465},[],[467],{"type":63,"value":468},"nr",{"type":63,"value":470}," to ",{"type":58,"tag":134,"props":472,"children":474},{"className":473},[],[475],{"type":63,"value":476},"__syscall_nr",{"type":63,"value":478},".",{"type":58,"tag":59,"props":480,"children":481},{},[482,484,491,493,498,500,506],{"type":63,"value":483},"And as explained ",{"type":58,"tag":453,"props":485,"children":488},{"href":486,"rel":487},"https://tanelpoder.com/posts/ebpf-pt-regs-error-on-linux-blame-fred/",[457],[489],{"type":63,"value":490},"here",{"type":63,"value":492},", the introduction of the ",{"type":58,"tag":110,"props":494,"children":495},{},[496],{"type":63,"value":497},"FRED",{"type":63,"value":499}," (Flexible Return and Event Delivery) mechanism on x86 (kernel v6.9) altered the way ",{"type":58,"tag":134,"props":501,"children":503},{"className":502},[],[504],{"type":63,"value":505},"pt_regs",{"type":63,"value":507}," are stored on the stack, adding padding and moving register offsets.",{"type":58,"tag":59,"props":509,"children":510},{},[511],{"type":63,"value":512},"Since the eBPF program itself has no control over these changes, theres an inherent need for a solution to ensure the portability of eBPF programs.",{"type":58,"tag":514,"props":515,"children":517},"h2",{"id":516},"bpf-co-re-compile-once-run-everywhere",[518],{"type":63,"value":519},"BPF CO-RE (Compile Once  Run Everywhere)",{"type":58,"tag":59,"props":521,"children":522},{},[523,525,531],{"type":63,"value":524},"If you search online, you'll find plenty of resources recommending the use of ",{"type":58,"tag":453,"props":526,"children":529},{"href":527,"rel":528},"https://docs.ebpf.io/concepts/core/",[457],[530],{"type":63,"value":519},{"type":63,"value":532}," to address this issue.",{"type":58,"tag":59,"props":534,"children":535},{},[536],{"type":63,"value":537},"In other words, rather than writing the programs like this:",{"type":58,"tag":126,"props":539,"children":547},{"className":128,"code":540,"highlights":541,"language":130,"meta":131,"style":131},"struct trace_sys_enter_execve {\n    short common_type;\n    char common_flags;\n    char common_preempt_count;\n    int common_pid;\n\n    s32 syscall_nr;        // offset=8,  size=4\n    u32 pad;               // offset=12, size=4 (pad)\n    const u8 *filename;    // offset=16, size=8\n    const u8 *const *argv; // offset=24, size=8\n    const u8 *const *envp; // offset=32, size=8\n};\n\nSEC(\"tracepoint/syscalls/sys_enter_execve\")\nint handle_execve_tp_non_core(struct trace_sys_enter_execve *ctx) {\n    const char *filename_ptr = (const char *)(ctx->filename);\n\n    u8 buf[ARGSIZE];\n    bpf_probe_read_user_str(buf, sizeof(buf), filename_ptr);\n\n    bpf_printk(\"Tracepoint triggered for execve syscall with parameter filename: %s\\n\", buf);\n    return 0;\n}\n",[141,163,177,191,205,41,232,246,260,40,542,543,544,545,546],11,12,15,16,19,[548],{"type":58,"tag":134,"props":549,"children":550},{"__ignoreMap":131},[551,565,579,593,606,620,629,643,657,687,723,757,765,773,799,841,909,917,936,960,968,1002,1023],{"type":58,"tag":138,"props":552,"children":555},{"class":553,"line":141},[140,554],"highlight",[556,560],{"type":58,"tag":138,"props":557,"children":558},{"style":145},[559],{"type":63,"value":148},{"type":58,"tag":138,"props":561,"children":562},{"style":151},[563],{"type":63,"value":564}," trace_sys_enter_execve {\n",{"type":58,"tag":138,"props":566,"children":568},{"class":567,"line":163},[140,554],[569,574],{"type":58,"tag":138,"props":570,"children":571},{"style":145},[572],{"type":63,"value":573},"    short",{"type":58,"tag":138,"props":575,"children":576},{"style":151},[577],{"type":63,"value":578}," common_type;\n",{"type":58,"tag":138,"props":580,"children":582},{"class":581,"line":177},[140,554],[583,588],{"type":58,"tag":138,"props":584,"children":585},{"style":145},[586],{"type":63,"value":587},"    char",{"type":58,"tag":138,"props":589,"children":590},{"style":151},[591],{"type":63,"value":592}," common_flags;\n",{"type":58,"tag":138,"props":594,"children":596},{"class":595,"line":191},[140,554],[597,601],{"type":58,"tag":138,"props":598,"children":599},{"style":145},[600],{"type":63,"value":587},{"type":58,"tag":138,"props":602,"children":603},{"style":151},[604],{"type":63,"value":605}," common_preempt_count;\n",{"type":58,"tag":138,"props":607,"children":609},{"class":608,"line":205},[140,554],[610,615],{"type":58,"tag":138,"props":611,"children":612},{"style":145},[613],{"type":63,"value":614},"    int",{"type":58,"tag":138,"props":616,"children":617},{"style":151},[618],{"type":63,"value":619}," common_pid;\n",{"type":58,"tag":138,"props":621,"children":623},{"class":622,"line":41},[140,554],[624],{"type":58,"tag":138,"props":625,"children":626},{"emptyLinePlaceholder":11},[627],{"type":63,"value":628},"\n",{"type":58,"tag":138,"props":630,"children":632},{"class":631,"line":232},[140,554],[633,638],{"type":58,"tag":138,"props":634,"children":635},{"style":151},[636],{"type":63,"value":637},"    s32 syscall_nr;",{"type":58,"tag":138,"props":639,"children":640},{"style":157},[641],{"type":63,"value":642},"        // offset=8,  size=4\n",{"type":58,"tag":138,"props":644,"children":646},{"class":645,"line":246},[140,554],[647,652],{"type":58,"tag":138,"props":648,"children":649},{"style":151},[650],{"type":63,"value":651},"    u32 pad;",{"type":58,"tag":138,"props":653,"children":654},{"style":157},[655],{"type":63,"value":656},"               // offset=12, size=4 (pad)\n",{"type":58,"tag":138,"props":658,"children":660},{"class":659,"line":260},[140,554],[661,666,671,677,682],{"type":58,"tag":138,"props":662,"children":663},{"style":145},[664],{"type":63,"value":665},"    const",{"type":58,"tag":138,"props":667,"children":668},{"style":151},[669],{"type":63,"value":670}," u8 ",{"type":58,"tag":138,"props":672,"children":674},{"style":673},"--shiki-default:#D4D4D4",[675],{"type":63,"value":676},"*",{"type":58,"tag":138,"props":678,"children":679},{"style":151},[680],{"type":63,"value":681},"filename;",{"type":58,"tag":138,"props":683,"children":684},{"style":157},[685],{"type":63,"value":686},"    // offset=16, size=8\n",{"type":58,"tag":138,"props":688,"children":690},{"class":689,"line":40},[140,554],[691,695,699,703,708,713,718],{"type":58,"tag":138,"props":692,"children":693},{"style":145},[694],{"type":63,"value":665},{"type":58,"tag":138,"props":696,"children":697},{"style":151},[698],{"type":63,"value":670},{"type":58,"tag":138,"props":700,"children":701},{"style":673},[702],{"type":63,"value":676},{"type":58,"tag":138,"props":704,"children":705},{"style":145},[706],{"type":63,"value":707},"const",{"type":58,"tag":138,"props":709,"children":710},{"style":673},[711],{"type":63,"value":712}," *",{"type":58,"tag":138,"props":714,"children":715},{"style":151},[716],{"type":63,"value":717},"argv;",{"type":58,"tag":138,"props":719,"children":720},{"style":157},[721],{"type":63,"value":722}," // offset=24, size=8\n",{"type":58,"tag":138,"props":724,"children":726},{"class":725,"line":542},[140,554],[727,731,735,739,743,747,752],{"type":58,"tag":138,"props":728,"children":729},{"style":145},[730],{"type":63,"value":665},{"type":58,"tag":138,"props":732,"children":733},{"style":151},[734],{"type":63,"value":670},{"type":58,"tag":138,"props":736,"children":737},{"style":673},[738],{"type":63,"value":676},{"type":58,"tag":138,"props":740,"children":741},{"style":145},[742],{"type":63,"value":707},{"type":58,"tag":138,"props":744,"children":745},{"style":673},[746],{"type":63,"value":712},{"type":58,"tag":138,"props":748,"children":749},{"style":151},[750],{"type":63,"value":751},"envp;",{"type":58,"tag":138,"props":753,"children":754},{"style":157},[755],{"type":63,"value":756}," // offset=32, size=8\n",{"type":58,"tag":138,"props":758,"children":760},{"class":759,"line":543},[140,554],[761],{"type":58,"tag":138,"props":762,"children":763},{"style":151},[764],{"type":63,"value":266},{"type":58,"tag":138,"props":766,"children":768},{"class":140,"line":767},13,[769],{"type":58,"tag":138,"props":770,"children":771},{"emptyLinePlaceholder":11},[772],{"type":63,"value":628},{"type":58,"tag":138,"props":774,"children":776},{"class":140,"line":775},14,[777,783,788,794],{"type":58,"tag":138,"props":778,"children":780},{"style":779},"--shiki-default:#DCDCAA",[781],{"type":63,"value":782},"SEC",{"type":58,"tag":138,"props":784,"children":785},{"style":151},[786],{"type":63,"value":787},"(",{"type":58,"tag":138,"props":789,"children":791},{"style":790},"--shiki-default:#CE9178",[792],{"type":63,"value":793},"\"tracepoint/syscalls/sys_enter_execve\"",{"type":58,"tag":138,"props":795,"children":796},{"style":151},[797],{"type":63,"value":798},")\n",{"type":58,"tag":138,"props":800,"children":802},{"class":801,"line":544},[140,554],[803,808,813,817,821,826,830,836],{"type":58,"tag":138,"props":804,"children":805},{"style":145},[806],{"type":63,"value":807},"int",{"type":58,"tag":138,"props":809,"children":810},{"style":779},[811],{"type":63,"value":812}," handle_execve_tp_non_core",{"type":58,"tag":138,"props":814,"children":815},{"style":151},[816],{"type":63,"value":787},{"type":58,"tag":138,"props":818,"children":819},{"style":145},[820],{"type":63,"value":148},{"type":58,"tag":138,"props":822,"children":823},{"style":151},[824],{"type":63,"value":825}," trace_sys_enter_execve ",{"type":58,"tag":138,"props":827,"children":828},{"style":673},[829],{"type":63,"value":676},{"type":58,"tag":138,"props":831,"children":833},{"style":832},"--shiki-default:#9CDCFE",[834],{"type":63,"value":835},"ctx",{"type":58,"tag":138,"props":837,"children":838},{"style":151},[839],{"type":63,"value":840},") {\n",{"type":58,"tag":138,"props":842,"children":844},{"class":843,"line":545},[140,554],[845,849,854,858,863,868,873,877,881,885,890,894,899,904],{"type":58,"tag":138,"props":846,"children":847},{"style":145},[848],{"type":63,"value":665},{"type":58,"tag":138,"props":850,"children":851},{"style":145},[852],{"type":63,"value":853}," char",{"type":58,"tag":138,"props":855,"children":856},{"style":673},[857],{"type":63,"value":712},{"type":58,"tag":138,"props":859,"children":860},{"style":151},[861],{"type":63,"value":862},"filename_ptr ",{"type":58,"tag":138,"props":864,"children":865},{"style":673},[866],{"type":63,"value":867},"=",{"type":58,"tag":138,"props":869,"children":870},{"style":151},[871],{"type":63,"value":872}," (",{"type":58,"tag":138,"props":874,"children":875},{"style":145},[876],{"type":63,"value":707},{"type":58,"tag":138,"props":878,"children":879},{"style":145},[880],{"type":63,"value":853},{"type":58,"tag":138,"props":882,"children":883},{"style":673},[884],{"type":63,"value":712},{"type":58,"tag":138,"props":886,"children":887},{"style":151},[888],{"type":63,"value":889},")(",{"type":58,"tag":138,"props":891,"children":892},{"style":832},[893],{"type":63,"value":835},{"type":58,"tag":138,"props":895,"children":896},{"style":151},[897],{"type":63,"value":898},"->",{"type":58,"tag":138,"props":900,"children":901},{"style":832},[902],{"type":63,"value":903},"filename",{"type":58,"tag":138,"props":905,"children":906},{"style":151},[907],{"type":63,"value":908},");\n",{"type":58,"tag":138,"props":910,"children":912},{"class":140,"line":911},17,[913],{"type":58,"tag":138,"props":914,"children":915},{"emptyLinePlaceholder":11},[916],{"type":63,"value":628},{"type":58,"tag":138,"props":918,"children":920},{"class":140,"line":919},18,[921,926,931],{"type":58,"tag":138,"props":922,"children":923},{"style":151},[924],{"type":63,"value":925},"    u8 ",{"type":58,"tag":138,"props":927,"children":928},{"style":832},[929],{"type":63,"value":930},"buf",{"type":58,"tag":138,"props":932,"children":933},{"style":151},[934],{"type":63,"value":935},"[ARGSIZE];\n",{"type":58,"tag":138,"props":937,"children":939},{"class":938,"line":546},[140,554],[940,945,950,955],{"type":58,"tag":138,"props":941,"children":942},{"style":779},[943],{"type":63,"value":944},"    bpf_probe_read_user_str",{"type":58,"tag":138,"props":946,"children":947},{"style":151},[948],{"type":63,"value":949},"(buf, ",{"type":58,"tag":138,"props":951,"children":952},{"style":145},[953],{"type":63,"value":954},"sizeof",{"type":58,"tag":138,"props":956,"children":957},{"style":151},[958],{"type":63,"value":959},"(buf), filename_ptr);\n",{"type":58,"tag":138,"props":961,"children":963},{"class":140,"line":962},20,[964],{"type":58,"tag":138,"props":965,"children":966},{"emptyLinePlaceholder":11},[967],{"type":63,"value":628},{"type":58,"tag":138,"props":969,"children":971},{"class":140,"line":970},21,[972,977,981,986,992,997],{"type":58,"tag":138,"props":973,"children":974},{"style":779},[975],{"type":63,"value":976},"    bpf_printk",{"type":58,"tag":138,"props":978,"children":979},{"style":151},[980],{"type":63,"value":787},{"type":58,"tag":138,"props":982,"children":983},{"style":790},[984],{"type":63,"value":985},"\"Tracepoint triggered for execve syscall with parameter filename: %s",{"type":58,"tag":138,"props":987,"children":989},{"style":988},"--shiki-default:#D7BA7D",[990],{"type":63,"value":991},"\\n",{"type":58,"tag":138,"props":993,"children":994},{"style":790},[995],{"type":63,"value":996},"\"",{"type":58,"tag":138,"props":998,"children":999},{"style":151},[1000],{"type":63,"value":1001},", buf);\n",{"type":58,"tag":138,"props":1003,"children":1005},{"class":140,"line":1004},22,[1006,1012,1018],{"type":58,"tag":138,"props":1007,"children":1009},{"style":1008},"--shiki-default:#C586C0",[1010],{"type":63,"value":1011},"    return",{"type":58,"tag":138,"props":1013,"children":1015},{"style":1014},"--shiki-default:#B5CEA8",[1016],{"type":63,"value":1017}," 0",{"type":58,"tag":138,"props":1019,"children":1020},{"style":151},[1021],{"type":63,"value":1022},";\n",{"type":58,"tag":138,"props":1024,"children":1026},{"class":140,"line":1025},23,[1027],{"type":58,"tag":138,"props":1028,"children":1029},{"style":151},[1030],{"type":63,"value":1031},"}\n",{"type":58,"tag":59,"props":1033,"children":1034},{},[1035,1037,1043],{"type":63,"value":1036},"You should replace the lines of code that access the kernel struct context with the ",{"type":58,"tag":134,"props":1038,"children":1040},{"className":1039},[],[1041],{"type":63,"value":1042},"BPF_CORE_*",{"type":63,"value":1044}," family of helper functions, which enables access to struct fields in a way that adapts across kernel versions:",{"type":58,"tag":126,"props":1046,"children":1049},{"className":128,"code":1047,"highlights":1048,"language":130,"meta":131,"style":131},"SEC(\"tracepoint/syscalls/sys_enter_execve\")\nint handle_execve_tp(struct trace_event_raw_sys_enter *ctx) {\n    char *filename_ptr = (char *)BPF_CORE_READ(ctx, args[0]);\n\n    u8 filename[ARGSIZE];\n    bpf_core_read_user_str(&filename, sizeof(filename), filename_ptr);\n\n    bpf_printk(\"Tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s\\n\", filename);\n    return 0;\n}\n",[163,177,41],[1050],{"type":58,"tag":134,"props":1051,"children":1052},{"__ignoreMap":131},[1053,1072,1110,1178,1185,1200,1232,1239,1268,1283],{"type":58,"tag":138,"props":1054,"children":1055},{"class":140,"line":141},[1056,1060,1064,1068],{"type":58,"tag":138,"props":1057,"children":1058},{"style":779},[1059],{"type":63,"value":782},{"type":58,"tag":138,"props":1061,"children":1062},{"style":151},[1063],{"type":63,"value":787},{"type":58,"tag":138,"props":1065,"children":1066},{"style":790},[1067],{"type":63,"value":793},{"type":58,"tag":138,"props":1069,"children":1070},{"style":151},[1071],{"type":63,"value":798},{"type":58,"tag":138,"props":1073,"children":1075},{"class":1074,"line":163},[140,554],[1076,1080,1085,1089,1093,1098,1102,1106],{"type":58,"tag":138,"props":1077,"children":1078},{"style":145},[1079],{"type":63,"value":807},{"type":58,"tag":138,"props":1081,"children":1082},{"style":779},[1083],{"type":63,"value":1084}," handle_execve_tp",{"type":58,"tag":138,"props":1086,"children":1087},{"style":151},[1088],{"type":63,"value":787},{"type":58,"tag":138,"props":1090,"children":1091},{"style":145},[1092],{"type":63,"value":148},{"type":58,"tag":138,"props":1094,"children":1095},{"style":151},[1096],{"type":63,"value":1097}," trace_event_raw_sys_enter ",{"type":58,"tag":138,"props":1099,"children":1100},{"style":673},[1101],{"type":63,"value":676},{"type":58,"tag":138,"props":1103,"children":1104},{"style":832},[1105],{"type":63,"value":835},{"type":58,"tag":138,"props":1107,"children":1108},{"style":151},[1109],{"type":63,"value":840},{"type":58,"tag":138,"props":1111,"children":1113},{"class":1112,"line":177},[140,554],[1114,1118,1122,1126,1130,1134,1139,1143,1148,1153,1158,1163,1168,1173],{"type":58,"tag":138,"props":1115,"children":1116},{"style":145},[1117],{"type":63,"value":587},{"type":58,"tag":138,"props":1119,"children":1120},{"style":673},[1121],{"type":63,"value":712},{"type":58,"tag":138,"props":1123,"children":1124},{"style":151},[1125],{"type":63,"value":862},{"type":58,"tag":138,"props":1127,"children":1128},{"style":673},[1129],{"type":63,"value":867},{"type":58,"tag":138,"props":1131,"children":1132},{"style":151},[1133],{"type":63,"value":872},{"type":58,"tag":138,"props":1135,"children":1136},{"style":145},[1137],{"type":63,"value":1138},"char",{"type":58,"tag":138,"props":1140,"children":1141},{"style":673},[1142],{"type":63,"value":712},{"type":58,"tag":138,"props":1144,"children":1145},{"style":151},[1146],{"type":63,"value":1147},")",{"type":58,"tag":138,"props":1149,"children":1150},{"style":779},[1151],{"type":63,"value":1152},"BPF_CORE_READ",{"type":58,"tag":138,"props":1154,"children":1155},{"style":151},[1156],{"type":63,"value":1157},"(ctx, ",{"type":58,"tag":138,"props":1159,"children":1160},{"style":832},[1161],{"type":63,"value":1162},"args",{"type":58,"tag":138,"props":1164,"children":1165},{"style":151},[1166],{"type":63,"value":1167},"[",{"type":58,"tag":138,"props":1169,"children":1170},{"style":1014},[1171],{"type":63,"value":1172},"0",{"type":58,"tag":138,"props":1174,"children":1175},{"style":151},[1176],{"type":63,"value":1177},"]);\n",{"type":58,"tag":138,"props":1179,"children":1180},{"class":140,"line":191},[1181],{"type":58,"tag":138,"props":1182,"children":1183},{"emptyLinePlaceholder":11},[1184],{"type":63,"value":628},{"type":58,"tag":138,"props":1186,"children":1187},{"class":140,"line":205},[1188,1192,1196],{"type":58,"tag":138,"props":1189,"children":1190},{"style":151},[1191],{"type":63,"value":925},{"type":58,"tag":138,"props":1193,"children":1194},{"style":832},[1195],{"type":63,"value":903},{"type":58,"tag":138,"props":1197,"children":1198},{"style":151},[1199],{"type":63,"value":935},{"type":58,"tag":138,"props":1201,"children":1203},{"class":1202,"line":41},[140,554],[1204,1209,1213,1218,1223,1227],{"type":58,"tag":138,"props":1205,"children":1206},{"style":779},[1207],{"type":63,"value":1208},"    bpf_core_read_user_str",{"type":58,"tag":138,"props":1210,"children":1211},{"style":151},[1212],{"type":63,"value":787},{"type":58,"tag":138,"props":1214,"children":1215},{"style":673},[1216],{"type":63,"value":1217},"&",{"type":58,"tag":138,"props":1219,"children":1220},{"style":151},[1221],{"type":63,"value":1222},"filename, ",{"type":58,"tag":138,"props":1224,"children":1225},{"style":145},[1226],{"type":63,"value":954},{"type":58,"tag":138,"props":1228,"children":1229},{"style":151},[1230],{"type":63,"value":1231},"(filename), filename_ptr);\n",{"type":58,"tag":138,"props":1233,"children":1234},{"class":140,"line":232},[1235],{"type":58,"tag":138,"props":1236,"children":1237},{"emptyLinePlaceholder":11},[1238],{"type":63,"value":628},{"type":58,"tag":138,"props":1240,"children":1241},{"class":140,"line":246},[1242,1246,1250,1255,1259,1263],{"type":58,"tag":138,"props":1243,"children":1244},{"style":779},[1245],{"type":63,"value":976},{"type":58,"tag":138,"props":1247,"children":1248},{"style":151},[1249],{"type":63,"value":787},{"type":58,"tag":138,"props":1251,"children":1252},{"style":790},[1253],{"type":63,"value":1254},"\"Tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s",{"type":58,"tag":138,"props":1256,"children":1257},{"style":988},[1258],{"type":63,"value":991},{"type":58,"tag":138,"props":1260,"children":1261},{"style":790},[1262],{"type":63,"value":996},{"type":58,"tag":138,"props":1264,"children":1265},{"style":151},[1266],{"type":63,"value":1267},", filename);\n",{"type":58,"tag":138,"props":1269,"children":1270},{"class":140,"line":260},[1271,1275,1279],{"type":58,"tag":138,"props":1272,"children":1273},{"style":1008},[1274],{"type":63,"value":1011},{"type":58,"tag":138,"props":1276,"children":1277},{"style":1014},[1278],{"type":63,"value":1017},{"type":58,"tag":138,"props":1280,"children":1281},{"style":151},[1282],{"type":63,"value":1022},{"type":58,"tag":138,"props":1284,"children":1285},{"class":140,"line":40},[1286],{"type":58,"tag":138,"props":1287,"children":1288},{"style":151},[1289],{"type":63,"value":1031},{"type":58,"tag":398,"props":1291,"children":1292},{"kind":400},[1293,1313],{"type":58,"tag":59,"props":1294,"children":1295},{},[1296,1298,1304,1306,1312],{"type":63,"value":1297}," If you look carefully, also the input context was changed. Instead of using the hardcoded ",{"type":58,"tag":134,"props":1299,"children":1301},{"className":1300},[],[1302],{"type":63,"value":1303},"struct trace_sys_enter_execve",{"type":63,"value":1305},", we use ",{"type":58,"tag":134,"props":1307,"children":1309},{"className":1308},[],[1310],{"type":63,"value":1311},"struct trace_event_raw_sys_enter",{"type":63,"value":478},{"type":58,"tag":59,"props":1314,"children":1315},{},[1316],{"type":63,"value":1317},"Why is that? Read along.",{"type":58,"tag":59,"props":1319,"children":1320},{},[1321,1323,1328],{"type":63,"value":1322},"In short, the ",{"type":58,"tag":134,"props":1324,"children":1326},{"className":1325},[],[1327],{"type":63,"value":1042},{"type":63,"value":1329}," family of helpers enables relocatable reads of kernel structs.",{"type":58,"tag":59,"props":1331,"children":1332},{},[1333,1335,1340],{"type":63,"value":1334},"So if a certain struct field (like ",{"type":58,"tag":134,"props":1336,"children":1338},{"className":1337},[],[1339],{"type":63,"value":903},{"type":63,"value":1341}," in the example) sits at a different offset in another kernel version, these helpers can still locate and read it correctly.",{"type":58,"tag":443,"props":1343,"children":1345},{":summary":1344},"More information about the `BPF_CORE_*` family of helpers",[1346,1358,1417,1430,1443],{"type":58,"tag":59,"props":1347,"children":1348},{},[1349,1351,1356],{"type":63,"value":1350},"All ",{"type":58,"tag":134,"props":1352,"children":1354},{"className":1353},[],[1355],{"type":63,"value":1042},{"type":63,"value":1357}," helpers let your eBPF program read fields from kernel structs in a way that survives kernel changes (renames, field reordering, different offsets) using BTF-based CO-RE relocations:",{"type":58,"tag":1359,"props":1360,"children":1361},"ul",{},[1362,1374,1393,1412],{"type":58,"tag":1363,"props":1364,"children":1365},"li",{},[1366,1372],{"type":58,"tag":134,"props":1367,"children":1369},{"className":1368},[],[1370],{"type":63,"value":1371},"BPF_CORE_READ(src, field, [nested_field, ...])",{"type":63,"value":1373},"  Reads the value of a (possibly nested) field from a kernel struct and on failure returns a zero value, which is not that ideal, since you cant distinguish real zero read from failed read.",{"type":58,"tag":1363,"props":1375,"children":1376},{},[1377,1383,1385,1391],{"type":58,"tag":134,"props":1378,"children":1380},{"className":1379},[],[1381],{"type":63,"value":1382},"BPF_CORE_READ_INTO(&dst, src, field, [nested_field, ...])",{"type":63,"value":1384},"  Reads into ",{"type":58,"tag":134,"props":1386,"children":1388},{"className":1387},[],[1389],{"type":63,"value":1390},"dst",{"type":63,"value":1392}," and returns a zero value on success and a negative value on error.",{"type":58,"tag":1363,"props":1394,"children":1395},{},[1396,1402,1404,1410],{"type":58,"tag":134,"props":1397,"children":1399},{"className":1398},[],[1400],{"type":63,"value":1401},"BPF_CORE_READ_USER",{"type":63,"value":1403}," / ",{"type":58,"tag":134,"props":1405,"children":1407},{"className":1406},[],[1408],{"type":63,"value":1409},"BPF_CORE_READ_USER_INTO",{"type":63,"value":1411},"  Same as above, but for user-memory pointers.",{"type":58,"tag":1363,"props":1413,"children":1414},{},[1415],{"type":63,"value":1416},"and others..",{"type":58,"tag":59,"props":1418,"children":1419},{},[1420,1422,1428],{"type":63,"value":1421},"You'll also see developers using ",{"type":58,"tag":134,"props":1423,"children":1425},{"className":1424},[],[1426],{"type":63,"value":1427},"bpf_core_read()",{"type":63,"value":1429}," or similar lower-case helpers.",{"type":58,"tag":59,"props":1431,"children":1432},{},[1433,1435,1441],{"type":63,"value":1434},"These are low-level functions that copy bytes from a relocatable address into a buffer and return an error code. In contrast, ",{"type":58,"tag":134,"props":1436,"children":1438},{"className":1437},[],[1439],{"type":63,"value":1440},"BPF_CORE_READ()",{"type":63,"value":1442}," is a macro built on top that automatically follows pointer chains and applies CO-RE relocations, making it especially convenient for accessing nested kernel structs.",{"type":58,"tag":126,"props":1444,"children":1446},{"className":128,"code":1445,"language":130,"meta":131,"style":131},"struct task_struct *task = bpf_get_current_task();\n\n// Using BPF_CORE_READ: follows pointer chain automatically\nu32 pid = BPF_CORE_READ(task, real_parent, pid);\n\n// Using bpf_core_read: you must spell out the destination and size\nu32 pid2 = 0;\nbpf_core_read(&pid2, sizeof(pid2), &task->real_parent->pid);\n",[1447],{"type":58,"tag":134,"props":1448,"children":1449},{"__ignoreMap":131},[1450,1485,1492,1500,1522,1529,1537,1557],{"type":58,"tag":138,"props":1451,"children":1452},{"class":140,"line":141},[1453,1457,1462,1466,1471,1475,1480],{"type":58,"tag":138,"props":1454,"children":1455},{"style":145},[1456],{"type":63,"value":148},{"type":58,"tag":138,"props":1458,"children":1459},{"style":151},[1460],{"type":63,"value":1461}," task_struct ",{"type":58,"tag":138,"props":1463,"children":1464},{"style":673},[1465],{"type":63,"value":676},{"type":58,"tag":138,"props":1467,"children":1468},{"style":151},[1469],{"type":63,"value":1470},"task ",{"type":58,"tag":138,"props":1472,"children":1473},{"style":673},[1474],{"type":63,"value":867},{"type":58,"tag":138,"props":1476,"children":1477},{"style":779},[1478],{"type":63,"value":1479}," bpf_get_current_task",{"type":58,"tag":138,"props":1481,"children":1482},{"style":151},[1483],{"type":63,"value":1484},"();\n",{"type":58,"tag":138,"props":1486,"children":1487},{"class":140,"line":163},[1488],{"type":58,"tag":138,"props":1489,"children":1490},{"emptyLinePlaceholder":11},[1491],{"type":63,"value":628},{"type":58,"tag":138,"props":1493,"children":1494},{"class":140,"line":177},[1495],{"type":58,"tag":138,"props":1496,"children":1497},{"style":157},[1498],{"type":63,"value":1499},"// Using BPF_CORE_READ: follows pointer chain automatically\n",{"type":58,"tag":138,"props":1501,"children":1502},{"class":140,"line":191},[1503,1508,1512,1517],{"type":58,"tag":138,"props":1504,"children":1505},{"style":151},[1506],{"type":63,"value":1507},"u32 pid ",{"type":58,"tag":138,"props":1509,"children":1510},{"style":673},[1511],{"type":63,"value":867},{"type":58,"tag":138,"props":1513,"children":1514},{"style":779},[1515],{"type":63,"value":1516}," BPF_CORE_READ",{"type":58,"tag":138,"props":1518,"children":1519},{"style":151},[1520],{"type":63,"value":1521},"(task, real_parent, pid);\n",{"type":58,"tag":138,"props":1523,"children":1524},{"class":140,"line":205},[1525],{"type":58,"tag":138,"props":1526,"children":1527},{"emptyLinePlaceholder":11},[1528],{"type":63,"value":628},{"type":58,"tag":138,"props":1530,"children":1531},{"class":140,"line":41},[1532],{"type":58,"tag":138,"props":1533,"children":1534},{"style":157},[1535],{"type":63,"value":1536},"// Using bpf_core_read: you must spell out the destination and size\n",{"type":58,"tag":138,"props":1538,"children":1539},{"class":140,"line":232},[1540,1545,1549,1553],{"type":58,"tag":138,"props":1541,"children":1542},{"style":151},[1543],{"type":63,"value":1544},"u32 pid2 ",{"type":58,"tag":138,"props":1546,"children":1547},{"style":673},[1548],{"type":63,"value":867},{"type":58,"tag":138,"props":1550,"children":1551},{"style":1014},[1552],{"type":63,"value":1017},{"type":58,"tag":138,"props":1554,"children":1555},{"style":151},[1556],{"type":63,"value":1022},{"type":58,"tag":138,"props":1558,"children":1559},{"class":140,"line":246},[1560,1565,1569,1573,1578,1583,1587,1592,1596,1601,1605,1610,1614,1619],{"type":58,"tag":138,"props":1561,"children":1562},{"style":779},[1563],{"type":63,"value":1564},"bpf_core_read",{"type":58,"tag":138,"props":1566,"children":1567},{"style":151},[1568],{"type":63,"value":787},{"type":58,"tag":138,"props":1570,"children":1571},{"style":673},[1572],{"type":63,"value":1217},{"type":58,"tag":138,"props":1574,"children":1575},{"style":832},[1576],{"type":63,"value":1577},"pid2",{"type":58,"tag":138,"props":1579,"children":1580},{"style":151},[1581],{"type":63,"value":1582},", ",{"type":58,"tag":138,"props":1584,"children":1585},{"style":145},[1586],{"type":63,"value":954},{"type":58,"tag":138,"props":1588,"children":1589},{"style":151},[1590],{"type":63,"value":1591},"(pid2), ",{"type":58,"tag":138,"props":1593,"children":1594},{"style":673},[1595],{"type":63,"value":1217},{"type":58,"tag":138,"props":1597,"children":1598},{"style":151},[1599],{"type":63,"value":1600},"task",{"type":58,"tag":138,"props":1602,"children":1603},{"style":673},[1604],{"type":63,"value":898},{"type":58,"tag":138,"props":1606,"children":1607},{"style":151},[1608],{"type":63,"value":1609},"real_parent",{"type":58,"tag":138,"props":1611,"children":1612},{"style":673},[1613],{"type":63,"value":898},{"type":58,"tag":138,"props":1615,"children":1616},{"style":832},[1617],{"type":63,"value":1618},"pid",{"type":58,"tag":138,"props":1620,"children":1621},{"style":151},[1622],{"type":63,"value":908},{"type":58,"tag":59,"props":1624,"children":1625},{},[1626],{"type":63,"value":1627},"Under the hood, this is made possible by BPF CO-RE relocation information and BPF Type Format.",{"type":58,"tag":59,"props":1629,"children":1630},{},[1631,1636],{"type":58,"tag":110,"props":1632,"children":1633},{},[1634],{"type":63,"value":1635},"Wait, what? CO-RE relocation information? BTF?",{"type":63,"value":1637}," Read along.",{"type":58,"tag":514,"props":1639,"children":1641},{"id":1640},"vmlinuxh-header-file",[1642],{"type":63,"value":1643},"vmlinux.h Header file",{"type":58,"tag":59,"props":1645,"children":1646},{},[1647,1649,1655],{"type":63,"value":1648},"If you peek into almost any production eBPF codebase, youll notice all of them include (or generate during the build-time) the ",{"type":58,"tag":134,"props":1650,"children":1652},{"className":1651},[],[1653],{"type":63,"value":1654},"vmlinux.h",{"type":63,"value":1656}," header.",{"type":58,"tag":59,"props":1658,"children":1659},{},[1660,1662,1668],{"type":63,"value":1661},"There's one also in our ",{"type":58,"tag":134,"props":1663,"children":1665},{"className":1664},[],[1666],{"type":63,"value":1667},"labs/lab2",{"type":63,"value":1669}," directory for this lab - open it.",{"type":58,"tag":59,"props":1671,"children":1672},{},[1673,1675,1681],{"type":63,"value":1674},"This file contains definitions for all kernel structs (like ",{"type":58,"tag":134,"props":1676,"children":1678},{"className":1677},[],[1679],{"type":63,"value":1680},"trace_event_raw_sys_enter",{"type":63,"value":1682}," in the example above), generated based on the currently running kernel.",{"type":58,"tag":443,"props":1684,"children":1686},{":summary":1685},"How does one create a vmlinux.h file?",[1687,1692,1754],{"type":58,"tag":59,"props":1688,"children":1689},{},[1690],{"type":63,"value":1691}," You can generate this header file using:",{"type":58,"tag":126,"props":1693,"children":1697},{"className":1694,"code":1695,"language":1696,"meta":131,"style":131},"language-bash shiki shiki-themes slack-dark","sudo bpftool btf dump file /sys/kernel/btf/vmlinux format c > vmlinux.h\n","bash",[1698],{"type":58,"tag":134,"props":1699,"children":1700},{"__ignoreMap":131},[1701],{"type":58,"tag":138,"props":1702,"children":1703},{"class":140,"line":141},[1704,1709,1714,1719,1724,1729,1734,1739,1744,1749],{"type":58,"tag":138,"props":1705,"children":1706},{"style":779},[1707],{"type":63,"value":1708},"sudo",{"type":58,"tag":138,"props":1710,"children":1711},{"style":790},[1712],{"type":63,"value":1713}," bpftool",{"type":58,"tag":138,"props":1715,"children":1716},{"style":790},[1717],{"type":63,"value":1718}," btf",{"type":58,"tag":138,"props":1720,"children":1721},{"style":790},[1722],{"type":63,"value":1723}," dump",{"type":58,"tag":138,"props":1725,"children":1726},{"style":790},[1727],{"type":63,"value":1728}," file",{"type":58,"tag":138,"props":1730,"children":1731},{"style":790},[1732],{"type":63,"value":1733}," /sys/kernel/btf/vmlinux",{"type":58,"tag":138,"props":1735,"children":1736},{"style":790},[1737],{"type":63,"value":1738}," format",{"type":58,"tag":138,"props":1740,"children":1741},{"style":790},[1742],{"type":63,"value":1743}," c",{"type":58,"tag":138,"props":1745,"children":1746},{"style":673},[1747],{"type":63,"value":1748}," >",{"type":58,"tag":138,"props":1750,"children":1751},{"style":790},[1752],{"type":63,"value":1753}," vmlinux.h\n",{"type":58,"tag":59,"props":1755,"children":1756},{},[1757,1759,1765],{"type":63,"value":1758},"But as mentioned above, these files are usually build during build time, e.g. in the ",{"type":58,"tag":134,"props":1760,"children":1762},{"className":1761},[],[1763],{"type":63,"value":1764},"Makefile",{"type":63,"value":478},{"type":58,"tag":59,"props":1767,"children":1768},{},[1769],{"type":63,"value":1770},"Heres where it gets interesting  this header includes a few special lines at both the top and bottom:",{"type":58,"tag":126,"props":1772,"children":1774},{"className":128,"code":1773,"language":130,"meta":131,"style":131},"#ifndef BPF_NO_PRESERVE_ACCESS_INDEX\n#pragma clang attribute push (__attribute__((preserve_access_index)), apply_to = record)\n#endif\n...\n# Kernel Struct definitions\n...\n#ifndef BPF_NO_PRESERVE_ACCESS_INDEX\n#pragma clang attribute pop\n#endif\n",[1775],{"type":58,"tag":134,"props":1776,"children":1777},{"__ignoreMap":131},[1778,1791,1857,1865,1873,1881,1888,1899,1919],{"type":58,"tag":138,"props":1779,"children":1780},{"class":140,"line":141},[1781,1786],{"type":58,"tag":138,"props":1782,"children":1783},{"style":1008},[1784],{"type":63,"value":1785},"#ifndef",{"type":58,"tag":138,"props":1787,"children":1788},{"style":779},[1789],{"type":63,"value":1790}," BPF_NO_PRESERVE_ACCESS_INDEX\n",{"type":58,"tag":138,"props":1792,"children":1793},{"class":140,"line":163},[1794,1799,1804,1809,1814,1818,1823,1828,1833,1838,1843,1848,1853],{"type":58,"tag":138,"props":1795,"children":1796},{"style":1008},[1797],{"type":63,"value":1798},"#pragma",{"type":58,"tag":138,"props":1800,"children":1801},{"style":832},[1802],{"type":63,"value":1803}," clang",{"type":58,"tag":138,"props":1805,"children":1806},{"style":832},[1807],{"type":63,"value":1808}," attribute",{"type":58,"tag":138,"props":1810,"children":1811},{"style":832},[1812],{"type":63,"value":1813}," push",{"type":58,"tag":138,"props":1815,"children":1816},{"style":145},[1817],{"type":63,"value":872},{"type":58,"tag":138,"props":1819,"children":1820},{"style":832},[1821],{"type":63,"value":1822},"__attribute__",{"type":58,"tag":138,"props":1824,"children":1825},{"style":145},[1826],{"type":63,"value":1827},"((",{"type":58,"tag":138,"props":1829,"children":1830},{"style":832},[1831],{"type":63,"value":1832},"preserve_access_index",{"type":58,"tag":138,"props":1834,"children":1835},{"style":145},[1836],{"type":63,"value":1837},")), ",{"type":58,"tag":138,"props":1839,"children":1840},{"style":832},[1841],{"type":63,"value":1842},"apply_to",{"type":58,"tag":138,"props":1844,"children":1845},{"style":145},[1846],{"type":63,"value":1847}," = ",{"type":58,"tag":138,"props":1849,"children":1850},{"style":832},[1851],{"type":63,"value":1852},"record",{"type":58,"tag":138,"props":1854,"children":1855},{"style":145},[1856],{"type":63,"value":798},{"type":58,"tag":138,"props":1858,"children":1859},{"class":140,"line":177},[1860],{"type":58,"tag":138,"props":1861,"children":1862},{"style":1008},[1863],{"type":63,"value":1864},"#endif\n",{"type":58,"tag":138,"props":1866,"children":1867},{"class":140,"line":191},[1868],{"type":58,"tag":138,"props":1869,"children":1870},{"style":151},[1871],{"type":63,"value":1872},"...\n",{"type":58,"tag":138,"props":1874,"children":1875},{"class":140,"line":205},[1876],{"type":58,"tag":138,"props":1877,"children":1878},{"style":151},[1879],{"type":63,"value":1880},"# Kernel Struct definitions\n",{"type":58,"tag":138,"props":1882,"children":1883},{"class":140,"line":41},[1884],{"type":58,"tag":138,"props":1885,"children":1886},{"style":151},[1887],{"type":63,"value":1872},{"type":58,"tag":138,"props":1889,"children":1890},{"class":140,"line":232},[1891,1895],{"type":58,"tag":138,"props":1892,"children":1893},{"style":1008},[1894],{"type":63,"value":1785},{"type":58,"tag":138,"props":1896,"children":1897},{"style":779},[1898],{"type":63,"value":1790},{"type":58,"tag":138,"props":1900,"children":1901},{"class":140,"line":246},[1902,1906,1910,1914],{"type":58,"tag":138,"props":1903,"children":1904},{"style":1008},[1905],{"type":63,"value":1798},{"type":58,"tag":138,"props":1907,"children":1908},{"style":832},[1909],{"type":63,"value":1803},{"type":58,"tag":138,"props":1911,"children":1912},{"style":832},[1913],{"type":63,"value":1808},{"type":58,"tag":138,"props":1915,"children":1916},{"style":832},[1917],{"type":63,"value":1918}," pop\n",{"type":58,"tag":138,"props":1920,"children":1921},{"class":140,"line":260},[1922],{"type":58,"tag":138,"props":1923,"children":1924},{"style":1008},[1925],{"type":63,"value":1864},{"type":58,"tag":59,"props":1927,"children":1928},{},[1929,1931,1937,1939,1944],{"type":63,"value":1930},"The line ",{"type":58,"tag":134,"props":1932,"children":1934},{"className":1933},[],[1935],{"type":63,"value":1936},"__attribute__((preserve_access_index))",{"type":63,"value":1938}," at the top of ",{"type":58,"tag":134,"props":1940,"children":1942},{"className":1941},[],[1943],{"type":63,"value":1654},{"type":63,"value":1945},", tells the compiler to emit BPF CO-RE (Compile Once  Run Everywhere) relocation information (into the output binary) for every struct field your eBPF program accesses into your eBPF object file.",{"type":58,"tag":59,"props":1947,"children":1948},{},[1949,1951,1957,1959,1965],{"type":63,"value":1950},"And the ",{"type":58,"tag":134,"props":1952,"children":1954},{"className":1953},[],[1955],{"type":63,"value":1956},"clang attribute push",{"type":63,"value":1958}," ensures this applies to all struct definitions until the matching ",{"type":58,"tag":134,"props":1960,"children":1962},{"className":1961},[],[1963],{"type":63,"value":1964},"clang attribute pop",{"type":63,"value":1966}," at the bottom of the file.",{"type":58,"tag":59,"props":1968,"children":1969},{},[1970,1972,1977,1979,1985],{"type":63,"value":1971},"In other words, when you reference a field (like ",{"type":58,"tag":134,"props":1973,"children":1975},{"className":1974},[],[1976],{"type":63,"value":903},{"type":63,"value":1978}," in the examples in ",{"type":58,"tag":134,"props":1980,"children":1982},{"className":1981},[],[1983],{"type":63,"value":1984},"labs/lab2/trace.c",{"type":63,"value":1986}," file) from a kernel struct, the compiler doesnt just hardcode its offset. Instead, it records metadatalike the fields name, type, offset, and parent struct.",{"type":58,"tag":126,"props":1988,"children":1991},{"className":128,"code":1047,"filename":1989,"highlights":1990,"language":130,"meta":131,"style":131},"trace.c",[177,41],[1992],{"type":58,"tag":134,"props":1993,"children":1994},{"__ignoreMap":131},[1995,2014,2049,2109,2116,2131,2159,2166,2193,2208],{"type":58,"tag":138,"props":1996,"children":1997},{"class":140,"line":141},[1998,2002,2006,2010],{"type":58,"tag":138,"props":1999,"children":2000},{"style":779},[2001],{"type":63,"value":782},{"type":58,"tag":138,"props":2003,"children":2004},{"style":151},[2005],{"type":63,"value":787},{"type":58,"tag":138,"props":2007,"children":2008},{"style":790},[2009],{"type":63,"value":793},{"type":58,"tag":138,"props":2011,"children":2012},{"style":151},[2013],{"type":63,"value":798},{"type":58,"tag":138,"props":2015,"children":2016},{"class":140,"line":163},[2017,2021,2025,2029,2033,2037,2041,2045],{"type":58,"tag":138,"props":2018,"children":2019},{"style":145},[2020],{"type":63,"value":807},{"type":58,"tag":138,"props":2022,"children":2023},{"style":779},[2024],{"type":63,"value":1084},{"type":58,"tag":138,"props":2026,"children":2027},{"style":151},[2028],{"type":63,"value":787},{"type":58,"tag":138,"props":2030,"children":2031},{"style":145},[2032],{"type":63,"value":148},{"type":58,"tag":138,"props":2034,"children":2035},{"style":151},[2036],{"type":63,"value":1097},{"type":58,"tag":138,"props":2038,"children":2039},{"style":673},[2040],{"type":63,"value":676},{"type":58,"tag":138,"props":2042,"children":2043},{"style":832},[2044],{"type":63,"value":835},{"type":58,"tag":138,"props":2046,"children":2047},{"style":151},[2048],{"type":63,"value":840},{"type":58,"tag":138,"props":2050,"children":2052},{"class":2051,"line":177},[140,554],[2053,2057,2061,2065,2069,2073,2077,2081,2085,2089,2093,2097,2101,2105],{"type":58,"tag":138,"props":2054,"children":2055},{"style":145},[2056],{"type":63,"value":587},{"type":58,"tag":138,"props":2058,"children":2059},{"style":673},[2060],{"type":63,"value":712},{"type":58,"tag":138,"props":2062,"children":2063},{"style":151},[2064],{"type":63,"value":862},{"type":58,"tag":138,"props":2066,"children":2067},{"style":673},[2068],{"type":63,"value":867},{"type":58,"tag":138,"props":2070,"children":2071},{"style":151},[2072],{"type":63,"value":872},{"type":58,"tag":138,"props":2074,"children":2075},{"style":145},[2076],{"type":63,"value":1138},{"type":58,"tag":138,"props":2078,"children":2079},{"style":673},[2080],{"type":63,"value":712},{"type":58,"tag":138,"props":2082,"children":2083},{"style":151},[2084],{"type":63,"value":1147},{"type":58,"tag":138,"props":2086,"children":2087},{"style":779},[2088],{"type":63,"value":1152},{"type":58,"tag":138,"props":2090,"children":2091},{"style":151},[2092],{"type":63,"value":1157},{"type":58,"tag":138,"props":2094,"children":2095},{"style":832},[2096],{"type":63,"value":1162},{"type":58,"tag":138,"props":2098,"children":2099},{"style":151},[2100],{"type":63,"value":1167},{"type":58,"tag":138,"props":2102,"children":2103},{"style":1014},[2104],{"type":63,"value":1172},{"type":58,"tag":138,"props":2106,"children":2107},{"style":151},[2108],{"type":63,"value":1177},{"type":58,"tag":138,"props":2110,"children":2111},{"class":140,"line":191},[2112],{"type":58,"tag":138,"props":2113,"children":2114},{"emptyLinePlaceholder":11},[2115],{"type":63,"value":628},{"type":58,"tag":138,"props":2117,"children":2118},{"class":140,"line":205},[2119,2123,2127],{"type":58,"tag":138,"props":2120,"children":2121},{"style":151},[2122],{"type":63,"value":925},{"type":58,"tag":138,"props":2124,"children":2125},{"style":832},[2126],{"type":63,"value":903},{"type":58,"tag":138,"props":2128,"children":2129},{"style":151},[2130],{"type":63,"value":935},{"type":58,"tag":138,"props":2132,"children":2134},{"class":2133,"line":41},[140,554],[2135,2139,2143,2147,2151,2155],{"type":58,"tag":138,"props":2136,"children":2137},{"style":779},[2138],{"type":63,"value":1208},{"type":58,"tag":138,"props":2140,"children":2141},{"style":151},[2142],{"type":63,"value":787},{"type":58,"tag":138,"props":2144,"children":2145},{"style":673},[2146],{"type":63,"value":1217},{"type":58,"tag":138,"props":2148,"children":2149},{"style":151},[2150],{"type":63,"value":1222},{"type":58,"tag":138,"props":2152,"children":2153},{"style":145},[2154],{"type":63,"value":954},{"type":58,"tag":138,"props":2156,"children":2157},{"style":151},[2158],{"type":63,"value":1231},{"type":58,"tag":138,"props":2160,"children":2161},{"class":140,"line":232},[2162],{"type":58,"tag":138,"props":2163,"children":2164},{"emptyLinePlaceholder":11},[2165],{"type":63,"value":628},{"type":58,"tag":138,"props":2167,"children":2168},{"class":140,"line":246},[2169,2173,2177,2181,2185,2189],{"type":58,"tag":138,"props":2170,"children":2171},{"style":779},[2172],{"type":63,"value":976},{"type":58,"tag":138,"props":2174,"children":2175},{"style":151},[2176],{"type":63,"value":787},{"type":58,"tag":138,"props":2178,"children":2179},{"style":790},[2180],{"type":63,"value":1254},{"type":58,"tag":138,"props":2182,"children":2183},{"style":988},[2184],{"type":63,"value":991},{"type":58,"tag":138,"props":2186,"children":2187},{"style":790},[2188],{"type":63,"value":996},{"type":58,"tag":138,"props":2190,"children":2191},{"style":151},[2192],{"type":63,"value":1267},{"type":58,"tag":138,"props":2194,"children":2195},{"class":140,"line":260},[2196,2200,2204],{"type":58,"tag":138,"props":2197,"children":2198},{"style":1008},[2199],{"type":63,"value":1011},{"type":58,"tag":138,"props":2201,"children":2202},{"style":1014},[2203],{"type":63,"value":1017},{"type":58,"tag":138,"props":2205,"children":2206},{"style":151},[2207],{"type":63,"value":1022},{"type":58,"tag":138,"props":2209,"children":2210},{"class":140,"line":40},[2211],{"type":58,"tag":138,"props":2212,"children":2213},{"style":151},[2214],{"type":63,"value":1031},{"type":58,"tag":443,"props":2216,"children":2218},{":summary":2217},"More information on the metadata record",[2219,2237,2300,2305],{"type":58,"tag":59,"props":2220,"children":2221},{},[2222,2224,2235],{"type":63,"value":2223},"Compiler records the metadata within ",{"type":58,"tag":453,"props":2225,"children":2228},{"href":2226,"rel":2227},"https://codebrowser.dev/linux/linux/include/uapi/linux/bpf.h.html#7501",[457],[2229],{"type":58,"tag":134,"props":2230,"children":2232},{"className":2231},[],[2233],{"type":63,"value":2234},"bpf_core_relo struct",{"type":63,"value":2236}," or so-called BPF CO-RE relocation structure, defined as:",{"type":58,"tag":126,"props":2238,"children":2240},{"className":128,"code":2239,"language":130,"meta":131,"style":131},"struct bpf_core_relo {\n    __u32 insn_off;\n    __u32 type_id;\n    __u32 access_str_off;\n    enum bpf_core_relo_kind kind;\n};\n",[2241],{"type":58,"tag":134,"props":2242,"children":2243},{"__ignoreMap":131},[2244,2256,2264,2272,2280,2293],{"type":58,"tag":138,"props":2245,"children":2246},{"class":140,"line":141},[2247,2251],{"type":58,"tag":138,"props":2248,"children":2249},{"style":145},[2250],{"type":63,"value":148},{"type":58,"tag":138,"props":2252,"children":2253},{"style":151},[2254],{"type":63,"value":2255}," bpf_core_relo {\n",{"type":58,"tag":138,"props":2257,"children":2258},{"class":140,"line":163},[2259],{"type":58,"tag":138,"props":2260,"children":2261},{"style":151},[2262],{"type":63,"value":2263},"    __u32 insn_off;\n",{"type":58,"tag":138,"props":2265,"children":2266},{"class":140,"line":177},[2267],{"type":58,"tag":138,"props":2268,"children":2269},{"style":151},[2270],{"type":63,"value":2271},"    __u32 type_id;\n",{"type":58,"tag":138,"props":2273,"children":2274},{"class":140,"line":191},[2275],{"type":58,"tag":138,"props":2276,"children":2277},{"style":151},[2278],{"type":63,"value":2279},"    __u32 access_str_off;\n",{"type":58,"tag":138,"props":2281,"children":2282},{"class":140,"line":205},[2283,2288],{"type":58,"tag":138,"props":2284,"children":2285},{"style":145},[2286],{"type":63,"value":2287},"    enum",{"type":58,"tag":138,"props":2289,"children":2290},{"style":151},[2291],{"type":63,"value":2292}," bpf_core_relo_kind kind;\n",{"type":58,"tag":138,"props":2294,"children":2295},{"class":140,"line":41},[2296],{"type":58,"tag":138,"props":2297,"children":2298},{"style":151},[2299],{"type":63,"value":266},{"type":58,"tag":59,"props":2301,"children":2302},{},[2303],{"type":63,"value":2304},"where the arguments are:",{"type":58,"tag":1359,"props":2306,"children":2307},{},[2308,2319,2330],{"type":58,"tag":1363,"props":2309,"children":2310},{},[2311,2317],{"type":58,"tag":134,"props":2312,"children":2314},{"className":2313},[],[2315],{"type":63,"value":2316},"insn_off",{"type":63,"value":2318},": Identifies the instruction being relocated, such as one that sets a register to a specific value.",{"type":58,"tag":1363,"props":2320,"children":2321},{},[2322,2328],{"type":58,"tag":134,"props":2323,"children":2325},{"className":2324},[],[2326],{"type":63,"value":2327},"type_id",{"type":63,"value":2329},": References BTF (BPF Type Format) metadata, which describes the layout of the kernel structure.",{"type":58,"tag":1363,"props":2331,"children":2332},{},[2333,2339],{"type":58,"tag":134,"props":2334,"children":2336},{"className":2335},[],[2337],{"type":63,"value":2338},"access_str_off",{"type":63,"value":2340},": Specifies how a particular field is accessed relative to the structure.",{"type":58,"tag":59,"props":2342,"children":2343},{},[2344,2346,2353],{"type":63,"value":2345},"This metadata is recorded in ",{"type":58,"tag":453,"props":2347,"children":2350},{"href":2348,"rel":2349},"https://docs.ebpf.io/concepts/btf/",[457],[2351],{"type":63,"value":2352},"BPF Type Format (BTF)",{"type":63,"value":478},{"type":58,"tag":514,"props":2355,"children":2357},{"id":2356},"bpf-type-format-btf",[2358],{"type":63,"value":2352},{"type":58,"tag":59,"props":2360,"children":2361},{},[2362,2364,2369],{"type":63,"value":2363},"To understand how this metadata looks like, let's build and run the program from ",{"type":58,"tag":134,"props":2365,"children":2367},{"className":2366},[],[2368],{"type":63,"value":1667},{"type":63,"value":2370}," directory, using:",{"type":58,"tag":126,"props":2372,"children":2374},{"className":1694,"code":2373,"language":1696,"meta":131,"style":131},"go generate\ngo build\nsudo ./lab2\n",[2375],{"type":58,"tag":134,"props":2376,"children":2377},{"__ignoreMap":131},[2378,2391,2403],{"type":58,"tag":138,"props":2379,"children":2380},{"class":140,"line":141},[2381,2386],{"type":58,"tag":138,"props":2382,"children":2383},{"style":779},[2384],{"type":63,"value":2385},"go",{"type":58,"tag":138,"props":2387,"children":2388},{"style":790},[2389],{"type":63,"value":2390}," generate\n",{"type":58,"tag":138,"props":2392,"children":2393},{"class":140,"line":163},[2394,2398],{"type":58,"tag":138,"props":2395,"children":2396},{"style":779},[2397],{"type":63,"value":2385},{"type":58,"tag":138,"props":2399,"children":2400},{"style":790},[2401],{"type":63,"value":2402}," build\n",{"type":58,"tag":138,"props":2404,"children":2405},{"class":140,"line":177},[2406,2410],{"type":58,"tag":138,"props":2407,"children":2408},{"style":779},[2409],{"type":63,"value":1708},{"type":58,"tag":138,"props":2411,"children":2412},{"style":790},[2413],{"type":63,"value":2414}," ./lab2\n",{"type":58,"tag":59,"props":2416,"children":2417},{},[2418,2420,2426],{"type":63,"value":2419},"And then dump the recorded BTF information for the ",{"type":58,"tag":134,"props":2421,"children":2423},{"className":2422},[],[2424],{"type":63,"value":2425},"handle_execve_tp",{"type":63,"value":2427}," tracepoint program using:",{"type":58,"tag":126,"props":2429,"children":2431},{"className":1694,"code":2430,"language":1696,"meta":131,"style":131},"sudo bpftool prog # Find the BTF ID (`btf_id`) of the `handle_execve_tp` program\nsudo bpftool btf dump id \u003Cprog-btf-id>\n",[2432],{"type":58,"tag":134,"props":2433,"children":2434},{"__ignoreMap":131},[2435,2456],{"type":58,"tag":138,"props":2436,"children":2437},{"class":140,"line":141},[2438,2442,2446,2451],{"type":58,"tag":138,"props":2439,"children":2440},{"style":779},[2441],{"type":63,"value":1708},{"type":58,"tag":138,"props":2443,"children":2444},{"style":790},[2445],{"type":63,"value":1713},{"type":58,"tag":138,"props":2447,"children":2448},{"style":790},[2449],{"type":63,"value":2450}," prog",{"type":58,"tag":138,"props":2452,"children":2453},{"style":157},[2454],{"type":63,"value":2455}," # Find the BTF ID (`btf_id`) of the `handle_execve_tp` program\n",{"type":58,"tag":138,"props":2457,"children":2458},{"class":140,"line":163},[2459,2463,2467,2471,2475,2480,2485,2490,2495],{"type":58,"tag":138,"props":2460,"children":2461},{"style":779},[2462],{"type":63,"value":1708},{"type":58,"tag":138,"props":2464,"children":2465},{"style":790},[2466],{"type":63,"value":1713},{"type":58,"tag":138,"props":2468,"children":2469},{"style":790},[2470],{"type":63,"value":1718},{"type":58,"tag":138,"props":2472,"children":2473},{"style":790},[2474],{"type":63,"value":1723},{"type":58,"tag":138,"props":2476,"children":2477},{"style":790},[2478],{"type":63,"value":2479}," id",{"type":58,"tag":138,"props":2481,"children":2482},{"style":673},[2483],{"type":63,"value":2484}," \u003C",{"type":58,"tag":138,"props":2486,"children":2487},{"style":790},[2488],{"type":63,"value":2489},"prog-btf-i",{"type":58,"tag":138,"props":2491,"children":2492},{"style":151},[2493],{"type":63,"value":2494},"d",{"type":58,"tag":138,"props":2496,"children":2497},{"style":673},[2498],{"type":63,"value":2499},">\n",{"type":58,"tag":126,"props":2501,"children":2505},{"className":2502,"code":2504,"language":63},[2503],"language-text","[1] FUNC 'handle_execve_tp' type_id=14 linkage=global\n[2] INT 'int' size=4 bits_offset=0 nr_bits=32 encoding=SIGNED\n[3] INT 'unsigned short' size=2 bits_offset=0 nr_bits=16 encoding=(none)\n[4] INT 'unsigned char' size=1 bits_offset=0 nr_bits=8 encoding=(none)\n[5] STRUCT 'trace_entry' size=8 vlen=4\n        'type' type_id=3 bits_offset=0\n        'flags' type_id=4 bits_offset=16\n        'preempt_count' type_id=4 bits_offset=24\n        'pid' type_id=2 bits_offset=32\n[6] INT 'long' size=8 bits_offset=0 nr_bits=64 encoding=SIGNED\n[7] INT '__ARRAY_SIZE_TYPE__' size=4 bits_offset=0 nr_bits=32 encoding=(none)\n[8] INT 'unsigned long' size=8 bits_offset=0 nr_bits=64 encoding=(none)\n[9] ARRAY '(anon)' type_id=8 index_type_id=7 nr_elems=6\n[10] INT 'char' size=1 bits_offset=0 nr_bits=8 encoding=SIGNED\n[11] ARRAY '(anon)' type_id=10 index_type_id=7 nr_elems=0\n[12] STRUCT 'trace_event_raw_sys_enter' size=64 vlen=4\n        'ent' type_id=5 bits_offset=0\n        'id' type_id=6 bits_offset=64\n        'args' type_id=9 bits_offset=128\n        '__data' type_id=11 bits_offset=512\n[13] PTR '(anon)' type_id=12\n[14] FUNC_PROTO '(anon)' ret_type_id=2 vlen=1\n        'ctx' type_id=13\n",[2506],{"type":58,"tag":134,"props":2507,"children":2508},{"__ignoreMap":131},[2509],{"type":63,"value":2504},{"type":58,"tag":398,"props":2511,"children":2512},{"kind":400},[2513,2565,2585],{"type":58,"tag":59,"props":2514,"children":2515},{},[2516,2518,2524,2526,2532,2534,2540,2542,2548,2550,2555,2557,2564],{"type":63,"value":2517}," To embed BTF information into the eBPF application binary, ",{"type":58,"tag":134,"props":2519,"children":2521},{"className":2520},[],[2522],{"type":63,"value":2523},"clang",{"type":63,"value":2525}," must be invoked with the ",{"type":58,"tag":134,"props":2527,"children":2529},{"className":2528},[],[2530],{"type":63,"value":2531},"-g",{"type":63,"value":2533}," flag. You dont see it explicitly because ",{"type":58,"tag":134,"props":2535,"children":2537},{"className":2536},[],[2538],{"type":63,"value":2539},"go generate",{"type":63,"value":2541}," runs ",{"type":58,"tag":134,"props":2543,"children":2545},{"className":2544},[],[2546],{"type":63,"value":2547},"bpf2go",{"type":63,"value":2549},", which internally invokes ",{"type":58,"tag":134,"props":2551,"children":2553},{"className":2552},[],[2554],{"type":63,"value":2523},{"type":63,"value":2556}," with ",{"type":58,"tag":453,"props":2558,"children":2561},{"href":2559,"rel":2560},"https://github.com/cilium/ebpf/blob/5ba3156ee1314afa3c3166e59d7775d674f57760/cmd/bpf2go/gen/compile.go#L92",[457],[2562],{"type":63,"value":2563},"the -g flag enabled by default",{"type":63,"value":478},{"type":58,"tag":59,"props":2566,"children":2567},{},[2568,2570,2575,2577,2583],{"type":63,"value":2569},"Without ",{"type":58,"tag":134,"props":2571,"children":2573},{"className":2572},[],[2574],{"type":63,"value":2531},{"type":63,"value":2576},", compiling eBPF programs that use ",{"type":58,"tag":134,"props":2578,"children":2580},{"className":2579},[],[2581],{"type":63,"value":2582},"BPF_CORE*",{"type":63,"value":2584}," helpers fails with:",{"type":58,"tag":126,"props":2586,"children":2589},{"className":2587,"code":2588,"language":63},[2503],"error: using builtin_preserve_access_index() without -g\n",[2590],{"type":58,"tag":134,"props":2591,"children":2592},{"__ignoreMap":131},[2593],{"type":63,"value":2588},{"type":58,"tag":443,"props":2595,"children":2597},{":summary":2596},"Detailed explanation of the BTF output",[2598,2603,2608],{"type":58,"tag":59,"props":2599,"children":2600},{},[2601],{"type":63,"value":2602},"Each numbered entry corresponds to a type definition: integers, arrays, structs, pointers, function prototypes, and so on.",{"type":58,"tag":59,"props":2604,"children":2605},{},[2606],{"type":63,"value":2607},"For example:",{"type":58,"tag":1359,"props":2609,"children":2610},{},[2611,2628,2647,2665,2757],{"type":58,"tag":1363,"props":2612,"children":2613},{},[2614,2620,2622,2627],{"type":58,"tag":134,"props":2615,"children":2617},{"className":2616},[],[2618],{"type":63,"value":2619},"[1] FUNC 'handle_execve_tp'",{"type":63,"value":2621},"  defines a global function named ",{"type":58,"tag":134,"props":2623,"children":2625},{"className":2624},[],[2626],{"type":63,"value":2425},{"type":63,"value":478},{"type":58,"tag":1363,"props":2629,"children":2630},{},[2631,2637,2639,2645],{"type":58,"tag":134,"props":2632,"children":2634},{"className":2633},[],[2635],{"type":63,"value":2636},"[14] FUNC_PROTO",{"type":63,"value":2638},"  says this function returns an int ",{"type":58,"tag":134,"props":2640,"children":2642},{"className":2641},[],[2643],{"type":63,"value":2644},"(type_id=2)",{"type":63,"value":2646}," and takes one parameter called ctx.",{"type":58,"tag":1363,"props":2648,"children":2649},{},[2650,2656,2658,2664],{"type":58,"tag":134,"props":2651,"children":2653},{"className":2652},[],[2654],{"type":63,"value":2655},"[13] PTR  [12] STRUCT 'trace_event_raw_sys_enter'",{"type":63,"value":2657},"  the ctx argument is a pointer to a ",{"type":58,"tag":134,"props":2659,"children":2661},{"className":2660},[],[2662],{"type":63,"value":2663},"trace_event_raw_sys_enter struct",{"type":63,"value":478},{"type":58,"tag":1363,"props":2666,"children":2667},{},[2668,2674,2676],{"type":58,"tag":134,"props":2669,"children":2671},{"className":2670},[],[2672],{"type":63,"value":2673},"[12] STRUCT 'trace_event_raw_sys_enter'",{"type":63,"value":2675},"  represents the syscall-enter tracepoint data:\n",{"type":58,"tag":1359,"props":2677,"children":2678},{},[2679,2725,2736,2746],{"type":58,"tag":1363,"props":2680,"children":2681},{},[2682,2688,2690,2696,2698,2704,2705,2711,2712,2718,2719,2724],{"type":58,"tag":134,"props":2683,"children":2685},{"className":2684},[],[2686],{"type":63,"value":2687},"ent",{"type":63,"value":2689},"  a trace_entry header (",{"type":58,"tag":134,"props":2691,"children":2693},{"className":2692},[],[2694],{"type":63,"value":2695},"[5]",{"type":63,"value":2697},") with fields like ",{"type":58,"tag":134,"props":2699,"children":2701},{"className":2700},[],[2702],{"type":63,"value":2703},"type",{"type":63,"value":1582},{"type":58,"tag":134,"props":2706,"children":2708},{"className":2707},[],[2709],{"type":63,"value":2710},"flags",{"type":63,"value":1582},{"type":58,"tag":134,"props":2713,"children":2715},{"className":2714},[],[2716],{"type":63,"value":2717},"preempt_count",{"type":63,"value":1582},{"type":58,"tag":134,"props":2720,"children":2722},{"className":2721},[],[2723],{"type":63,"value":1618},{"type":63,"value":478},{"type":58,"tag":1363,"props":2726,"children":2727},{},[2728,2734],{"type":58,"tag":134,"props":2729,"children":2731},{"className":2730},[],[2732],{"type":63,"value":2733},"id",{"type":63,"value":2735},"  syscall ID (long).",{"type":58,"tag":1363,"props":2737,"children":2738},{},[2739,2744],{"type":58,"tag":134,"props":2740,"children":2742},{"className":2741},[],[2743],{"type":63,"value":1162},{"type":63,"value":2745},"  array of six unsigned long values (syscall arguments).",{"type":58,"tag":1363,"props":2747,"children":2748},{},[2749,2755],{"type":58,"tag":134,"props":2750,"children":2752},{"className":2751},[],[2753],{"type":63,"value":2754},"__data",{"type":63,"value":2756},"  flexible array for extra data.",{"type":58,"tag":1363,"props":2758,"children":2759},{},[2760,2766],{"type":58,"tag":134,"props":2761,"children":2763},{"className":2762},[],[2764],{"type":63,"value":2765},"[2][11]",{"type":63,"value":2767},"  supporting integer and array type definitions used to build the structs.",{"type":58,"tag":59,"props":2769,"children":2770},{},[2771],{"type":63,"value":2772},"Well, this is quite a lot to take it, but what it really shows is the BTF (BPF Type Format) description of kernel structures/types your program is working with.",{"type":58,"tag":59,"props":2774,"children":2775},{},[2776],{"type":63,"value":2777},"And for your eBPF program to work across kernel versionswhere struct layouts may differthe target kernel must also be compiled with BTF support. Without it, the program wont be able to resolve the correct fields offsets at runtime.",{"type":58,"tag":443,"props":2779,"children":2781},{":summary":2780},"Still confused?",[2782,2787,2822],{"type":58,"tag":59,"props":2783,"children":2784},{},[2785],{"type":63,"value":2786}," The BTF data shown above is only a metadata record of kernel structs and their layout that our eBPF program uses. While the BTF information from the target kernel is different and can be inspected (on the target kernel) with:",{"type":58,"tag":126,"props":2788,"children":2790},{"className":1694,"code":2789,"language":1696,"meta":131,"style":131},"sudo bpftool btf dump file /sys/kernel/btf/vmlinux\n",[2791],{"type":58,"tag":134,"props":2792,"children":2793},{"__ignoreMap":131},[2794],{"type":58,"tag":138,"props":2795,"children":2796},{"class":140,"line":141},[2797,2801,2805,2809,2813,2817],{"type":58,"tag":138,"props":2798,"children":2799},{"style":779},[2800],{"type":63,"value":1708},{"type":58,"tag":138,"props":2802,"children":2803},{"style":790},[2804],{"type":63,"value":1713},{"type":58,"tag":138,"props":2806,"children":2807},{"style":790},[2808],{"type":63,"value":1718},{"type":58,"tag":138,"props":2810,"children":2811},{"style":790},[2812],{"type":63,"value":1723},{"type":58,"tag":138,"props":2814,"children":2815},{"style":790},[2816],{"type":63,"value":1728},{"type":58,"tag":138,"props":2818,"children":2819},{"style":790},[2820],{"type":63,"value":2821}," /sys/kernel/btf/vmlinux\n",{"type":58,"tag":126,"props":2823,"children":2826},{"className":2824,"code":2825,"language":63},[2503],"[1] FUNC_PROTO '(anon)' ret_type_id=0 vlen=0\n[2] FUNC 'verify_cpu' type_id=1 linkage=static\n[3] FUNC 'sev_verify_cbit' type_id=1 linkage=static\n[4] INT 'long unsigned int' size=8 bits_offset=0 nr_bits=64 encoding=(none)\n[5] CONST '(anon)' type_id=4\n[6] ARRAY '(anon)' type_id=4 index_type_id=21 nr_elems=2\n[7] PTR '(anon)' type_id=9\n[8] INT 'char' size=1 bits_offset=0 nr_bits=8 encoding=SIGNED\n[9] CONST '(anon)' type_id=8\n[10] INT 'unsigned int' size=4 bits_offset=0 nr_bits=32 encoding=(none)\n[11] CONST '(anon)' type_id=10\n[12] INT 'signed char' size=1 bits_offset=0 nr_bits=8 encoding=SIGNED\n[13] TYPEDEF '__u8' type_id=14\n...\n",[2827],{"type":58,"tag":134,"props":2828,"children":2829},{"__ignoreMap":131},[2830],{"type":63,"value":2825},{"type":58,"tag":59,"props":2832,"children":2833},{},[2834],{"type":58,"tag":110,"props":2835,"children":2836},{},[2837],{"type":63,"value":2838},"Why is this necessary?",{"type":58,"tag":59,"props":2840,"children":2841},{},[2842,2844,2851],{"type":63,"value":2843},"When your eBPF program is loaded by a BPF loader like ",{"type":58,"tag":453,"props":2845,"children":2848},{"href":2846,"rel":2847},"https://github.com/libbpf/libbpf",[457],[2849],{"type":63,"value":2850},"libbpf",{"type":63,"value":2852},", the loader compares the programs BTF data with the target kernels BTF.",{"type":58,"tag":59,"props":2854,"children":2855},{},[2856],{"type":63,"value":2857},"And since it's quite likely your program won't only run on the kernel it was compiled on, the loader needs to resolve types, updates offsets, and adjusts field accesses to ensure the program reads kernel structures correctly.",{"type":58,"tag":59,"props":2859,"children":2860},{},[2861,2863,2868],{"type":63,"value":2862},"This process is known as ",{"type":58,"tag":110,"props":2864,"children":2865},{},[2866],{"type":63,"value":2867},"field offset relocation",{"type":63,"value":478},{"type":58,"tag":59,"props":2870,"children":2871},{},[2872],{"type":63,"value":2873},"Although most eBPF kernels nowadays support BTF, it's not really something we can rely on when we want to design truly portable eBPF programs.",{"type":58,"tag":443,"props":2875,"children":2877},{":summary":2876},"How to check if your kernel is compiled with BTF support?",[2878,2883,2927,2936,2941],{"type":58,"tag":59,"props":2879,"children":2880},{},[2881],{"type":63,"value":2882},"You can verify this using:",{"type":58,"tag":126,"props":2884,"children":2886},{"className":1694,"code":2885,"language":1696,"meta":131,"style":131},"grep CONFIG_DEBUG_INFO_BTF /boot/config-$(uname -r)\n",[2887],{"type":58,"tag":134,"props":2888,"children":2889},{"__ignoreMap":131},[2890],{"type":58,"tag":138,"props":2891,"children":2892},{"class":140,"line":141},[2893,2898,2903,2908,2913,2918,2923],{"type":58,"tag":138,"props":2894,"children":2895},{"style":779},[2896],{"type":63,"value":2897},"grep",{"type":58,"tag":138,"props":2899,"children":2900},{"style":790},[2901],{"type":63,"value":2902}," CONFIG_DEBUG_INFO_BTF",{"type":58,"tag":138,"props":2904,"children":2905},{"style":790},[2906],{"type":63,"value":2907}," /boot/config-",{"type":58,"tag":138,"props":2909,"children":2910},{"style":151},[2911],{"type":63,"value":2912},"$(",{"type":58,"tag":138,"props":2914,"children":2915},{"style":779},[2916],{"type":63,"value":2917},"uname",{"type":58,"tag":138,"props":2919,"children":2920},{"style":790},[2921],{"type":63,"value":2922}," -r",{"type":58,"tag":138,"props":2924,"children":2925},{"style":151},[2926],{"type":63,"value":798},{"type":58,"tag":126,"props":2928,"children":2931},{"className":2929,"code":2930,"language":63},[2503],"CONFIG_DEBUG_INFO_BTF=y\n",[2932],{"type":58,"tag":134,"props":2933,"children":2934},{"__ignoreMap":131},[2935],{"type":63,"value":2930},{"type":58,"tag":59,"props":2937,"children":2938},{},[2939],{"type":63,"value":2940},"In case it doesnt, then you have two options:",{"type":58,"tag":1359,"props":2942,"children":2943},{},[2944,2957],{"type":58,"tag":1363,"props":2945,"children":2946},{},[2947,2949,2955],{"type":63,"value":2948},"Re-compile the kernel with the ",{"type":58,"tag":134,"props":2950,"children":2952},{"className":2951},[],[2953],{"type":63,"value":2954},"CONFIG_DEBUG_INFO_BTF=y",{"type":63,"value":2956}," option or upgrade the kernel, which is time-consuming, inconvenient  especially if the machine is in production.",{"type":58,"tag":1363,"props":2958,"children":2959},{},[2960],{"type":63,"value":2961},"Or better, provide the BTF information of that specific kernel alongside your program. We'll talk about this in the next tutorial",{"type":58,"tag":59,"props":2963,"children":2964},{},[2965],{"type":58,"tag":110,"props":2966,"children":2967},{},[2968],{"type":63,"value":2969},"But can we do something to avoid this dependency?",{"type":58,"tag":59,"props":2971,"children":2972},{},[2973],{"type":63,"value":2974},"Actuallyyes, but we'll cover that in the next tutorial.",{"type":58,"tag":59,"props":2976,"children":2977},{},[2978,2980,2985,2987,2993],{"type":63,"value":2979},"If you havent checked it yet, the code in ",{"type":58,"tag":134,"props":2981,"children":2983},{"className":2982},[],[2984],{"type":63,"value":1667},{"type":63,"value":2986}," provides portable versions of Tracepoint, Raw Tracepoint, kprobe, fprobe and BTF-Enabled Raw Tracepoint eBPF programs for capturing ",{"type":58,"tag":134,"props":2988,"children":2990},{"className":2989},[],[2991],{"type":63,"value":2992},"execve",{"type":63,"value":2994}," syscall events.",{"type":58,"tag":398,"props":2996,"children":2998},{"kind":2997},"warning",[2999,3007,3019,3029,3414],{"type":58,"tag":59,"props":3000,"children":3001},{},[3002],{"type":58,"tag":110,"props":3003,"children":3004},{},[3005],{"type":63,"value":3006}," Extra Insight ",{"type":58,"tag":59,"props":3008,"children":3009},{},[3010,3012,3017],{"type":63,"value":3011},"To ones surprise, you don't always need to use ",{"type":58,"tag":134,"props":3013,"children":3015},{"className":3014},[],[3016],{"type":63,"value":1042},{"type":63,"value":3018}," helpers to do CO-RE-relocatable reads.",{"type":58,"tag":59,"props":3020,"children":3021},{},[3022,3027],{"type":58,"tag":110,"props":3023,"children":3024},{},[3025],{"type":63,"value":3026},"BTF-Enabled Raw Tracepoint",{"type":63,"value":3028}," allow you to directly access kernel memory.",{"type":58,"tag":126,"props":3030,"children":3033},{"className":128,"code":3031,"filename":1989,"highlights":3032,"language":130,"meta":131,"style":131},"SEC(\"tp_btf/sys_enter\")\nint handle_execve_btf(u64 *ctx) {\n    long int syscall_id = (long int)ctx[1];\n    if (syscall_id != 59)\n        return 0;\n\n    struct pt_regs *regs = (struct pt_regs *)ctx[0]; // No need to use BPF_CORE_READ helper\n    char *filename = (char *)PT_REGS_PARM1(regs); // No need to use PT_REGS_PARM1_CORE helper\n    char buf[ARGSIZE];\n    bpf_probe_read_user_str(buf, sizeof(buf), filename); // No need to use bpf_core_read_user_str helper\n\n    bpf_printk(\"BTF-enabled tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s\\n\", buf);\n    return 0;\n}\n",[141,232,246,40],[3034],{"type":58,"tag":134,"props":3035,"children":3036},{"__ignoreMap":131},[3037,3058,3087,3144,3171,3187,3194,3263,3315,3331,3357,3364,3392,3407],{"type":58,"tag":138,"props":3038,"children":3040},{"class":3039,"line":141},[140,554],[3041,3045,3049,3054],{"type":58,"tag":138,"props":3042,"children":3043},{"style":779},[3044],{"type":63,"value":782},{"type":58,"tag":138,"props":3046,"children":3047},{"style":151},[3048],{"type":63,"value":787},{"type":58,"tag":138,"props":3050,"children":3051},{"style":790},[3052],{"type":63,"value":3053},"\"tp_btf/sys_enter\"",{"type":58,"tag":138,"props":3055,"children":3056},{"style":151},[3057],{"type":63,"value":798},{"type":58,"tag":138,"props":3059,"children":3060},{"class":140,"line":163},[3061,3065,3070,3075,3079,3083],{"type":58,"tag":138,"props":3062,"children":3063},{"style":145},[3064],{"type":63,"value":807},{"type":58,"tag":138,"props":3066,"children":3067},{"style":779},[3068],{"type":63,"value":3069}," handle_execve_btf",{"type":58,"tag":138,"props":3071,"children":3072},{"style":151},[3073],{"type":63,"value":3074},"(u64 ",{"type":58,"tag":138,"props":3076,"children":3077},{"style":673},[3078],{"type":63,"value":676},{"type":58,"tag":138,"props":3080,"children":3081},{"style":832},[3082],{"type":63,"value":835},{"type":58,"tag":138,"props":3084,"children":3085},{"style":151},[3086],{"type":63,"value":840},{"type":58,"tag":138,"props":3088,"children":3089},{"class":140,"line":177},[3090,3095,3100,3105,3109,3113,3118,3122,3126,3130,3134,3139],{"type":58,"tag":138,"props":3091,"children":3092},{"style":145},[3093],{"type":63,"value":3094},"    long",{"type":58,"tag":138,"props":3096,"children":3097},{"style":145},[3098],{"type":63,"value":3099}," int",{"type":58,"tag":138,"props":3101,"children":3102},{"style":151},[3103],{"type":63,"value":3104}," syscall_id ",{"type":58,"tag":138,"props":3106,"children":3107},{"style":673},[3108],{"type":63,"value":867},{"type":58,"tag":138,"props":3110,"children":3111},{"style":151},[3112],{"type":63,"value":872},{"type":58,"tag":138,"props":3114,"children":3115},{"style":145},[3116],{"type":63,"value":3117},"long",{"type":58,"tag":138,"props":3119,"children":3120},{"style":145},[3121],{"type":63,"value":3099},{"type":58,"tag":138,"props":3123,"children":3124},{"style":151},[3125],{"type":63,"value":1147},{"type":58,"tag":138,"props":3127,"children":3128},{"style":832},[3129],{"type":63,"value":835},{"type":58,"tag":138,"props":3131,"children":3132},{"style":151},[3133],{"type":63,"value":1167},{"type":58,"tag":138,"props":3135,"children":3136},{"style":1014},[3137],{"type":63,"value":3138},"1",{"type":58,"tag":138,"props":3140,"children":3141},{"style":151},[3142],{"type":63,"value":3143},"];\n",{"type":58,"tag":138,"props":3145,"children":3146},{"class":140,"line":191},[3147,3152,3157,3162,3167],{"type":58,"tag":138,"props":3148,"children":3149},{"style":1008},[3150],{"type":63,"value":3151},"    if",{"type":58,"tag":138,"props":3153,"children":3154},{"style":151},[3155],{"type":63,"value":3156}," (syscall_id ",{"type":58,"tag":138,"props":3158,"children":3159},{"style":673},[3160],{"type":63,"value":3161},"!=",{"type":58,"tag":138,"props":3163,"children":3164},{"style":1014},[3165],{"type":63,"value":3166}," 59",{"type":58,"tag":138,"props":3168,"children":3169},{"style":151},[3170],{"type":63,"value":798},{"type":58,"tag":138,"props":3172,"children":3173},{"class":140,"line":205},[3174,3179,3183],{"type":58,"tag":138,"props":3175,"children":3176},{"style":1008},[3177],{"type":63,"value":3178},"        return",{"type":58,"tag":138,"props":3180,"children":3181},{"style":1014},[3182],{"type":63,"value":1017},{"type":58,"tag":138,"props":3184,"children":3185},{"style":151},[3186],{"type":63,"value":1022},{"type":58,"tag":138,"props":3188,"children":3189},{"class":140,"line":41},[3190],{"type":58,"tag":138,"props":3191,"children":3192},{"emptyLinePlaceholder":11},[3193],{"type":63,"value":628},{"type":58,"tag":138,"props":3195,"children":3197},{"class":3196,"line":232},[140,554],[3198,3203,3208,3212,3217,3221,3225,3229,3233,3237,3241,3245,3249,3253,3258],{"type":58,"tag":138,"props":3199,"children":3200},{"style":145},[3201],{"type":63,"value":3202},"    struct",{"type":58,"tag":138,"props":3204,"children":3205},{"style":151},[3206],{"type":63,"value":3207}," pt_regs ",{"type":58,"tag":138,"props":3209,"children":3210},{"style":673},[3211],{"type":63,"value":676},{"type":58,"tag":138,"props":3213,"children":3214},{"style":151},[3215],{"type":63,"value":3216},"regs ",{"type":58,"tag":138,"props":3218,"children":3219},{"style":673},[3220],{"type":63,"value":867},{"type":58,"tag":138,"props":3222,"children":3223},{"style":151},[3224],{"type":63,"value":872},{"type":58,"tag":138,"props":3226,"children":3227},{"style":145},[3228],{"type":63,"value":148},{"type":58,"tag":138,"props":3230,"children":3231},{"style":151},[3232],{"type":63,"value":3207},{"type":58,"tag":138,"props":3234,"children":3235},{"style":673},[3236],{"type":63,"value":676},{"type":58,"tag":138,"props":3238,"children":3239},{"style":151},[3240],{"type":63,"value":1147},{"type":58,"tag":138,"props":3242,"children":3243},{"style":832},[3244],{"type":63,"value":835},{"type":58,"tag":138,"props":3246,"children":3247},{"style":151},[3248],{"type":63,"value":1167},{"type":58,"tag":138,"props":3250,"children":3251},{"style":1014},[3252],{"type":63,"value":1172},{"type":58,"tag":138,"props":3254,"children":3255},{"style":151},[3256],{"type":63,"value":3257},"];",{"type":58,"tag":138,"props":3259,"children":3260},{"style":157},[3261],{"type":63,"value":3262}," // No need to use BPF_CORE_READ helper\n",{"type":58,"tag":138,"props":3264,"children":3266},{"class":3265,"line":246},[140,554],[3267,3271,3275,3280,3284,3288,3292,3296,3300,3305,3310],{"type":58,"tag":138,"props":3268,"children":3269},{"style":145},[3270],{"type":63,"value":587},{"type":58,"tag":138,"props":3272,"children":3273},{"style":673},[3274],{"type":63,"value":712},{"type":58,"tag":138,"props":3276,"children":3277},{"style":151},[3278],{"type":63,"value":3279},"filename ",{"type":58,"tag":138,"props":3281,"children":3282},{"style":673},[3283],{"type":63,"value":867},{"type":58,"tag":138,"props":3285,"children":3286},{"style":151},[3287],{"type":63,"value":872},{"type":58,"tag":138,"props":3289,"children":3290},{"style":145},[3291],{"type":63,"value":1138},{"type":58,"tag":138,"props":3293,"children":3294},{"style":673},[3295],{"type":63,"value":712},{"type":58,"tag":138,"props":3297,"children":3298},{"style":151},[3299],{"type":63,"value":1147},{"type":58,"tag":138,"props":3301,"children":3302},{"style":779},[3303],{"type":63,"value":3304},"PT_REGS_PARM1",{"type":58,"tag":138,"props":3306,"children":3307},{"style":151},[3308],{"type":63,"value":3309},"(regs);",{"type":58,"tag":138,"props":3311,"children":3312},{"style":157},[3313],{"type":63,"value":3314}," // No need to use PT_REGS_PARM1_CORE helper\n",{"type":58,"tag":138,"props":3316,"children":3317},{"class":140,"line":260},[3318,3322,3327],{"type":58,"tag":138,"props":3319,"children":3320},{"style":145},[3321],{"type":63,"value":587},{"type":58,"tag":138,"props":3323,"children":3324},{"style":832},[3325],{"type":63,"value":3326}," buf",{"type":58,"tag":138,"props":3328,"children":3329},{"style":151},[3330],{"type":63,"value":935},{"type":58,"tag":138,"props":3332,"children":3334},{"class":3333,"line":40},[140,554],[3335,3339,3343,3347,3352],{"type":58,"tag":138,"props":3336,"children":3337},{"style":779},[3338],{"type":63,"value":944},{"type":58,"tag":138,"props":3340,"children":3341},{"style":151},[3342],{"type":63,"value":949},{"type":58,"tag":138,"props":3344,"children":3345},{"style":145},[3346],{"type":63,"value":954},{"type":58,"tag":138,"props":3348,"children":3349},{"style":151},[3350],{"type":63,"value":3351},"(buf), filename);",{"type":58,"tag":138,"props":3353,"children":3354},{"style":157},[3355],{"type":63,"value":3356}," // No need to use bpf_core_read_user_str helper\n",{"type":58,"tag":138,"props":3358,"children":3359},{"class":140,"line":542},[3360],{"type":58,"tag":138,"props":3361,"children":3362},{"emptyLinePlaceholder":11},[3363],{"type":63,"value":628},{"type":58,"tag":138,"props":3365,"children":3366},{"class":140,"line":543},[3367,3371,3375,3380,3384,3388],{"type":58,"tag":138,"props":3368,"children":3369},{"style":779},[3370],{"type":63,"value":976},{"type":58,"tag":138,"props":3372,"children":3373},{"style":151},[3374],{"type":63,"value":787},{"type":58,"tag":138,"props":3376,"children":3377},{"style":790},[3378],{"type":63,"value":3379},"\"BTF-enabled tracepoint (CO-RE) triggered for execve syscall with parameter filename: %s",{"type":58,"tag":138,"props":3381,"children":3382},{"style":988},[3383],{"type":63,"value":991},{"type":58,"tag":138,"props":3385,"children":3386},{"style":790},[3387],{"type":63,"value":996},{"type":58,"tag":138,"props":3389,"children":3390},{"style":151},[3391],{"type":63,"value":1001},{"type":58,"tag":138,"props":3393,"children":3394},{"class":140,"line":767},[3395,3399,3403],{"type":58,"tag":138,"props":3396,"children":3397},{"style":1008},[3398],{"type":63,"value":1011},{"type":58,"tag":138,"props":3400,"children":3401},{"style":1014},[3402],{"type":63,"value":1017},{"type":58,"tag":138,"props":3404,"children":3405},{"style":151},[3406],{"type":63,"value":1022},{"type":58,"tag":138,"props":3408,"children":3409},{"class":140,"line":775},[3410],{"type":58,"tag":138,"props":3411,"children":3412},{"style":151},[3413],{"type":63,"value":1031},{"type":58,"tag":59,"props":3415,"children":3416},{},[3417],{"type":63,"value":3418},"This makes the BTF-enabled tracepoint slightly more convenient to develop compared to the raw and regular tracepoints.",{"type":58,"tag":3420,"props":3421,"children":3422},"style",{},[3423],{"type":63,"value":3424},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":131,"searchDepth":163,"depth":163,"links":3427},[3428,3429,3430],{"id":516,"depth":163,"text":519},{"id":1640,"depth":163,"text":1643},{"id":2356,"depth":163,"text":2352},["Reactive",3432],{},["Reactive",3434],{},["Reactive",3436],{},"#portable-ebpf-programs-46216e54-server",{"left":39,"top":39,"width":3439,"height":3439,"rotate":39,"vFlip":3440,"hFlip":3440,"body":3441},24,false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":39,"top":39,"width":3443,"height":3443,"rotate":39,"vFlip":3440,"hFlip":3440,"body":3444},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",3446],{"$scurrentUser":3447,"$salerts":3451,"$scontentToggle":3452,"$ssite-config":3453},{"id":3448,"anonymous":11,"effectiveTier":3449,"hasEmailSubscription":3440},"697b5f64cc8f8f56faac74e1",{"name":3450},"free",[],{"/tutorials/portable-ebpf-programs-46216e54":11},{"_priority":3454,"env":3457,"name":3458,"url":3459},{"name":3455,"env":3456,"url":39},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",3462],{"tutorial-page-tutorial-portable-ebpf-programs-46216e54":-1,"content-tutorial-portable-ebpf-programs-46216e54-v1762190214682":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/portable-ebpf-programs-46216e54"]</script></body></html>