<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs</title><link nonce="" rel="stylesheet" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/inter.css"><link nonce="" rel="stylesheet" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">h4[data-v-f2a5dd23]{display:block;font-family:var(--typography-font-display);font-size:var(--prose-h4-fontSize);font-weight:var(--prose-h4-fontWeight);letter-spacing:var(--prose-h4-letterSpacing);line-height:var(--prose-h4-lineHeight);margin:var(--prose-h4-margin)}h4[data-v-f2a5dd23] .icon{display:inline-block;height:var(--prose-h4-iconSize);margin-inline-start:10px;opacity:0;transition:opacity .1s;width:var(--prose-h4-iconSize)}h4 a[data-v-f2a5dd23]:hover .icon{opacity:1}</style><style nonce="">details>summary[data-v-370f298d]{font-size:var(--prose-p-fontSize)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><style nonce="">em[data-v-c83db111]{font-family:var(--typography-font-body);font-style:italic}</style><style nonce="">hr[data-v-34b8dd49]{border-top:var(--prose-hr-width) var(--prose-hr-style) var(--prose-hr-color);margin:var(--prose-hr-margin)}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-3pKepD1O0M3aS2TBuTWkSY6sutdBuL8lDUVxYUx5Ej+xaE6p7jcjj/U5PEFiKfFd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bze7R7FK.js"><link nonce="" integrity="sha384-dmAK1hhiumNXMs/NjWqR1YxMm3vyiMg16sggZx3HjlYKju1wCeiJzsSNr9NEW6TG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddhl0Rna.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><link nonce="" integrity="sha384-xu7xpGLYeS0IbsjNLP5u/+IuPYZcceT7B26kgPDTCYvxrLG6Ua23dGz3TxOFGCP4" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BRQUNQ8K.js"><link nonce="" integrity="sha384-jGINj1ShftWKDI7S23mVZ+L6D2f9piqFpjk0Pzqu1vUKQJ4qE55dJD6e7E5C0bPG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BBTDB2dI.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="In this tutorial, you’ll learn why it is safe to run eBPF code in the kernel, some of its advantages compared to kernel modules, and why the verifier is the most crucial component of eBPF."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs | iximiuz Labs"><meta property="og:description" content="In this tutorial, you’ll learn why it is safe to run eBPF code in the kernel, some of its advantages compared to kernel modules, and why the verifier is the most crucial component of eBPF."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/ebpf-verifier-3bd2e199"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-verifier-3bd2e199/__static__/verifier.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs | iximiuz Labs"><meta name="twitter:description" content="In this tutorial, you’ll learn why it is safe to run eBPF code in the kernel, some of its advantages compared to kernel modules, and why the verifier is the most crucial component of eBPF."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-verifier-3bd2e199/__static__/verifier.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/ebpf-verifier-3bd2e199"><link nonce="" rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-verifier-3bd2e199/__static__/verifier.png"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/_name_.BsyFxT4E.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseCodeInline.BhuXSD4-.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseLi.BqrAa653.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseH4.DWM_oxDZ.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/DetailsBox.3wfYThLq.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProsePre.B_fgAJq0.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseEm.CT7G3_ue.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ProseHr.BdCZvnSy.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-verifier-3bd2e199/__static__/verifier.png"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/ebpf-verifier-3bd2e199" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Febpf-verifier-3bd2e199" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-verifier-3bd2e199" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#ebpf-verifier" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">eBPF Verifier</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-verifier-3bd2e199" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Programming</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs"><meta itemprop="abstract" content="In this tutorial, you’ll learn why it is safe to run eBPF code in the kernel, some of its advantages compared to kernel modules, and why the verifier is the most crucial component of eBPF."><meta itemprop="dateCreated" content="2025-09-01T00:00:00.000Z"><meta itemprop="datePublished" content="2025-09-01T00:00:00.000Z"><meta itemprop="dateModified" content="2025-09-01T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:underline no-underline truncate">Programming</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Sep 1, 2025"><time datetime="createdAt"> Published: Sep 1, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->When you start the tutorial, you’ll see a <code class="prose-code-inline" data-v-a031129a=""><!--[-->Term 1<!--]--></code> terminal and an <code class="prose-code-inline" data-v-a031129a=""><!--[-->IDE<!--]--></code> on the right-hand side. You are logged in as <code class="prose-code-inline" data-v-a031129a=""><!--[-->laborant<!--]--></code>, and the current working directory already contains the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-hello-world<!--]--></code> folder. Inside, you’ll find the <a href="https://github.com/dorkamotorka/ebpf-hello-world" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF Hello World labs<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, implemented with <a href="https://ebpf-go.dev/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->ebpf-go<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> — a Golang eBPF framework developed as part of the <a href="https://cilium.io/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->Cilium<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> project.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This tutorial serves as the continuation of <a href="https://labs.iximiuz.com/tutorials/my-first-ebpf-program-5120140e" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->From Zero to Your First eBPF Program<!--]--><!----></a>, <a href="https://labs.iximiuz.com/tutorials/ebpf-maps-tutorial-3efd4617" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->Storing Data in eBPF: Your First eBPF Map<!--]--><!----></a> and <a href="https://labs.iximiuz.com/tutorials/inspecting-ebpf-using-bpftool-43dfa319" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->Inspecting and Monitoring eBPF Applications<!--]--><!----></a>, expanding on the introduced concepts.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In this part, you’ll learn how the eBPF verifier ensures that eBPF code can run safely in the kernel.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:600px;"><div class="text-center"><img src="eBPF%20Verifier_%20Why%20the%20Kernel%20Can%20Safely%20Run%20eBPF%20Programs_files/ebpf-verifier.png" alt="eBPF Verifier" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->The code for this lab is located in the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-hello-world/lab4<!--]--></code>
 directory. The program is intentionally broken—meaning the verifier 
will reject it if you try to run it. Your task in the upcoming steps is 
to understand why it fails and then work on fixing it.<!--]--></p><h2 id="ebpf-verifier" class="prose-h2" data-v-b9b1576a=""><!--[-->eBPF Verifier<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->We’ve
 mentioned verification several times throughout these tutorials, so you
 already know that when you load an eBPF program into the kernel, this 
process ensures that the program is safe.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This verification is done by the <a href="https://docs.ebpf.io/linux/concepts/verifier/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF verifier<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.
 And by “safe”, we don’t mean cybersecurity-related security, but simply
 that the program won’t crash the system or cause a kernel panic.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 Safe execution is one of the biggest advantages of eBPF programs compared to traditional kernel modules.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->To
 achieve this, the verifier checks every possible execution path through
 your program and validates that each instruction is safe. This 
includes:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Validating Helper Functions<!--]--></strong>:
 Ensures only approved kernel helper functions are called, as different 
helper functions are valid for different BPF program types. (Remember 
the <code class="prose-code-inline" data-v-a031129a=""><!--[-->sudo bpftool feature probe<!--]--></code> output?)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Validating Helper Function Arguments<!--]--></strong>: Ensures the arguments passed to helper functions are valid.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Checking the License<!--]--></strong>:
 Ensures that if you are using an eBPF helper function that’s licensed 
under GPL, your program also has a GPL-compatible license.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Checking Memory Access<!--]--></strong>: Ensures the program only reads and writes to memory it is allowed to access.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Checking Pointers Before Dereferencing Them<!--]--></strong>: Ensures pointers in code are safe and not null or out of bounds before use.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Accessing Context<!--]--></strong>: Ensures that the program accesses only the fields in the input context structure it is allowed to.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Running to Completion<!--]--></strong>: Ensures the program will eventually finish instead of running forever.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Loops<!--]--></strong>: Ensures that loops are bounded and cannot cause infinite execution.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Checking the Return Code<!--]--></strong>: Ensures the program returns a valid value for its type of hook.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Invalid Instructions<!--]--></strong>: Rejects any instruction that is not supported or not allowed in eBPF.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Unreachable Instructions<!--]--></strong>: Flags and removes instructions that the program can never reach during execution.<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 the next sections, we’ll look at a few of these checks with practical 
examples and tips for debugging them. For more details about the eBPF 
verifier itself, we recommend <a href="https://isovalent.com/books/learning-ebpf/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->Learning eBPF, Chapter 6: The eBPF Verifier book<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><h4 id="checking-the-license" class="prose-h4" data-v-f2a5dd23=""><!--[-->Checking the License<!--]--><!----></h4><p class="prose-p" data-v-b025fb9f=""><!--[-->When
 an eBPF program is loaded into the kernel, the verifier inspects which 
helper functions it uses. If any of those helpers are marked “GPL-only,”
 the program must declare a GPL-compatible license.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">But how can one check if the helper function in use is GPL-licensed?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->It’s
 not the most convenient approach, but you can determine this for each 
helper function by checking the Linux kernel source for the 
corresponding <code class="prose-code-inline" data-v-a031129a=""><!--[-->&lt;helper-function&gt;_proto<!--]--></code> struct definition.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For example, the prototype for <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_probe_read_user_str()<!--]--></code> is <a href="https://codebrowser.dev/linux/linux/kernel/trace/bpf_trace.c.html#bpf_probe_read_user_str_proto" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_probe_read_user_str_proto<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, where the <code class="prose-code-inline" data-v-a031129a=""><!--[-->.gpl_only<!--]--></code> boolean field indicates that the helper is restricted to GPL-licensed programs.<!--]--></p><!--]--></details><!--]--></div><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Does that mean one also has to license the user-space part of the eBPF application as GPL?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Not really. When it comes to user space, your eBPF loader code and supporting libraries do <strong class="prose-strong" data-v-24022f14=""><!--[-->NOT<!--]--></strong> need to be GPL-licensed, only the in-kernel eBPF program does.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This
 separation allows companies and projects to keep user space tooling 
under permissive licenses while still running GPL-licensed code in the 
kernel. For more details, see the <a href="https://ebpf.io/blog/ebpf-licensing-guide/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF Licensing Guide<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->To demonstrate this, open the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-hello-world/lab4/hello.c<!--]--></code> file. You’ll find calls to helpers such as <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_probe_read_user_str()<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_update_elem()<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_lookup_elem()<!--]--></code> - but notice there’s no license definition anywhere in the code:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tracepoint/syscalls/sys_enter_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_tp</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_event_raw_sys_enter </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">args</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">];
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> path_key key </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {};
</span></span><span class="line highlight" line="6"><span style="--shiki-default:#569CD6">    long</span><span style="--shiki-default:#E6E6E6"> n </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">path</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">path</span><span style="--shiki-default:#E6E6E6">), filename);
</span></span><span class="line" line="7"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (n </span><span style="--shiki-default:#D4D4D4">&lt;=</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="8"><span style="--shiki-default:#C586C0">        return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;</span><span style="--shiki-default:#6A9955"> // couldn't read the path
</span></span><span class="line" line="9"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#E6E6E6">    __u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_map_lookup_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">exec_count, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key);
</span></span><span class="line" line="12"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (val) {
</span></span><span class="line" line="13"><span style="--shiki-default:#D4D4D4">        *</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">+=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="14"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="15"><span style="--shiki-default:#E6E6E6">        __u64 init </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line highlight" line="16"><span style="--shiki-default:#DCDCAA">        bpf_map_update_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">exec_count, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">init, BPF_NOEXIST);
</span></span><span class="line" line="17"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="18"><span style="--shiki-default:#E6E6E6">...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->If you build and run this program, you’ll see the following verifier error:<!--]--></p><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>cannot call GPL-restricted function from non-GPL compatible program
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->This is expected: like mentioned above or if you check the Linux kernel source, you’ll notice that among these helpers, <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_probe_read_user_str()<!--]--></code> is GPL-only.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To
 resolve this, you need to declare your program’s license explicitly. 
Add the following line anywhere in your code — top, bottom, or even in 
the middle doesn’t matter, as long as it’s present:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">char</span><span style="--shiki-default:#E6E6E6"> _license</span><span style="--shiki-default:#569CD6">[]</span><span style="--shiki-default:#DCDCAA"> SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"license"</span><span style="--shiki-default:#E6E6E6">) </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#CE9178"> "GPL"</span><span style="--shiki-default:#E6E6E6">;
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Does it always have to be GPL? What about dual-licensed options like Dual MIT/GPL?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Not necessarily. The eBPF license string just needs to be GPL-compatible.
The Linux kernel accepts several options, including <strong class="prose-strong" data-v-24022f14=""><!--[-->GPL<!--]--></strong>, <strong class="prose-strong" data-v-24022f14=""><!--[-->GPL v2<!--]--></strong>, <strong class="prose-strong" data-v-24022f14=""><!--[-->Dual BSD/GPL<!--]--></strong>, <strong class="prose-strong" data-v-24022f14=""><!--[-->Dual MIT/GPL<!--]--></strong>, and <strong class="prose-strong" data-v-24022f14=""><!--[-->Dual MPL/GPL<!--]--></strong>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Many projects actually choose a <strong class="prose-strong" data-v-24022f14=""><!--[-->dual license<!--]--></strong> in order to:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->satisfy the eBPF verifier in case of GPL-ed helper functions<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->give
 other projects flexibility to integrate/reuse parts of the eBPF code 
without being forced to adopt GPL for their entire codebase<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->For full details on accepted annotations, see the kernel’s <a href="https://github.com/torvalds/linux/blob/master/Documentation/process/license-rules.rst" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->license-rules documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Re-run the program and see it works as expected.<!--]--></p><h4 id="checking-pointers-before-dereferencing-them" class="prose-h4" data-v-f2a5dd23=""><!--[-->Checking Pointers Before Dereferencing Them<!--]--><!----></h4><p class="prose-p" data-v-b025fb9f=""><!--[-->Let’s say you want to validate or debug your program by printing which binary paths are executed and stored in the eBPF map.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To do this, you might try adding the following lines just before the end of your eBPF program:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_map_lookup_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">exec_count</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (val) {
</span></span><span class="line" line="4"><span style="--shiki-default:#D4D4D4">        *</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">+=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">        __u64 init </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="7"><span style="--shiki-default:#DCDCAA">        bpf_map_update_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">exec_count, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">init, BPF_NOEXIST);
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#6A9955">    // Step 2: Print `key.path` and `*val`
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"execve: %s (count: %llu)</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, key.path, </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">val</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="14"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->However, this won’t really work. If you try to run the program, you’ll hit a verifier error such as:<!--]--></p><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>last insn is not an exit or jmp (2 line(s) omitted)
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->At first glance, this error is a bit misleading. Technically, it’s the verifier’s way of saying <em class="prose-em" data-v-c83db111=""><!--[-->“your function doesn’t always end with a return instruction.”<!--]--></em><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But since we clearly have a <code class="prose-code-inline" data-v-a031129a=""><!--[-->return 0;<!--]--></code> in place, it feels like the verifier is just trolling us 😅.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And it’s also pretty clear the error only showed up after we added the new line. That means something about it must be wrong.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->We could now disassemble the <code class="prose-code-inline" data-v-a031129a=""><!--[-->hello_bpf.o<!--]--></code> kernel object (built with <code class="prose-code-inline" data-v-a031129a=""><!--[-->go generate<!--]--></code>
 command) to track down the error, but that would be another tutorial on
 its own. In this case, the issue is actually visible directly in our 
code.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The problem is that we never verify whether <code class="prose-code-inline" data-v-a031129a=""><!--[-->*val<!--]--></code> points to valid memory. The <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_lookup_elem<!--]--></code> helper may in fact return <code class="prose-code-inline" data-v-a031129a=""><!--[-->null<!--]--></code> which is not a valid memory location and cannot be safely dereferenced. To fix this, we need to move our <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_printk()<!--]--></code> statement inside the <code class="prose-code-inline" data-v-a031129a=""><!--[-->if (val)<!--]--></code> branch:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_map_lookup_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">exec_count</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="3"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (val) {
</span></span><span class="line" line="4"><span style="--shiki-default:#D4D4D4">        *</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">+=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">        __u64 init </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="7"><span style="--shiki-default:#DCDCAA">        bpf_map_update_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">exec_count, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">init, BPF_NOEXIST);
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#6A9955">    // Step 2: Print `key.path` and `*val`
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (val) {
</span></span><span class="line highlight" line="12"><span style="--shiki-default:#DCDCAA">        bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"execve: %s (count: %llu)</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">path</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">val);
</span></span><span class="line highlight" line="13"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="14"><span emptylineplaceholder="true">
</span></span><span class="line" line="15"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="16"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->To summarize this, always check pointers before dereferencing them.<!--]--></p><h4 id="running-to-completion-and-complexity-limit" class="prose-h4" data-v-f2a5dd23=""><!--[-->Running to Completion and Complexity Limit<!--]--><!----></h4><p class="prose-p" data-v-b025fb9f=""><!--[-->Another
 important verifier check is to make sure the program runs to completion
 in a relatively short amount of time. Otherwise, there is a risk that 
it might consume resources indefinitely, possibly containing infinite 
loops that could hang the kernel completely.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Just imagine our eBPF program attached to the <code class="prose-code-inline" data-v-a031129a=""><!--[-->execve()<!--]--></code> syscall running for too long. It could cause massive delays in the termination of the <code class="prose-code-inline" data-v-a031129a=""><!--[-->execve<!--]--></code> syscall and consequently have a significant impact on the system.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->So, when eBPF was introduced, there were two parameters that limited its size:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->The maximum number of eBPF bytecode instructions for a program:<!--]--></strong> 4096<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->The complexity limit:<!--]--></strong> 32768<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->You
 may think of the second number as the total number of instructions 
accumulated over all execution paths. So if a program had many logical 
branches or loops and required too much effort from the verifier, it 
would fail to load, even if it had fewer than 4096 instructions.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To allow for more complex eBPF programs, both limits were raised in a <a href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c04c0d2b968ac45d6ef020316808ef6c82325a82" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->commit in Linux 5.2<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to 1 million instructions.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->If your program is too complex and classified as hogging the system for too long, you'll end up seeing the following error:<!--]--></p><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>BPF program is too large. Processed 1000001 insn
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->But
 in reality, eBPF programs tend to be small, and the one-million-state 
complexity limit is big enough that most use cases will never hit it. 
Only some advanced projects like <a href="https://github.com/cilium/cilium" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->Cilium<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> may be facing it, and they need to regularly adjust their code to satisfy the verifier's requirements.<!--]--></p><hr class="prose-hr" data-v-34b8dd49=""><p class="prose-p" data-v-b025fb9f=""><!--[-->In our personal experience, the easiest and most trivial way to debug verifier code is by using a combination of <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_printk()<!--]--></code>
 function and commenting/uncommenting lines of code to determine the 
cause of the verification error and take it from there either through 
the byte code or general understanding of the checks that we discussed 
above.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->When 
still learning eBPF, getting code through the verifier seemed like a 
dark art and you might find yourself needing assistance to resolve 
verifier errors. And that's okay - we've all been there. The <a href="https://ebpf.io/slack" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF community Slack channel<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> is a good place to ask for help or just ping us directly.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 There's also a <a href="https://github.com/parttimenerd/ebpf-verifier-errors" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF verifier errors GitHub repository<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>
 that collects different verifier errors and their resolution. Although 
it's a gamble, whether it will be maintained over time but a nice 
resource when you're encountering issues.<!--]--></p><!--]--></div><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 One thing to bear in mind is that the verifier works on eBPF bytecode, 
not directly on the source. And that bytecode depends on the output from
 the compiler. Because of things like compiler optimization, a change in
 the source code might not always result in exactly what you expect in 
the bytecode, so correspondingly it might not give you the result you 
expect in the verifier’s verdict.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For
 example, the verifier will reject unreachable instructions, but the 
compiler might optimize them away before the verifier sees them.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Congrats, you've came to the end of this tutorial. 🥳<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The last four labs covered the fundamentals of eBPF — now it’s time to put your knowledge to the test. Head over to <a href="https://labs.iximiuz.com/challenges/ebpf-beginner-challenge-89ffd924" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->the Challenge<!--]--><!----></a> and see how much you’ve learned!<!--]--></p><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game — Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-ebpf-verifier-3bd2e199" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10"> ✕ </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial ebpf-verifier-3bd2e199<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">ebpf-verifier-3bd2e199</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial ebpf-verifier-3bd2e199<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-verifier-3bd2e199" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":2097,"once":2112,"_errors":2113,"serverRendered":11,"path":2115},["ShallowReactive",3],{"tutorial-page-tutorial-ebpf-verifier-3bd2e199":4,"content-tutorial-ebpf-verifier-3bd2e199-v1760554338460":49,"i-material-symbols-light:expand-content":2090,"i-ph:copy":2094},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":40,"completionCount":41,"accessControl":42,"userAccess":48},"68b538114b20bbbbc878102a","tutorial","ebpf-verifier-3bd2e199","eBPF Verifier: Why the Kernel Can Safely Run eBPF Programs","In this tutorial, you’ll learn why it is safe to run eBPF code in the kernel, some of its advantages compared to kernel modules, and why the verifier is the most crucial component of eBPF.","2025-09-01T00:00:00.000Z",true,"ebpf-playground-2bd77c1c",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#ebpf-verifier-3bd2e199","2025-09-01","tutorials/ebpf-verifier-3bd2e199/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1760554338460,"https://labs.iximiuz.com/tutorials/ebpf-verifier-3bd2e199","/content/files/tutorials/ebpf-verifier-3bd2e199/__static__/verifier.png",[30,31],"linux","programming",[33],"eBPF","todo",{"clone_hello_world":36},{"init":11,"user":37,"name":38,"status":39},"laborant","clone_hello_world",0,66,41,{"canList":43,"canPreview":45,"canRead":46,"canStart":47},[44],"anyone",[44],[44],[44],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[50],{"title":8,"description":51,"kind":6,"playground":52,"categories":53,"tagz":54,"createdAt":10,"updatedAt":10,"cover":28,"type":55,"children":56,"hash":15,"preview":-1,"pageUrl":27,"tasks":2079,"toc":2080,"tutorials":2083,"challenges":2085,"courses":2087,"key":2089},"In this tutorial, you’ll learn why it is safe to run eBPF code in the kernel, some of its advantages compared to kernel modules, and why the verifier is the most crucial component of eBPF.\n",{"name":12},[30,31],[33],"root",[57,126,158,163,170,183,189,194,208,218,223,347,361,367,372,424,453,487,1021,1026,1036,1048,1053,1110,1188,1193,1198,1203,1208,1480,1485,1494,1505,1518,1523,1544,1589,1883,1888,1894,1899,1920,1925,1948,1953,1967,1972,1981,1994,1998,2010,2024,2041,2054,2059,2073],{"type":58,"tag":59,"props":60,"children":61},"element","p",{},[62,65,72,74,80,82,87,89,95,97,106,108,115,117,124],{"type":63,"value":64},"text","When you start the tutorial, you’ll see a ",{"type":58,"tag":66,"props":67,"children":69},"code",{"className":68},[],[70],{"type":63,"value":71},"Term 1",{"type":63,"value":73}," terminal and an ",{"type":58,"tag":66,"props":75,"children":77},{"className":76},[],[78],{"type":63,"value":79},"IDE",{"type":63,"value":81}," on the right-hand side. You are logged in as ",{"type":58,"tag":66,"props":83,"children":85},{"className":84},[],[86],{"type":63,"value":37},{"type":63,"value":88},", and the current working directory already contains the ",{"type":58,"tag":66,"props":90,"children":92},{"className":91},[],[93],{"type":63,"value":94},"ebpf-hello-world",{"type":63,"value":96}," folder. Inside, you’ll find the ",{"type":58,"tag":98,"props":99,"children":103},"a",{"href":100,"rel":101},"https://github.com/dorkamotorka/ebpf-hello-world",[102],"nofollow",[104],{"type":63,"value":105},"eBPF Hello World labs",{"type":63,"value":107},", implemented with ",{"type":58,"tag":98,"props":109,"children":112},{"href":110,"rel":111},"https://ebpf-go.dev/",[102],[113],{"type":63,"value":114},"ebpf-go",{"type":63,"value":116}," — a Golang eBPF framework developed as part of the ",{"type":58,"tag":98,"props":118,"children":121},{"href":119,"rel":120},"https://cilium.io/",[102],[122],{"type":63,"value":123},"Cilium",{"type":63,"value":125}," project.",{"type":58,"tag":59,"props":127,"children":128},{},[129,131,138,140,147,149,156],{"type":63,"value":130},"This tutorial serves as the continuation of ",{"type":58,"tag":98,"props":132,"children":135},{"href":133,"rel":134},"https://labs.iximiuz.com/tutorials/my-first-ebpf-program-5120140e",[102],[136],{"type":63,"value":137},"From Zero to Your First eBPF Program",{"type":63,"value":139},", ",{"type":58,"tag":98,"props":141,"children":144},{"href":142,"rel":143},"https://labs.iximiuz.com/tutorials/ebpf-maps-tutorial-3efd4617",[102],[145],{"type":63,"value":146},"Storing Data in eBPF: Your First eBPF Map",{"type":63,"value":148}," and ",{"type":58,"tag":98,"props":150,"children":153},{"href":151,"rel":152},"https://labs.iximiuz.com/tutorials/inspecting-ebpf-using-bpftool-43dfa319",[102],[154],{"type":63,"value":155},"Inspecting and Monitoring eBPF Applications",{"type":63,"value":157},", expanding on the introduced concepts.",{"type":58,"tag":59,"props":159,"children":160},{},[161],{"type":63,"value":162},"In this part, you’ll learn how the eBPF verifier ensures that eBPF code can run safely in the kernel.",{"type":58,"tag":164,"props":165,"children":169},"image-box",{":alt":166,":max-width":167,":src":168},"eBPF Verifier","600px","/content/files/tutorials/ebpf-verifier-3bd2e199/__static__/ebpf-verifier.png",[],{"type":58,"tag":59,"props":171,"children":172},{},[173,175,181],{"type":63,"value":174},"The code for this lab is located in the ",{"type":58,"tag":66,"props":176,"children":178},{"className":177},[],[179],{"type":63,"value":180},"ebpf-hello-world/lab4",{"type":63,"value":182}," directory. The program is intentionally broken—meaning the verifier will reject it if you try to run it. Your task in the upcoming steps is to understand why it fails and then work on fixing it.",{"type":58,"tag":184,"props":185,"children":187},"h2",{"id":186},"ebpf-verifier",[188],{"type":63,"value":166},{"type":58,"tag":59,"props":190,"children":191},{},[192],{"type":63,"value":193},"We’ve mentioned verification several times throughout these tutorials, so you already know that when you load an eBPF program into the kernel, this process ensures that the program is safe.",{"type":58,"tag":59,"props":195,"children":196},{},[197,199,206],{"type":63,"value":198},"This verification is done by the ",{"type":58,"tag":98,"props":200,"children":203},{"href":201,"rel":202},"https://docs.ebpf.io/linux/concepts/verifier/",[102],[204],{"type":63,"value":205},"eBPF verifier",{"type":63,"value":207},". And by “safe”, we don’t mean cybersecurity-related security, but simply that the program won’t crash the system or cause a kernel panic.",{"type":58,"tag":209,"props":210,"children":212},"remark-box",{"kind":211},"info",[213],{"type":58,"tag":59,"props":214,"children":215},{},[216],{"type":63,"value":217},"💡 Safe execution is one of the biggest advantages of eBPF programs compared to traditional kernel modules.",{"type":58,"tag":59,"props":219,"children":220},{},[221],{"type":63,"value":222},"To achieve this, the verifier checks every possible execution path through your program and validates that each instruction is safe. This includes:",{"type":58,"tag":224,"props":225,"children":226},"ul",{},[227,247,257,267,277,287,297,307,317,327,337],{"type":58,"tag":228,"props":229,"children":230},"li",{},[231,237,239,245],{"type":58,"tag":232,"props":233,"children":234},"strong",{},[235],{"type":63,"value":236},"Validating Helper Functions",{"type":63,"value":238},": Ensures only approved kernel helper functions are called, as different helper functions are valid for different BPF program types. (Remember the ",{"type":58,"tag":66,"props":240,"children":242},{"className":241},[],[243],{"type":63,"value":244},"sudo bpftool feature probe",{"type":63,"value":246}," output?)",{"type":58,"tag":228,"props":248,"children":249},{},[250,255],{"type":58,"tag":232,"props":251,"children":252},{},[253],{"type":63,"value":254},"Validating Helper Function Arguments",{"type":63,"value":256},": Ensures the arguments passed to helper functions are valid.",{"type":58,"tag":228,"props":258,"children":259},{},[260,265],{"type":58,"tag":232,"props":261,"children":262},{},[263],{"type":63,"value":264},"Checking the License",{"type":63,"value":266},": Ensures that if you are using an eBPF helper function that’s licensed under GPL, your program also has a GPL-compatible license.",{"type":58,"tag":228,"props":268,"children":269},{},[270,275],{"type":58,"tag":232,"props":271,"children":272},{},[273],{"type":63,"value":274},"Checking Memory Access",{"type":63,"value":276},": Ensures the program only reads and writes to memory it is allowed to access.",{"type":58,"tag":228,"props":278,"children":279},{},[280,285],{"type":58,"tag":232,"props":281,"children":282},{},[283],{"type":63,"value":284},"Checking Pointers Before Dereferencing Them",{"type":63,"value":286},": Ensures pointers in code are safe and not null or out of bounds before use.",{"type":58,"tag":228,"props":288,"children":289},{},[290,295],{"type":58,"tag":232,"props":291,"children":292},{},[293],{"type":63,"value":294},"Accessing Context",{"type":63,"value":296},": Ensures that the program accesses only the fields in the input context structure it is allowed to.",{"type":58,"tag":228,"props":298,"children":299},{},[300,305],{"type":58,"tag":232,"props":301,"children":302},{},[303],{"type":63,"value":304},"Running to Completion",{"type":63,"value":306},": Ensures the program will eventually finish instead of running forever.",{"type":58,"tag":228,"props":308,"children":309},{},[310,315],{"type":58,"tag":232,"props":311,"children":312},{},[313],{"type":63,"value":314},"Loops",{"type":63,"value":316},": Ensures that loops are bounded and cannot cause infinite execution.",{"type":58,"tag":228,"props":318,"children":319},{},[320,325],{"type":58,"tag":232,"props":321,"children":322},{},[323],{"type":63,"value":324},"Checking the Return Code",{"type":63,"value":326},": Ensures the program returns a valid value for its type of hook.",{"type":58,"tag":228,"props":328,"children":329},{},[330,335],{"type":58,"tag":232,"props":331,"children":332},{},[333],{"type":63,"value":334},"Invalid Instructions",{"type":63,"value":336},": Rejects any instruction that is not supported or not allowed in eBPF.",{"type":58,"tag":228,"props":338,"children":339},{},[340,345],{"type":58,"tag":232,"props":341,"children":342},{},[343],{"type":63,"value":344},"Unreachable Instructions",{"type":63,"value":346},": Flags and removes instructions that the program can never reach during execution.",{"type":58,"tag":59,"props":348,"children":349},{},[350,352,359],{"type":63,"value":351},"In the next sections, we’ll look at a few of these checks with practical examples and tips for debugging them. For more details about the eBPF verifier itself, we recommend ",{"type":58,"tag":98,"props":353,"children":356},{"href":354,"rel":355},"https://isovalent.com/books/learning-ebpf/",[102],[357],{"type":63,"value":358},"Learning eBPF, Chapter 6: The eBPF Verifier book",{"type":63,"value":360},".",{"type":58,"tag":362,"props":363,"children":365},"h4",{"id":364},"checking-the-license",[366],{"type":63,"value":264},{"type":58,"tag":59,"props":368,"children":369},{},[370],{"type":63,"value":371},"When an eBPF program is loaded into the kernel, the verifier inspects which helper functions it uses. If any of those helpers are marked “GPL-only,” the program must declare a GPL-compatible license.",{"type":58,"tag":373,"props":374,"children":376},"details-box",{":summary":375},"But how can one check if the helper function in use is GPL-licensed?",[377,390],{"type":58,"tag":59,"props":378,"children":379},{},[380,382,388],{"type":63,"value":381},"It’s not the most convenient approach, but you can determine this for each helper function by checking the Linux kernel source for the corresponding ",{"type":58,"tag":66,"props":383,"children":385},{"className":384},[],[386],{"type":63,"value":387},"\u003Chelper-function>_proto",{"type":63,"value":389}," struct definition.",{"type":58,"tag":59,"props":391,"children":392},{},[393,395,401,403,414,416,422],{"type":63,"value":394},"For example, the prototype for ",{"type":58,"tag":66,"props":396,"children":398},{"className":397},[],[399],{"type":63,"value":400},"bpf_probe_read_user_str()",{"type":63,"value":402}," is ",{"type":58,"tag":98,"props":404,"children":407},{"href":405,"rel":406},"https://codebrowser.dev/linux/linux/kernel/trace/bpf_trace.c.html#bpf_probe_read_user_str_proto",[102],[408],{"type":58,"tag":66,"props":409,"children":411},{"className":410},[],[412],{"type":63,"value":413},"bpf_probe_read_user_str_proto",{"type":63,"value":415},", where the ",{"type":58,"tag":66,"props":417,"children":419},{"className":418},[],[420],{"type":63,"value":421},".gpl_only",{"type":63,"value":423}," boolean field indicates that the helper is restricted to GPL-licensed programs.",{"type":58,"tag":373,"props":425,"children":427},{":summary":426},"Does that mean one also has to license the user-space part of the eBPF application as GPL?",[428,440],{"type":58,"tag":59,"props":429,"children":430},{},[431,433,438],{"type":63,"value":432},"Not really. When it comes to user space, your eBPF loader code and supporting libraries do ",{"type":58,"tag":232,"props":434,"children":435},{},[436],{"type":63,"value":437},"NOT",{"type":63,"value":439}," need to be GPL-licensed, only the in-kernel eBPF program does.",{"type":58,"tag":59,"props":441,"children":442},{},[443,445,452],{"type":63,"value":444},"This separation allows companies and projects to keep user space tooling under permissive licenses while still running GPL-licensed code in the kernel. For more details, see the ",{"type":58,"tag":98,"props":446,"children":449},{"href":447,"rel":448},"https://ebpf.io/blog/ebpf-licensing-guide/",[102],[450],{"type":63,"value":451},"eBPF Licensing Guide",{"type":63,"value":360},{"type":58,"tag":59,"props":454,"children":455},{},[456,458,464,466,471,472,478,479,485],{"type":63,"value":457},"To demonstrate this, open the ",{"type":58,"tag":66,"props":459,"children":461},{"className":460},[],[462],{"type":63,"value":463},"ebpf-hello-world/lab4/hello.c",{"type":63,"value":465}," file. You’ll find calls to helpers such as ",{"type":58,"tag":66,"props":467,"children":469},{"className":468},[],[470],{"type":63,"value":400},{"type":63,"value":139},{"type":58,"tag":66,"props":473,"children":475},{"className":474},[],[476],{"type":63,"value":477},"bpf_map_update_elem()",{"type":63,"value":148},{"type":58,"tag":66,"props":480,"children":482},{"className":481},[],[483],{"type":63,"value":484},"bpf_map_lookup_elem()",{"type":63,"value":486}," - but notice there’s no license definition anywhere in the code:",{"type":58,"tag":488,"props":489,"children":499},"pre",{"className":490,"code":491,"filename":492,"highlights":493,"language":497,"meta":498,"style":498},"language-c shiki shiki-themes slack-dark","SEC(\"tracepoint/syscalls/sys_enter_execve\")\nint handle_execve_tp(struct trace_event_raw_sys_enter *ctx) {\n    const char *filename = (const char *)ctx->args[0];\n\n    struct path_key key = {};\n    long n = bpf_probe_read_user_str(key.path, sizeof(key.path), filename);\n    if (n \u003C= 0) {\n        return 0; // couldn't read the path\n    }\n\n    __u64 *val = bpf_map_lookup_elem(&exec_count, &key);\n    if (val) {\n        *val += 1;\n    } else {\n        __u64 init = 1;\n        bpf_map_update_elem(&exec_count, &key, &init, BPF_NOEXIST);\n    }\n...\n","hello.c",[494,495,496],6,11,16,"c","",[500],{"type":58,"tag":66,"props":501,"children":502},{"__ignoreMap":498},[503,532,578,660,669,692,764,793,817,826,834,884,897,925,944,965,1004,1012],{"type":58,"tag":504,"props":505,"children":508},"span",{"class":506,"line":507},"line",1,[509,515,521,527],{"type":58,"tag":504,"props":510,"children":512},{"style":511},"--shiki-default:#DCDCAA",[513],{"type":63,"value":514},"SEC",{"type":58,"tag":504,"props":516,"children":518},{"style":517},"--shiki-default:#E6E6E6",[519],{"type":63,"value":520},"(",{"type":58,"tag":504,"props":522,"children":524},{"style":523},"--shiki-default:#CE9178",[525],{"type":63,"value":526},"\"tracepoint/syscalls/sys_enter_execve\"",{"type":58,"tag":504,"props":528,"children":529},{"style":517},[530],{"type":63,"value":531},")\n",{"type":58,"tag":504,"props":533,"children":535},{"class":506,"line":534},2,[536,542,547,551,556,561,567,573],{"type":58,"tag":504,"props":537,"children":539},{"style":538},"--shiki-default:#569CD6",[540],{"type":63,"value":541},"int",{"type":58,"tag":504,"props":543,"children":544},{"style":511},[545],{"type":63,"value":546}," handle_execve_tp",{"type":58,"tag":504,"props":548,"children":549},{"style":517},[550],{"type":63,"value":520},{"type":58,"tag":504,"props":552,"children":553},{"style":538},[554],{"type":63,"value":555},"struct",{"type":58,"tag":504,"props":557,"children":558},{"style":517},[559],{"type":63,"value":560}," trace_event_raw_sys_enter ",{"type":58,"tag":504,"props":562,"children":564},{"style":563},"--shiki-default:#D4D4D4",[565],{"type":63,"value":566},"*",{"type":58,"tag":504,"props":568,"children":570},{"style":569},"--shiki-default:#9CDCFE",[571],{"type":63,"value":572},"ctx",{"type":58,"tag":504,"props":574,"children":575},{"style":517},[576],{"type":63,"value":577},") {\n",{"type":58,"tag":504,"props":579,"children":581},{"class":506,"line":580},3,[582,587,592,597,602,607,612,617,621,625,630,634,639,644,649,655],{"type":58,"tag":504,"props":583,"children":584},{"style":538},[585],{"type":63,"value":586},"    const",{"type":58,"tag":504,"props":588,"children":589},{"style":538},[590],{"type":63,"value":591}," char",{"type":58,"tag":504,"props":593,"children":594},{"style":563},[595],{"type":63,"value":596}," *",{"type":58,"tag":504,"props":598,"children":599},{"style":517},[600],{"type":63,"value":601},"filename ",{"type":58,"tag":504,"props":603,"children":604},{"style":563},[605],{"type":63,"value":606},"=",{"type":58,"tag":504,"props":608,"children":609},{"style":517},[610],{"type":63,"value":611}," (",{"type":58,"tag":504,"props":613,"children":614},{"style":538},[615],{"type":63,"value":616},"const",{"type":58,"tag":504,"props":618,"children":619},{"style":538},[620],{"type":63,"value":591},{"type":58,"tag":504,"props":622,"children":623},{"style":563},[624],{"type":63,"value":596},{"type":58,"tag":504,"props":626,"children":627},{"style":517},[628],{"type":63,"value":629},")",{"type":58,"tag":504,"props":631,"children":632},{"style":569},[633],{"type":63,"value":572},{"type":58,"tag":504,"props":635,"children":636},{"style":517},[637],{"type":63,"value":638},"->",{"type":58,"tag":504,"props":640,"children":641},{"style":569},[642],{"type":63,"value":643},"args",{"type":58,"tag":504,"props":645,"children":646},{"style":517},[647],{"type":63,"value":648},"[",{"type":58,"tag":504,"props":650,"children":652},{"style":651},"--shiki-default:#B5CEA8",[653],{"type":63,"value":654},"0",{"type":58,"tag":504,"props":656,"children":657},{"style":517},[658],{"type":63,"value":659},"];\n",{"type":58,"tag":504,"props":661,"children":663},{"class":506,"line":662},4,[664],{"type":58,"tag":504,"props":665,"children":666},{"emptyLinePlaceholder":11},[667],{"type":63,"value":668},"\n",{"type":58,"tag":504,"props":670,"children":672},{"class":506,"line":671},5,[673,678,683,687],{"type":58,"tag":504,"props":674,"children":675},{"style":538},[676],{"type":63,"value":677},"    struct",{"type":58,"tag":504,"props":679,"children":680},{"style":517},[681],{"type":63,"value":682}," path_key key ",{"type":58,"tag":504,"props":684,"children":685},{"style":563},[686],{"type":63,"value":606},{"type":58,"tag":504,"props":688,"children":689},{"style":517},[690],{"type":63,"value":691}," {};\n",{"type":58,"tag":504,"props":693,"children":696},{"class":694,"line":494},[506,695],"highlight",[697,702,707,711,716,720,725,729,734,738,743,747,751,755,759],{"type":58,"tag":504,"props":698,"children":699},{"style":538},[700],{"type":63,"value":701},"    long",{"type":58,"tag":504,"props":703,"children":704},{"style":517},[705],{"type":63,"value":706}," n ",{"type":58,"tag":504,"props":708,"children":709},{"style":563},[710],{"type":63,"value":606},{"type":58,"tag":504,"props":712,"children":713},{"style":511},[714],{"type":63,"value":715}," bpf_probe_read_user_str",{"type":58,"tag":504,"props":717,"children":718},{"style":517},[719],{"type":63,"value":520},{"type":58,"tag":504,"props":721,"children":722},{"style":569},[723],{"type":63,"value":724},"key",{"type":58,"tag":504,"props":726,"children":727},{"style":517},[728],{"type":63,"value":360},{"type":58,"tag":504,"props":730,"children":731},{"style":569},[732],{"type":63,"value":733},"path",{"type":58,"tag":504,"props":735,"children":736},{"style":517},[737],{"type":63,"value":139},{"type":58,"tag":504,"props":739,"children":740},{"style":538},[741],{"type":63,"value":742},"sizeof",{"type":58,"tag":504,"props":744,"children":745},{"style":517},[746],{"type":63,"value":520},{"type":58,"tag":504,"props":748,"children":749},{"style":569},[750],{"type":63,"value":724},{"type":58,"tag":504,"props":752,"children":753},{"style":517},[754],{"type":63,"value":360},{"type":58,"tag":504,"props":756,"children":757},{"style":569},[758],{"type":63,"value":733},{"type":58,"tag":504,"props":760,"children":761},{"style":517},[762],{"type":63,"value":763},"), filename);\n",{"type":58,"tag":504,"props":765,"children":767},{"class":506,"line":766},7,[768,774,779,784,789],{"type":58,"tag":504,"props":769,"children":771},{"style":770},"--shiki-default:#C586C0",[772],{"type":63,"value":773},"    if",{"type":58,"tag":504,"props":775,"children":776},{"style":517},[777],{"type":63,"value":778}," (n ",{"type":58,"tag":504,"props":780,"children":781},{"style":563},[782],{"type":63,"value":783},"\u003C=",{"type":58,"tag":504,"props":785,"children":786},{"style":651},[787],{"type":63,"value":788}," 0",{"type":58,"tag":504,"props":790,"children":791},{"style":517},[792],{"type":63,"value":577},{"type":58,"tag":504,"props":794,"children":796},{"class":506,"line":795},8,[797,802,806,811],{"type":58,"tag":504,"props":798,"children":799},{"style":770},[800],{"type":63,"value":801},"        return",{"type":58,"tag":504,"props":803,"children":804},{"style":651},[805],{"type":63,"value":788},{"type":58,"tag":504,"props":807,"children":808},{"style":517},[809],{"type":63,"value":810},";",{"type":58,"tag":504,"props":812,"children":814},{"style":813},"--shiki-default:#6A9955",[815],{"type":63,"value":816}," // couldn't read the path\n",{"type":58,"tag":504,"props":818,"children":820},{"class":506,"line":819},9,[821],{"type":58,"tag":504,"props":822,"children":823},{"style":517},[824],{"type":63,"value":825},"    }\n",{"type":58,"tag":504,"props":827,"children":829},{"class":506,"line":828},10,[830],{"type":58,"tag":504,"props":831,"children":832},{"emptyLinePlaceholder":11},[833],{"type":63,"value":668},{"type":58,"tag":504,"props":835,"children":837},{"class":836,"line":495},[506,695],[838,843,847,852,856,861,865,870,875,879],{"type":58,"tag":504,"props":839,"children":840},{"style":517},[841],{"type":63,"value":842},"    __u64 ",{"type":58,"tag":504,"props":844,"children":845},{"style":563},[846],{"type":63,"value":566},{"type":58,"tag":504,"props":848,"children":849},{"style":517},[850],{"type":63,"value":851},"val ",{"type":58,"tag":504,"props":853,"children":854},{"style":563},[855],{"type":63,"value":606},{"type":58,"tag":504,"props":857,"children":858},{"style":511},[859],{"type":63,"value":860}," bpf_map_lookup_elem",{"type":58,"tag":504,"props":862,"children":863},{"style":517},[864],{"type":63,"value":520},{"type":58,"tag":504,"props":866,"children":867},{"style":563},[868],{"type":63,"value":869},"&",{"type":58,"tag":504,"props":871,"children":872},{"style":517},[873],{"type":63,"value":874},"exec_count, ",{"type":58,"tag":504,"props":876,"children":877},{"style":563},[878],{"type":63,"value":869},{"type":58,"tag":504,"props":880,"children":881},{"style":517},[882],{"type":63,"value":883},"key);\n",{"type":58,"tag":504,"props":885,"children":887},{"class":506,"line":886},12,[888,892],{"type":58,"tag":504,"props":889,"children":890},{"style":770},[891],{"type":63,"value":773},{"type":58,"tag":504,"props":893,"children":894},{"style":517},[895],{"type":63,"value":896}," (val) {\n",{"type":58,"tag":504,"props":898,"children":900},{"class":506,"line":899},13,[901,906,910,915,920],{"type":58,"tag":504,"props":902,"children":903},{"style":563},[904],{"type":63,"value":905},"        *",{"type":58,"tag":504,"props":907,"children":908},{"style":517},[909],{"type":63,"value":851},{"type":58,"tag":504,"props":911,"children":912},{"style":563},[913],{"type":63,"value":914},"+=",{"type":58,"tag":504,"props":916,"children":917},{"style":651},[918],{"type":63,"value":919}," 1",{"type":58,"tag":504,"props":921,"children":922},{"style":517},[923],{"type":63,"value":924},";\n",{"type":58,"tag":504,"props":926,"children":928},{"class":506,"line":927},14,[929,934,939],{"type":58,"tag":504,"props":930,"children":931},{"style":517},[932],{"type":63,"value":933},"    } ",{"type":58,"tag":504,"props":935,"children":936},{"style":770},[937],{"type":63,"value":938},"else",{"type":58,"tag":504,"props":940,"children":941},{"style":517},[942],{"type":63,"value":943}," {\n",{"type":58,"tag":504,"props":945,"children":947},{"class":506,"line":946},15,[948,953,957,961],{"type":58,"tag":504,"props":949,"children":950},{"style":517},[951],{"type":63,"value":952},"        __u64 init ",{"type":58,"tag":504,"props":954,"children":955},{"style":563},[956],{"type":63,"value":606},{"type":58,"tag":504,"props":958,"children":959},{"style":651},[960],{"type":63,"value":919},{"type":58,"tag":504,"props":962,"children":963},{"style":517},[964],{"type":63,"value":924},{"type":58,"tag":504,"props":966,"children":968},{"class":967,"line":496},[506,695],[969,974,978,982,986,990,995,999],{"type":58,"tag":504,"props":970,"children":971},{"style":511},[972],{"type":63,"value":973},"        bpf_map_update_elem",{"type":58,"tag":504,"props":975,"children":976},{"style":517},[977],{"type":63,"value":520},{"type":58,"tag":504,"props":979,"children":980},{"style":563},[981],{"type":63,"value":869},{"type":58,"tag":504,"props":983,"children":984},{"style":517},[985],{"type":63,"value":874},{"type":58,"tag":504,"props":987,"children":988},{"style":563},[989],{"type":63,"value":869},{"type":58,"tag":504,"props":991,"children":992},{"style":517},[993],{"type":63,"value":994},"key, ",{"type":58,"tag":504,"props":996,"children":997},{"style":563},[998],{"type":63,"value":869},{"type":58,"tag":504,"props":1000,"children":1001},{"style":517},[1002],{"type":63,"value":1003},"init, BPF_NOEXIST);\n",{"type":58,"tag":504,"props":1005,"children":1007},{"class":506,"line":1006},17,[1008],{"type":58,"tag":504,"props":1009,"children":1010},{"style":517},[1011],{"type":63,"value":825},{"type":58,"tag":504,"props":1013,"children":1015},{"class":506,"line":1014},18,[1016],{"type":58,"tag":504,"props":1017,"children":1018},{"style":517},[1019],{"type":63,"value":1020},"...\n",{"type":58,"tag":59,"props":1022,"children":1023},{},[1024],{"type":63,"value":1025},"If you build and run this program, you’ll see the following verifier error:",{"type":58,"tag":488,"props":1027,"children":1031},{"className":1028,"code":1030,"language":63},[1029],"language-text","cannot call GPL-restricted function from non-GPL compatible program\n",[1032],{"type":58,"tag":66,"props":1033,"children":1034},{"__ignoreMap":498},[1035],{"type":63,"value":1030},{"type":58,"tag":59,"props":1037,"children":1038},{},[1039,1041,1046],{"type":63,"value":1040},"This is expected: like mentioned above or if you check the Linux kernel source, you’ll notice that among these helpers, ",{"type":58,"tag":66,"props":1042,"children":1044},{"className":1043},[],[1045],{"type":63,"value":400},{"type":63,"value":1047}," is GPL-only.",{"type":58,"tag":59,"props":1049,"children":1050},{},[1051],{"type":63,"value":1052},"To resolve this, you need to declare your program’s license explicitly. Add the following line anywhere in your code — top, bottom, or even in the middle doesn’t matter, as long as it’s present:",{"type":58,"tag":488,"props":1054,"children":1056},{"className":490,"code":1055,"filename":492,"language":497,"meta":498,"style":498},"char _license[] SEC(\"license\") = \"GPL\";\n",[1057],{"type":58,"tag":66,"props":1058,"children":1059},{"__ignoreMap":498},[1060],{"type":58,"tag":504,"props":1061,"children":1062},{"class":506,"line":507},[1063,1068,1073,1078,1083,1087,1092,1097,1101,1106],{"type":58,"tag":504,"props":1064,"children":1065},{"style":538},[1066],{"type":63,"value":1067},"char",{"type":58,"tag":504,"props":1069,"children":1070},{"style":517},[1071],{"type":63,"value":1072}," _license",{"type":58,"tag":504,"props":1074,"children":1075},{"style":538},[1076],{"type":63,"value":1077},"[]",{"type":58,"tag":504,"props":1079,"children":1080},{"style":511},[1081],{"type":63,"value":1082}," SEC",{"type":58,"tag":504,"props":1084,"children":1085},{"style":517},[1086],{"type":63,"value":520},{"type":58,"tag":504,"props":1088,"children":1089},{"style":523},[1090],{"type":63,"value":1091},"\"license\"",{"type":58,"tag":504,"props":1093,"children":1094},{"style":517},[1095],{"type":63,"value":1096},") ",{"type":58,"tag":504,"props":1098,"children":1099},{"style":563},[1100],{"type":63,"value":606},{"type":58,"tag":504,"props":1102,"children":1103},{"style":523},[1104],{"type":63,"value":1105}," \"GPL\"",{"type":58,"tag":504,"props":1107,"children":1108},{"style":517},[1109],{"type":63,"value":924},{"type":58,"tag":373,"props":1111,"children":1113},{":summary":1112},"Does it always have to be GPL? What about dual-licensed options like Dual MIT/GPL?",[1114,1150,1162,1175],{"type":58,"tag":59,"props":1115,"children":1116},{},[1117,1119,1124,1125,1130,1131,1136,1137,1142,1144,1149],{"type":63,"value":1118},"Not necessarily. The eBPF license string just needs to be GPL-compatible.\nThe Linux kernel accepts several options, including ",{"type":58,"tag":232,"props":1120,"children":1121},{},[1122],{"type":63,"value":1123},"GPL",{"type":63,"value":139},{"type":58,"tag":232,"props":1126,"children":1127},{},[1128],{"type":63,"value":1129},"GPL v2",{"type":63,"value":139},{"type":58,"tag":232,"props":1132,"children":1133},{},[1134],{"type":63,"value":1135},"Dual BSD/GPL",{"type":63,"value":139},{"type":58,"tag":232,"props":1138,"children":1139},{},[1140],{"type":63,"value":1141},"Dual MIT/GPL",{"type":63,"value":1143},", and ",{"type":58,"tag":232,"props":1145,"children":1146},{},[1147],{"type":63,"value":1148},"Dual MPL/GPL",{"type":63,"value":360},{"type":58,"tag":59,"props":1151,"children":1152},{},[1153,1155,1160],{"type":63,"value":1154},"Many projects actually choose a ",{"type":58,"tag":232,"props":1156,"children":1157},{},[1158],{"type":63,"value":1159},"dual license",{"type":63,"value":1161}," in order to:",{"type":58,"tag":224,"props":1163,"children":1164},{},[1165,1170],{"type":58,"tag":228,"props":1166,"children":1167},{},[1168],{"type":63,"value":1169},"satisfy the eBPF verifier in case of GPL-ed helper functions",{"type":58,"tag":228,"props":1171,"children":1172},{},[1173],{"type":63,"value":1174},"give other projects flexibility to integrate/reuse parts of the eBPF code without being forced to adopt GPL for their entire codebase",{"type":58,"tag":59,"props":1176,"children":1177},{},[1178,1180,1187],{"type":63,"value":1179},"For full details on accepted annotations, see the kernel’s ",{"type":58,"tag":98,"props":1181,"children":1184},{"href":1182,"rel":1183},"https://github.com/torvalds/linux/blob/master/Documentation/process/license-rules.rst",[102],[1185],{"type":63,"value":1186},"license-rules documentation",{"type":63,"value":360},{"type":58,"tag":59,"props":1189,"children":1190},{},[1191],{"type":63,"value":1192},"Re-run the program and see it works as expected.",{"type":58,"tag":362,"props":1194,"children":1196},{"id":1195},"checking-pointers-before-dereferencing-them",[1197],{"type":63,"value":284},{"type":58,"tag":59,"props":1199,"children":1200},{},[1201],{"type":63,"value":1202},"Let’s say you want to validate or debug your program by printing which binary paths are executed and stored in the eBPF map.",{"type":58,"tag":59,"props":1204,"children":1205},{},[1206],{"type":63,"value":1207},"To do this, you might try adding the following lines just before the end of your eBPF program:",{"type":58,"tag":488,"props":1209,"children":1212},{"className":490,"code":1210,"filename":492,"highlights":1211,"language":497,"meta":498,"style":498},"...\n    __u64 *val = bpf_map_lookup_elem(&exec_count, &key);\n    if (val) {\n        *val += 1;\n    } else {\n        __u64 init = 1;\n        bpf_map_update_elem(&exec_count, &key, &init, BPF_NOEXIST);\n    }\n\n    // Step 2: Print `key.path` and `*val`\n    bpf_printk(\"execve: %s (count: %llu)\\n\", key.path, *val);\n\n    return 0;\n}\n",[828,495],[1213],{"type":58,"tag":66,"props":1214,"children":1215},{"__ignoreMap":498},[1216,1223,1276,1287,1310,1325,1344,1379,1386,1393,1402,1449,1456,1472],{"type":58,"tag":504,"props":1217,"children":1218},{"class":506,"line":507},[1219],{"type":58,"tag":504,"props":1220,"children":1221},{"style":517},[1222],{"type":63,"value":1020},{"type":58,"tag":504,"props":1224,"children":1225},{"class":506,"line":534},[1226,1230,1234,1238,1242,1246,1250,1254,1259,1263,1267,1271],{"type":58,"tag":504,"props":1227,"children":1228},{"style":517},[1229],{"type":63,"value":842},{"type":58,"tag":504,"props":1231,"children":1232},{"style":563},[1233],{"type":63,"value":566},{"type":58,"tag":504,"props":1235,"children":1236},{"style":517},[1237],{"type":63,"value":851},{"type":58,"tag":504,"props":1239,"children":1240},{"style":563},[1241],{"type":63,"value":606},{"type":58,"tag":504,"props":1243,"children":1244},{"style":511},[1245],{"type":63,"value":860},{"type":58,"tag":504,"props":1247,"children":1248},{"style":517},[1249],{"type":63,"value":520},{"type":58,"tag":504,"props":1251,"children":1252},{"style":563},[1253],{"type":63,"value":869},{"type":58,"tag":504,"props":1255,"children":1256},{"style":569},[1257],{"type":63,"value":1258},"exec_count",{"type":58,"tag":504,"props":1260,"children":1261},{"style":517},[1262],{"type":63,"value":139},{"type":58,"tag":504,"props":1264,"children":1265},{"style":563},[1266],{"type":63,"value":869},{"type":58,"tag":504,"props":1268,"children":1269},{"style":569},[1270],{"type":63,"value":724},{"type":58,"tag":504,"props":1272,"children":1273},{"style":517},[1274],{"type":63,"value":1275},");\n",{"type":58,"tag":504,"props":1277,"children":1278},{"class":506,"line":580},[1279,1283],{"type":58,"tag":504,"props":1280,"children":1281},{"style":770},[1282],{"type":63,"value":773},{"type":58,"tag":504,"props":1284,"children":1285},{"style":517},[1286],{"type":63,"value":896},{"type":58,"tag":504,"props":1288,"children":1289},{"class":506,"line":662},[1290,1294,1298,1302,1306],{"type":58,"tag":504,"props":1291,"children":1292},{"style":563},[1293],{"type":63,"value":905},{"type":58,"tag":504,"props":1295,"children":1296},{"style":517},[1297],{"type":63,"value":851},{"type":58,"tag":504,"props":1299,"children":1300},{"style":563},[1301],{"type":63,"value":914},{"type":58,"tag":504,"props":1303,"children":1304},{"style":651},[1305],{"type":63,"value":919},{"type":58,"tag":504,"props":1307,"children":1308},{"style":517},[1309],{"type":63,"value":924},{"type":58,"tag":504,"props":1311,"children":1312},{"class":506,"line":671},[1313,1317,1321],{"type":58,"tag":504,"props":1314,"children":1315},{"style":517},[1316],{"type":63,"value":933},{"type":58,"tag":504,"props":1318,"children":1319},{"style":770},[1320],{"type":63,"value":938},{"type":58,"tag":504,"props":1322,"children":1323},{"style":517},[1324],{"type":63,"value":943},{"type":58,"tag":504,"props":1326,"children":1327},{"class":506,"line":494},[1328,1332,1336,1340],{"type":58,"tag":504,"props":1329,"children":1330},{"style":517},[1331],{"type":63,"value":952},{"type":58,"tag":504,"props":1333,"children":1334},{"style":563},[1335],{"type":63,"value":606},{"type":58,"tag":504,"props":1337,"children":1338},{"style":651},[1339],{"type":63,"value":919},{"type":58,"tag":504,"props":1341,"children":1342},{"style":517},[1343],{"type":63,"value":924},{"type":58,"tag":504,"props":1345,"children":1346},{"class":506,"line":766},[1347,1351,1355,1359,1363,1367,1371,1375],{"type":58,"tag":504,"props":1348,"children":1349},{"style":511},[1350],{"type":63,"value":973},{"type":58,"tag":504,"props":1352,"children":1353},{"style":517},[1354],{"type":63,"value":520},{"type":58,"tag":504,"props":1356,"children":1357},{"style":563},[1358],{"type":63,"value":869},{"type":58,"tag":504,"props":1360,"children":1361},{"style":517},[1362],{"type":63,"value":874},{"type":58,"tag":504,"props":1364,"children":1365},{"style":563},[1366],{"type":63,"value":869},{"type":58,"tag":504,"props":1368,"children":1369},{"style":517},[1370],{"type":63,"value":994},{"type":58,"tag":504,"props":1372,"children":1373},{"style":563},[1374],{"type":63,"value":869},{"type":58,"tag":504,"props":1376,"children":1377},{"style":517},[1378],{"type":63,"value":1003},{"type":58,"tag":504,"props":1380,"children":1381},{"class":506,"line":795},[1382],{"type":58,"tag":504,"props":1383,"children":1384},{"style":517},[1385],{"type":63,"value":825},{"type":58,"tag":504,"props":1387,"children":1388},{"class":506,"line":819},[1389],{"type":58,"tag":504,"props":1390,"children":1391},{"emptyLinePlaceholder":11},[1392],{"type":63,"value":668},{"type":58,"tag":504,"props":1394,"children":1396},{"class":1395,"line":828},[506,695],[1397],{"type":58,"tag":504,"props":1398,"children":1399},{"style":813},[1400],{"type":63,"value":1401},"    // Step 2: Print `key.path` and `*val`\n",{"type":58,"tag":504,"props":1403,"children":1405},{"class":1404,"line":495},[506,695],[1406,1411,1415,1420,1426,1431,1436,1440,1445],{"type":58,"tag":504,"props":1407,"children":1408},{"style":511},[1409],{"type":63,"value":1410},"    bpf_printk",{"type":58,"tag":504,"props":1412,"children":1413},{"style":517},[1414],{"type":63,"value":520},{"type":58,"tag":504,"props":1416,"children":1417},{"style":523},[1418],{"type":63,"value":1419},"\"execve: %s (count: %llu)",{"type":58,"tag":504,"props":1421,"children":1423},{"style":1422},"--shiki-default:#D7BA7D",[1424],{"type":63,"value":1425},"\\n",{"type":58,"tag":504,"props":1427,"children":1428},{"style":523},[1429],{"type":63,"value":1430},"\"",{"type":58,"tag":504,"props":1432,"children":1433},{"style":517},[1434],{"type":63,"value":1435},", key.path, ",{"type":58,"tag":504,"props":1437,"children":1438},{"style":563},[1439],{"type":63,"value":566},{"type":58,"tag":504,"props":1441,"children":1442},{"style":569},[1443],{"type":63,"value":1444},"val",{"type":58,"tag":504,"props":1446,"children":1447},{"style":517},[1448],{"type":63,"value":1275},{"type":58,"tag":504,"props":1450,"children":1451},{"class":506,"line":886},[1452],{"type":58,"tag":504,"props":1453,"children":1454},{"emptyLinePlaceholder":11},[1455],{"type":63,"value":668},{"type":58,"tag":504,"props":1457,"children":1458},{"class":506,"line":899},[1459,1464,1468],{"type":58,"tag":504,"props":1460,"children":1461},{"style":770},[1462],{"type":63,"value":1463},"    return",{"type":58,"tag":504,"props":1465,"children":1466},{"style":651},[1467],{"type":63,"value":788},{"type":58,"tag":504,"props":1469,"children":1470},{"style":517},[1471],{"type":63,"value":924},{"type":58,"tag":504,"props":1473,"children":1474},{"class":506,"line":927},[1475],{"type":58,"tag":504,"props":1476,"children":1477},{"style":517},[1478],{"type":63,"value":1479},"}\n",{"type":58,"tag":59,"props":1481,"children":1482},{},[1483],{"type":63,"value":1484},"However, this won’t really work. If you try to run the program, you’ll hit a verifier error such as:",{"type":58,"tag":488,"props":1486,"children":1489},{"className":1487,"code":1488,"language":63},[1029],"last insn is not an exit or jmp (2 line(s) omitted)\n",[1490],{"type":58,"tag":66,"props":1491,"children":1492},{"__ignoreMap":498},[1493],{"type":63,"value":1488},{"type":58,"tag":59,"props":1495,"children":1496},{},[1497,1499],{"type":63,"value":1498},"At first glance, this error is a bit misleading. Technically, it’s the verifier’s way of saying ",{"type":58,"tag":1500,"props":1501,"children":1502},"em",{},[1503],{"type":63,"value":1504},"“your function doesn’t always end with a return instruction.”",{"type":58,"tag":59,"props":1506,"children":1507},{},[1508,1510,1516],{"type":63,"value":1509},"But since we clearly have a ",{"type":58,"tag":66,"props":1511,"children":1513},{"className":1512},[],[1514],{"type":63,"value":1515},"return 0;",{"type":63,"value":1517}," in place, it feels like the verifier is just trolling us 😅.",{"type":58,"tag":59,"props":1519,"children":1520},{},[1521],{"type":63,"value":1522},"And it’s also pretty clear the error only showed up after we added the new line. That means something about it must be wrong.",{"type":58,"tag":59,"props":1524,"children":1525},{},[1526,1528,1534,1536,1542],{"type":63,"value":1527},"We could now disassemble the ",{"type":58,"tag":66,"props":1529,"children":1531},{"className":1530},[],[1532],{"type":63,"value":1533},"hello_bpf.o",{"type":63,"value":1535}," kernel object (built with ",{"type":58,"tag":66,"props":1537,"children":1539},{"className":1538},[],[1540],{"type":63,"value":1541},"go generate",{"type":63,"value":1543}," command) to track down the error, but that would be another tutorial on its own. In this case, the issue is actually visible directly in our code.",{"type":58,"tag":59,"props":1545,"children":1546},{},[1547,1549,1555,1557,1563,1565,1571,1573,1579,1581,1587],{"type":63,"value":1548},"The problem is that we never verify whether ",{"type":58,"tag":66,"props":1550,"children":1552},{"className":1551},[],[1553],{"type":63,"value":1554},"*val",{"type":63,"value":1556}," points to valid memory. The ",{"type":58,"tag":66,"props":1558,"children":1560},{"className":1559},[],[1561],{"type":63,"value":1562},"bpf_map_lookup_elem",{"type":63,"value":1564}," helper may in fact return ",{"type":58,"tag":66,"props":1566,"children":1568},{"className":1567},[],[1569],{"type":63,"value":1570},"null",{"type":63,"value":1572}," which is not a valid memory location and cannot be safely dereferenced. To fix this, we need to move our ",{"type":58,"tag":66,"props":1574,"children":1576},{"className":1575},[],[1577],{"type":63,"value":1578},"bpf_printk()",{"type":63,"value":1580}," statement inside the ",{"type":58,"tag":66,"props":1582,"children":1584},{"className":1583},[],[1585],{"type":63,"value":1586},"if (val)",{"type":63,"value":1588}," branch:",{"type":58,"tag":488,"props":1590,"children":1593},{"className":490,"code":1591,"filename":492,"highlights":1592,"language":497,"meta":498,"style":498},"...\n    __u64 *val = bpf_map_lookup_elem(&exec_count, &key);\n    if (val) {\n        *val += 1;\n    } else {\n        __u64 init = 1;\n        bpf_map_update_elem(&exec_count, &key, &init, BPF_NOEXIST);\n    }\n\n    // Step 2: Print `key.path` and `*val`\n    if (val) {\n        bpf_printk(\"execve: %s (count: %llu)\\n\", key.path, *val);\n    }\n\n    return 0;\n}\n",[828,495,886,899],[1594],{"type":58,"tag":66,"props":1595,"children":1596},{"__ignoreMap":498},[1597,1604,1655,1666,1689,1704,1723,1758,1765,1772,1780,1792,1846,1854,1861,1876],{"type":58,"tag":504,"props":1598,"children":1599},{"class":506,"line":507},[1600],{"type":58,"tag":504,"props":1601,"children":1602},{"style":517},[1603],{"type":63,"value":1020},{"type":58,"tag":504,"props":1605,"children":1606},{"class":506,"line":534},[1607,1611,1615,1619,1623,1627,1631,1635,1639,1643,1647,1651],{"type":58,"tag":504,"props":1608,"children":1609},{"style":517},[1610],{"type":63,"value":842},{"type":58,"tag":504,"props":1612,"children":1613},{"style":563},[1614],{"type":63,"value":566},{"type":58,"tag":504,"props":1616,"children":1617},{"style":517},[1618],{"type":63,"value":851},{"type":58,"tag":504,"props":1620,"children":1621},{"style":563},[1622],{"type":63,"value":606},{"type":58,"tag":504,"props":1624,"children":1625},{"style":511},[1626],{"type":63,"value":860},{"type":58,"tag":504,"props":1628,"children":1629},{"style":517},[1630],{"type":63,"value":520},{"type":58,"tag":504,"props":1632,"children":1633},{"style":563},[1634],{"type":63,"value":869},{"type":58,"tag":504,"props":1636,"children":1637},{"style":569},[1638],{"type":63,"value":1258},{"type":58,"tag":504,"props":1640,"children":1641},{"style":517},[1642],{"type":63,"value":139},{"type":58,"tag":504,"props":1644,"children":1645},{"style":563},[1646],{"type":63,"value":869},{"type":58,"tag":504,"props":1648,"children":1649},{"style":569},[1650],{"type":63,"value":724},{"type":58,"tag":504,"props":1652,"children":1653},{"style":517},[1654],{"type":63,"value":1275},{"type":58,"tag":504,"props":1656,"children":1657},{"class":506,"line":580},[1658,1662],{"type":58,"tag":504,"props":1659,"children":1660},{"style":770},[1661],{"type":63,"value":773},{"type":58,"tag":504,"props":1663,"children":1664},{"style":517},[1665],{"type":63,"value":896},{"type":58,"tag":504,"props":1667,"children":1668},{"class":506,"line":662},[1669,1673,1677,1681,1685],{"type":58,"tag":504,"props":1670,"children":1671},{"style":563},[1672],{"type":63,"value":905},{"type":58,"tag":504,"props":1674,"children":1675},{"style":517},[1676],{"type":63,"value":851},{"type":58,"tag":504,"props":1678,"children":1679},{"style":563},[1680],{"type":63,"value":914},{"type":58,"tag":504,"props":1682,"children":1683},{"style":651},[1684],{"type":63,"value":919},{"type":58,"tag":504,"props":1686,"children":1687},{"style":517},[1688],{"type":63,"value":924},{"type":58,"tag":504,"props":1690,"children":1691},{"class":506,"line":671},[1692,1696,1700],{"type":58,"tag":504,"props":1693,"children":1694},{"style":517},[1695],{"type":63,"value":933},{"type":58,"tag":504,"props":1697,"children":1698},{"style":770},[1699],{"type":63,"value":938},{"type":58,"tag":504,"props":1701,"children":1702},{"style":517},[1703],{"type":63,"value":943},{"type":58,"tag":504,"props":1705,"children":1706},{"class":506,"line":494},[1707,1711,1715,1719],{"type":58,"tag":504,"props":1708,"children":1709},{"style":517},[1710],{"type":63,"value":952},{"type":58,"tag":504,"props":1712,"children":1713},{"style":563},[1714],{"type":63,"value":606},{"type":58,"tag":504,"props":1716,"children":1717},{"style":651},[1718],{"type":63,"value":919},{"type":58,"tag":504,"props":1720,"children":1721},{"style":517},[1722],{"type":63,"value":924},{"type":58,"tag":504,"props":1724,"children":1725},{"class":506,"line":766},[1726,1730,1734,1738,1742,1746,1750,1754],{"type":58,"tag":504,"props":1727,"children":1728},{"style":511},[1729],{"type":63,"value":973},{"type":58,"tag":504,"props":1731,"children":1732},{"style":517},[1733],{"type":63,"value":520},{"type":58,"tag":504,"props":1735,"children":1736},{"style":563},[1737],{"type":63,"value":869},{"type":58,"tag":504,"props":1739,"children":1740},{"style":517},[1741],{"type":63,"value":874},{"type":58,"tag":504,"props":1743,"children":1744},{"style":563},[1745],{"type":63,"value":869},{"type":58,"tag":504,"props":1747,"children":1748},{"style":517},[1749],{"type":63,"value":994},{"type":58,"tag":504,"props":1751,"children":1752},{"style":563},[1753],{"type":63,"value":869},{"type":58,"tag":504,"props":1755,"children":1756},{"style":517},[1757],{"type":63,"value":1003},{"type":58,"tag":504,"props":1759,"children":1760},{"class":506,"line":795},[1761],{"type":58,"tag":504,"props":1762,"children":1763},{"style":517},[1764],{"type":63,"value":825},{"type":58,"tag":504,"props":1766,"children":1767},{"class":506,"line":819},[1768],{"type":58,"tag":504,"props":1769,"children":1770},{"emptyLinePlaceholder":11},[1771],{"type":63,"value":668},{"type":58,"tag":504,"props":1773,"children":1775},{"class":1774,"line":828},[506,695],[1776],{"type":58,"tag":504,"props":1777,"children":1778},{"style":813},[1779],{"type":63,"value":1401},{"type":58,"tag":504,"props":1781,"children":1783},{"class":1782,"line":495},[506,695],[1784,1788],{"type":58,"tag":504,"props":1785,"children":1786},{"style":770},[1787],{"type":63,"value":773},{"type":58,"tag":504,"props":1789,"children":1790},{"style":517},[1791],{"type":63,"value":896},{"type":58,"tag":504,"props":1793,"children":1795},{"class":1794,"line":886},[506,695],[1796,1801,1805,1809,1813,1817,1821,1825,1829,1833,1837,1841],{"type":58,"tag":504,"props":1797,"children":1798},{"style":511},[1799],{"type":63,"value":1800},"        bpf_printk",{"type":58,"tag":504,"props":1802,"children":1803},{"style":517},[1804],{"type":63,"value":520},{"type":58,"tag":504,"props":1806,"children":1807},{"style":523},[1808],{"type":63,"value":1419},{"type":58,"tag":504,"props":1810,"children":1811},{"style":1422},[1812],{"type":63,"value":1425},{"type":58,"tag":504,"props":1814,"children":1815},{"style":523},[1816],{"type":63,"value":1430},{"type":58,"tag":504,"props":1818,"children":1819},{"style":517},[1820],{"type":63,"value":139},{"type":58,"tag":504,"props":1822,"children":1823},{"style":569},[1824],{"type":63,"value":724},{"type":58,"tag":504,"props":1826,"children":1827},{"style":517},[1828],{"type":63,"value":360},{"type":58,"tag":504,"props":1830,"children":1831},{"style":569},[1832],{"type":63,"value":733},{"type":58,"tag":504,"props":1834,"children":1835},{"style":517},[1836],{"type":63,"value":139},{"type":58,"tag":504,"props":1838,"children":1839},{"style":563},[1840],{"type":63,"value":566},{"type":58,"tag":504,"props":1842,"children":1843},{"style":517},[1844],{"type":63,"value":1845},"val);\n",{"type":58,"tag":504,"props":1847,"children":1849},{"class":1848,"line":899},[506,695],[1850],{"type":58,"tag":504,"props":1851,"children":1852},{"style":517},[1853],{"type":63,"value":825},{"type":58,"tag":504,"props":1855,"children":1856},{"class":506,"line":927},[1857],{"type":58,"tag":504,"props":1858,"children":1859},{"emptyLinePlaceholder":11},[1860],{"type":63,"value":668},{"type":58,"tag":504,"props":1862,"children":1863},{"class":506,"line":946},[1864,1868,1872],{"type":58,"tag":504,"props":1865,"children":1866},{"style":770},[1867],{"type":63,"value":1463},{"type":58,"tag":504,"props":1869,"children":1870},{"style":651},[1871],{"type":63,"value":788},{"type":58,"tag":504,"props":1873,"children":1874},{"style":517},[1875],{"type":63,"value":924},{"type":58,"tag":504,"props":1877,"children":1878},{"class":506,"line":496},[1879],{"type":58,"tag":504,"props":1880,"children":1881},{"style":517},[1882],{"type":63,"value":1479},{"type":58,"tag":59,"props":1884,"children":1885},{},[1886],{"type":63,"value":1887},"To summarize this, always check pointers before dereferencing them.",{"type":58,"tag":362,"props":1889,"children":1891},{"id":1890},"running-to-completion-and-complexity-limit",[1892],{"type":63,"value":1893},"Running to Completion and Complexity Limit",{"type":58,"tag":59,"props":1895,"children":1896},{},[1897],{"type":63,"value":1898},"Another important verifier check is to make sure the program runs to completion in a relatively short amount of time. Otherwise, there is a risk that it might consume resources indefinitely, possibly containing infinite loops that could hang the kernel completely.",{"type":58,"tag":59,"props":1900,"children":1901},{},[1902,1904,1910,1912,1918],{"type":63,"value":1903},"Just imagine our eBPF program attached to the ",{"type":58,"tag":66,"props":1905,"children":1907},{"className":1906},[],[1908],{"type":63,"value":1909},"execve()",{"type":63,"value":1911}," syscall running for too long. It could cause massive delays in the termination of the ",{"type":58,"tag":66,"props":1913,"children":1915},{"className":1914},[],[1916],{"type":63,"value":1917},"execve",{"type":63,"value":1919}," syscall and consequently have a significant impact on the system.",{"type":58,"tag":59,"props":1921,"children":1922},{},[1923],{"type":63,"value":1924},"So, when eBPF was introduced, there were two parameters that limited its size:",{"type":58,"tag":224,"props":1926,"children":1927},{},[1928,1938],{"type":58,"tag":228,"props":1929,"children":1930},{},[1931,1936],{"type":58,"tag":232,"props":1932,"children":1933},{},[1934],{"type":63,"value":1935},"The maximum number of eBPF bytecode instructions for a program:",{"type":63,"value":1937}," 4096",{"type":58,"tag":228,"props":1939,"children":1940},{},[1941,1946],{"type":58,"tag":232,"props":1942,"children":1943},{},[1944],{"type":63,"value":1945},"The complexity limit:",{"type":63,"value":1947}," 32768",{"type":58,"tag":59,"props":1949,"children":1950},{},[1951],{"type":63,"value":1952},"You may think of the second number as the total number of instructions accumulated over all execution paths. So if a program had many logical branches or loops and required too much effort from the verifier, it would fail to load, even if it had fewer than 4096 instructions.",{"type":58,"tag":59,"props":1954,"children":1955},{},[1956,1958,1965],{"type":63,"value":1957},"To allow for more complex eBPF programs, both limits were raised in a ",{"type":58,"tag":98,"props":1959,"children":1962},{"href":1960,"rel":1961},"https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c04c0d2b968ac45d6ef020316808ef6c82325a82",[102],[1963],{"type":63,"value":1964},"commit in Linux 5.2",{"type":63,"value":1966}," to 1 million instructions.",{"type":58,"tag":59,"props":1968,"children":1969},{},[1970],{"type":63,"value":1971},"If your program is too complex and classified as hogging the system for too long, you'll end up seeing the following error:",{"type":58,"tag":488,"props":1973,"children":1976},{"className":1974,"code":1975,"language":63},[1029],"BPF program is too large. Processed 1000001 insn\n",[1977],{"type":58,"tag":66,"props":1978,"children":1979},{"__ignoreMap":498},[1980],{"type":63,"value":1975},{"type":58,"tag":59,"props":1982,"children":1983},{},[1984,1986,1992],{"type":63,"value":1985},"But in reality, eBPF programs tend to be small, and the one-million-state complexity limit is big enough that most use cases will never hit it. Only some advanced projects like ",{"type":58,"tag":98,"props":1987,"children":1990},{"href":1988,"rel":1989},"https://github.com/cilium/cilium",[102],[1991],{"type":63,"value":123},{"type":63,"value":1993}," may be facing it, and they need to regularly adjust their code to satisfy the verifier's requirements.",{"type":58,"tag":1995,"props":1996,"children":1997},"hr",{},[],{"type":58,"tag":59,"props":1999,"children":2000},{},[2001,2003,2008],{"type":63,"value":2002},"In our personal experience, the easiest and most trivial way to debug verifier code is by using a combination of ",{"type":58,"tag":66,"props":2004,"children":2006},{"className":2005},[],[2007],{"type":63,"value":1578},{"type":63,"value":2009}," function and commenting/uncommenting lines of code to determine the cause of the verification error and take it from there either through the byte code or general understanding of the checks that we discussed above.",{"type":58,"tag":59,"props":2011,"children":2012},{},[2013,2015,2022],{"type":63,"value":2014},"When still learning eBPF, getting code through the verifier seemed like a dark art and you might find yourself needing assistance to resolve verifier errors. And that's okay - we've all been there. The ",{"type":58,"tag":98,"props":2016,"children":2019},{"href":2017,"rel":2018},"https://ebpf.io/slack",[102],[2020],{"type":63,"value":2021},"eBPF community Slack channel",{"type":63,"value":2023}," is a good place to ask for help or just ping us directly.",{"type":58,"tag":209,"props":2025,"children":2026},{"kind":211},[2027],{"type":58,"tag":59,"props":2028,"children":2029},{},[2030,2032,2039],{"type":63,"value":2031},"💡 There's also a ",{"type":58,"tag":98,"props":2033,"children":2036},{"href":2034,"rel":2035},"https://github.com/parttimenerd/ebpf-verifier-errors",[102],[2037],{"type":63,"value":2038},"eBPF verifier errors GitHub repository",{"type":63,"value":2040}," that collects different verifier errors and their resolution. Although it's a gamble, whether it will be maintained over time but a nice resource when you're encountering issues.",{"type":58,"tag":209,"props":2042,"children":2043},{"kind":211},[2044,2049],{"type":58,"tag":59,"props":2045,"children":2046},{},[2047],{"type":63,"value":2048},"💡 One thing to bear in mind is that the verifier works on eBPF bytecode, not directly on the source. And that bytecode depends on the output from the compiler. Because of things like compiler optimization, a change in the source code might not always result in exactly what you expect in the bytecode, so correspondingly it might not give you the result you expect in the verifier’s verdict.",{"type":58,"tag":59,"props":2050,"children":2051},{},[2052],{"type":63,"value":2053},"For example, the verifier will reject unreachable instructions, but the compiler might optimize them away before the verifier sees them.",{"type":58,"tag":59,"props":2055,"children":2056},{},[2057],{"type":63,"value":2058},"Congrats, you've came to the end of this tutorial. 🥳",{"type":58,"tag":59,"props":2060,"children":2061},{},[2062,2064,2071],{"type":63,"value":2063},"The last four labs covered the fundamentals of eBPF — now it’s time to put your knowledge to the test. Head over to ",{"type":58,"tag":98,"props":2065,"children":2068},{"href":2066,"rel":2067},"https://labs.iximiuz.com/challenges/ebpf-beginner-challenge-89ffd924",[102],[2069],{"type":63,"value":2070},"the Challenge",{"type":63,"value":2072}," and see how much you’ve learned!",{"type":58,"tag":2074,"props":2075,"children":2076},"style",{},[2077],{"type":63,"value":2078},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":498,"searchDepth":534,"depth":534,"links":2081},[2082],{"id":186,"depth":534,"text":166},["Reactive",2084],{},["Reactive",2086],{},["Reactive",2088],{},"#ebpf-verifier-3bd2e199-server",{"left":39,"top":39,"width":2091,"height":2091,"rotate":39,"vFlip":2092,"hFlip":2092,"body":2093},24,false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":39,"top":39,"width":2095,"height":2095,"rotate":39,"vFlip":2092,"hFlip":2092,"body":2096},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",2098],{"$scurrentUser":2099,"$salerts":2103,"$scontentToggle":2104,"$ssite-config":2105},{"id":2100,"anonymous":11,"effectiveTier":2101,"hasEmailSubscription":2092},"697b5f64cc8f8f56faac74e1",{"name":2102},"free",[],{"/tutorials/ebpf-verifier-3bd2e199":11},{"_priority":2106,"env":2109,"name":2110,"url":2111},{"name":2107,"env":2108,"url":39},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",2114],{"tutorial-page-tutorial-ebpf-verifier-3bd2e199":-1,"content-tutorial-ebpf-verifier-3bd2e199-v1760554338460":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/ebpf-verifier-3bd2e199"]</script></body></html>