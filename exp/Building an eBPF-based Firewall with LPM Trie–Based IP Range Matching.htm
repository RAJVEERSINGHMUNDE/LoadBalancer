<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching</title><link nonce="" rel="stylesheet" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/inter.css"><link nonce="" rel="stylesheet" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">details>summary[data-v-370f298d]{font-size:var(--prose-p-fontSize)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><style nonce="">hr[data-v-34b8dd49]{border-top:var(--prose-hr-width) var(--prose-hr-style) var(--prose-hr-color);margin:var(--prose-hr-margin)}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-jGINj1ShftWKDI7S23mVZ+L6D2f9piqFpjk0Pzqu1vUKQJ4qE55dJD6e7E5C0bPG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BBTDB2dI.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><link nonce="" integrity="sha384-dmAK1hhiumNXMs/NjWqR1YxMm3vyiMg16sggZx3HjlYKju1wCeiJzsSNr9NEW6TG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddhl0Rna.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="Learn how to build an eBPF/XDP firewall that filters packets by IP ranges using BPF_MAP_TYPE_LPM_TRIE and longest-prefix matching."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching | iximiuz Labs"><meta property="og:description" content="Learn how to build an eBPF/XDP firewall that filters packets by IP ranges using BPF_MAP_TYPE_LPM_TRIE and longest-prefix matching."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/ebpf-firewall-ed03d648"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-firewall-ed03d648/__static__/firewall.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching | iximiuz Labs"><meta name="twitter:description" content="Learn how to build an eBPF/XDP firewall that filters packets by IP ranges using BPF_MAP_TYPE_LPM_TRIE and longest-prefix matching."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-firewall-ed03d648/__static__/firewall.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/ebpf-firewall-ed03d648"><link nonce="" rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-firewall-ed03d648/__static__/firewall.png"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/_name_.BsyFxT4E.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseCodeInline.BhuXSD4-.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseLi.BqrAa653.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/DetailsBox.3wfYThLq.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProsePre.B_fgAJq0.css"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/ProseHr.BdCZvnSy.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-firewall-ed03d648/__static__/firewall.png"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/ebpf-firewall-ed03d648" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Febpf-firewall-ed03d648" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-firewall-ed03d648" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#high-level-overview" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">High-Level Overview</a><!----></li><li data-v-c294bba9=""><a href="#bpf_map_type_lpm_trie-ebpf-map" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">BPF_MAP_TYPE_LPM_TRIE eBPF map</a><!----></li><li data-v-c294bba9=""><a href="#implementation-breakdown" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">Implementation Breakdown</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-firewall-ed03d648" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Programming</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching"><meta itemprop="abstract" content="Learn how to build an eBPF/XDP firewall that filters packets by IP ranges using BPF_MAP_TYPE_LPM_TRIE and longest-prefix matching."><meta itemprop="dateCreated" content="2025-12-26T00:00:00.000Z"><meta itemprop="datePublished" content="2025-12-26T00:00:00.000Z"><meta itemprop="dateModified" content="2025-12-26T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:underline no-underline truncate">Programming</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Dec 26, 2025"><time datetime="createdAt"> Published: Dec 26, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->By now, we already know how to <a href="https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->capture network traffic using eBPF/XDP<!--]--><!----></a>, parse it, and even perform some basic <a href="https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->IPv6 ICMP rate limiting<!--]--><!----></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->So
 naturally, you might wonder how different an eBPF-based firewall really
 is from the rate limiter. After all, instead of rate-limiting packets, 
we could just block them entirely, right?<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Well, not quite.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->While
 our firewall implementation will only focus on filtering packets by 
client IP (not by ports, protocol, or fingerprinting), one ideally 
doesn’t want users to specify every single IP rule manually. In many 
cases, it would be much easier to allow one to whitelist or blacklist 
entire IP ranges instead.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Nonetheless,
 a simple IP-based firewall might work fine if you’re only whitelisting a
 few static addresses. But what if those IPs are dynamic and constantly 
changing within a certain range or subnet?<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:600px;"><div class="text-center"><img src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/firewall-trans.webp" alt="XDP Firewall" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->But how?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In this tutorial, we’ll learn how to filter network packets using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code>
 eBPF map type, which allows one to easily check and enforce whether a 
certain IP (client machine) belongs to a blacklisted IP range or not.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This playground has a network topology with 4 separate machines on three different networks:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> in network <code class="prose-code-inline" data-v-a031129a=""><!--[-->172.16.0.10/24<!--]--></code><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->client<!--]--></code> in network <code class="prose-code-inline" data-v-a031129a=""><!--[-->10.0.0.10/16<!--]--></code><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->attacker<!--]--></code> in network <code class="prose-code-inline" data-v-a031129a=""><!--[-->192.168.178.10/24<!--]--></code><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->gateway<!--]--></code> between networks <code class="prose-code-inline" data-v-a031129a=""><!--[-->192.168.178.0/24<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->10.0.0.0/16<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->172.16.0.10/24<!--]--></code><!--]--></li><!--]--></ul><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/fw-playground.webp" alt="XDP Firewall Playground" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><h2 id="high-level-overview" class="prose-h2" data-v-b9b1576a=""><!--[-->High-Level Overview<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->Designing an XDP-based firewall is quite straightforward and follows a similar pattern as packet rate-limiting:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->Keep a blacklist (or whitelist) of rules in an eBPF map (IPs, ports, protocols)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Capture and parse incoming network packets<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Check the packet header fields against the map entries<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Enforce the firewall rules<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->But
 obviously things get more complex when adding features such as 
filtering a combination of IP, port, and protocol, or introducing 
mechanisms to detect anomalies in network traffic like TCP/TLS 
fingeprinting.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 TCP/TLS fingerprinting examines unique protocol traits—such as TCP 
options and TLS ClientHello fields—that form consistent, 
implementation-specific signatures used to identify clients or servers.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->But why even XDP? Why not just nftables (or iptables)?<!--]--></strong><!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:600px;"><div class="text-center"><img src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/cfnewnew.webp" alt="Results reproduced using Cloudflare’s benchmarking setup - https://github.com/cloudflare/cloudflare-blog/blob/master/2018-07-dropping-packets/README.md" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Confused what's on this chart?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->This chart <strong class="prose-strong" data-v-24022f14=""><!--[-->compares packet-dropping performance across several networking layers and technologies<!--]--></strong>, showing how many packets per second a single CPU can process.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->It
 highlights that XDP massively outperforms all other methods—reaching 
over 10 million packets per second—while iptables, nftables, tc, and 
socket-based filtering handle only a small fraction of that throughput.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->While
 these numbers speak for themselves, one shouldn’t overstate their 
impact — most companies don’t really operate at a scale where XDP’s 
extreme performance truly matters, and netfilter-based firewalls are 
more than sufficient for their needs.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But when that scale does matter, XDP-based firewalls like Cloudflare’s Magic Firewall can block massive attacks—such as <a href="https://www.cloudflare.com/en-gb/learning/ddos/famous-ddos-attacks/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->7.3 terabits-per-second (Tbps) DDoS floods<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>—delivering exceptional value to the organizations that rely on them.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Ideally,
 we’d address all the different firewall features, but instead, I’ll 
show you one approach in particular that other eBPF tutorials don't put 
much focus on — the use of <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code> for blacklisting (or whitelisting) IP addresses.<!--]--></p><h2 id="bpf_map_type_lpm_trie-ebpf-map" class="prose-h2" data-v-b9b1576a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE eBPF map<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 the case of a firewall, this eBPF map type allows one to determine, 
through a simple map lookup, whether an IP belongs to any of the 
specified blacklisted (or whitelisted) IP ranges.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Its key is a <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_lpm_trie_key<!--]--></code> struct:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> bpf_lpm_trie_key {
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u32   prefixlen;
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __u8    data</span><span style="--shiki-default:#569CD6">[]</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Detailed description of the bpf_lpm_trie_key struct</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 In a <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_lpm_trie_key<!--]--></code> struct, the two fields mean:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->prefixlen<!--]--></code><!--]--></strong> — the CIDR prefix length (the number after <code class="prose-code-inline" data-v-a031129a=""><!--[-->/<!--]--></code>):<ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->IPv4:<!--]--></strong> 0–32<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->IPv6:<!--]--></strong> 0–128<!--]--></li><!--]--></ul><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->data<!--]--></code><!--]--></strong> — the network address, whose byte size must match the address family:<ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->IPv4:<!--]--></strong> 4 bytes<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->IPv6:<!--]--></strong> 16 bytes<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Example (IPv4):<!--]--></strong> <code class="prose-code-inline" data-v-a031129a=""><!--[-->192.168.1.0/24<!--]--></code><!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> bpf_lpm_trie_key {
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u32   prefixlen </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 24</span><span style="--shiki-default:#E6E6E6">;  
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __u8    </span><span style="--shiki-default:#9CDCFE">data</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">4</span><span style="--shiki-default:#E6E6E6">] </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {</span><span style="--shiki-default:#B5CEA8">192</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">168</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">};    
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Example (IPv6):<!--]--></strong> <code class="prose-code-inline" data-v-a031129a=""><!--[-->2001:db8::/32<!--]--></code><!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> bpf_lpm_trie_key {
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    __u32 prefixlen </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 32</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    __u8  </span><span style="--shiki-default:#9CDCFE">data</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">16</span><span style="--shiki-default:#E6E6E6">]  </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="4"><span style="--shiki-default:#B5CEA8">        0x20</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x01</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x0d</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0xb8</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="5"><span style="--shiki-default:#B5CEA8">        0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="6"><span style="--shiki-default:#B5CEA8">        0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="7"><span style="--shiki-default:#B5CEA8">        0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#B5CEA8">0x00
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">    };
</span></span><span class="line" line="9"><span style="--shiki-default:#E6E6E6">};
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->But
 this is just a rather complex key, whereas the value in this key-value 
pair can be arbitrary and may be used to enforce different logic in your
 program (e.g., 1 for allowed, 0 for blocked).<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->So, what’s so special about this eBPF map?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The cool thing is that this eBPF map internally builds a trie, and key lookups work by walking that trie to perform <a href="https://en.wikipedia.org/wiki/Longest_prefix_match" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->longest prefix matching<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Here’s an image to illustrate this structure.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:400px;"><div class="text-center"><img src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/lpmtrie-basic.webp" alt="Simplified eBPF LPM Trie" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 other words, this structure is perfect for firewall application, as the
 user can simply blacklist (or whitelist) whole IP ranges and this eBPF 
map will tell us whether the client IP is within a certain IP range (or 
not), allowing us to filter packets accordingly.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Building%20an%20eBPF-based%20Firewall%20with%20LPM%20Trie%E2%80%93Based%20IP%20Range%20Matching_files/sbs-lpm.webp" alt="Simplified Lookup of eBPF LPM Trie" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Whether we then block or allow network packets based on a match is entirely up to the eBPF program’s logic.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">More information about eBPF LPM Trie</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 fact, the trie structure on the image above is a big 
oversimplification, neither does it take into an account any 
optimization techniques like <strong class="prose-strong" data-v-24022f14=""><!--[-->path compression<!--]--></strong> or <strong class="prose-strong" data-v-24022f14=""><!--[-->level compression<!--]--></strong> nor does it explain <strong class="prose-strong" data-v-24022f14=""><!--[-->multibit and singlebit nodes<!--]--></strong>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The
 current eBPF LPM trie implementation doesn’t fully support either of 
these optimizations anyway (though work is underway, as noted in <a href="https://blog.cloudflare.com/a-deep-dive-into-bpf-lpm-trie-performance-and-optimization/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->Cloudflare reports<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>).<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But this isn’t a math tutorial, so if you are interested in the details, have a look at the implementation in <a href="https://elixir.bootlin.com/linux/v6.12.43/source/kernel/bpf/lpm_trie.c" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->kernel/bpf/lpm_trie.c<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->More
 importantly. if multiple nodes (with values) are hit, the trie 
remembers the most recent node (with value) it saw and keeps going. If 
it finds another one deeper down, it overwrites the previous "return 
value".<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->What about <code class="prose-code-inline" data-v-a031129a=""><!--[-->prefixlen<!--]--></code>? What role does it play here?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Prefix
 length determines at what depth are the nodes that store an eBPF map 
value. If the term "depth" confuses you, imagine the same trie structure
 as above, just with nodes holding a singlebit.<!--]--></p><!--]--></details><!--]--></div><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 Interesting fact: routers work the same way—they use longest-prefix 
matching to figure out the most specific route for a destination IP.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Without further ado, let’s take a look at how this works in practice.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->We define our <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code> eBPF map type:<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(type, BPF_MAP_TYPE_LPM_TRIE);
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">    __type</span><span style="--shiki-default:#E6E6E6">(key, </span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> ipv4_lpm_key);
</span></span><span class="line" line="4"><span style="--shiki-default:#DCDCAA">    __type</span><span style="--shiki-default:#E6E6E6">(value, __u32);
</span></span><span class="line" line="5"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(map_flags, BPF_F_NO_PREALLOC); 
</span></span><span class="line" line="6"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(max_entries, </span><span style="--shiki-default:#B5CEA8">65535</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">} blocked_ips </span><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">".maps"</span><span style="--shiki-default:#E6E6E6">);
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">What’s the purpose of the BPF_F_NO_PREALLOC flag?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 eBPF hash maps are pre-allocated by default, this means that even a 
completely empty map will use the same amount of kernel memory as a full
 map.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->If <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_F_NO_PREALLOC<!--]--></code> flag is set, pre-allocation is disabled.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Users
 might consider disabling this for large maps since allocating large 
amounts of memory takes a lot of time during creation and might be 
undesirable.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But for <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code> eBPF map type, the <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_F_NO_PREALLOC<!--]--></code> flag must always be set when creating this map type since its implementation cannot pre-allocate it.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->This eBPF map is then populated from the user space program (<code class="prose-code-inline" data-v-a031129a=""><!--[-->lab/main.go<!--]--></code>), which basically just means converting the IPs provided in the input to the format that this eBPF map expects (<code class="prose-code-inline" data-v-a031129a=""><!--[-->prefixlen<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->data<!--]--></code>):<!--]--></p><!--[--><div class="highlight-go prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/main.go</span><!--[--><pre class="language-go shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">var</span><span style="--shiki-default:#9CDCFE"> blockedIPs</span><span style="--shiki-default:#4EC9B0">   string
</span></span><span class="line" line="2"><span style="--shiki-default:#9CDCFE">flag</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">StringVar</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">blockedIPs</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#CE9178">"blocked-ips"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#CE9178">""</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#CE9178">"Comma-separated IP/mask (192.168.23.3/32, 228.13.0.0/16)"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="3"><span style="--shiki-default:#D4D4D4">...
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955">// Build the keys for the BPF_MAP_TYPE_LPM_TRIE eBPF Map
</span></span><span class="line" line="5"><span style="--shiki-default:#6A9955">// e.g. 127.0.0.1/32 -&gt; { Prefixlen: 32, Data: 16777343} 
</span></span><span class="line" line="6"><span style="--shiki-default:#6A9955">// Where the:
</span></span><span class="line" line="7"><span style="--shiki-default:#6A9955">// - 'Prefixlen' is the prefix length in bits (e.g., /32, /24).
</span></span><span class="line" line="8"><span style="--shiki-default:#6A9955">// - 'Data' is the IP converted to the integer
</span></span><span class="line" line="9"><span style="--shiki-default:#9CDCFE">keys</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#DCDCAA"> buildIPv4LPMKeys</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">blockedIPs</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="10"><span style="--shiki-default:#C586C0">if</span><span style="--shiki-default:#9CDCFE"> err</span><span style="--shiki-default:#D4D4D4"> !=</span><span style="--shiki-default:#569CD6"> nil</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="11"><span style="--shiki-default:#9CDCFE">  log</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">Fatalf</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"blocked-ips error: %v"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="12"><span style="--shiki-default:#E6E6E6">}
</span></span><span class="line" line="13"><span style="--shiki-default:#D4D4D4">...
</span></span><span class="line" line="14"><span style="--shiki-default:#6A9955">// Add blocked CIDRs/LPM Trie keys into the eBPF map
</span></span><span class="line" line="15"><span style="--shiki-default:#6A9955">// Doesn't matter which prefix the captured IP will match (as long as it does match we need to block it)
</span></span><span class="line" line="16"><span style="--shiki-default:#C586C0">for</span><span style="--shiki-default:#9CDCFE"> _</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#C586C0"> range</span><span style="--shiki-default:#9CDCFE"> keys</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="17"><span style="--shiki-default:#C586C0">  if</span><span style="--shiki-default:#9CDCFE"> err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> objs</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">xdpMaps</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">BlockedIps</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">Put</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#4EC9B0">uint32</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">)); </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> !=</span><span style="--shiki-default:#569CD6"> nil</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="18"><span style="--shiki-default:#9CDCFE">    log</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">Fatalf</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"error adding CIDR to allow list: %s"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="19"><span style="--shiki-default:#E6E6E6">  }
</span></span><span class="line" line="20"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 Note that when I say CIDR block, I’m simply referring to an IP range defined by a network address and a prefix length.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->In this implementation, the map value actually doesn’t matter (we simply set it to <code class="prose-code-inline" data-v-a031129a=""><!--[-->1<!--]--></code>); all we care about is whether the IP exists in the blacklist. And if the lookup returns <code class="prose-code-inline" data-v-a031129a=""><!--[-->NULL<!--]--></code>, the client isn’t blocked, so the packet is allowed to pass.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->With that covered, you should have a pretty good intuition how can we now fit this into our eBPF firewall implementation.<!--]--></p><h2 id="implementation-breakdown" class="prose-h2" data-v-b9b1576a=""><!--[-->Implementation Breakdown<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->The only difference that we have compared to <a href="https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->packet rate-limiting program<!--]--><!----></a> is now to perform a lookup against the <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code> eBPF map with the prefix.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">lab/xdp.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">__u32 src </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_ntohl</span><span style="--shiki-default:#E6E6E6">(ip</span><span style="--shiki-default:#D4D4D4">-&gt;</span><span style="--shiki-default:#9CDCFE">saddr</span><span style="--shiki-default:#E6E6E6">); 
</span></span><span class="line" line="3"><span emptylineplaceholder="true">
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> ipv4_lpm_key key </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">  .prefixlen </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 32</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">  .data </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> src,
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">};
</span></span><span class="line" line="8"><span emptylineplaceholder="true">
</span></span><span class="line" line="9"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">blocked </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_map_lookup_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">blocked_ips</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="10"><span style="--shiki-default:#C586C0">if</span><span style="--shiki-default:#E6E6E6"> (blocked </span><span style="--shiki-default:#D4D4D4">&amp;&amp;</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">blocked) {
</span></span><span class="line" line="11"><span style="--shiki-default:#C586C0">  return</span><span style="--shiki-default:#E6E6E6"> XDP_DROP;
</span></span><span class="line" line="12"><span style="--shiki-default:#E6E6E6">}
</span></span><span class="line" line="13"><span style="--shiki-default:#E6E6E6">...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Here, prefix (<code class="prose-code-inline" data-v-a031129a=""><!--[-->/32<!--]--></code>) is just hardcoded, because a single IP represent "a range with a single IP".<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And with this simple trick of using <code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_LPM_TRIE<!--]--></code>
 we already created a pretty powerful layer 4 firewall that filters 
network packets based on the client IP but allowing one to blacklist 
whole IP ranges.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">What do you mean when you say L4 (or L7)?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->When one talks about L4 and L7, we’re referring to different layers of the network stack:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Layer 4 (L4):<!--]--></strong> The transport layer—TCP/UDP and the layers below (IP, Ethernet).<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Layer 7 (L7):<!--]--></strong> The application layer, where filtering is based on things like HTTP headers, DNS hostnames, and other protocol-level data.<!--]--></li><!--]--></ul><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Let's see it in action.<!--]--></p><hr class="prose-hr" data-v-34b8dd49=""><p class="prose-p" data-v-b025fb9f=""><!--[-->We
 could demonstrate this with simple ICMP pings—just like in the ICMPv6 
rate-limiting example—but let’s take it one step further.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->First, start an HTTP server on the <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> node (<code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> tab):<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">python3</span><span style="--shiki-default:#CE9178"> -m</span><span style="--shiki-default:#CE9178"> http.server
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Then, from either the <code class="prose-code-inline" data-v-a031129a=""><!--[-->attacker<!--]--></code> or <code class="prose-code-inline" data-v-a031129a=""><!--[-->client<!--]--></code> node (<code class="prose-code-inline" data-v-a031129a=""><!--[-->attacker<!--]--></code> or <code class="prose-code-inline" data-v-a031129a=""><!--[-->client<!--]--></code> tabs), try accessing it:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">curl</span><span style="--shiki-default:#CE9178"> http://172.16.0.10:8000
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->You’ll
 notice that both nodes can successfully reach the HTTP server, even 
though ideally the attacker shouldn’t be able to reach it.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Therefore, let’s build and run our eBPF XDP firewall. Open another <code class="prose-code-inline" data-v-a031129a=""><!--[-->server<!--]--></code> tab, navigate to the <code class="prose-code-inline" data-v-a031129a=""><!--[-->/lab<!--]--></code> directory, and run:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> generate
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> build
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ./xdp</span><span style="--shiki-default:#CE9178"> -i</span><span style="--shiki-default:#CE9178"> eth0</span><span style="--shiki-default:#CE9178"> --blocked-ips</span><span style="--shiki-default:#CE9178"> 192.168.178.10/24</span><span style="--shiki-default:#6A9955"> # &lt;- this is the attacker subnet
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 Try running <code class="prose-code-inline" data-v-a031129a=""><!--[-->sudo ./xdp --help<!--]--></code> to see all available parameters and their usage.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Now curl the HTTP server again—you’ll see that the attacker is blocked. Success ✅<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 Actually, whitelisting clients would actually be easier, since there 
are usually far fewer trusted clients than potential attackers. However,
 we use blacklisting here so we don’t unintentionally interfere with 
other network traffic required for the playground to function.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->That
 said, for pure L4 filtering—IP, ports, protocol, and some advanced 
matching—eBPF is easily the most performant option. But I believe the 
transition will still be slow: eBPF expertise is rare, and migration is 
best done in batches—if you do need it, start by replacing a small 
subset of features with XDP and then expand as your team’s skills grow.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->I will leave it at that - congrats you've came to the end of this tutorial 🎉<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 the next tutorial, we take a look at different XDP Load balancing 
solutions, starting with XDP NAT Load Balancer implementation.<!--]--></p><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game — Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-ebpf-firewall-ed03d648" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10"> ✕ </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial ebpf-firewall-ed03d648<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">ebpf-firewall-ed03d648</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial ebpf-firewall-ed03d648<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-firewall-ed03d648" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":2471,"once":2486,"_errors":2487,"serverRendered":11,"path":2489},["ShallowReactive",3],{"tutorial-page-tutorial-ebpf-firewall-ed03d648":4,"content-tutorial-ebpf-firewall-ed03d648-v1766928134826":62,"i-material-symbols-light:expand-content":2464,"i-ph:copy":2468},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":53,"completionCount":54,"accessControl":55,"userAccess":61},"68efe904ed1ebc020287cc3b","tutorial","ebpf-firewall-ed03d648","Building an eBPF-based Firewall with LPM Trie–Based IP Range Matching","Learn how to build an eBPF/XDP firewall that filters packets by IP ranges using BPF_MAP_TYPE_LPM_TRIE and longest-prefix matching.","2025-12-26T00:00:00.000Z",true,"flexbox",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#ebpf-firewall-ed03d648","2025-12-26","tutorials/ebpf-firewall-ed03d648/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1766928134826,"https://labs.iximiuz.com/tutorials/ebpf-firewall-ed03d648","/content/files/tutorials/ebpf-firewall-ed03d648/__static__/firewall.png",[30,31],"linux","programming",[33],"eBPF","todo",{"clone_lab":36,"setup_networking_server":41,"setup_networking_client":44,"setup_networking_attacker":47,"setup_networking_gateway":50},{"init":11,"user":37,"machine":38,"name":39,"status":40},"laborant","server","clone_lab",0,{"init":11,"machine":38,"user":42,"name":43,"status":40},"root","setup_networking_server",{"init":11,"machine":45,"user":42,"name":46,"status":40},"client","setup_networking_client",{"init":11,"machine":48,"user":42,"name":49,"status":40},"attacker","setup_networking_attacker",{"init":11,"machine":51,"user":42,"name":52,"status":40},"gateway","setup_networking_gateway",10,3,{"canList":56,"canPreview":58,"canRead":59,"canStart":60},[57],"anyone",[57],[57],[57],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[63],{"title":8,"description":64,"kind":6,"categories":65,"tagz":66,"createdAt":10,"updatedAt":10,"cover":28,"playground":67,"type":42,"children":144,"hash":15,"preview":-1,"pageUrl":27,"tasks":2451,"toc":2452,"tutorials":2457,"challenges":2459,"courses":2461,"key":2463},"Learn how to build an eBPF/XDP firewall that filters packets by IP ranges using BPF_MAP_TYPE_LPM_TRIE and longest-prefix matching.\n",[30,31],[33],{"name":12,"networks":68,"machines":81},[69,72,75,78],{"name":70,"subnet":71,"private":11},"net-1","192.168.178.0/24",{"name":73,"subnet":74,"private":11},"net-2","10.0.0.0/16",{"name":76,"subnet":77,"private":11},"net-3","172.16.0.0/24",{"name":79,"subnet":80},"net-4","100.64.0.0/24",[82,100,120,132],{"name":38,"kernel":83,"drives":85,"users":90,"network":93,"resources":97},{"source":84},"6.1",[86],{"source":87,"mount":88,"size":89},"oci://ghcr.io/dorkamotorka/ebpf-labs:latest","/","10GiB",[91],{"name":37,"default":11,"welcome":92},"This is the server node.\n\nIP: 172.16.0.10/24\n",{"interfaces":94},[95],{"network":76,"address":96},"172.16.0.10",{"cpuCount":98,"ramSize":99},4,"4GiB",{"name":51,"kernel":101,"drives":102,"users":104,"network":107,"resources":117},{"source":84},[103],{"source":87,"mount":88,"size":89},[105],{"name":37,"default":11,"welcome":106},"This is a gateway node that is attached to all three networks.\n\nIP #1: 192.168.178.2/24\nIP #2: 10.0.0.2/16\nIP #3: 172.16.0.2/24 \nIP #4: 100.64.0.2/24 (Just for internet access)\n",{"interfaces":108},[109,111,113,115],{"network":70,"address":110},"192.168.178.2",{"network":73,"address":112},"10.0.0.2",{"network":76,"address":114},"172.16.0.2",{"network":79,"address":116},"100.64.0.2",{"cpuCount":118,"ramSize":119},1,"1GiB",{"name":45,"kernel":121,"drives":122,"users":124,"network":127,"resources":131},{"source":84},[123],{"source":87,"mount":88,"size":89},[125],{"name":37,"default":11,"welcome":126},"This is a client node.\n\nIP: 10.0.0.10/24\n",{"interfaces":128},[129],{"network":73,"address":130},"10.0.0.10",{"cpuCount":118,"ramSize":119},{"name":48,"kernel":133,"drives":134,"users":136,"network":139,"resources":143},{"source":84},[135],{"source":87,"mount":88,"size":89},[137],{"name":37,"default":11,"welcome":138},"This is a attacker node.\n\nIP: 192.168.178.10/24\n",{"interfaces":140},[141],{"network":70,"address":142},"192.168.178.10",{"cpuCount":118,"ramSize":119},[145,173,178,183,188,193,200,209,223,228,308,313,320,325,348,353,363,371,376,398,403,417,429,435,440,453,516,1007,1012,1020,1033,1038,1044,1049,1055,1060,1141,1149,1154,1166,1295,1341,1366,1842,1850,1870,1875,1881,1901,2140,2153,2165,2197,2202,2206,2211,2230,2257,2287,2307,2312,2332,2401,2417,2422,2430,2435,2440,2445],{"type":146,"tag":147,"props":148,"children":149},"element","p",{},[150,153,162,164,171],{"type":151,"value":152},"text","By now, we already know how to ",{"type":146,"tag":154,"props":155,"children":159},"a",{"href":156,"rel":157},"https://labs.iximiuz.com/tutorials/ebpf-xdp-fundamentals-6342d24e",[158],"nofollow",[160],{"type":151,"value":161},"capture network traffic using eBPF/XDP",{"type":151,"value":163},", parse it, and even perform some basic ",{"type":146,"tag":154,"props":165,"children":168},{"href":166,"rel":167},"https://labs.iximiuz.com/tutorials/ebpf-ratelimiting-dbc12915",[158],[169],{"type":151,"value":170},"IPv6 ICMP rate limiting",{"type":151,"value":172},".",{"type":146,"tag":147,"props":174,"children":175},{},[176],{"type":151,"value":177},"So naturally, you might wonder how different an eBPF-based firewall really is from the rate limiter. After all, instead of rate-limiting packets, we could just block them entirely, right?",{"type":146,"tag":147,"props":179,"children":180},{},[181],{"type":151,"value":182},"Well, not quite.",{"type":146,"tag":147,"props":184,"children":185},{},[186],{"type":151,"value":187},"While our firewall implementation will only focus on filtering packets by client IP (not by ports, protocol, or fingerprinting), one ideally doesn’t want users to specify every single IP rule manually. In many cases, it would be much easier to allow one to whitelist or blacklist entire IP ranges instead.",{"type":146,"tag":147,"props":189,"children":190},{},[191],{"type":151,"value":192},"Nonetheless, a simple IP-based firewall might work fine if you’re only whitelisting a few static addresses. But what if those IPs are dynamic and constantly changing within a certain range or subnet?",{"type":146,"tag":194,"props":195,"children":199},"image-box",{":alt":196,":src":197,":max-width":198},"XDP Firewall","/content/files/tutorials/ebpf-firewall-ed03d648/__static__/firewall-trans.png","600px",[],{"type":146,"tag":147,"props":201,"children":202},{},[203],{"type":146,"tag":204,"props":205,"children":206},"strong",{},[207],{"type":151,"value":208},"But how?",{"type":146,"tag":147,"props":210,"children":211},{},[212,214,221],{"type":151,"value":213},"In this tutorial, we’ll learn how to filter network packets using the ",{"type":146,"tag":215,"props":216,"children":218},"code",{"className":217},[],[219],{"type":151,"value":220},"BPF_MAP_TYPE_LPM_TRIE",{"type":151,"value":222}," eBPF map type, which allows one to easily check and enforce whether a certain IP (client machine) belongs to a blacklisted IP range or not.",{"type":146,"tag":147,"props":224,"children":225},{},[226],{"type":151,"value":227},"This playground has a network topology with 4 separate machines on three different networks:",{"type":146,"tag":229,"props":230,"children":231},"ul",{},[232,249,264,279],{"type":146,"tag":233,"props":234,"children":235},"li",{},[236,241,243],{"type":146,"tag":215,"props":237,"children":239},{"className":238},[],[240],{"type":151,"value":38},{"type":151,"value":242}," in network ",{"type":146,"tag":215,"props":244,"children":246},{"className":245},[],[247],{"type":151,"value":248},"172.16.0.10/24",{"type":146,"tag":233,"props":250,"children":251},{},[252,257,258],{"type":146,"tag":215,"props":253,"children":255},{"className":254},[],[256],{"type":151,"value":45},{"type":151,"value":242},{"type":146,"tag":215,"props":259,"children":261},{"className":260},[],[262],{"type":151,"value":263},"10.0.0.10/16",{"type":146,"tag":233,"props":265,"children":266},{},[267,272,273],{"type":146,"tag":215,"props":268,"children":270},{"className":269},[],[271],{"type":151,"value":48},{"type":151,"value":242},{"type":146,"tag":215,"props":274,"children":276},{"className":275},[],[277],{"type":151,"value":278},"192.168.178.10/24",{"type":146,"tag":233,"props":280,"children":281},{},[282,287,289,294,296,301,303],{"type":146,"tag":215,"props":283,"children":285},{"className":284},[],[286],{"type":151,"value":51},{"type":151,"value":288}," between networks ",{"type":146,"tag":215,"props":290,"children":292},{"className":291},[],[293],{"type":151,"value":71},{"type":151,"value":295},", ",{"type":146,"tag":215,"props":297,"children":299},{"className":298},[],[300],{"type":151,"value":74},{"type":151,"value":302}," and ",{"type":146,"tag":215,"props":304,"children":306},{"className":305},[],[307],{"type":151,"value":248},{"type":146,"tag":194,"props":309,"children":312},{":alt":310,":src":311},"XDP Firewall Playground","/content/files/tutorials/ebpf-firewall-ed03d648/__static__/fw-playground.png",[],{"type":146,"tag":314,"props":315,"children":317},"h2",{"id":316},"high-level-overview",[318],{"type":151,"value":319},"High-Level Overview",{"type":146,"tag":147,"props":321,"children":322},{},[323],{"type":151,"value":324},"Designing an XDP-based firewall is quite straightforward and follows a similar pattern as packet rate-limiting:",{"type":146,"tag":229,"props":326,"children":327},{},[328,333,338,343],{"type":146,"tag":233,"props":329,"children":330},{},[331],{"type":151,"value":332},"Keep a blacklist (or whitelist) of rules in an eBPF map (IPs, ports, protocols)",{"type":146,"tag":233,"props":334,"children":335},{},[336],{"type":151,"value":337},"Capture and parse incoming network packets",{"type":146,"tag":233,"props":339,"children":340},{},[341],{"type":151,"value":342},"Check the packet header fields against the map entries",{"type":146,"tag":233,"props":344,"children":345},{},[346],{"type":151,"value":347},"Enforce the firewall rules",{"type":146,"tag":147,"props":349,"children":350},{},[351],{"type":151,"value":352},"But obviously things get more complex when adding features such as filtering a combination of IP, port, and protocol, or introducing mechanisms to detect anomalies in network traffic like TCP/TLS fingeprinting.",{"type":146,"tag":354,"props":355,"children":357},"remark-box",{"kind":356},"info",[358],{"type":146,"tag":147,"props":359,"children":360},{},[361],{"type":151,"value":362},"💡 TCP/TLS fingerprinting examines unique protocol traits—such as TCP options and TLS ClientHello fields—that form consistent, implementation-specific signatures used to identify clients or servers.",{"type":146,"tag":147,"props":364,"children":365},{},[366],{"type":146,"tag":204,"props":367,"children":368},{},[369],{"type":151,"value":370},"But why even XDP? Why not just nftables (or iptables)?",{"type":146,"tag":194,"props":372,"children":375},{":alt":373,":src":374,":max-width":198},"Results reproduced using Cloudflare’s benchmarking setup - https://github.com/cloudflare/cloudflare-blog/blob/master/2018-07-dropping-packets/README.md","/content/files/tutorials/ebpf-firewall-ed03d648/__static__/cfnewnew.png",[],{"type":146,"tag":377,"props":378,"children":380},"details-box",{":summary":379},"Confused what's on this chart?",[381,393],{"type":146,"tag":147,"props":382,"children":383},{},[384,386,391],{"type":151,"value":385},"This chart ",{"type":146,"tag":204,"props":387,"children":388},{},[389],{"type":151,"value":390},"compares packet-dropping performance across several networking layers and technologies",{"type":151,"value":392},", showing how many packets per second a single CPU can process.",{"type":146,"tag":147,"props":394,"children":395},{},[396],{"type":151,"value":397},"It highlights that XDP massively outperforms all other methods—reaching over 10 million packets per second—while iptables, nftables, tc, and socket-based filtering handle only a small fraction of that throughput.",{"type":146,"tag":147,"props":399,"children":400},{},[401],{"type":151,"value":402},"While these numbers speak for themselves, one shouldn’t overstate their impact — most companies don’t really operate at a scale where XDP’s extreme performance truly matters, and netfilter-based firewalls are more than sufficient for their needs.",{"type":146,"tag":147,"props":404,"children":405},{},[406,408,415],{"type":151,"value":407},"But when that scale does matter, XDP-based firewalls like Cloudflare’s Magic Firewall can block massive attacks—such as ",{"type":146,"tag":154,"props":409,"children":412},{"href":410,"rel":411},"https://www.cloudflare.com/en-gb/learning/ddos/famous-ddos-attacks/",[158],[413],{"type":151,"value":414},"7.3 terabits-per-second (Tbps) DDoS floods",{"type":151,"value":416},"—delivering exceptional value to the organizations that rely on them.",{"type":146,"tag":147,"props":418,"children":419},{},[420,422,427],{"type":151,"value":421},"Ideally, we’d address all the different firewall features, but instead, I’ll show you one approach in particular that other eBPF tutorials don't put much focus on — the use of ",{"type":146,"tag":215,"props":423,"children":425},{"className":424},[],[426],{"type":151,"value":220},{"type":151,"value":428}," for blacklisting (or whitelisting) IP addresses.",{"type":146,"tag":314,"props":430,"children":432},{"id":431},"bpf_map_type_lpm_trie-ebpf-map",[433],{"type":151,"value":434},"BPF_MAP_TYPE_LPM_TRIE eBPF map",{"type":146,"tag":147,"props":436,"children":437},{},[438],{"type":151,"value":439},"In the case of a firewall, this eBPF map type allows one to determine, through a simple map lookup, whether an IP belongs to any of the specified blacklisted (or whitelisted) IP ranges.",{"type":146,"tag":147,"props":441,"children":442},{},[443,445,451],{"type":151,"value":444},"Its key is a ",{"type":146,"tag":215,"props":446,"children":448},{"className":447},[],[449],{"type":151,"value":450},"bpf_lpm_trie_key",{"type":151,"value":452}," struct:",{"type":146,"tag":454,"props":455,"children":460},"pre",{"className":456,"code":457,"language":458,"meta":459,"style":459},"language-c shiki shiki-themes slack-dark","struct bpf_lpm_trie_key {\n    __u32   prefixlen;\n    __u8    data[];\n};\n","c","",[461],{"type":146,"tag":215,"props":462,"children":463},{"__ignoreMap":459},[464,481,490,508],{"type":146,"tag":465,"props":466,"children":468},"span",{"class":467,"line":118},"line",[469,475],{"type":146,"tag":465,"props":470,"children":472},{"style":471},"--shiki-default:#569CD6",[473],{"type":151,"value":474},"struct",{"type":146,"tag":465,"props":476,"children":478},{"style":477},"--shiki-default:#E6E6E6",[479],{"type":151,"value":480}," bpf_lpm_trie_key {\n",{"type":146,"tag":465,"props":482,"children":484},{"class":467,"line":483},2,[485],{"type":146,"tag":465,"props":486,"children":487},{"style":477},[488],{"type":151,"value":489},"    __u32   prefixlen;\n",{"type":146,"tag":465,"props":491,"children":492},{"class":467,"line":54},[493,498,503],{"type":146,"tag":465,"props":494,"children":495},{"style":477},[496],{"type":151,"value":497},"    __u8    data",{"type":146,"tag":465,"props":499,"children":500},{"style":471},[501],{"type":151,"value":502},"[]",{"type":146,"tag":465,"props":504,"children":505},{"style":477},[506],{"type":151,"value":507},";\n",{"type":146,"tag":465,"props":509,"children":510},{"class":467,"line":98},[511],{"type":146,"tag":465,"props":512,"children":513},{"style":477},[514],{"type":151,"value":515},"};\n",{"type":146,"tag":377,"props":517,"children":519},{":summary":518},"Detailed description of the bpf_lpm_trie_key struct",[520,532,614,630,754,769],{"type":146,"tag":147,"props":521,"children":522},{},[523,525,530],{"type":151,"value":524},"💡 In a ",{"type":146,"tag":215,"props":526,"children":528},{"className":527},[],[529],{"type":151,"value":450},{"type":151,"value":531}," struct, the two fields mean:",{"type":146,"tag":229,"props":533,"children":534},{},[535,579],{"type":146,"tag":233,"props":536,"children":537},{},[538,547,549,554,556],{"type":146,"tag":204,"props":539,"children":540},{},[541],{"type":146,"tag":215,"props":542,"children":544},{"className":543},[],[545],{"type":151,"value":546},"prefixlen",{"type":151,"value":548}," — the CIDR prefix length (the number after ",{"type":146,"tag":215,"props":550,"children":552},{"className":551},[],[553],{"type":151,"value":88},{"type":151,"value":555},"):",{"type":146,"tag":229,"props":557,"children":558},{},[559,569],{"type":146,"tag":233,"props":560,"children":561},{},[562,567],{"type":146,"tag":204,"props":563,"children":564},{},[565],{"type":151,"value":566},"IPv4:",{"type":151,"value":568}," 0–32",{"type":146,"tag":233,"props":570,"children":571},{},[572,577],{"type":146,"tag":204,"props":573,"children":574},{},[575],{"type":151,"value":576},"IPv6:",{"type":151,"value":578}," 0–128",{"type":146,"tag":233,"props":580,"children":581},{},[582,591,593],{"type":146,"tag":204,"props":583,"children":584},{},[585],{"type":146,"tag":215,"props":586,"children":588},{"className":587},[],[589],{"type":151,"value":590},"data",{"type":151,"value":592}," — the network address, whose byte size must match the address family:",{"type":146,"tag":229,"props":594,"children":595},{},[596,605],{"type":146,"tag":233,"props":597,"children":598},{},[599,603],{"type":146,"tag":204,"props":600,"children":601},{},[602],{"type":151,"value":566},{"type":151,"value":604}," 4 bytes",{"type":146,"tag":233,"props":606,"children":607},{},[608,612],{"type":146,"tag":204,"props":609,"children":610},{},[611],{"type":151,"value":576},{"type":151,"value":613}," 16 bytes",{"type":146,"tag":147,"props":615,"children":616},{},[617,622,624],{"type":146,"tag":204,"props":618,"children":619},{},[620],{"type":151,"value":621},"Example (IPv4):",{"type":151,"value":623}," ",{"type":146,"tag":215,"props":625,"children":627},{"className":626},[],[628],{"type":151,"value":629},"192.168.1.0/24",{"type":146,"tag":454,"props":631,"children":633},{"className":456,"code":632,"language":458,"meta":459,"style":459},"struct bpf_lpm_trie_key {\n    __u32   prefixlen = 24;  \n    __u8    data[4] = {192, 168, 1, 0};    \n};\n",[634],{"type":146,"tag":215,"props":635,"children":636},{"__ignoreMap":459},[637,648,673,747],{"type":146,"tag":465,"props":638,"children":639},{"class":467,"line":118},[640,644],{"type":146,"tag":465,"props":641,"children":642},{"style":471},[643],{"type":151,"value":474},{"type":146,"tag":465,"props":645,"children":646},{"style":477},[647],{"type":151,"value":480},{"type":146,"tag":465,"props":649,"children":650},{"class":467,"line":483},[651,656,662,668],{"type":146,"tag":465,"props":652,"children":653},{"style":477},[654],{"type":151,"value":655},"    __u32   prefixlen ",{"type":146,"tag":465,"props":657,"children":659},{"style":658},"--shiki-default:#D4D4D4",[660],{"type":151,"value":661},"=",{"type":146,"tag":465,"props":663,"children":665},{"style":664},"--shiki-default:#B5CEA8",[666],{"type":151,"value":667}," 24",{"type":146,"tag":465,"props":669,"children":670},{"style":477},[671],{"type":151,"value":672},";  \n",{"type":146,"tag":465,"props":674,"children":675},{"class":467,"line":54},[676,681,686,691,696,701,705,710,715,719,724,728,733,737,742],{"type":146,"tag":465,"props":677,"children":678},{"style":477},[679],{"type":151,"value":680},"    __u8    ",{"type":146,"tag":465,"props":682,"children":684},{"style":683},"--shiki-default:#9CDCFE",[685],{"type":151,"value":590},{"type":146,"tag":465,"props":687,"children":688},{"style":477},[689],{"type":151,"value":690},"[",{"type":146,"tag":465,"props":692,"children":693},{"style":664},[694],{"type":151,"value":695},"4",{"type":146,"tag":465,"props":697,"children":698},{"style":477},[699],{"type":151,"value":700},"] ",{"type":146,"tag":465,"props":702,"children":703},{"style":658},[704],{"type":151,"value":661},{"type":146,"tag":465,"props":706,"children":707},{"style":477},[708],{"type":151,"value":709}," {",{"type":146,"tag":465,"props":711,"children":712},{"style":664},[713],{"type":151,"value":714},"192",{"type":146,"tag":465,"props":716,"children":717},{"style":477},[718],{"type":151,"value":295},{"type":146,"tag":465,"props":720,"children":721},{"style":664},[722],{"type":151,"value":723},"168",{"type":146,"tag":465,"props":725,"children":726},{"style":477},[727],{"type":151,"value":295},{"type":146,"tag":465,"props":729,"children":730},{"style":664},[731],{"type":151,"value":732},"1",{"type":146,"tag":465,"props":734,"children":735},{"style":477},[736],{"type":151,"value":295},{"type":146,"tag":465,"props":738,"children":739},{"style":664},[740],{"type":151,"value":741},"0",{"type":146,"tag":465,"props":743,"children":744},{"style":477},[745],{"type":151,"value":746},"};    \n",{"type":146,"tag":465,"props":748,"children":749},{"class":467,"line":98},[750],{"type":146,"tag":465,"props":751,"children":752},{"style":477},[753],{"type":151,"value":515},{"type":146,"tag":147,"props":755,"children":756},{},[757,762,763],{"type":146,"tag":204,"props":758,"children":759},{},[760],{"type":151,"value":761},"Example (IPv6):",{"type":151,"value":623},{"type":146,"tag":215,"props":764,"children":766},{"className":765},[],[767],{"type":151,"value":768},"2001:db8::/32",{"type":146,"tag":454,"props":770,"children":772},{"className":456,"code":771,"language":458,"meta":459,"style":459},"struct bpf_lpm_trie_key {\n    __u32 prefixlen = 32;\n    __u8  data[16]  = {\n        0x20, 0x01, 0x0d, 0xb8,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00,\n        0x00, 0x00, 0x00, 0x00\n    };\n};\n",[773],{"type":146,"tag":215,"props":774,"children":775},{"__ignoreMap":459},[776,787,808,843,883,921,957,990,999],{"type":146,"tag":465,"props":777,"children":778},{"class":467,"line":118},[779,783],{"type":146,"tag":465,"props":780,"children":781},{"style":471},[782],{"type":151,"value":474},{"type":146,"tag":465,"props":784,"children":785},{"style":477},[786],{"type":151,"value":480},{"type":146,"tag":465,"props":788,"children":789},{"class":467,"line":483},[790,795,799,804],{"type":146,"tag":465,"props":791,"children":792},{"style":477},[793],{"type":151,"value":794},"    __u32 prefixlen ",{"type":146,"tag":465,"props":796,"children":797},{"style":658},[798],{"type":151,"value":661},{"type":146,"tag":465,"props":800,"children":801},{"style":664},[802],{"type":151,"value":803}," 32",{"type":146,"tag":465,"props":805,"children":806},{"style":477},[807],{"type":151,"value":507},{"type":146,"tag":465,"props":809,"children":810},{"class":467,"line":54},[811,816,820,824,829,834,838],{"type":146,"tag":465,"props":812,"children":813},{"style":477},[814],{"type":151,"value":815},"    __u8  ",{"type":146,"tag":465,"props":817,"children":818},{"style":683},[819],{"type":151,"value":590},{"type":146,"tag":465,"props":821,"children":822},{"style":477},[823],{"type":151,"value":690},{"type":146,"tag":465,"props":825,"children":826},{"style":664},[827],{"type":151,"value":828},"16",{"type":146,"tag":465,"props":830,"children":831},{"style":477},[832],{"type":151,"value":833},"]  ",{"type":146,"tag":465,"props":835,"children":836},{"style":658},[837],{"type":151,"value":661},{"type":146,"tag":465,"props":839,"children":840},{"style":477},[841],{"type":151,"value":842}," {\n",{"type":146,"tag":465,"props":844,"children":845},{"class":467,"line":98},[846,851,855,860,864,869,873,878],{"type":146,"tag":465,"props":847,"children":848},{"style":664},[849],{"type":151,"value":850},"        0x20",{"type":146,"tag":465,"props":852,"children":853},{"style":477},[854],{"type":151,"value":295},{"type":146,"tag":465,"props":856,"children":857},{"style":664},[858],{"type":151,"value":859},"0x01",{"type":146,"tag":465,"props":861,"children":862},{"style":477},[863],{"type":151,"value":295},{"type":146,"tag":465,"props":865,"children":866},{"style":664},[867],{"type":151,"value":868},"0x0d",{"type":146,"tag":465,"props":870,"children":871},{"style":477},[872],{"type":151,"value":295},{"type":146,"tag":465,"props":874,"children":875},{"style":664},[876],{"type":151,"value":877},"0xb8",{"type":146,"tag":465,"props":879,"children":880},{"style":477},[881],{"type":151,"value":882},",\n",{"type":146,"tag":465,"props":884,"children":886},{"class":467,"line":885},5,[887,892,896,901,905,909,913,917],{"type":146,"tag":465,"props":888,"children":889},{"style":664},[890],{"type":151,"value":891},"        0x00",{"type":146,"tag":465,"props":893,"children":894},{"style":477},[895],{"type":151,"value":295},{"type":146,"tag":465,"props":897,"children":898},{"style":664},[899],{"type":151,"value":900},"0x00",{"type":146,"tag":465,"props":902,"children":903},{"style":477},[904],{"type":151,"value":295},{"type":146,"tag":465,"props":906,"children":907},{"style":664},[908],{"type":151,"value":900},{"type":146,"tag":465,"props":910,"children":911},{"style":477},[912],{"type":151,"value":295},{"type":146,"tag":465,"props":914,"children":915},{"style":664},[916],{"type":151,"value":900},{"type":146,"tag":465,"props":918,"children":919},{"style":477},[920],{"type":151,"value":882},{"type":146,"tag":465,"props":922,"children":924},{"class":467,"line":923},6,[925,929,933,937,941,945,949,953],{"type":146,"tag":465,"props":926,"children":927},{"style":664},[928],{"type":151,"value":891},{"type":146,"tag":465,"props":930,"children":931},{"style":477},[932],{"type":151,"value":295},{"type":146,"tag":465,"props":934,"children":935},{"style":664},[936],{"type":151,"value":900},{"type":146,"tag":465,"props":938,"children":939},{"style":477},[940],{"type":151,"value":295},{"type":146,"tag":465,"props":942,"children":943},{"style":664},[944],{"type":151,"value":900},{"type":146,"tag":465,"props":946,"children":947},{"style":477},[948],{"type":151,"value":295},{"type":146,"tag":465,"props":950,"children":951},{"style":664},[952],{"type":151,"value":900},{"type":146,"tag":465,"props":954,"children":955},{"style":477},[956],{"type":151,"value":882},{"type":146,"tag":465,"props":958,"children":960},{"class":467,"line":959},7,[961,965,969,973,977,981,985],{"type":146,"tag":465,"props":962,"children":963},{"style":664},[964],{"type":151,"value":891},{"type":146,"tag":465,"props":966,"children":967},{"style":477},[968],{"type":151,"value":295},{"type":146,"tag":465,"props":970,"children":971},{"style":664},[972],{"type":151,"value":900},{"type":146,"tag":465,"props":974,"children":975},{"style":477},[976],{"type":151,"value":295},{"type":146,"tag":465,"props":978,"children":979},{"style":664},[980],{"type":151,"value":900},{"type":146,"tag":465,"props":982,"children":983},{"style":477},[984],{"type":151,"value":295},{"type":146,"tag":465,"props":986,"children":987},{"style":664},[988],{"type":151,"value":989},"0x00\n",{"type":146,"tag":465,"props":991,"children":993},{"class":467,"line":992},8,[994],{"type":146,"tag":465,"props":995,"children":996},{"style":477},[997],{"type":151,"value":998},"    };\n",{"type":146,"tag":465,"props":1000,"children":1002},{"class":467,"line":1001},9,[1003],{"type":146,"tag":465,"props":1004,"children":1005},{"style":477},[1006],{"type":151,"value":515},{"type":146,"tag":147,"props":1008,"children":1009},{},[1010],{"type":151,"value":1011},"But this is just a rather complex key, whereas the value in this key-value pair can be arbitrary and may be used to enforce different logic in your program (e.g., 1 for allowed, 0 for blocked).",{"type":146,"tag":147,"props":1013,"children":1014},{},[1015],{"type":146,"tag":204,"props":1016,"children":1017},{},[1018],{"type":151,"value":1019},"So, what’s so special about this eBPF map?",{"type":146,"tag":147,"props":1021,"children":1022},{},[1023,1025,1032],{"type":151,"value":1024},"The cool thing is that this eBPF map internally builds a trie, and key lookups work by walking that trie to perform ",{"type":146,"tag":154,"props":1026,"children":1029},{"href":1027,"rel":1028},"https://en.wikipedia.org/wiki/Longest_prefix_match",[158],[1030],{"type":151,"value":1031},"longest prefix matching",{"type":151,"value":172},{"type":146,"tag":147,"props":1034,"children":1035},{},[1036],{"type":151,"value":1037},"Here’s an image to illustrate this structure.",{"type":146,"tag":194,"props":1039,"children":1043},{":alt":1040,":src":1041,":max-width":1042},"Simplified eBPF LPM Trie","/content/files/tutorials/ebpf-firewall-ed03d648/__static__/lpmtrie-basic.png","400px",[],{"type":146,"tag":147,"props":1045,"children":1046},{},[1047],{"type":151,"value":1048},"In other words, this structure is perfect for firewall application, as the user can simply blacklist (or whitelist) whole IP ranges and this eBPF map will tell us whether the client IP is within a certain IP range (or not), allowing us to filter packets accordingly.",{"type":146,"tag":194,"props":1050,"children":1054},{":alt":1051,":src":1052,":max-width":1053},"Simplified Lookup of eBPF LPM Trie","/content/files/tutorials/ebpf-firewall-ed03d648/__static__/sbs-lpm.png","800px",[],{"type":146,"tag":147,"props":1056,"children":1057},{},[1058],{"type":151,"value":1059},"Whether we then block or allow network packets based on a match is entirely up to the eBPF program’s logic.",{"type":146,"tag":377,"props":1061,"children":1063},{":summary":1062},"More information about eBPF LPM Trie",[1064,1089,1103,1116,1121,1136],{"type":146,"tag":147,"props":1065,"children":1066},{},[1067,1069,1074,1076,1081,1083,1088],{"type":151,"value":1068},"In fact, the trie structure on the image above is a big oversimplification, neither does it take into an account any optimization techniques like ",{"type":146,"tag":204,"props":1070,"children":1071},{},[1072],{"type":151,"value":1073},"path compression",{"type":151,"value":1075}," or ",{"type":146,"tag":204,"props":1077,"children":1078},{},[1079],{"type":151,"value":1080},"level compression",{"type":151,"value":1082}," nor does it explain ",{"type":146,"tag":204,"props":1084,"children":1085},{},[1086],{"type":151,"value":1087},"multibit and singlebit nodes",{"type":151,"value":172},{"type":146,"tag":147,"props":1090,"children":1091},{},[1092,1094,1101],{"type":151,"value":1093},"The current eBPF LPM trie implementation doesn’t fully support either of these optimizations anyway (though work is underway, as noted in ",{"type":146,"tag":154,"props":1095,"children":1098},{"href":1096,"rel":1097},"https://blog.cloudflare.com/a-deep-dive-into-bpf-lpm-trie-performance-and-optimization/",[158],[1099],{"type":151,"value":1100},"Cloudflare reports",{"type":151,"value":1102},").",{"type":146,"tag":147,"props":1104,"children":1105},{},[1106,1108,1115],{"type":151,"value":1107},"But this isn’t a math tutorial, so if you are interested in the details, have a look at the implementation in ",{"type":146,"tag":154,"props":1109,"children":1112},{"href":1110,"rel":1111},"https://elixir.bootlin.com/linux/v6.12.43/source/kernel/bpf/lpm_trie.c",[158],[1113],{"type":151,"value":1114},"kernel/bpf/lpm_trie.c",{"type":151,"value":172},{"type":146,"tag":147,"props":1117,"children":1118},{},[1119],{"type":151,"value":1120},"More importantly. if multiple nodes (with values) are hit, the trie remembers the most recent node (with value) it saw and keeps going. If it finds another one deeper down, it overwrites the previous \"return value\".",{"type":146,"tag":147,"props":1122,"children":1123},{},[1124],{"type":146,"tag":204,"props":1125,"children":1126},{},[1127,1129,1134],{"type":151,"value":1128},"What about ",{"type":146,"tag":215,"props":1130,"children":1132},{"className":1131},[],[1133],{"type":151,"value":546},{"type":151,"value":1135},"? What role does it play here?",{"type":146,"tag":147,"props":1137,"children":1138},{},[1139],{"type":151,"value":1140},"Prefix length determines at what depth are the nodes that store an eBPF map value. If the term \"depth\" confuses you, imagine the same trie structure as above, just with nodes holding a singlebit.",{"type":146,"tag":354,"props":1142,"children":1143},{"kind":356},[1144],{"type":146,"tag":147,"props":1145,"children":1146},{},[1147],{"type":151,"value":1148},"💡 Interesting fact: routers work the same way—they use longest-prefix matching to figure out the most specific route for a destination IP.",{"type":146,"tag":147,"props":1150,"children":1151},{},[1152],{"type":151,"value":1153},"Without further ado, let’s take a look at how this works in practice.",{"type":146,"tag":147,"props":1155,"children":1156},{},[1157,1159,1164],{"type":151,"value":1158},"We define our ",{"type":146,"tag":215,"props":1160,"children":1162},{"className":1161},[],[1163],{"type":151,"value":220},{"type":151,"value":1165}," eBPF map type:",{"type":146,"tag":454,"props":1167,"children":1170},{"className":456,"code":1168,"filename":1169,"language":458,"meta":459,"style":459},"struct {\n    __uint(type, BPF_MAP_TYPE_LPM_TRIE);\n    __type(key, struct ipv4_lpm_key);\n    __type(value, __u32);\n    __uint(map_flags, BPF_F_NO_PREALLOC); \n    __uint(max_entries, 65535);\n} blocked_ips SEC(\".maps\");\n","lab/xdp.c",[1171],{"type":146,"tag":215,"props":1172,"children":1173},{"__ignoreMap":459},[1174,1185,1199,1221,1233,1245,1267],{"type":146,"tag":465,"props":1175,"children":1176},{"class":467,"line":118},[1177,1181],{"type":146,"tag":465,"props":1178,"children":1179},{"style":471},[1180],{"type":151,"value":474},{"type":146,"tag":465,"props":1182,"children":1183},{"style":477},[1184],{"type":151,"value":842},{"type":146,"tag":465,"props":1186,"children":1187},{"class":467,"line":483},[1188,1194],{"type":146,"tag":465,"props":1189,"children":1191},{"style":1190},"--shiki-default:#DCDCAA",[1192],{"type":151,"value":1193},"    __uint",{"type":146,"tag":465,"props":1195,"children":1196},{"style":477},[1197],{"type":151,"value":1198},"(type, BPF_MAP_TYPE_LPM_TRIE);\n",{"type":146,"tag":465,"props":1200,"children":1201},{"class":467,"line":54},[1202,1207,1212,1216],{"type":146,"tag":465,"props":1203,"children":1204},{"style":1190},[1205],{"type":151,"value":1206},"    __type",{"type":146,"tag":465,"props":1208,"children":1209},{"style":477},[1210],{"type":151,"value":1211},"(key, ",{"type":146,"tag":465,"props":1213,"children":1214},{"style":471},[1215],{"type":151,"value":474},{"type":146,"tag":465,"props":1217,"children":1218},{"style":477},[1219],{"type":151,"value":1220}," ipv4_lpm_key);\n",{"type":146,"tag":465,"props":1222,"children":1223},{"class":467,"line":98},[1224,1228],{"type":146,"tag":465,"props":1225,"children":1226},{"style":1190},[1227],{"type":151,"value":1206},{"type":146,"tag":465,"props":1229,"children":1230},{"style":477},[1231],{"type":151,"value":1232},"(value, __u32);\n",{"type":146,"tag":465,"props":1234,"children":1235},{"class":467,"line":885},[1236,1240],{"type":146,"tag":465,"props":1237,"children":1238},{"style":1190},[1239],{"type":151,"value":1193},{"type":146,"tag":465,"props":1241,"children":1242},{"style":477},[1243],{"type":151,"value":1244},"(map_flags, BPF_F_NO_PREALLOC); \n",{"type":146,"tag":465,"props":1246,"children":1247},{"class":467,"line":923},[1248,1252,1257,1262],{"type":146,"tag":465,"props":1249,"children":1250},{"style":1190},[1251],{"type":151,"value":1193},{"type":146,"tag":465,"props":1253,"children":1254},{"style":477},[1255],{"type":151,"value":1256},"(max_entries, ",{"type":146,"tag":465,"props":1258,"children":1259},{"style":664},[1260],{"type":151,"value":1261},"65535",{"type":146,"tag":465,"props":1263,"children":1264},{"style":477},[1265],{"type":151,"value":1266},");\n",{"type":146,"tag":465,"props":1268,"children":1269},{"class":467,"line":959},[1270,1275,1280,1285,1291],{"type":146,"tag":465,"props":1271,"children":1272},{"style":477},[1273],{"type":151,"value":1274},"} blocked_ips ",{"type":146,"tag":465,"props":1276,"children":1277},{"style":1190},[1278],{"type":151,"value":1279},"SEC",{"type":146,"tag":465,"props":1281,"children":1282},{"style":477},[1283],{"type":151,"value":1284},"(",{"type":146,"tag":465,"props":1286,"children":1288},{"style":1287},"--shiki-default:#CE9178",[1289],{"type":151,"value":1290},"\".maps\"",{"type":146,"tag":465,"props":1292,"children":1293},{"style":477},[1294],{"type":151,"value":1266},{"type":146,"tag":377,"props":1296,"children":1298},{":summary":1297},"What’s the purpose of the BPF_F_NO_PREALLOC flag?",[1299,1304,1317,1322],{"type":146,"tag":147,"props":1300,"children":1301},{},[1302],{"type":151,"value":1303},"💡 eBPF hash maps are pre-allocated by default, this means that even a completely empty map will use the same amount of kernel memory as a full map.",{"type":146,"tag":147,"props":1305,"children":1306},{},[1307,1309,1315],{"type":151,"value":1308},"If ",{"type":146,"tag":215,"props":1310,"children":1312},{"className":1311},[],[1313],{"type":151,"value":1314},"BPF_F_NO_PREALLOC",{"type":151,"value":1316}," flag is set, pre-allocation is disabled.",{"type":146,"tag":147,"props":1318,"children":1319},{},[1320],{"type":151,"value":1321},"Users might consider disabling this for large maps since allocating large amounts of memory takes a lot of time during creation and might be undesirable.",{"type":146,"tag":147,"props":1323,"children":1324},{},[1325,1327,1332,1334,1339],{"type":151,"value":1326},"But for ",{"type":146,"tag":215,"props":1328,"children":1330},{"className":1329},[],[1331],{"type":151,"value":220},{"type":151,"value":1333}," eBPF map type, the ",{"type":146,"tag":215,"props":1335,"children":1337},{"className":1336},[],[1338],{"type":151,"value":1314},{"type":151,"value":1340}," flag must always be set when creating this map type since its implementation cannot pre-allocate it.",{"type":146,"tag":147,"props":1342,"children":1343},{},[1344,1346,1352,1354,1359,1360,1365],{"type":151,"value":1345},"This eBPF map is then populated from the user space program (",{"type":146,"tag":215,"props":1347,"children":1349},{"className":1348},[],[1350],{"type":151,"value":1351},"lab/main.go",{"type":151,"value":1353},"), which basically just means converting the IPs provided in the input to the format that this eBPF map expects (",{"type":146,"tag":215,"props":1355,"children":1357},{"className":1356},[],[1358],{"type":151,"value":546},{"type":151,"value":302},{"type":146,"tag":215,"props":1361,"children":1363},{"className":1362},[],[1364],{"type":151,"value":590},{"type":151,"value":555},{"type":146,"tag":454,"props":1367,"children":1371},{"className":1368,"code":1369,"filename":1351,"language":1370,"meta":459,"style":459},"language-go shiki shiki-themes slack-dark","var blockedIPs   string\nflag.StringVar(&blockedIPs, \"blocked-ips\", \"\", \"Comma-separated IP/mask (192.168.23.3/32, 228.13.0.0/16)\")\n...\n// Build the keys for the BPF_MAP_TYPE_LPM_TRIE eBPF Map\n// e.g. 127.0.0.1/32 -> { Prefixlen: 32, Data: 16777343} \n// Where the:\n// - 'Prefixlen' is the prefix length in bits (e.g., /32, /24).\n// - 'Data' is the IP converted to the integer\nkeys, err := buildIPv4LPMKeys(blockedIPs)\nif err != nil {\n  log.Fatalf(\"blocked-ips error: %v\", err)\n}\n...\n// Add blocked CIDRs/LPM Trie keys into the eBPF map\n// Doesn't matter which prefix the captured IP will match (as long as it does match we need to block it)\nfor _, key := range keys {\n  if err := objs.xdpMaps.BlockedIps.Put(&key, uint32(1)); err != nil {\n    log.Fatalf(\"error adding CIDR to allow list: %s\", err)\n  }\n}\n","go",[1372],{"type":146,"tag":215,"props":1373,"children":1374},{"__ignoreMap":459},[1375,1394,1457,1465,1474,1482,1490,1498,1506,1545,1573,1612,1621,1629,1638,1647,1688,1787,1825,1834],{"type":146,"tag":465,"props":1376,"children":1377},{"class":467,"line":118},[1378,1383,1388],{"type":146,"tag":465,"props":1379,"children":1380},{"style":471},[1381],{"type":151,"value":1382},"var",{"type":146,"tag":465,"props":1384,"children":1385},{"style":683},[1386],{"type":151,"value":1387}," blockedIPs",{"type":146,"tag":465,"props":1389,"children":1391},{"style":1390},"--shiki-default:#4EC9B0",[1392],{"type":151,"value":1393},"   string\n",{"type":146,"tag":465,"props":1395,"children":1396},{"class":467,"line":483},[1397,1402,1406,1411,1415,1420,1425,1429,1434,1438,1443,1447,1452],{"type":146,"tag":465,"props":1398,"children":1399},{"style":683},[1400],{"type":151,"value":1401},"flag",{"type":146,"tag":465,"props":1403,"children":1404},{"style":477},[1405],{"type":151,"value":172},{"type":146,"tag":465,"props":1407,"children":1408},{"style":1190},[1409],{"type":151,"value":1410},"StringVar",{"type":146,"tag":465,"props":1412,"children":1413},{"style":477},[1414],{"type":151,"value":1284},{"type":146,"tag":465,"props":1416,"children":1417},{"style":658},[1418],{"type":151,"value":1419},"&",{"type":146,"tag":465,"props":1421,"children":1422},{"style":683},[1423],{"type":151,"value":1424},"blockedIPs",{"type":146,"tag":465,"props":1426,"children":1427},{"style":477},[1428],{"type":151,"value":295},{"type":146,"tag":465,"props":1430,"children":1431},{"style":1287},[1432],{"type":151,"value":1433},"\"blocked-ips\"",{"type":146,"tag":465,"props":1435,"children":1436},{"style":477},[1437],{"type":151,"value":295},{"type":146,"tag":465,"props":1439,"children":1440},{"style":1287},[1441],{"type":151,"value":1442},"\"\"",{"type":146,"tag":465,"props":1444,"children":1445},{"style":477},[1446],{"type":151,"value":295},{"type":146,"tag":465,"props":1448,"children":1449},{"style":1287},[1450],{"type":151,"value":1451},"\"Comma-separated IP/mask (192.168.23.3/32, 228.13.0.0/16)\"",{"type":146,"tag":465,"props":1453,"children":1454},{"style":477},[1455],{"type":151,"value":1456},")\n",{"type":146,"tag":465,"props":1458,"children":1459},{"class":467,"line":54},[1460],{"type":146,"tag":465,"props":1461,"children":1462},{"style":658},[1463],{"type":151,"value":1464},"...\n",{"type":146,"tag":465,"props":1466,"children":1467},{"class":467,"line":98},[1468],{"type":146,"tag":465,"props":1469,"children":1471},{"style":1470},"--shiki-default:#6A9955",[1472],{"type":151,"value":1473},"// Build the keys for the BPF_MAP_TYPE_LPM_TRIE eBPF Map\n",{"type":146,"tag":465,"props":1475,"children":1476},{"class":467,"line":885},[1477],{"type":146,"tag":465,"props":1478,"children":1479},{"style":1470},[1480],{"type":151,"value":1481},"// e.g. 127.0.0.1/32 -> { Prefixlen: 32, Data: 16777343} \n",{"type":146,"tag":465,"props":1483,"children":1484},{"class":467,"line":923},[1485],{"type":146,"tag":465,"props":1486,"children":1487},{"style":1470},[1488],{"type":151,"value":1489},"// Where the:\n",{"type":146,"tag":465,"props":1491,"children":1492},{"class":467,"line":959},[1493],{"type":146,"tag":465,"props":1494,"children":1495},{"style":1470},[1496],{"type":151,"value":1497},"// - 'Prefixlen' is the prefix length in bits (e.g., /32, /24).\n",{"type":146,"tag":465,"props":1499,"children":1500},{"class":467,"line":992},[1501],{"type":146,"tag":465,"props":1502,"children":1503},{"style":1470},[1504],{"type":151,"value":1505},"// - 'Data' is the IP converted to the integer\n",{"type":146,"tag":465,"props":1507,"children":1508},{"class":467,"line":1001},[1509,1514,1518,1523,1528,1533,1537,1541],{"type":146,"tag":465,"props":1510,"children":1511},{"style":683},[1512],{"type":151,"value":1513},"keys",{"type":146,"tag":465,"props":1515,"children":1516},{"style":477},[1517],{"type":151,"value":295},{"type":146,"tag":465,"props":1519,"children":1520},{"style":683},[1521],{"type":151,"value":1522},"err",{"type":146,"tag":465,"props":1524,"children":1525},{"style":658},[1526],{"type":151,"value":1527}," :=",{"type":146,"tag":465,"props":1529,"children":1530},{"style":1190},[1531],{"type":151,"value":1532}," buildIPv4LPMKeys",{"type":146,"tag":465,"props":1534,"children":1535},{"style":477},[1536],{"type":151,"value":1284},{"type":146,"tag":465,"props":1538,"children":1539},{"style":683},[1540],{"type":151,"value":1424},{"type":146,"tag":465,"props":1542,"children":1543},{"style":477},[1544],{"type":151,"value":1456},{"type":146,"tag":465,"props":1546,"children":1547},{"class":467,"line":53},[1548,1554,1559,1564,1569],{"type":146,"tag":465,"props":1549,"children":1551},{"style":1550},"--shiki-default:#C586C0",[1552],{"type":151,"value":1553},"if",{"type":146,"tag":465,"props":1555,"children":1556},{"style":683},[1557],{"type":151,"value":1558}," err",{"type":146,"tag":465,"props":1560,"children":1561},{"style":658},[1562],{"type":151,"value":1563}," !=",{"type":146,"tag":465,"props":1565,"children":1566},{"style":471},[1567],{"type":151,"value":1568}," nil",{"type":146,"tag":465,"props":1570,"children":1571},{"style":477},[1572],{"type":151,"value":842},{"type":146,"tag":465,"props":1574,"children":1576},{"class":467,"line":1575},11,[1577,1582,1586,1591,1595,1600,1604,1608],{"type":146,"tag":465,"props":1578,"children":1579},{"style":683},[1580],{"type":151,"value":1581},"  log",{"type":146,"tag":465,"props":1583,"children":1584},{"style":477},[1585],{"type":151,"value":172},{"type":146,"tag":465,"props":1587,"children":1588},{"style":1190},[1589],{"type":151,"value":1590},"Fatalf",{"type":146,"tag":465,"props":1592,"children":1593},{"style":477},[1594],{"type":151,"value":1284},{"type":146,"tag":465,"props":1596,"children":1597},{"style":1287},[1598],{"type":151,"value":1599},"\"blocked-ips error: %v\"",{"type":146,"tag":465,"props":1601,"children":1602},{"style":477},[1603],{"type":151,"value":295},{"type":146,"tag":465,"props":1605,"children":1606},{"style":683},[1607],{"type":151,"value":1522},{"type":146,"tag":465,"props":1609,"children":1610},{"style":477},[1611],{"type":151,"value":1456},{"type":146,"tag":465,"props":1613,"children":1615},{"class":467,"line":1614},12,[1616],{"type":146,"tag":465,"props":1617,"children":1618},{"style":477},[1619],{"type":151,"value":1620},"}\n",{"type":146,"tag":465,"props":1622,"children":1624},{"class":467,"line":1623},13,[1625],{"type":146,"tag":465,"props":1626,"children":1627},{"style":658},[1628],{"type":151,"value":1464},{"type":146,"tag":465,"props":1630,"children":1632},{"class":467,"line":1631},14,[1633],{"type":146,"tag":465,"props":1634,"children":1635},{"style":1470},[1636],{"type":151,"value":1637},"// Add blocked CIDRs/LPM Trie keys into the eBPF map\n",{"type":146,"tag":465,"props":1639,"children":1641},{"class":467,"line":1640},15,[1642],{"type":146,"tag":465,"props":1643,"children":1644},{"style":1470},[1645],{"type":151,"value":1646},"// Doesn't matter which prefix the captured IP will match (as long as it does match we need to block it)\n",{"type":146,"tag":465,"props":1648,"children":1650},{"class":467,"line":1649},16,[1651,1656,1661,1665,1670,1674,1679,1684],{"type":146,"tag":465,"props":1652,"children":1653},{"style":1550},[1654],{"type":151,"value":1655},"for",{"type":146,"tag":465,"props":1657,"children":1658},{"style":683},[1659],{"type":151,"value":1660}," _",{"type":146,"tag":465,"props":1662,"children":1663},{"style":477},[1664],{"type":151,"value":295},{"type":146,"tag":465,"props":1666,"children":1667},{"style":683},[1668],{"type":151,"value":1669},"key",{"type":146,"tag":465,"props":1671,"children":1672},{"style":658},[1673],{"type":151,"value":1527},{"type":146,"tag":465,"props":1675,"children":1676},{"style":1550},[1677],{"type":151,"value":1678}," range",{"type":146,"tag":465,"props":1680,"children":1681},{"style":683},[1682],{"type":151,"value":1683}," keys",{"type":146,"tag":465,"props":1685,"children":1686},{"style":477},[1687],{"type":151,"value":842},{"type":146,"tag":465,"props":1689,"children":1691},{"class":467,"line":1690},17,[1692,1697,1701,1705,1710,1714,1719,1723,1728,1732,1737,1741,1745,1749,1753,1758,1762,1766,1771,1775,1779,1783],{"type":146,"tag":465,"props":1693,"children":1694},{"style":1550},[1695],{"type":151,"value":1696},"  if",{"type":146,"tag":465,"props":1698,"children":1699},{"style":683},[1700],{"type":151,"value":1558},{"type":146,"tag":465,"props":1702,"children":1703},{"style":658},[1704],{"type":151,"value":1527},{"type":146,"tag":465,"props":1706,"children":1707},{"style":683},[1708],{"type":151,"value":1709}," objs",{"type":146,"tag":465,"props":1711,"children":1712},{"style":477},[1713],{"type":151,"value":172},{"type":146,"tag":465,"props":1715,"children":1716},{"style":683},[1717],{"type":151,"value":1718},"xdpMaps",{"type":146,"tag":465,"props":1720,"children":1721},{"style":477},[1722],{"type":151,"value":172},{"type":146,"tag":465,"props":1724,"children":1725},{"style":683},[1726],{"type":151,"value":1727},"BlockedIps",{"type":146,"tag":465,"props":1729,"children":1730},{"style":477},[1731],{"type":151,"value":172},{"type":146,"tag":465,"props":1733,"children":1734},{"style":1190},[1735],{"type":151,"value":1736},"Put",{"type":146,"tag":465,"props":1738,"children":1739},{"style":477},[1740],{"type":151,"value":1284},{"type":146,"tag":465,"props":1742,"children":1743},{"style":658},[1744],{"type":151,"value":1419},{"type":146,"tag":465,"props":1746,"children":1747},{"style":683},[1748],{"type":151,"value":1669},{"type":146,"tag":465,"props":1750,"children":1751},{"style":477},[1752],{"type":151,"value":295},{"type":146,"tag":465,"props":1754,"children":1755},{"style":1390},[1756],{"type":151,"value":1757},"uint32",{"type":146,"tag":465,"props":1759,"children":1760},{"style":477},[1761],{"type":151,"value":1284},{"type":146,"tag":465,"props":1763,"children":1764},{"style":664},[1765],{"type":151,"value":732},{"type":146,"tag":465,"props":1767,"children":1768},{"style":477},[1769],{"type":151,"value":1770},")); ",{"type":146,"tag":465,"props":1772,"children":1773},{"style":683},[1774],{"type":151,"value":1522},{"type":146,"tag":465,"props":1776,"children":1777},{"style":658},[1778],{"type":151,"value":1563},{"type":146,"tag":465,"props":1780,"children":1781},{"style":471},[1782],{"type":151,"value":1568},{"type":146,"tag":465,"props":1784,"children":1785},{"style":477},[1786],{"type":151,"value":842},{"type":146,"tag":465,"props":1788,"children":1790},{"class":467,"line":1789},18,[1791,1796,1800,1804,1808,1813,1817,1821],{"type":146,"tag":465,"props":1792,"children":1793},{"style":683},[1794],{"type":151,"value":1795},"    log",{"type":146,"tag":465,"props":1797,"children":1798},{"style":477},[1799],{"type":151,"value":172},{"type":146,"tag":465,"props":1801,"children":1802},{"style":1190},[1803],{"type":151,"value":1590},{"type":146,"tag":465,"props":1805,"children":1806},{"style":477},[1807],{"type":151,"value":1284},{"type":146,"tag":465,"props":1809,"children":1810},{"style":1287},[1811],{"type":151,"value":1812},"\"error adding CIDR to allow list: %s\"",{"type":146,"tag":465,"props":1814,"children":1815},{"style":477},[1816],{"type":151,"value":295},{"type":146,"tag":465,"props":1818,"children":1819},{"style":683},[1820],{"type":151,"value":1522},{"type":146,"tag":465,"props":1822,"children":1823},{"style":477},[1824],{"type":151,"value":1456},{"type":146,"tag":465,"props":1826,"children":1828},{"class":467,"line":1827},19,[1829],{"type":146,"tag":465,"props":1830,"children":1831},{"style":477},[1832],{"type":151,"value":1833},"  }\n",{"type":146,"tag":465,"props":1835,"children":1837},{"class":467,"line":1836},20,[1838],{"type":146,"tag":465,"props":1839,"children":1840},{"style":477},[1841],{"type":151,"value":1620},{"type":146,"tag":354,"props":1843,"children":1844},{"kind":356},[1845],{"type":146,"tag":147,"props":1846,"children":1847},{},[1848],{"type":151,"value":1849},"💡 Note that when I say CIDR block, I’m simply referring to an IP range defined by a network address and a prefix length.",{"type":146,"tag":147,"props":1851,"children":1852},{},[1853,1855,1860,1862,1868],{"type":151,"value":1854},"In this implementation, the map value actually doesn’t matter (we simply set it to ",{"type":146,"tag":215,"props":1856,"children":1858},{"className":1857},[],[1859],{"type":151,"value":732},{"type":151,"value":1861},"); all we care about is whether the IP exists in the blacklist. And if the lookup returns ",{"type":146,"tag":215,"props":1863,"children":1865},{"className":1864},[],[1866],{"type":151,"value":1867},"NULL",{"type":151,"value":1869},", the client isn’t blocked, so the packet is allowed to pass.",{"type":146,"tag":147,"props":1871,"children":1872},{},[1873],{"type":151,"value":1874},"With that covered, you should have a pretty good intuition how can we now fit this into our eBPF firewall implementation.",{"type":146,"tag":314,"props":1876,"children":1878},{"id":1877},"implementation-breakdown",[1879],{"type":151,"value":1880},"Implementation Breakdown",{"type":146,"tag":147,"props":1882,"children":1883},{},[1884,1886,1892,1894,1899],{"type":151,"value":1885},"The only difference that we have compared to ",{"type":146,"tag":154,"props":1887,"children":1889},{"href":166,"rel":1888},[158],[1890],{"type":151,"value":1891},"packet rate-limiting program",{"type":151,"value":1893}," is now to perform a lookup against the ",{"type":146,"tag":215,"props":1895,"children":1897},{"className":1896},[],[1898],{"type":151,"value":220},{"type":151,"value":1900}," eBPF map with the prefix.",{"type":146,"tag":454,"props":1902,"children":1904},{"className":456,"code":1903,"filename":1169,"language":458,"meta":459,"style":459},"...\n__u32 src = bpf_ntohl(ip->saddr); \n\nstruct ipv4_lpm_key key = {\n  .prefixlen = 32,\n  .data = src,\n};\n\nint *blocked = bpf_map_lookup_elem(&blocked_ips, &key);\nif (blocked && *blocked) {\n  return XDP_DROP;\n}\n...\n",[1905],{"type":146,"tag":215,"props":1906,"children":1907},{"__ignoreMap":459},[1908,1915,1952,1960,1980,2000,2017,2024,2031,2087,2113,2126,2133],{"type":146,"tag":465,"props":1909,"children":1910},{"class":467,"line":118},[1911],{"type":146,"tag":465,"props":1912,"children":1913},{"style":477},[1914],{"type":151,"value":1464},{"type":146,"tag":465,"props":1916,"children":1917},{"class":467,"line":483},[1918,1923,1927,1932,1937,1942,1947],{"type":146,"tag":465,"props":1919,"children":1920},{"style":477},[1921],{"type":151,"value":1922},"__u32 src ",{"type":146,"tag":465,"props":1924,"children":1925},{"style":658},[1926],{"type":151,"value":661},{"type":146,"tag":465,"props":1928,"children":1929},{"style":1190},[1930],{"type":151,"value":1931}," bpf_ntohl",{"type":146,"tag":465,"props":1933,"children":1934},{"style":477},[1935],{"type":151,"value":1936},"(ip",{"type":146,"tag":465,"props":1938,"children":1939},{"style":658},[1940],{"type":151,"value":1941},"->",{"type":146,"tag":465,"props":1943,"children":1944},{"style":683},[1945],{"type":151,"value":1946},"saddr",{"type":146,"tag":465,"props":1948,"children":1949},{"style":477},[1950],{"type":151,"value":1951},"); \n",{"type":146,"tag":465,"props":1953,"children":1954},{"class":467,"line":54},[1955],{"type":146,"tag":465,"props":1956,"children":1957},{"emptyLinePlaceholder":11},[1958],{"type":151,"value":1959},"\n",{"type":146,"tag":465,"props":1961,"children":1962},{"class":467,"line":98},[1963,1967,1972,1976],{"type":146,"tag":465,"props":1964,"children":1965},{"style":471},[1966],{"type":151,"value":474},{"type":146,"tag":465,"props":1968,"children":1969},{"style":477},[1970],{"type":151,"value":1971}," ipv4_lpm_key key ",{"type":146,"tag":465,"props":1973,"children":1974},{"style":658},[1975],{"type":151,"value":661},{"type":146,"tag":465,"props":1977,"children":1978},{"style":477},[1979],{"type":151,"value":842},{"type":146,"tag":465,"props":1981,"children":1982},{"class":467,"line":885},[1983,1988,1992,1996],{"type":146,"tag":465,"props":1984,"children":1985},{"style":477},[1986],{"type":151,"value":1987},"  .prefixlen ",{"type":146,"tag":465,"props":1989,"children":1990},{"style":658},[1991],{"type":151,"value":661},{"type":146,"tag":465,"props":1993,"children":1994},{"style":664},[1995],{"type":151,"value":803},{"type":146,"tag":465,"props":1997,"children":1998},{"style":477},[1999],{"type":151,"value":882},{"type":146,"tag":465,"props":2001,"children":2002},{"class":467,"line":923},[2003,2008,2012],{"type":146,"tag":465,"props":2004,"children":2005},{"style":477},[2006],{"type":151,"value":2007},"  .data ",{"type":146,"tag":465,"props":2009,"children":2010},{"style":658},[2011],{"type":151,"value":661},{"type":146,"tag":465,"props":2013,"children":2014},{"style":477},[2015],{"type":151,"value":2016}," src,\n",{"type":146,"tag":465,"props":2018,"children":2019},{"class":467,"line":959},[2020],{"type":146,"tag":465,"props":2021,"children":2022},{"style":477},[2023],{"type":151,"value":515},{"type":146,"tag":465,"props":2025,"children":2026},{"class":467,"line":992},[2027],{"type":146,"tag":465,"props":2028,"children":2029},{"emptyLinePlaceholder":11},[2030],{"type":151,"value":1959},{"type":146,"tag":465,"props":2032,"children":2033},{"class":467,"line":1001},[2034,2039,2044,2049,2053,2058,2062,2066,2071,2075,2079,2083],{"type":146,"tag":465,"props":2035,"children":2036},{"style":471},[2037],{"type":151,"value":2038},"int",{"type":146,"tag":465,"props":2040,"children":2041},{"style":658},[2042],{"type":151,"value":2043}," *",{"type":146,"tag":465,"props":2045,"children":2046},{"style":477},[2047],{"type":151,"value":2048},"blocked ",{"type":146,"tag":465,"props":2050,"children":2051},{"style":658},[2052],{"type":151,"value":661},{"type":146,"tag":465,"props":2054,"children":2055},{"style":1190},[2056],{"type":151,"value":2057}," bpf_map_lookup_elem",{"type":146,"tag":465,"props":2059,"children":2060},{"style":477},[2061],{"type":151,"value":1284},{"type":146,"tag":465,"props":2063,"children":2064},{"style":658},[2065],{"type":151,"value":1419},{"type":146,"tag":465,"props":2067,"children":2068},{"style":683},[2069],{"type":151,"value":2070},"blocked_ips",{"type":146,"tag":465,"props":2072,"children":2073},{"style":477},[2074],{"type":151,"value":295},{"type":146,"tag":465,"props":2076,"children":2077},{"style":658},[2078],{"type":151,"value":1419},{"type":146,"tag":465,"props":2080,"children":2081},{"style":683},[2082],{"type":151,"value":1669},{"type":146,"tag":465,"props":2084,"children":2085},{"style":477},[2086],{"type":151,"value":1266},{"type":146,"tag":465,"props":2088,"children":2089},{"class":467,"line":53},[2090,2094,2099,2104,2108],{"type":146,"tag":465,"props":2091,"children":2092},{"style":1550},[2093],{"type":151,"value":1553},{"type":146,"tag":465,"props":2095,"children":2096},{"style":477},[2097],{"type":151,"value":2098}," (blocked ",{"type":146,"tag":465,"props":2100,"children":2101},{"style":658},[2102],{"type":151,"value":2103},"&&",{"type":146,"tag":465,"props":2105,"children":2106},{"style":658},[2107],{"type":151,"value":2043},{"type":146,"tag":465,"props":2109,"children":2110},{"style":477},[2111],{"type":151,"value":2112},"blocked) {\n",{"type":146,"tag":465,"props":2114,"children":2115},{"class":467,"line":1575},[2116,2121],{"type":146,"tag":465,"props":2117,"children":2118},{"style":1550},[2119],{"type":151,"value":2120},"  return",{"type":146,"tag":465,"props":2122,"children":2123},{"style":477},[2124],{"type":151,"value":2125}," XDP_DROP;\n",{"type":146,"tag":465,"props":2127,"children":2128},{"class":467,"line":1614},[2129],{"type":146,"tag":465,"props":2130,"children":2131},{"style":477},[2132],{"type":151,"value":1620},{"type":146,"tag":465,"props":2134,"children":2135},{"class":467,"line":1623},[2136],{"type":146,"tag":465,"props":2137,"children":2138},{"style":477},[2139],{"type":151,"value":1464},{"type":146,"tag":147,"props":2141,"children":2142},{},[2143,2145,2151],{"type":151,"value":2144},"Here, prefix (",{"type":146,"tag":215,"props":2146,"children":2148},{"className":2147},[],[2149],{"type":151,"value":2150},"/32",{"type":151,"value":2152},") is just hardcoded, because a single IP represent \"a range with a single IP\".",{"type":146,"tag":147,"props":2154,"children":2155},{},[2156,2158,2163],{"type":151,"value":2157},"And with this simple trick of using ",{"type":146,"tag":215,"props":2159,"children":2161},{"className":2160},[],[2162],{"type":151,"value":220},{"type":151,"value":2164}," we already created a pretty powerful layer 4 firewall that filters network packets based on the client IP but allowing one to blacklist whole IP ranges.",{"type":146,"tag":377,"props":2166,"children":2168},{":summary":2167},"What do you mean when you say L4 (or L7)?",[2169,2174],{"type":146,"tag":147,"props":2170,"children":2171},{},[2172],{"type":151,"value":2173},"When one talks about L4 and L7, we’re referring to different layers of the network stack:",{"type":146,"tag":229,"props":2175,"children":2176},{},[2177,2187],{"type":146,"tag":233,"props":2178,"children":2179},{},[2180,2185],{"type":146,"tag":204,"props":2181,"children":2182},{},[2183],{"type":151,"value":2184},"Layer 4 (L4):",{"type":151,"value":2186}," The transport layer—TCP/UDP and the layers below (IP, Ethernet).",{"type":146,"tag":233,"props":2188,"children":2189},{},[2190,2195],{"type":146,"tag":204,"props":2191,"children":2192},{},[2193],{"type":151,"value":2194},"Layer 7 (L7):",{"type":151,"value":2196}," The application layer, where filtering is based on things like HTTP headers, DNS hostnames, and other protocol-level data.",{"type":146,"tag":147,"props":2198,"children":2199},{},[2200],{"type":151,"value":2201},"Let's see it in action.",{"type":146,"tag":2203,"props":2204,"children":2205},"hr",{},[],{"type":146,"tag":147,"props":2207,"children":2208},{},[2209],{"type":151,"value":2210},"We could demonstrate this with simple ICMP pings—just like in the ICMPv6 rate-limiting example—but let’s take it one step further.",{"type":146,"tag":147,"props":2212,"children":2213},{},[2214,2216,2221,2223,2228],{"type":151,"value":2215},"First, start an HTTP server on the ",{"type":146,"tag":215,"props":2217,"children":2219},{"className":2218},[],[2220],{"type":151,"value":38},{"type":151,"value":2222}," node (",{"type":146,"tag":215,"props":2224,"children":2226},{"className":2225},[],[2227],{"type":151,"value":38},{"type":151,"value":2229}," tab):",{"type":146,"tag":454,"props":2231,"children":2235},{"className":2232,"code":2233,"language":2234,"meta":459,"style":459},"language-bash shiki shiki-themes slack-dark","python3 -m http.server\n","bash",[2236],{"type":146,"tag":215,"props":2237,"children":2238},{"__ignoreMap":459},[2239],{"type":146,"tag":465,"props":2240,"children":2241},{"class":467,"line":118},[2242,2247,2252],{"type":146,"tag":465,"props":2243,"children":2244},{"style":1190},[2245],{"type":151,"value":2246},"python3",{"type":146,"tag":465,"props":2248,"children":2249},{"style":1287},[2250],{"type":151,"value":2251}," -m",{"type":146,"tag":465,"props":2253,"children":2254},{"style":1287},[2255],{"type":151,"value":2256}," http.server\n",{"type":146,"tag":147,"props":2258,"children":2259},{},[2260,2262,2267,2268,2273,2274,2279,2280,2285],{"type":151,"value":2261},"Then, from either the ",{"type":146,"tag":215,"props":2263,"children":2265},{"className":2264},[],[2266],{"type":151,"value":48},{"type":151,"value":1075},{"type":146,"tag":215,"props":2269,"children":2271},{"className":2270},[],[2272],{"type":151,"value":45},{"type":151,"value":2222},{"type":146,"tag":215,"props":2275,"children":2277},{"className":2276},[],[2278],{"type":151,"value":48},{"type":151,"value":1075},{"type":146,"tag":215,"props":2281,"children":2283},{"className":2282},[],[2284],{"type":151,"value":45},{"type":151,"value":2286}," tabs), try accessing it:",{"type":146,"tag":454,"props":2288,"children":2290},{"className":2232,"code":2289,"language":2234,"meta":459,"style":459},"curl http://172.16.0.10:8000\n",[2291],{"type":146,"tag":215,"props":2292,"children":2293},{"__ignoreMap":459},[2294],{"type":146,"tag":465,"props":2295,"children":2296},{"class":467,"line":118},[2297,2302],{"type":146,"tag":465,"props":2298,"children":2299},{"style":1190},[2300],{"type":151,"value":2301},"curl",{"type":146,"tag":465,"props":2303,"children":2304},{"style":1287},[2305],{"type":151,"value":2306}," http://172.16.0.10:8000\n",{"type":146,"tag":147,"props":2308,"children":2309},{},[2310],{"type":151,"value":2311},"You’ll notice that both nodes can successfully reach the HTTP server, even though ideally the attacker shouldn’t be able to reach it.",{"type":146,"tag":147,"props":2313,"children":2314},{},[2315,2317,2322,2324,2330],{"type":151,"value":2316},"Therefore, let’s build and run our eBPF XDP firewall. Open another ",{"type":146,"tag":215,"props":2318,"children":2320},{"className":2319},[],[2321],{"type":151,"value":38},{"type":151,"value":2323}," tab, navigate to the ",{"type":146,"tag":215,"props":2325,"children":2327},{"className":2326},[],[2328],{"type":151,"value":2329},"/lab",{"type":151,"value":2331}," directory, and run:",{"type":146,"tag":454,"props":2333,"children":2335},{"className":2232,"code":2334,"language":2234,"meta":459,"style":459},"go generate\ngo build\nsudo ./xdp -i eth0 --blocked-ips 192.168.178.10/24 # \u003C- this is the attacker subnet\n",[2336],{"type":146,"tag":215,"props":2337,"children":2338},{"__ignoreMap":459},[2339,2351,2363],{"type":146,"tag":465,"props":2340,"children":2341},{"class":467,"line":118},[2342,2346],{"type":146,"tag":465,"props":2343,"children":2344},{"style":1190},[2345],{"type":151,"value":1370},{"type":146,"tag":465,"props":2347,"children":2348},{"style":1287},[2349],{"type":151,"value":2350}," generate\n",{"type":146,"tag":465,"props":2352,"children":2353},{"class":467,"line":483},[2354,2358],{"type":146,"tag":465,"props":2355,"children":2356},{"style":1190},[2357],{"type":151,"value":1370},{"type":146,"tag":465,"props":2359,"children":2360},{"style":1287},[2361],{"type":151,"value":2362}," build\n",{"type":146,"tag":465,"props":2364,"children":2365},{"class":467,"line":54},[2366,2371,2376,2381,2386,2391,2396],{"type":146,"tag":465,"props":2367,"children":2368},{"style":1190},[2369],{"type":151,"value":2370},"sudo",{"type":146,"tag":465,"props":2372,"children":2373},{"style":1287},[2374],{"type":151,"value":2375}," ./xdp",{"type":146,"tag":465,"props":2377,"children":2378},{"style":1287},[2379],{"type":151,"value":2380}," -i",{"type":146,"tag":465,"props":2382,"children":2383},{"style":1287},[2384],{"type":151,"value":2385}," eth0",{"type":146,"tag":465,"props":2387,"children":2388},{"style":1287},[2389],{"type":151,"value":2390}," --blocked-ips",{"type":146,"tag":465,"props":2392,"children":2393},{"style":1287},[2394],{"type":151,"value":2395}," 192.168.178.10/24",{"type":146,"tag":465,"props":2397,"children":2398},{"style":1470},[2399],{"type":151,"value":2400}," # \u003C- this is the attacker subnet\n",{"type":146,"tag":354,"props":2402,"children":2403},{"kind":356},[2404],{"type":146,"tag":147,"props":2405,"children":2406},{},[2407,2409,2415],{"type":151,"value":2408},"💡 Try running ",{"type":146,"tag":215,"props":2410,"children":2412},{"className":2411},[],[2413],{"type":151,"value":2414},"sudo ./xdp --help",{"type":151,"value":2416}," to see all available parameters and their usage.",{"type":146,"tag":147,"props":2418,"children":2419},{},[2420],{"type":151,"value":2421},"Now curl the HTTP server again—you’ll see that the attacker is blocked. Success ✅",{"type":146,"tag":354,"props":2423,"children":2424},{"kind":356},[2425],{"type":146,"tag":147,"props":2426,"children":2427},{},[2428],{"type":151,"value":2429},"💡 Actually, whitelisting clients would actually be easier, since there are usually far fewer trusted clients than potential attackers. However, we use blacklisting here so we don’t unintentionally interfere with other network traffic required for the playground to function.",{"type":146,"tag":147,"props":2431,"children":2432},{},[2433],{"type":151,"value":2434},"That said, for pure L4 filtering—IP, ports, protocol, and some advanced matching—eBPF is easily the most performant option. But I believe the transition will still be slow: eBPF expertise is rare, and migration is best done in batches—if you do need it, start by replacing a small subset of features with XDP and then expand as your team’s skills grow.",{"type":146,"tag":147,"props":2436,"children":2437},{},[2438],{"type":151,"value":2439},"I will leave it at that - congrats you've came to the end of this tutorial 🎉",{"type":146,"tag":147,"props":2441,"children":2442},{},[2443],{"type":151,"value":2444},"In the next tutorial, we take a look at different XDP Load balancing solutions, starting with XDP NAT Load Balancer implementation.",{"type":146,"tag":2446,"props":2447,"children":2448},"style",{},[2449],{"type":151,"value":2450},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":459,"searchDepth":483,"depth":483,"links":2453},[2454,2455,2456],{"id":316,"depth":483,"text":319},{"id":431,"depth":483,"text":434},{"id":1877,"depth":483,"text":1880},["Reactive",2458],{},["Reactive",2460],{},["Reactive",2462],{},"#ebpf-firewall-ed03d648-server",{"left":40,"top":40,"width":2465,"height":2465,"rotate":40,"vFlip":2466,"hFlip":2466,"body":2467},24,false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":40,"top":40,"width":2469,"height":2469,"rotate":40,"vFlip":2466,"hFlip":2466,"body":2470},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",2472],{"$scurrentUser":2473,"$salerts":2477,"$scontentToggle":2478,"$ssite-config":2479},{"id":2474,"anonymous":11,"effectiveTier":2475,"hasEmailSubscription":2466},"697b5f64cc8f8f56faac74e1",{"name":2476},"free",[],{"/tutorials/ebpf-firewall-ed03d648":11},{"_priority":2480,"env":2483,"name":2484,"url":2485},{"name":2481,"env":2482,"url":40},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",2488],{"tutorial-page-tutorial-ebpf-firewall-ed03d648":-1,"content-tutorial-ebpf-firewall-ed03d648-v1766928134826":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/ebpf-firewall-ed03d648"]</script></body></html>