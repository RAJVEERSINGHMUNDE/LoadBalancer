<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose?</title><link nonce="" rel="stylesheet" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/inter.css"><link nonce="" rel="stylesheet" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">details>summary[data-v-370f298d]{font-size:var(--prose-p-fontSize)}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-dmAK1hhiumNXMs/NjWqR1YxMm3vyiMg16sggZx3HjlYKju1wCeiJzsSNr9NEW6TG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddhl0Rna.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="In this tutorial, we’ll look at how different eBPF tracing mechanisms work in practice by focusing on a single use case: capturing execve system call events. We’ll start with tracepoints, move on to raw tracepoints, and then cover kprobes and fprobes, showing how each attaches to the kernel and what data they expose. Along the way, we’ll compare their trade-offs in terms of stability, performance, and portability."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose? | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose? | iximiuz Labs"><meta property="og:description" content="In this tutorial, we’ll look at how different eBPF tracing mechanisms work in practice by focusing on a single use case: capturing execve system call events. We’ll start with tracepoints, move on to raw tracepoints, and then cover kprobes and fprobes, showing how each attaches to the kernel and what data they expose. Along the way, we’ll compare their trade-offs in terms of stability, performance, and portability."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/ebpf-tracing-46a570d1"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-tracing-46a570d1/__static__/tracing.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose? | iximiuz Labs"><meta name="twitter:description" content="In this tutorial, we’ll look at how different eBPF tracing mechanisms work in practice by focusing on a single use case: capturing execve system call events. We’ll start with tracepoints, move on to raw tracepoints, and then cover kprobes and fprobes, showing how each attaches to the kernel and what data they expose. Along the way, we’ll compare their trade-offs in terms of stability, performance, and portability."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-tracing-46a570d1/__static__/tracing.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/ebpf-tracing-46a570d1"><link nonce="" rel="image_src" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/tracing.png"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/_name_.BsyFxT4E.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseCodeInline.BhuXSD4-.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProsePre.B_fgAJq0.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/DetailsBox.3wfYThLq.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/ProseLi.BqrAa653.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/tracing.png"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/ebpf-tracing-46a570d1" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose?" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose?</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Febpf-tracing-46a570d1" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-tracing-46a570d1" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#ebpf-tracepoint" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">eBPF Tracepoint</a><!----></li><li data-v-c294bba9=""><a href="#ebpf-raw-tracepoint" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">eBPF Raw Tracepoint</a><!----></li><li data-v-c294bba9=""><a href="#ebpf-kernel-probes-kprobes" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">eBPF Kernel Probes (kprobes)</a><!----></li><li data-v-c294bba9=""><a href="#fprobes" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">Fprobes</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-tracing-46a570d1" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Programming</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose?"><meta itemprop="abstract" content="In this tutorial, we’ll look at how different eBPF tracing mechanisms work in practice by focusing on a single use case: capturing execve system call events. We’ll start with tracepoints, move on to raw tracepoints, and then cover kprobes and fprobes, showing how each attaches to the kernel and what data they expose. Along the way, we’ll compare their trade-offs in terms of stability, performance, and portability."><meta itemprop="dateCreated" content="2025-09-09T00:00:00.000Z"><meta itemprop="datePublished" content="2025-09-09T00:00:00.000Z"><meta itemprop="dateModified" content="2025-09-09T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:underline no-underline truncate">Programming</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Sep 9, 2025"><time datetime="createdAt"> Published: Sep 9, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose?</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->It is safe to say that almost all eBPF programs can capture and send kernel event data to user space applications.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->However,
 eBPF tracing program types like kprobes, fprobes, and tracepoints are 
often preferred because they hook into kernel functions or events with 
access to rich, actionable data for tasks like performance monitoring or
 syscall argument tracing.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->But their overlapping functionality can make choosing the right one confusing.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:600px;"><div class="text-center"><img src="eBPF%20Tracepoints,%20Kprobes,%20or%20Fprobes_%20Which%20One%20Should%20You%20Choose__files/tracing.png" alt="eBPF Tracing" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->In this tutorial, we’ll look at a few different eBPF tracing program types that all capture <code class="prose-code-inline" data-v-a031129a=""><!--[-->execve<!--]--></code> syscall events, and then compare their strengths and trade-offs. The code lives for this lab is in the <code class="prose-code-inline" data-v-a031129a=""><!--[-->labs/lab1<!--]--></code> directory.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->I’ll
 walk you through the details step by step—but you can also try things 
out anytime by building and running the program yourself:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> generate
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> build
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ./lab1
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Then, open a new terminal tab and inspect the eBPF logs to see which kernel events these hook points capture:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> prog</span><span style="--shiki-default:#CE9178"> trace
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><h2 id="ebpf-tracepoint" class="prose-h2" data-v-b9b1576a=""><!--[-->eBPF Tracepoint<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->eBPF
 tracepoint programs attach to predefined hook points in the Linux 
kernel. These hook points are defined in the kernel source code with a <code class="prose-code-inline" data-v-a031129a=""><!--[-->TRACE_EVENT<!--]--></code> macro. Once attached, an eBPF program runs its custom logic whenever the kernel hits the corresponding tracepoint.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">More information on TRACE_EVENT macro</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->TRACE_EVENT<!--]--></code> is the generic macro for defining custom tracepoints in the kernel, while <code class="prose-code-inline" data-v-a031129a=""><!--[-->TRACE_EVENT_SYSCALL<!--]--></code> is a specialized variant for syscalls through which eBPF Tracepoint hook are created.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In fact, there is <strong class="prose-strong" data-v-24022f14=""><!--[-->NO<!--]--></strong> static <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_enter_execve<!--]--></code> tracepoint defined in the kernel.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Instead, per-syscall tracepoints are generated at build time using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->TRACE_EVENT_SYSCALL<!--]--></code> template in <a href="https://codebrowser.dev/linux/linux/include/trace/events/syscalls.h.html" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->include/trace/events/syscalls.h<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> and syscall metadata from the architecture’s syscall tables like <a href="https://raw.githubusercontent.com/torvalds/linux/master/arch/x86/entry/syscalls/syscall_64.tbl" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->arch/x86/entry/syscalls/syscall_64.tbl<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>. This generation is handled by code in <a href="https://codebrowser.dev/linux/linux/kernel/trace/trace_syscalls.c.html" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->kernel/trace/trace_syscalls.c<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to produce an entry tracepoint like <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_enter_execve<!--]--></code> to which eBPF can then attach to.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->For example, the <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_enter_execve<!--]--></code> tracepoint fires when a process calls <code class="prose-code-inline" data-v-a031129a=""><!--[-->execve<!--]--></code>,
 exposing the program name and arguments. This makes it useful for tasks
 such as auditing, security monitoring, or analyzing user activity.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->You can find all events that eBPF tracepoints can hook onto, using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> cat</span><span style="--shiki-default:#CE9178"> /sys/kernel/debug/tracing/available_events
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>drm:drm_vblank_event
drm:drm_vblank_event_queued
drm:drm_vblank_event_delivered
...
syscalls:sys_exit_execveat
syscalls:sys_enter_execveat
syscalls:sys_exit_execve
syscalls:sys_enter_execve # &lt;- here is our tracepoint
syscalls:sys_exit_pipe
...
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->The output format is in the form <code class="prose-code-inline" data-v-a031129a=""><!--[-->&lt;category&gt;:&lt;name&gt;<!--]--></code>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->category<!--]--></code> and the <code class="prose-code-inline" data-v-a031129a=""><!--[-->name<!--]--></code>, you can then view the input arguments for each tracepoint by printing the contents of <code class="prose-code-inline" data-v-a031129a=""><!--[-->/sys/kernel/debug/tracing/events/&lt;category&gt;/&lt;name&gt;/format<!--]--></code>.<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> cat</span><span style="--shiki-default:#CE9178"> /sys/kernel/debug/tracing/events/syscalls/sys_enter_execve/format
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>name: sys_enter_execve
ID: 660
format:
        field:unsigned short common_type;           offset:0; size:2; signed:0;
        field:unsigned char common_flags;           offset:2; size:1; signed:0;
        field:unsigned char common_preempt_count;   offset:3; size:1; signed:0;
        field:int           common_pid;             offset:4; size:4; signed:1;

        field:int        __syscall_nr;              offset:8;  size:4; signed:1;
        field:const char * filename;                offset:16; size:8; signed:0;
        field:const char *const * argv;             offset:24; size:8; signed:0;
        field:const char *const * envp;             offset:32; size:8; signed:0;

print fmt: "filename: 0x%08lx, argv: 0x%08lx, envp: 0x%08lx", ((unsigned long)(REC-&gt;filename)), ((unsigned long)(REC-&gt;argv)), ((unsigned long)(REC-&gt;envp))
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡
 The first four arguments, are actually not accessible by the eBPF code.
 This is a choice that dates back to the original inclusion of this 
code. See explaination in <a href="https://github.com/torvalds/linux/commit/98b5c2c65c2951772a8fc661f50d675e450e8bce" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->commit 98b5c2c65c29<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->With
 this information, you can then define an input context struct that 
matches the accessible fields and then write your eBPF tracepoint 
program against it.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_sys_enter_execve {                                             
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    short</span><span style="--shiki-default:#E6E6E6"> common_type;                                                      
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#E6E6E6"> common_flags;                                                      
</span></span><span class="line" line="5"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#E6E6E6"> common_preempt_count;                                              
</span></span><span class="line" line="6"><span style="--shiki-default:#569CD6">    int</span><span style="--shiki-default:#E6E6E6"> common_pid;                                                         
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">                                                                            
</span></span><span class="line" line="8"><span style="--shiki-default:#E6E6E6">    s32 syscall_nr;</span><span style="--shiki-default:#6A9955">        // offset=8,  size=4                             
</span></span><span class="line" line="9"><span style="--shiki-default:#E6E6E6">    u32 pad;</span><span style="--shiki-default:#6A9955">               // offset=12, size=4 (pad)                       
</span></span><span class="line" line="10"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#E6E6E6"> u8 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">filename;</span><span style="--shiki-default:#6A9955">    // offset=16, size=8                             
</span></span><span class="line" line="11"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#E6E6E6"> u8 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">argv;</span><span style="--shiki-default:#6A9955"> // offset=24, size=8                             
</span></span><span class="line" line="12"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#E6E6E6"> u8 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">envp;</span><span style="--shiki-default:#6A9955"> // offset=32, size=8                             
</span></span><span class="line" line="13"><span style="--shiki-default:#E6E6E6">};                                                                          
</span></span><span class="line" line="14"><span style="--shiki-default:#E6E6E6">                                                                            
</span></span><span class="line" line="15"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tracepoint/syscalls/sys_enter_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="16"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_tp_non_core</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_sys_enter_execve </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="17"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename_ptr </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)(</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">filename</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="18"><span emptylineplaceholder="true">
</span></span><span class="line" line="19"><span style="--shiki-default:#E6E6E6">    u8 </span><span style="--shiki-default:#9CDCFE">buf</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line" line="20"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(buf, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(buf), filename_ptr);
</span></span><span class="line" line="21"><span emptylineplaceholder="true">
</span></span><span class="line" line="22"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Tracepoint triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, buf);
</span></span><span class="line" line="23"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="24"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 <code class="prose-code-inline" data-v-a031129a=""><!--[-->SEC("tp/xx/yy")<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->SEC("tracepoint/xx/yy")<!--]--></code> are equivalent, and you can use either one according to personal preference.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->But there are two downsides to this:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->First, <strong class="prose-strong" data-v-24022f14=""><!--[-->tracepoints only exist where kernel developers have added them<!--]--></strong>.
 If you need visibility into something that is not supported by the 
listed tracepoints, you either go through the long process of proposing a
 new tracepoint upstream (and convincing Linus to accept it), or use an 
alternative technique.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->Second, they’re <strong class="prose-strong" data-v-24022f14=""><!--[-->not always ideal for high-performance use cases<!--]--></strong> — we’ll dig into that shortly.<!--]--></li><!--]--></ul><h2 id="ebpf-raw-tracepoint" class="prose-h2" data-v-b9b1576a=""><!--[-->eBPF Raw Tracepoint<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->Raw tracepoints may look similar to regular tracepoints, since both correspond to events you can view under <code class="prose-code-inline" data-v-a031129a=""><!--[-->/sys/kernel/debug/tracing/available_events<!--]--></code>. The difference lies in how the kernel passes arguments to them.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For
 regular tracepoints, the kernel pre-processes the arguments and builds a
 context struct. In contrast, eBPF raw tracepoints receive their 
arguments in a raw format via <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct bpf_raw_tracepoint_args<!--]--></code> (defined in <code class="prose-code-inline" data-v-a031129a=""><!--[-->vmlinux.h<!--]--></code>), and the program must interpret them manually.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Because no extra work is done to package fields, raw tracepoints typically <a href="https://lwn.net/Articles/750569/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->run faster with less overhead than regular tracepoints<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Another important difference is that there are no per-syscall raw tracepoints like <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_enter_execve<!--]--></code>. Instead, only the generic <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_enter<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_exit<!--]--></code> tracepoints exist.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">What is the difference between sys_enter and sys_exit tracepoint?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_enter<!--]--></code> hooks trigger on every syscall event entry, while <code class="prose-code-inline" data-v-a031129a=""><!--[-->sys_exit<!--]--></code> hooks trigger on its return, capturing the return value of the syscall.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->This
 means that if you want to act on a specific syscall event inside your 
raw tracepoint eBPF program, you need to filter by syscall ID.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line highlight" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"raw_tracepoint/sys_enter"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_raw_tp_non_core</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> bpf_raw_tracepoint_args </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line highlight" line="3"><span style="--shiki-default:#6A9955">    // There is no method to attach a raw_tp directly to a single syscall... 
</span></span><span class="line highlight" line="4"><span style="--shiki-default:#6A9955">    // this is because there are no static defined tracepoints on single syscalls but only on generic sys_enter/sys_exit
</span></span><span class="line highlight" line="5"><span style="--shiki-default:#6A9955">    // So we have to filter by syscall ID
</span></span><span class="line highlight" line="6"><span style="--shiki-default:#6A9955">    //
</span></span><span class="line highlight" line="7"><span style="--shiki-default:#6A9955">    // The arguments of input context struct are defined in TP_PROTO of the tracepoint definition in kernel.
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#6A9955">    // Ref: https://codebrowser.dev/linux/linux/include/trace/events/syscalls.h.html#20
</span></span><span class="line highlight" line="9"><span style="--shiki-default:#6A9955">    // In this case it is TP_PROTO(struct pt_regs *regs, long id):
</span></span><span class="line highlight" line="10"><span style="--shiki-default:#6A9955">    // args[0] -&gt; struct pt_regs *regs
</span></span><span class="line highlight" line="11"><span style="--shiki-default:#6A9955">    // args[1] -&gt; long id
</span></span><span class="line highlight" line="12"><span style="--shiki-default:#569CD6">    unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6"> id </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#9CDCFE"> ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">args</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">1</span><span style="--shiki-default:#E6E6E6">];
</span></span><span class="line highlight" line="13"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (id </span><span style="--shiki-default:#D4D4D4">!=</span><span style="--shiki-default:#B5CEA8"> 59</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#6A9955">   // execve sycall ID
</span></span><span class="line highlight" line="14"><span style="--shiki-default:#C586C0">        return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">regs </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">args</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">];
</span></span><span class="line" line="17"><span emptylineplaceholder="true">
</span></span><span class="line" line="18"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename;
</span></span><span class="line" line="19"><span style="--shiki-default:#6A9955">    // Intentionally accessing the register (without using PT_REGS_PARM* macro) directly for illustration
</span></span><span class="line" line="20"><span style="--shiki-default:#DCDCAA">    bpf_probe_read</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">filename, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(filename), </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">regs</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">di</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="21"><span emptylineplaceholder="true">
</span></span><span class="line" line="22"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#9CDCFE"> buf</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line" line="23"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(buf, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(buf), filename);
</span></span><span class="line" line="24"><span emptylineplaceholder="true">
</span></span><span class="line" line="25"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Raw tracepoint triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, buf);
</span></span><span class="line" line="26"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="27"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 <code class="prose-code-inline" data-v-a031129a=""><!--[-->SEC("raw_tp/xx")<!--]--></code> and <code class="prose-code-inline" data-v-a031129a=""><!--[-->SEC("raw_tracepoint/xx")<!--]--></code> are equivalent, and you can use either one according to personal preference.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Notice also that we are reading the syscall arguments from CPU registers. On x86-64, the <a href="https://gitlab.com/x86-psABIs/x86-64-ABI/-/jobs/artifacts/master/raw/x86-64-ABI/abi.pdf?job=build" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->System V ABI<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> defines the first argument in <code class="prose-code-inline" data-v-a031129a=""><!--[-->%rdi<!--]--></code> (<code class="prose-code-inline" data-v-a031129a=""><!--[-->regs-&gt;di<!--]--></code>), the second in <code class="prose-code-inline" data-v-a031129a=""><!--[-->%rsi<!--]--></code>, and so on.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#E6E6E6">...
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">    bpf_probe_read</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">filename</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(filename), </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">regs</span><span style="--shiki-default:#D4D4D4">-&gt;</span><span style="--shiki-default:#9CDCFE">di</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Since
 we rely on CPU registers, we need to target our binary for specific 
system architectures. One way to achieve this is to set a <code class="prose-code-inline" data-v-a031129a=""><!--[-->--target<!--]--></code> flag to the <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf2go<!--]--></code> command (actually <code class="prose-code-inline" data-v-a031129a=""><!--[-->clang<!--]--></code> internally).<!--]--></p><!--[--><div class="highlight-go prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">main.go</span><!--[--><pre class="language-go shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">package</span><span style="--shiki-default:#4EC9B0"> main</span><span style="--shiki-default:#E6E6E6">                                                                
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">                                                                            
</span></span><span class="line highlight" line="3"><span style="--shiki-default:#6A9955">//go:generate go run github.com/cilium/ebpf/cmd/bpf2go -target amd64 trace trace.c
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6"> 
</span></span><span class="line" line="5"><span style="--shiki-default:#C586C0">import</span><span style="--shiki-default:#E6E6E6"> (
</span></span><span class="line" line="6"><span style="--shiki-default:#CE9178">  "log"
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><h2 id="ebpf-kernel-probes-kprobes" class="prose-h2" data-v-b9b1576a=""><!--[-->eBPF Kernel Probes (kprobes)<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->Regular
 and raw eBPF tracepoints might in fact be sufficient for your use case,
 but their main limitation is that they are limited to a set of 
predefined hook points in the kernel, disallowing you to trace arbitrary
 kernel events.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Kprobes
 alleviate this by allowing dynamic hooks into any kernel function, 
including within function body, not just at the start or return.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 Kernel functions marked with the <code class="prose-code-inline" data-v-a031129a=""><!--[-->notrace<!--]--></code> keyword are exceptions, and kprobes cannot hook them.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Conveniently, you can list all kernel symbols in <code class="prose-code-inline" data-v-a031129a=""><!--[-->/proc/kallsyms<!--]--></code>:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> cat</span><span style="--shiki-default:#CE9178"> /proc/kallsyms</span><span style="--shiki-default:#D4D4D4"> |</span><span style="--shiki-default:#DCDCAA"> less
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>ffffffff81000000 T startup_64
ffffffff81000000 T _stext
ffffffff81000000 T _text
ffffffff81000060 T secondary_startup_64
ffffffff81000065 T secondary_startup_64_no_verify
ffffffff81000120 t verify_cpu
...
ffffffff812b7710 T __ia32_sys_execveat
ffffffff812b7780 T __ia32_sys_execve
ffffffff812b77d0 T __x64_sys_execveat
ffffffff812b7840 T __x64_sys_execve # &lt;- Our kernel function
...
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 If a function is not in <code class="prose-code-inline" data-v-a031129a=""><!--[-->/proc/kallsyms<!--]--></code>, it's likely because is was inlined at compile time. Also verify they are not blacklisted in <code class="prose-code-inline" data-v-a031129a=""><!--[-->/sys/kernel/debug/krpobes/blacklist<!--]--></code>.<!--]--></p><!--]--></div><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"kprobe/__x64_sys_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> kprobe_execve_non_core</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#6A9955">    // On x86-64, the entry wrapper __x64_sys_execve is called with a pointer to struct pt_regs in %rdi -&gt; pt_regs.di
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">regs </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">di</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="5"><span emptylineplaceholder="true">
</span></span><span class="line" line="6"><span style="--shiki-default:#6A9955">    // Read the filename "from the inner regs"
</span></span><span class="line" line="7"><span style="--shiki-default:#569CD6">    unsigned</span><span style="--shiki-default:#569CD6"> long</span><span style="--shiki-default:#E6E6E6"> di </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="8"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_kernel</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">di, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(di), </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#9CDCFE">regs</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">di</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="9"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)di;
</span></span><span class="line" line="10"><span emptylineplaceholder="true">
</span></span><span class="line" line="11"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#9CDCFE"> buf</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line" line="12"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(buf, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(buf), filename);
</span></span><span class="line" line="13"><span emptylineplaceholder="true">
</span></span><span class="line" line="14"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Kprobe triggered for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, buf);
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="17"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->But the issue with kprobes is that you <strong class="prose-strong" data-v-24022f14=""><!--[-->depend
 on whatever code happens to be in the kernel your system runs and are 
not assured to be stable across different kernel versions<!--]--></strong>.
 Functions might exist in certain kernel versions, while not in others, 
structs can change, rename, or remove a field you are using.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 the upcoming tutorial, we’ll look at how to avoid these kinds of 
non-portable scenarios. But in general, think of them as a last resort 
in case none other eBPF program type supports what you are looking for.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 The same applies for <strong class="prose-strong" data-v-24022f14=""><!--[-->kretprobes<!--]--></strong> — kernel probes one can attach to the exit of the function.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Also, when we attach a kprobe, it’s similar to inserting a breakpoint in a debugger: the <a href="https://elixir.bootlin.com/linux/v6.15.6/source/kernel/kprobes.c#L1152" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->kernel patches the target instruction with one that triggers a debug exception<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>. When this instruction executes, the exception handler calls our probe handler.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->And while this mechanism works well, it has a downside.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Each
 probe hit generates an exception, causing context switches and 
exception handling. That overhead may be negligible for infrequent 
probes, but if many probes are attached to “hot” kernel functions, 
performance can degrade significantly.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Is there some alternative to allow triggering eBPF programs with less overhead? Yes, of course.<!--]--></p><h2 id="fprobes" class="prose-h2" data-v-b9b1576a=""><!--[-->Fprobes<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->As
 mentioned above, kprobes work by patching an instruction to trigger an 
exception, which adds context-switch and exception-handling overhead.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Fprobes in contrast build on the <a href="https://www.kernel.org/doc/html/v6.9/trace/ftrace.html" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->ftrace mechanism<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 other words, at each function entry, the compiler emits a NOP 
instruction that can later be patched at runtime into a jump to an <a href="https://lwn.net/Articles/804937/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF trampoline<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.
 This trampoline invokes the eBPF program as if it were called by the 
original caller itself, bypassing exceptions and greatly reducing the 
overhead.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The 
main (rather small) limitation is that fprobes can only attach at 
function entry (fentry) and function exit (fexit) points, not at 
arbitrary instruction offsets like kprobes. However, fentry/fexit probes
 are flexible in that they can also attach to eBPF programs such as XDP,
 TC, or cgroup programs.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Why would one ever attach to an eBPF program onto an eBPF XDP, TC or cgroup program?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->It may sound unusual, but using fprobes you can trace eBPF programs just like you would trace kernel functions.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->For example, I once used an fentry program to measure <a href="https://github.com/dorkamotorka/xdpmonitor-ebpf" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->how frequently different XDP return codes occurred<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> which was helpful while developing an eBPF-based firewall.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->I applied the same idea to <a href="https://github.com/dorkamotorka/tcmonitor-ebpf" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->collect statistics of TC programs return codes<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Additionally, fexit probes have access to the function’s input parameters, something kretprobes cannot provide.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">trace.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"fentry/__x64_sys_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> fentry_execve</span><span style="--shiki-default:#E6E6E6">(u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">regs </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> pt_regs </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">];
</span></span><span class="line" line="4"><span emptylineplaceholder="true">
</span></span><span class="line" line="5"><span style="--shiki-default:#6A9955">    // x86-64: first arg in rdi -&gt; pt_regs.di
</span></span><span class="line" line="6"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">regs</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">di</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="7"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#9CDCFE"> buf</span><span style="--shiki-default:#E6E6E6">[ARGSIZE];
</span></span><span class="line" line="8"><span style="--shiki-default:#DCDCAA">    bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(buf, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(buf), filename);
</span></span><span class="line" line="9"><span emptylineplaceholder="true">
</span></span><span class="line" line="10"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Fentry tracepoint triggered (CO-RE) for execve syscall with parameter filename: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, buf);
</span></span><span class="line" line="11"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="12"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->They
 do however require at least kernel version 5.5 which might be an issue 
if you need to support older kernels, at least for now. But otherwise 
they are mostly superior to kprobes.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]"><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->💡 For the examples above, I intentionally read the register value using <code class="prose-code-inline" data-v-a031129a=""><!--[-->&amp;regs→di<!--]--></code>, where I could also use <a href="https://docs.ebpf.io/ebpf-library/libbpf/ebpf/PT_REGS_PARM/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->PT_REGS_PARM*<!--]--></code><!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> macro which should be preffered.<!--]--></p><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Before
 I let you go, note that there are also BTF-enabled tracepoints, which 
we’ll briefly cover in the upcoming tutorial alongside an introduction 
to BTF (BPF Type Format).<!--]--></p><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game — Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-ebpf-tracing-46a570d1" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10"> ✕ </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial ebpf-tracing-46a570d1<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">ebpf-tracing-46a570d1</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial ebpf-tracing-46a570d1<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-tracing-46a570d1" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":2866,"once":2881,"_errors":2882,"serverRendered":11,"path":2884},["ShallowReactive",3],{"tutorial-page-tutorial-ebpf-tracing-46a570d1":4,"content-tutorial-ebpf-tracing-46a570d1-v1762190616578":49,"i-material-symbols-light:expand-content":2860,"i-ph:copy":2863},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":40,"completionCount":41,"accessControl":42,"userAccess":48},"68bfce1ca008b033b2879ce4","tutorial","ebpf-tracing-46a570d1","eBPF Tracepoints, Kprobes, or Fprobes: Which One Should You Choose?","In this tutorial, we’ll look at how different eBPF tracing mechanisms work in practice by focusing on a single use case: capturing execve system call events. We’ll start with tracepoints, move on to raw tracepoints, and then cover kprobes and fprobes, showing how each attaches to the kernel and what data they expose. Along the way, we’ll compare their trade-offs in terms of stability, performance, and portability.","2025-09-09T00:00:00.000Z",true,"ebpf-playground-2bd77c1c",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#ebpf-tracing-46a570d1","2025-09-09","tutorials/ebpf-tracing-46a570d1/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1762190616578,"https://labs.iximiuz.com/tutorials/ebpf-tracing-46a570d1","/content/files/tutorials/ebpf-tracing-46a570d1/__static__/tracing.png",[30,31],"linux","programming",[33],"eBPF","todo",{"clone_hello_world":36},{"init":11,"user":37,"name":38,"status":39},"laborant","clone_hello_world",0,30,13,{"canList":43,"canPreview":45,"canRead":46,"canStart":47},[44],"anyone",[44],[44],[44],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[50],{"title":8,"description":51,"kind":6,"playground":52,"categories":53,"tagz":54,"createdAt":10,"updatedAt":10,"cover":28,"type":55,"children":56,"hash":15,"preview":-1,"pageUrl":27,"tasks":2846,"toc":2847,"tutorials":2853,"challenges":2855,"courses":2857,"key":2859},"In this tutorial, we’ll look at how different eBPF tracing mechanisms work in practice by focusing on a single use case: capturing execve system call events. We’ll start with tracepoints, move on to raw tracepoints, and then cover kprobes and fprobes, showing how each attaches to the kernel and what data they expose. Along the way, we’ll compare their trade-offs in terms of stability, performance, and portability.\n",{"name":12},[30,31],[33],"root",[57,65,70,75,81,103,108,164,169,198,205,218,322,341,346,370,380,393,421,444,453,471,476,975,999,1004,1033,1039,1052,1073,1086,1113,1135,1140,1660,1681,1718,1791,1820,1894,1900,1905,1910,1926,1939,1972,1981,2003,2376,2388,2393,2408,2422,2427,2432,2437,2443,2448,2461,2475,2480,2516,2521,2801,2806,2835,2840],{"type":58,"tag":59,"props":60,"children":61},"element","p",{},[62],{"type":63,"value":64},"text","It is safe to say that almost all eBPF programs can capture and send kernel event data to user space applications.",{"type":58,"tag":59,"props":66,"children":67},{},[68],{"type":63,"value":69},"However, eBPF tracing program types like kprobes, fprobes, and tracepoints are often preferred because they hook into kernel functions or events with access to rich, actionable data for tasks like performance monitoring or syscall argument tracing.",{"type":58,"tag":59,"props":71,"children":72},{},[73],{"type":63,"value":74},"But their overlapping functionality can make choosing the right one confusing.",{"type":58,"tag":76,"props":77,"children":80},"image-box",{":alt":78,":max-width":79,":src":28},"eBPF Tracing","600px",[],{"type":58,"tag":59,"props":82,"children":83},{},[84,86,93,95,101],{"type":63,"value":85},"In this tutorial, we’ll look at a few different eBPF tracing program types that all capture ",{"type":58,"tag":87,"props":88,"children":90},"code",{"className":89},[],[91],{"type":63,"value":92},"execve",{"type":63,"value":94}," syscall events, and then compare their strengths and trade-offs. The code lives for this lab is in the ",{"type":58,"tag":87,"props":96,"children":98},{"className":97},[],[99],{"type":63,"value":100},"labs/lab1",{"type":63,"value":102}," directory.",{"type":58,"tag":59,"props":104,"children":105},{},[106],{"type":63,"value":107},"I’ll walk you through the details step by step—but you can also try things out anytime by building and running the program yourself:",{"type":58,"tag":109,"props":110,"children":115},"pre",{"className":111,"code":112,"language":113,"meta":114,"style":114},"language-bash shiki shiki-themes slack-dark","go generate\ngo build\nsudo ./lab1\n","bash","",[116],{"type":58,"tag":87,"props":117,"children":118},{"__ignoreMap":114},[119,137,150],{"type":58,"tag":120,"props":121,"children":124},"span",{"class":122,"line":123},"line",1,[125,131],{"type":58,"tag":120,"props":126,"children":128},{"style":127},"--shiki-default:#DCDCAA",[129],{"type":63,"value":130},"go",{"type":58,"tag":120,"props":132,"children":134},{"style":133},"--shiki-default:#CE9178",[135],{"type":63,"value":136}," generate\n",{"type":58,"tag":120,"props":138,"children":140},{"class":122,"line":139},2,[141,145],{"type":58,"tag":120,"props":142,"children":143},{"style":127},[144],{"type":63,"value":130},{"type":58,"tag":120,"props":146,"children":147},{"style":133},[148],{"type":63,"value":149}," build\n",{"type":58,"tag":120,"props":151,"children":153},{"class":122,"line":152},3,[154,159],{"type":58,"tag":120,"props":155,"children":156},{"style":127},[157],{"type":63,"value":158},"sudo",{"type":58,"tag":120,"props":160,"children":161},{"style":133},[162],{"type":63,"value":163}," ./lab1\n",{"type":58,"tag":59,"props":165,"children":166},{},[167],{"type":63,"value":168},"Then, open a new terminal tab and inspect the eBPF logs to see which kernel events these hook points capture:",{"type":58,"tag":109,"props":170,"children":172},{"className":111,"code":171,"language":113,"meta":114,"style":114},"sudo bpftool prog trace\n",[173],{"type":58,"tag":87,"props":174,"children":175},{"__ignoreMap":114},[176],{"type":58,"tag":120,"props":177,"children":178},{"class":122,"line":123},[179,183,188,193],{"type":58,"tag":120,"props":180,"children":181},{"style":127},[182],{"type":63,"value":158},{"type":58,"tag":120,"props":184,"children":185},{"style":133},[186],{"type":63,"value":187}," bpftool",{"type":58,"tag":120,"props":189,"children":190},{"style":133},[191],{"type":63,"value":192}," prog",{"type":58,"tag":120,"props":194,"children":195},{"style":133},[196],{"type":63,"value":197}," trace\n",{"type":58,"tag":199,"props":200,"children":202},"h2",{"id":201},"ebpf-tracepoint",[203],{"type":63,"value":204},"eBPF Tracepoint",{"type":58,"tag":59,"props":206,"children":207},{},[208,210,216],{"type":63,"value":209},"eBPF tracepoint programs attach to predefined hook points in the Linux kernel. These hook points are defined in the kernel source code with a ",{"type":58,"tag":87,"props":211,"children":213},{"className":212},[],[214],{"type":63,"value":215},"TRACE_EVENT",{"type":63,"value":217}," macro. Once attached, an eBPF program runs its custom logic whenever the kernel hits the corresponding tracepoint.",{"type":58,"tag":219,"props":220,"children":222},"details-box",{":summary":221},"More information on TRACE_EVENT macro",[223,241,262],{"type":58,"tag":59,"props":224,"children":225},{},[226,231,233,239],{"type":58,"tag":87,"props":227,"children":229},{"className":228},[],[230],{"type":63,"value":215},{"type":63,"value":232}," is the generic macro for defining custom tracepoints in the kernel, while ",{"type":58,"tag":87,"props":234,"children":236},{"className":235},[],[237],{"type":63,"value":238},"TRACE_EVENT_SYSCALL",{"type":63,"value":240}," is a specialized variant for syscalls through which eBPF Tracepoint hook are created.",{"type":58,"tag":59,"props":242,"children":243},{},[244,246,252,254,260],{"type":63,"value":245},"In fact, there is ",{"type":58,"tag":247,"props":248,"children":249},"strong",{},[250],{"type":63,"value":251},"NO",{"type":63,"value":253}," static ",{"type":58,"tag":87,"props":255,"children":257},{"className":256},[],[258],{"type":63,"value":259},"sys_enter_execve",{"type":63,"value":261}," tracepoint defined in the kernel.",{"type":58,"tag":59,"props":263,"children":264},{},[265,267,272,274,287,289,300,302,313,315,320],{"type":63,"value":266},"Instead, per-syscall tracepoints are generated at build time using the ",{"type":58,"tag":87,"props":268,"children":270},{"className":269},[],[271],{"type":63,"value":238},{"type":63,"value":273}," template in ",{"type":58,"tag":275,"props":276,"children":280},"a",{"href":277,"rel":278},"https://codebrowser.dev/linux/linux/include/trace/events/syscalls.h.html",[279],"nofollow",[281],{"type":58,"tag":87,"props":282,"children":284},{"className":283},[],[285],{"type":63,"value":286},"include/trace/events/syscalls.h",{"type":63,"value":288}," and syscall metadata from the architecture’s syscall tables like ",{"type":58,"tag":275,"props":290,"children":293},{"href":291,"rel":292},"https://raw.githubusercontent.com/torvalds/linux/master/arch/x86/entry/syscalls/syscall_64.tbl",[279],[294],{"type":58,"tag":87,"props":295,"children":297},{"className":296},[],[298],{"type":63,"value":299},"arch/x86/entry/syscalls/syscall_64.tbl",{"type":63,"value":301},". This generation is handled by code in ",{"type":58,"tag":275,"props":303,"children":306},{"href":304,"rel":305},"https://codebrowser.dev/linux/linux/kernel/trace/trace_syscalls.c.html",[279],[307],{"type":58,"tag":87,"props":308,"children":310},{"className":309},[],[311],{"type":63,"value":312},"kernel/trace/trace_syscalls.c",{"type":63,"value":314}," to produce an entry tracepoint like ",{"type":58,"tag":87,"props":316,"children":318},{"className":317},[],[319],{"type":63,"value":259},{"type":63,"value":321}," to which eBPF can then attach to.",{"type":58,"tag":59,"props":323,"children":324},{},[325,327,332,334,339],{"type":63,"value":326},"For example, the ",{"type":58,"tag":87,"props":328,"children":330},{"className":329},[],[331],{"type":63,"value":259},{"type":63,"value":333}," tracepoint fires when a process calls ",{"type":58,"tag":87,"props":335,"children":337},{"className":336},[],[338],{"type":63,"value":92},{"type":63,"value":340},", exposing the program name and arguments. This makes it useful for tasks such as auditing, security monitoring, or analyzing user activity.",{"type":58,"tag":59,"props":342,"children":343},{},[344],{"type":63,"value":345},"You can find all events that eBPF tracepoints can hook onto, using:",{"type":58,"tag":109,"props":347,"children":349},{"className":111,"code":348,"language":113,"meta":114,"style":114},"sudo cat /sys/kernel/debug/tracing/available_events\n",[350],{"type":58,"tag":87,"props":351,"children":352},{"__ignoreMap":114},[353],{"type":58,"tag":120,"props":354,"children":355},{"class":122,"line":123},[356,360,365],{"type":58,"tag":120,"props":357,"children":358},{"style":127},[359],{"type":63,"value":158},{"type":58,"tag":120,"props":361,"children":362},{"style":133},[363],{"type":63,"value":364}," cat",{"type":58,"tag":120,"props":366,"children":367},{"style":133},[368],{"type":63,"value":369}," /sys/kernel/debug/tracing/available_events\n",{"type":58,"tag":109,"props":371,"children":375},{"className":372,"code":374,"language":63},[373],"language-text","drm:drm_vblank_event\ndrm:drm_vblank_event_queued\ndrm:drm_vblank_event_delivered\n...\nsyscalls:sys_exit_execveat\nsyscalls:sys_enter_execveat\nsyscalls:sys_exit_execve\nsyscalls:sys_enter_execve # \u003C- here is our tracepoint\nsyscalls:sys_exit_pipe\n...\n",[376],{"type":58,"tag":87,"props":377,"children":378},{"__ignoreMap":114},[379],{"type":63,"value":374},{"type":58,"tag":59,"props":381,"children":382},{},[383,385,391],{"type":63,"value":384},"The output format is in the form ",{"type":58,"tag":87,"props":386,"children":388},{"className":387},[],[389],{"type":63,"value":390},"\u003Ccategory>:\u003Cname>",{"type":63,"value":392},".",{"type":58,"tag":59,"props":394,"children":395},{},[396,398,404,406,412,414,420],{"type":63,"value":397},"Using the ",{"type":58,"tag":87,"props":399,"children":401},{"className":400},[],[402],{"type":63,"value":403},"category",{"type":63,"value":405}," and the ",{"type":58,"tag":87,"props":407,"children":409},{"className":408},[],[410],{"type":63,"value":411},"name",{"type":63,"value":413},", you can then view the input arguments for each tracepoint by printing the contents of ",{"type":58,"tag":87,"props":415,"children":417},{"className":416},[],[418],{"type":63,"value":419},"/sys/kernel/debug/tracing/events/\u003Ccategory>/\u003Cname>/format",{"type":63,"value":392},{"type":58,"tag":109,"props":422,"children":424},{"className":111,"code":423,"language":113,"meta":114,"style":114},"sudo cat /sys/kernel/debug/tracing/events/syscalls/sys_enter_execve/format\n",[425],{"type":58,"tag":87,"props":426,"children":427},{"__ignoreMap":114},[428],{"type":58,"tag":120,"props":429,"children":430},{"class":122,"line":123},[431,435,439],{"type":58,"tag":120,"props":432,"children":433},{"style":127},[434],{"type":63,"value":158},{"type":58,"tag":120,"props":436,"children":437},{"style":133},[438],{"type":63,"value":364},{"type":58,"tag":120,"props":440,"children":441},{"style":133},[442],{"type":63,"value":443}," /sys/kernel/debug/tracing/events/syscalls/sys_enter_execve/format\n",{"type":58,"tag":109,"props":445,"children":448},{"className":446,"code":447,"language":63},[373],"name: sys_enter_execve\nID: 660\nformat:\n        field:unsigned short common_type;           offset:0; size:2; signed:0;\n        field:unsigned char common_flags;           offset:2; size:1; signed:0;\n        field:unsigned char common_preempt_count;   offset:3; size:1; signed:0;\n        field:int           common_pid;             offset:4; size:4; signed:1;\n\n        field:int        __syscall_nr;              offset:8;  size:4; signed:1;\n        field:const char * filename;                offset:16; size:8; signed:0;\n        field:const char *const * argv;             offset:24; size:8; signed:0;\n        field:const char *const * envp;             offset:32; size:8; signed:0;\n\nprint fmt: \"filename: 0x%08lx, argv: 0x%08lx, envp: 0x%08lx\", ((unsigned long)(REC->filename)), ((unsigned long)(REC->argv)), ((unsigned long)(REC->envp))\n",[449],{"type":58,"tag":87,"props":450,"children":451},{"__ignoreMap":114},[452],{"type":63,"value":447},{"type":58,"tag":454,"props":455,"children":457},"remark-box",{"kind":456},"info",[458],{"type":58,"tag":59,"props":459,"children":460},{},[461,463,470],{"type":63,"value":462},"💡 The first four arguments, are actually not accessible by the eBPF code. This is a choice that dates back to the original inclusion of this code. See explaination in ",{"type":58,"tag":275,"props":464,"children":467},{"href":465,"rel":466},"https://github.com/torvalds/linux/commit/98b5c2c65c2951772a8fc661f50d675e450e8bce",[279],[468],{"type":63,"value":469},"commit 98b5c2c65c29",{"type":63,"value":392},{"type":58,"tag":59,"props":472,"children":473},{},[474],{"type":63,"value":475},"With this information, you can then define an input context struct that matches the accessible fields and then write your eBPF tracepoint program against it.",{"type":58,"tag":109,"props":477,"children":482},{"className":478,"code":479,"filename":480,"language":481,"meta":114,"style":114},"language-c shiki shiki-themes slack-dark","...\nstruct trace_sys_enter_execve {                                             \n    short common_type;                                                      \n    char common_flags;                                                      \n    char common_preempt_count;                                              \n    int common_pid;                                                         \n                                                                            \n    s32 syscall_nr;        // offset=8,  size=4                             \n    u32 pad;               // offset=12, size=4 (pad)                       \n    const u8 *filename;    // offset=16, size=8                             \n    const u8 *const *argv; // offset=24, size=8                             \n    const u8 *const *envp; // offset=32, size=8                             \n};                                                                          \n                                                                            \nSEC(\"tracepoint/syscalls/sys_enter_execve\")\nint handle_execve_tp_non_core(struct trace_sys_enter_execve *ctx) {\n    const char *filename_ptr = (const char *)(ctx->filename);\n\n    u8 buf[ARGSIZE];\n    bpf_probe_read_user_str(buf, sizeof(buf), filename_ptr);\n\n    bpf_printk(\"Tracepoint triggered for execve syscall with parameter filename: %s\\n\", buf);\n    return 0;\n}\n","trace.c","c",[483],{"type":58,"tag":87,"props":484,"children":485},{"__ignoreMap":114},[486,495,509,522,536,549,563,572,587,601,631,667,701,709,717,741,783,851,860,879,903,911,945,966],{"type":58,"tag":120,"props":487,"children":488},{"class":122,"line":123},[489],{"type":58,"tag":120,"props":490,"children":492},{"style":491},"--shiki-default:#E6E6E6",[493],{"type":63,"value":494},"...\n",{"type":58,"tag":120,"props":496,"children":497},{"class":122,"line":139},[498,504],{"type":58,"tag":120,"props":499,"children":501},{"style":500},"--shiki-default:#569CD6",[502],{"type":63,"value":503},"struct",{"type":58,"tag":120,"props":505,"children":506},{"style":491},[507],{"type":63,"value":508}," trace_sys_enter_execve {                                             \n",{"type":58,"tag":120,"props":510,"children":511},{"class":122,"line":152},[512,517],{"type":58,"tag":120,"props":513,"children":514},{"style":500},[515],{"type":63,"value":516},"    short",{"type":58,"tag":120,"props":518,"children":519},{"style":491},[520],{"type":63,"value":521}," common_type;                                                      \n",{"type":58,"tag":120,"props":523,"children":525},{"class":122,"line":524},4,[526,531],{"type":58,"tag":120,"props":527,"children":528},{"style":500},[529],{"type":63,"value":530},"    char",{"type":58,"tag":120,"props":532,"children":533},{"style":491},[534],{"type":63,"value":535}," common_flags;                                                      \n",{"type":58,"tag":120,"props":537,"children":539},{"class":122,"line":538},5,[540,544],{"type":58,"tag":120,"props":541,"children":542},{"style":500},[543],{"type":63,"value":530},{"type":58,"tag":120,"props":545,"children":546},{"style":491},[547],{"type":63,"value":548}," common_preempt_count;                                              \n",{"type":58,"tag":120,"props":550,"children":552},{"class":122,"line":551},6,[553,558],{"type":58,"tag":120,"props":554,"children":555},{"style":500},[556],{"type":63,"value":557},"    int",{"type":58,"tag":120,"props":559,"children":560},{"style":491},[561],{"type":63,"value":562}," common_pid;                                                         \n",{"type":58,"tag":120,"props":564,"children":566},{"class":122,"line":565},7,[567],{"type":58,"tag":120,"props":568,"children":569},{"style":491},[570],{"type":63,"value":571},"                                                                            \n",{"type":58,"tag":120,"props":573,"children":575},{"class":122,"line":574},8,[576,581],{"type":58,"tag":120,"props":577,"children":578},{"style":491},[579],{"type":63,"value":580},"    s32 syscall_nr;",{"type":58,"tag":120,"props":582,"children":584},{"style":583},"--shiki-default:#6A9955",[585],{"type":63,"value":586},"        // offset=8,  size=4                             \n",{"type":58,"tag":120,"props":588,"children":590},{"class":122,"line":589},9,[591,596],{"type":58,"tag":120,"props":592,"children":593},{"style":491},[594],{"type":63,"value":595},"    u32 pad;",{"type":58,"tag":120,"props":597,"children":598},{"style":583},[599],{"type":63,"value":600},"               // offset=12, size=4 (pad)                       \n",{"type":58,"tag":120,"props":602,"children":604},{"class":122,"line":603},10,[605,610,615,621,626],{"type":58,"tag":120,"props":606,"children":607},{"style":500},[608],{"type":63,"value":609},"    const",{"type":58,"tag":120,"props":611,"children":612},{"style":491},[613],{"type":63,"value":614}," u8 ",{"type":58,"tag":120,"props":616,"children":618},{"style":617},"--shiki-default:#D4D4D4",[619],{"type":63,"value":620},"*",{"type":58,"tag":120,"props":622,"children":623},{"style":491},[624],{"type":63,"value":625},"filename;",{"type":58,"tag":120,"props":627,"children":628},{"style":583},[629],{"type":63,"value":630},"    // offset=16, size=8                             \n",{"type":58,"tag":120,"props":632,"children":634},{"class":122,"line":633},11,[635,639,643,647,652,657,662],{"type":58,"tag":120,"props":636,"children":637},{"style":500},[638],{"type":63,"value":609},{"type":58,"tag":120,"props":640,"children":641},{"style":491},[642],{"type":63,"value":614},{"type":58,"tag":120,"props":644,"children":645},{"style":617},[646],{"type":63,"value":620},{"type":58,"tag":120,"props":648,"children":649},{"style":500},[650],{"type":63,"value":651},"const",{"type":58,"tag":120,"props":653,"children":654},{"style":617},[655],{"type":63,"value":656}," *",{"type":58,"tag":120,"props":658,"children":659},{"style":491},[660],{"type":63,"value":661},"argv;",{"type":58,"tag":120,"props":663,"children":664},{"style":583},[665],{"type":63,"value":666}," // offset=24, size=8                             \n",{"type":58,"tag":120,"props":668,"children":670},{"class":122,"line":669},12,[671,675,679,683,687,691,696],{"type":58,"tag":120,"props":672,"children":673},{"style":500},[674],{"type":63,"value":609},{"type":58,"tag":120,"props":676,"children":677},{"style":491},[678],{"type":63,"value":614},{"type":58,"tag":120,"props":680,"children":681},{"style":617},[682],{"type":63,"value":620},{"type":58,"tag":120,"props":684,"children":685},{"style":500},[686],{"type":63,"value":651},{"type":58,"tag":120,"props":688,"children":689},{"style":617},[690],{"type":63,"value":656},{"type":58,"tag":120,"props":692,"children":693},{"style":491},[694],{"type":63,"value":695},"envp;",{"type":58,"tag":120,"props":697,"children":698},{"style":583},[699],{"type":63,"value":700}," // offset=32, size=8                             \n",{"type":58,"tag":120,"props":702,"children":703},{"class":122,"line":41},[704],{"type":58,"tag":120,"props":705,"children":706},{"style":491},[707],{"type":63,"value":708},"};                                                                          \n",{"type":58,"tag":120,"props":710,"children":712},{"class":122,"line":711},14,[713],{"type":58,"tag":120,"props":714,"children":715},{"style":491},[716],{"type":63,"value":571},{"type":58,"tag":120,"props":718,"children":720},{"class":122,"line":719},15,[721,726,731,736],{"type":58,"tag":120,"props":722,"children":723},{"style":127},[724],{"type":63,"value":725},"SEC",{"type":58,"tag":120,"props":727,"children":728},{"style":491},[729],{"type":63,"value":730},"(",{"type":58,"tag":120,"props":732,"children":733},{"style":133},[734],{"type":63,"value":735},"\"tracepoint/syscalls/sys_enter_execve\"",{"type":58,"tag":120,"props":737,"children":738},{"style":491},[739],{"type":63,"value":740},")\n",{"type":58,"tag":120,"props":742,"children":744},{"class":122,"line":743},16,[745,750,755,759,763,768,772,778],{"type":58,"tag":120,"props":746,"children":747},{"style":500},[748],{"type":63,"value":749},"int",{"type":58,"tag":120,"props":751,"children":752},{"style":127},[753],{"type":63,"value":754}," handle_execve_tp_non_core",{"type":58,"tag":120,"props":756,"children":757},{"style":491},[758],{"type":63,"value":730},{"type":58,"tag":120,"props":760,"children":761},{"style":500},[762],{"type":63,"value":503},{"type":58,"tag":120,"props":764,"children":765},{"style":491},[766],{"type":63,"value":767}," trace_sys_enter_execve ",{"type":58,"tag":120,"props":769,"children":770},{"style":617},[771],{"type":63,"value":620},{"type":58,"tag":120,"props":773,"children":775},{"style":774},"--shiki-default:#9CDCFE",[776],{"type":63,"value":777},"ctx",{"type":58,"tag":120,"props":779,"children":780},{"style":491},[781],{"type":63,"value":782},") {\n",{"type":58,"tag":120,"props":784,"children":786},{"class":122,"line":785},17,[787,791,796,800,805,810,815,819,823,827,832,836,841,846],{"type":58,"tag":120,"props":788,"children":789},{"style":500},[790],{"type":63,"value":609},{"type":58,"tag":120,"props":792,"children":793},{"style":500},[794],{"type":63,"value":795}," char",{"type":58,"tag":120,"props":797,"children":798},{"style":617},[799],{"type":63,"value":656},{"type":58,"tag":120,"props":801,"children":802},{"style":491},[803],{"type":63,"value":804},"filename_ptr ",{"type":58,"tag":120,"props":806,"children":807},{"style":617},[808],{"type":63,"value":809},"=",{"type":58,"tag":120,"props":811,"children":812},{"style":491},[813],{"type":63,"value":814}," (",{"type":58,"tag":120,"props":816,"children":817},{"style":500},[818],{"type":63,"value":651},{"type":58,"tag":120,"props":820,"children":821},{"style":500},[822],{"type":63,"value":795},{"type":58,"tag":120,"props":824,"children":825},{"style":617},[826],{"type":63,"value":656},{"type":58,"tag":120,"props":828,"children":829},{"style":491},[830],{"type":63,"value":831},")(",{"type":58,"tag":120,"props":833,"children":834},{"style":774},[835],{"type":63,"value":777},{"type":58,"tag":120,"props":837,"children":838},{"style":491},[839],{"type":63,"value":840},"->",{"type":58,"tag":120,"props":842,"children":843},{"style":774},[844],{"type":63,"value":845},"filename",{"type":58,"tag":120,"props":847,"children":848},{"style":491},[849],{"type":63,"value":850},");\n",{"type":58,"tag":120,"props":852,"children":854},{"class":122,"line":853},18,[855],{"type":58,"tag":120,"props":856,"children":857},{"emptyLinePlaceholder":11},[858],{"type":63,"value":859},"\n",{"type":58,"tag":120,"props":861,"children":863},{"class":122,"line":862},19,[864,869,874],{"type":58,"tag":120,"props":865,"children":866},{"style":491},[867],{"type":63,"value":868},"    u8 ",{"type":58,"tag":120,"props":870,"children":871},{"style":774},[872],{"type":63,"value":873},"buf",{"type":58,"tag":120,"props":875,"children":876},{"style":491},[877],{"type":63,"value":878},"[ARGSIZE];\n",{"type":58,"tag":120,"props":880,"children":882},{"class":122,"line":881},20,[883,888,893,898],{"type":58,"tag":120,"props":884,"children":885},{"style":127},[886],{"type":63,"value":887},"    bpf_probe_read_user_str",{"type":58,"tag":120,"props":889,"children":890},{"style":491},[891],{"type":63,"value":892},"(buf, ",{"type":58,"tag":120,"props":894,"children":895},{"style":500},[896],{"type":63,"value":897},"sizeof",{"type":58,"tag":120,"props":899,"children":900},{"style":491},[901],{"type":63,"value":902},"(buf), filename_ptr);\n",{"type":58,"tag":120,"props":904,"children":906},{"class":122,"line":905},21,[907],{"type":58,"tag":120,"props":908,"children":909},{"emptyLinePlaceholder":11},[910],{"type":63,"value":859},{"type":58,"tag":120,"props":912,"children":914},{"class":122,"line":913},22,[915,920,924,929,935,940],{"type":58,"tag":120,"props":916,"children":917},{"style":127},[918],{"type":63,"value":919},"    bpf_printk",{"type":58,"tag":120,"props":921,"children":922},{"style":491},[923],{"type":63,"value":730},{"type":58,"tag":120,"props":925,"children":926},{"style":133},[927],{"type":63,"value":928},"\"Tracepoint triggered for execve syscall with parameter filename: %s",{"type":58,"tag":120,"props":930,"children":932},{"style":931},"--shiki-default:#D7BA7D",[933],{"type":63,"value":934},"\\n",{"type":58,"tag":120,"props":936,"children":937},{"style":133},[938],{"type":63,"value":939},"\"",{"type":58,"tag":120,"props":941,"children":942},{"style":491},[943],{"type":63,"value":944},", buf);\n",{"type":58,"tag":120,"props":946,"children":948},{"class":122,"line":947},23,[949,955,961],{"type":58,"tag":120,"props":950,"children":952},{"style":951},"--shiki-default:#C586C0",[953],{"type":63,"value":954},"    return",{"type":58,"tag":120,"props":956,"children":958},{"style":957},"--shiki-default:#B5CEA8",[959],{"type":63,"value":960}," 0",{"type":58,"tag":120,"props":962,"children":963},{"style":491},[964],{"type":63,"value":965},";\n",{"type":58,"tag":120,"props":967,"children":969},{"class":122,"line":968},24,[970],{"type":58,"tag":120,"props":971,"children":972},{"style":491},[973],{"type":63,"value":974},"}\n",{"type":58,"tag":454,"props":976,"children":977},{"kind":456},[978],{"type":58,"tag":59,"props":979,"children":980},{},[981,983,989,991,997],{"type":63,"value":982},"💡 ",{"type":58,"tag":87,"props":984,"children":986},{"className":985},[],[987],{"type":63,"value":988},"SEC(\"tp/xx/yy\")",{"type":63,"value":990}," and ",{"type":58,"tag":87,"props":992,"children":994},{"className":993},[],[995],{"type":63,"value":996},"SEC(\"tracepoint/xx/yy\")",{"type":63,"value":998}," are equivalent, and you can use either one according to personal preference.",{"type":58,"tag":59,"props":1000,"children":1001},{},[1002],{"type":63,"value":1003},"But there are two downsides to this:",{"type":58,"tag":1005,"props":1006,"children":1007},"ul",{},[1008,1021],{"type":58,"tag":1009,"props":1010,"children":1011},"li",{},[1012,1014,1019],{"type":63,"value":1013},"First, ",{"type":58,"tag":247,"props":1015,"children":1016},{},[1017],{"type":63,"value":1018},"tracepoints only exist where kernel developers have added them",{"type":63,"value":1020},". If you need visibility into something that is not supported by the listed tracepoints, you either go through the long process of proposing a new tracepoint upstream (and convincing Linus to accept it), or use an alternative technique.",{"type":58,"tag":1009,"props":1022,"children":1023},{},[1024,1026,1031],{"type":63,"value":1025},"Second, they’re ",{"type":58,"tag":247,"props":1027,"children":1028},{},[1029],{"type":63,"value":1030},"not always ideal for high-performance use cases",{"type":63,"value":1032}," — we’ll dig into that shortly.",{"type":58,"tag":199,"props":1034,"children":1036},{"id":1035},"ebpf-raw-tracepoint",[1037],{"type":63,"value":1038},"eBPF Raw Tracepoint",{"type":58,"tag":59,"props":1040,"children":1041},{},[1042,1044,1050],{"type":63,"value":1043},"Raw tracepoints may look similar to regular tracepoints, since both correspond to events you can view under ",{"type":58,"tag":87,"props":1045,"children":1047},{"className":1046},[],[1048],{"type":63,"value":1049},"/sys/kernel/debug/tracing/available_events",{"type":63,"value":1051},". The difference lies in how the kernel passes arguments to them.",{"type":58,"tag":59,"props":1053,"children":1054},{},[1055,1057,1063,1065,1071],{"type":63,"value":1056},"For regular tracepoints, the kernel pre-processes the arguments and builds a context struct. In contrast, eBPF raw tracepoints receive their arguments in a raw format via ",{"type":58,"tag":87,"props":1058,"children":1060},{"className":1059},[],[1061],{"type":63,"value":1062},"struct bpf_raw_tracepoint_args",{"type":63,"value":1064}," (defined in ",{"type":58,"tag":87,"props":1066,"children":1068},{"className":1067},[],[1069],{"type":63,"value":1070},"vmlinux.h",{"type":63,"value":1072},"), and the program must interpret them manually.",{"type":58,"tag":59,"props":1074,"children":1075},{},[1076,1078,1085],{"type":63,"value":1077},"Because no extra work is done to package fields, raw tracepoints typically ",{"type":58,"tag":275,"props":1079,"children":1082},{"href":1080,"rel":1081},"https://lwn.net/Articles/750569/",[279],[1083],{"type":63,"value":1084},"run faster with less overhead than regular tracepoints",{"type":63,"value":392},{"type":58,"tag":59,"props":1087,"children":1088},{},[1089,1091,1096,1098,1104,1105,1111],{"type":63,"value":1090},"Another important difference is that there are no per-syscall raw tracepoints like ",{"type":58,"tag":87,"props":1092,"children":1094},{"className":1093},[],[1095],{"type":63,"value":259},{"type":63,"value":1097},". Instead, only the generic ",{"type":58,"tag":87,"props":1099,"children":1101},{"className":1100},[],[1102],{"type":63,"value":1103},"sys_enter",{"type":63,"value":990},{"type":58,"tag":87,"props":1106,"children":1108},{"className":1107},[],[1109],{"type":63,"value":1110},"sys_exit",{"type":63,"value":1112}," tracepoints exist.",{"type":58,"tag":219,"props":1114,"children":1116},{":summary":1115},"What is the difference between sys_enter and sys_exit tracepoint?",[1117],{"type":58,"tag":59,"props":1118,"children":1119},{},[1120,1121,1126,1128,1133],{"type":63,"value":982},{"type":58,"tag":87,"props":1122,"children":1124},{"className":1123},[],[1125],{"type":63,"value":1103},{"type":63,"value":1127}," hooks trigger on every syscall event entry, while ",{"type":58,"tag":87,"props":1129,"children":1131},{"className":1130},[],[1132],{"type":63,"value":1110},{"type":63,"value":1134}," hooks trigger on its return, capturing the return value of the syscall.",{"type":58,"tag":59,"props":1136,"children":1137},{},[1138],{"type":63,"value":1139},"This means that if you want to act on a specific syscall event inside your raw tracepoint eBPF program, you need to filter by syscall ID.",{"type":58,"tag":109,"props":1141,"children":1144},{"className":478,"code":1142,"filename":480,"highlights":1143,"language":481,"meta":114,"style":114},"SEC(\"raw_tracepoint/sys_enter\")\nint handle_execve_raw_tp_non_core(struct bpf_raw_tracepoint_args *ctx) {\n    // There is no method to attach a raw_tp directly to a single syscall... \n    // this is because there are no static defined tracepoints on single syscalls but only on generic sys_enter/sys_exit\n    // So we have to filter by syscall ID\n    //\n    // The arguments of input context struct are defined in TP_PROTO of the tracepoint definition in kernel.\n    // Ref: https://codebrowser.dev/linux/linux/include/trace/events/syscalls.h.html#20\n    // In this case it is TP_PROTO(struct pt_regs *regs, long id):\n    // args[0] -> struct pt_regs *regs\n    // args[1] -> long id\n    unsigned long id = ctx->args[1];\n    if (id != 59)   // execve sycall ID\n        return 0;\n\n    struct pt_regs *regs = (struct pt_regs *)ctx->args[0];\n\n    const char *filename;\n    // Intentionally accessing the register (without using PT_REGS_PARM* macro) directly for illustration\n    bpf_probe_read(&filename, sizeof(filename), &regs->di);\n\n    char buf[ARGSIZE];\n    bpf_probe_read_user_str(buf, sizeof(buf), filename);\n\n    bpf_printk(\"Raw tracepoint triggered for execve syscall with parameter filename: %s\\n\", buf);\n    return 0;\n}\n",[123,152,524,538,551,565,574,589,603,633,669,41,711],[1145],{"type":58,"tag":87,"props":1146,"children":1147},{"__ignoreMap":114},[1148,1170,1207,1216,1225,1234,1243,1252,1261,1270,1279,1288,1340,1374,1391,1398,1469,1476,1496,1504,1557,1564,1580,1600,1607,1636,1652],{"type":58,"tag":120,"props":1149,"children":1152},{"class":1150,"line":123},[122,1151],"highlight",[1153,1157,1161,1166],{"type":58,"tag":120,"props":1154,"children":1155},{"style":127},[1156],{"type":63,"value":725},{"type":58,"tag":120,"props":1158,"children":1159},{"style":491},[1160],{"type":63,"value":730},{"type":58,"tag":120,"props":1162,"children":1163},{"style":133},[1164],{"type":63,"value":1165},"\"raw_tracepoint/sys_enter\"",{"type":58,"tag":120,"props":1167,"children":1168},{"style":491},[1169],{"type":63,"value":740},{"type":58,"tag":120,"props":1171,"children":1172},{"class":122,"line":139},[1173,1177,1182,1186,1190,1195,1199,1203],{"type":58,"tag":120,"props":1174,"children":1175},{"style":500},[1176],{"type":63,"value":749},{"type":58,"tag":120,"props":1178,"children":1179},{"style":127},[1180],{"type":63,"value":1181}," handle_execve_raw_tp_non_core",{"type":58,"tag":120,"props":1183,"children":1184},{"style":491},[1185],{"type":63,"value":730},{"type":58,"tag":120,"props":1187,"children":1188},{"style":500},[1189],{"type":63,"value":503},{"type":58,"tag":120,"props":1191,"children":1192},{"style":491},[1193],{"type":63,"value":1194}," bpf_raw_tracepoint_args ",{"type":58,"tag":120,"props":1196,"children":1197},{"style":617},[1198],{"type":63,"value":620},{"type":58,"tag":120,"props":1200,"children":1201},{"style":774},[1202],{"type":63,"value":777},{"type":58,"tag":120,"props":1204,"children":1205},{"style":491},[1206],{"type":63,"value":782},{"type":58,"tag":120,"props":1208,"children":1210},{"class":1209,"line":152},[122,1151],[1211],{"type":58,"tag":120,"props":1212,"children":1213},{"style":583},[1214],{"type":63,"value":1215},"    // There is no method to attach a raw_tp directly to a single syscall... \n",{"type":58,"tag":120,"props":1217,"children":1219},{"class":1218,"line":524},[122,1151],[1220],{"type":58,"tag":120,"props":1221,"children":1222},{"style":583},[1223],{"type":63,"value":1224},"    // this is because there are no static defined tracepoints on single syscalls but only on generic sys_enter/sys_exit\n",{"type":58,"tag":120,"props":1226,"children":1228},{"class":1227,"line":538},[122,1151],[1229],{"type":58,"tag":120,"props":1230,"children":1231},{"style":583},[1232],{"type":63,"value":1233},"    // So we have to filter by syscall ID\n",{"type":58,"tag":120,"props":1235,"children":1237},{"class":1236,"line":551},[122,1151],[1238],{"type":58,"tag":120,"props":1239,"children":1240},{"style":583},[1241],{"type":63,"value":1242},"    //\n",{"type":58,"tag":120,"props":1244,"children":1246},{"class":1245,"line":565},[122,1151],[1247],{"type":58,"tag":120,"props":1248,"children":1249},{"style":583},[1250],{"type":63,"value":1251},"    // The arguments of input context struct are defined in TP_PROTO of the tracepoint definition in kernel.\n",{"type":58,"tag":120,"props":1253,"children":1255},{"class":1254,"line":574},[122,1151],[1256],{"type":58,"tag":120,"props":1257,"children":1258},{"style":583},[1259],{"type":63,"value":1260},"    // Ref: https://codebrowser.dev/linux/linux/include/trace/events/syscalls.h.html#20\n",{"type":58,"tag":120,"props":1262,"children":1264},{"class":1263,"line":589},[122,1151],[1265],{"type":58,"tag":120,"props":1266,"children":1267},{"style":583},[1268],{"type":63,"value":1269},"    // In this case it is TP_PROTO(struct pt_regs *regs, long id):\n",{"type":58,"tag":120,"props":1271,"children":1273},{"class":1272,"line":603},[122,1151],[1274],{"type":58,"tag":120,"props":1275,"children":1276},{"style":583},[1277],{"type":63,"value":1278},"    // args[0] -> struct pt_regs *regs\n",{"type":58,"tag":120,"props":1280,"children":1282},{"class":1281,"line":633},[122,1151],[1283],{"type":58,"tag":120,"props":1284,"children":1285},{"style":583},[1286],{"type":63,"value":1287},"    // args[1] -> long id\n",{"type":58,"tag":120,"props":1289,"children":1291},{"class":1290,"line":669},[122,1151],[1292,1297,1302,1307,1311,1316,1320,1325,1330,1335],{"type":58,"tag":120,"props":1293,"children":1294},{"style":500},[1295],{"type":63,"value":1296},"    unsigned",{"type":58,"tag":120,"props":1298,"children":1299},{"style":500},[1300],{"type":63,"value":1301}," long",{"type":58,"tag":120,"props":1303,"children":1304},{"style":491},[1305],{"type":63,"value":1306}," id ",{"type":58,"tag":120,"props":1308,"children":1309},{"style":617},[1310],{"type":63,"value":809},{"type":58,"tag":120,"props":1312,"children":1313},{"style":774},[1314],{"type":63,"value":1315}," ctx",{"type":58,"tag":120,"props":1317,"children":1318},{"style":491},[1319],{"type":63,"value":840},{"type":58,"tag":120,"props":1321,"children":1322},{"style":774},[1323],{"type":63,"value":1324},"args",{"type":58,"tag":120,"props":1326,"children":1327},{"style":491},[1328],{"type":63,"value":1329},"[",{"type":58,"tag":120,"props":1331,"children":1332},{"style":957},[1333],{"type":63,"value":1334},"1",{"type":58,"tag":120,"props":1336,"children":1337},{"style":491},[1338],{"type":63,"value":1339},"];\n",{"type":58,"tag":120,"props":1341,"children":1343},{"class":1342,"line":41},[122,1151],[1344,1349,1354,1359,1364,1369],{"type":58,"tag":120,"props":1345,"children":1346},{"style":951},[1347],{"type":63,"value":1348},"    if",{"type":58,"tag":120,"props":1350,"children":1351},{"style":491},[1352],{"type":63,"value":1353}," (id ",{"type":58,"tag":120,"props":1355,"children":1356},{"style":617},[1357],{"type":63,"value":1358},"!=",{"type":58,"tag":120,"props":1360,"children":1361},{"style":957},[1362],{"type":63,"value":1363}," 59",{"type":58,"tag":120,"props":1365,"children":1366},{"style":491},[1367],{"type":63,"value":1368},")",{"type":58,"tag":120,"props":1370,"children":1371},{"style":583},[1372],{"type":63,"value":1373},"   // execve sycall ID\n",{"type":58,"tag":120,"props":1375,"children":1377},{"class":1376,"line":711},[122,1151],[1378,1383,1387],{"type":58,"tag":120,"props":1379,"children":1380},{"style":951},[1381],{"type":63,"value":1382},"        return",{"type":58,"tag":120,"props":1384,"children":1385},{"style":957},[1386],{"type":63,"value":960},{"type":58,"tag":120,"props":1388,"children":1389},{"style":491},[1390],{"type":63,"value":965},{"type":58,"tag":120,"props":1392,"children":1393},{"class":122,"line":719},[1394],{"type":58,"tag":120,"props":1395,"children":1396},{"emptyLinePlaceholder":11},[1397],{"type":63,"value":859},{"type":58,"tag":120,"props":1399,"children":1400},{"class":122,"line":743},[1401,1406,1411,1415,1420,1424,1428,1432,1436,1440,1444,1448,1452,1456,1460,1465],{"type":58,"tag":120,"props":1402,"children":1403},{"style":500},[1404],{"type":63,"value":1405},"    struct",{"type":58,"tag":120,"props":1407,"children":1408},{"style":491},[1409],{"type":63,"value":1410}," pt_regs ",{"type":58,"tag":120,"props":1412,"children":1413},{"style":617},[1414],{"type":63,"value":620},{"type":58,"tag":120,"props":1416,"children":1417},{"style":491},[1418],{"type":63,"value":1419},"regs ",{"type":58,"tag":120,"props":1421,"children":1422},{"style":617},[1423],{"type":63,"value":809},{"type":58,"tag":120,"props":1425,"children":1426},{"style":491},[1427],{"type":63,"value":814},{"type":58,"tag":120,"props":1429,"children":1430},{"style":500},[1431],{"type":63,"value":503},{"type":58,"tag":120,"props":1433,"children":1434},{"style":491},[1435],{"type":63,"value":1410},{"type":58,"tag":120,"props":1437,"children":1438},{"style":617},[1439],{"type":63,"value":620},{"type":58,"tag":120,"props":1441,"children":1442},{"style":491},[1443],{"type":63,"value":1368},{"type":58,"tag":120,"props":1445,"children":1446},{"style":774},[1447],{"type":63,"value":777},{"type":58,"tag":120,"props":1449,"children":1450},{"style":491},[1451],{"type":63,"value":840},{"type":58,"tag":120,"props":1453,"children":1454},{"style":774},[1455],{"type":63,"value":1324},{"type":58,"tag":120,"props":1457,"children":1458},{"style":491},[1459],{"type":63,"value":1329},{"type":58,"tag":120,"props":1461,"children":1462},{"style":957},[1463],{"type":63,"value":1464},"0",{"type":58,"tag":120,"props":1466,"children":1467},{"style":491},[1468],{"type":63,"value":1339},{"type":58,"tag":120,"props":1470,"children":1471},{"class":122,"line":785},[1472],{"type":58,"tag":120,"props":1473,"children":1474},{"emptyLinePlaceholder":11},[1475],{"type":63,"value":859},{"type":58,"tag":120,"props":1477,"children":1478},{"class":122,"line":853},[1479,1483,1487,1491],{"type":58,"tag":120,"props":1480,"children":1481},{"style":500},[1482],{"type":63,"value":609},{"type":58,"tag":120,"props":1484,"children":1485},{"style":500},[1486],{"type":63,"value":795},{"type":58,"tag":120,"props":1488,"children":1489},{"style":617},[1490],{"type":63,"value":656},{"type":58,"tag":120,"props":1492,"children":1493},{"style":491},[1494],{"type":63,"value":1495},"filename;\n",{"type":58,"tag":120,"props":1497,"children":1498},{"class":122,"line":862},[1499],{"type":58,"tag":120,"props":1500,"children":1501},{"style":583},[1502],{"type":63,"value":1503},"    // Intentionally accessing the register (without using PT_REGS_PARM* macro) directly for illustration\n",{"type":58,"tag":120,"props":1505,"children":1506},{"class":122,"line":881},[1507,1512,1516,1521,1526,1530,1535,1539,1544,1548,1553],{"type":58,"tag":120,"props":1508,"children":1509},{"style":127},[1510],{"type":63,"value":1511},"    bpf_probe_read",{"type":58,"tag":120,"props":1513,"children":1514},{"style":491},[1515],{"type":63,"value":730},{"type":58,"tag":120,"props":1517,"children":1518},{"style":617},[1519],{"type":63,"value":1520},"&",{"type":58,"tag":120,"props":1522,"children":1523},{"style":491},[1524],{"type":63,"value":1525},"filename, ",{"type":58,"tag":120,"props":1527,"children":1528},{"style":500},[1529],{"type":63,"value":897},{"type":58,"tag":120,"props":1531,"children":1532},{"style":491},[1533],{"type":63,"value":1534},"(filename), ",{"type":58,"tag":120,"props":1536,"children":1537},{"style":617},[1538],{"type":63,"value":1520},{"type":58,"tag":120,"props":1540,"children":1541},{"style":774},[1542],{"type":63,"value":1543},"regs",{"type":58,"tag":120,"props":1545,"children":1546},{"style":491},[1547],{"type":63,"value":840},{"type":58,"tag":120,"props":1549,"children":1550},{"style":774},[1551],{"type":63,"value":1552},"di",{"type":58,"tag":120,"props":1554,"children":1555},{"style":491},[1556],{"type":63,"value":850},{"type":58,"tag":120,"props":1558,"children":1559},{"class":122,"line":905},[1560],{"type":58,"tag":120,"props":1561,"children":1562},{"emptyLinePlaceholder":11},[1563],{"type":63,"value":859},{"type":58,"tag":120,"props":1565,"children":1566},{"class":122,"line":913},[1567,1571,1576],{"type":58,"tag":120,"props":1568,"children":1569},{"style":500},[1570],{"type":63,"value":530},{"type":58,"tag":120,"props":1572,"children":1573},{"style":774},[1574],{"type":63,"value":1575}," buf",{"type":58,"tag":120,"props":1577,"children":1578},{"style":491},[1579],{"type":63,"value":878},{"type":58,"tag":120,"props":1581,"children":1582},{"class":122,"line":947},[1583,1587,1591,1595],{"type":58,"tag":120,"props":1584,"children":1585},{"style":127},[1586],{"type":63,"value":887},{"type":58,"tag":120,"props":1588,"children":1589},{"style":491},[1590],{"type":63,"value":892},{"type":58,"tag":120,"props":1592,"children":1593},{"style":500},[1594],{"type":63,"value":897},{"type":58,"tag":120,"props":1596,"children":1597},{"style":491},[1598],{"type":63,"value":1599},"(buf), filename);\n",{"type":58,"tag":120,"props":1601,"children":1602},{"class":122,"line":968},[1603],{"type":58,"tag":120,"props":1604,"children":1605},{"emptyLinePlaceholder":11},[1606],{"type":63,"value":859},{"type":58,"tag":120,"props":1608,"children":1610},{"class":122,"line":1609},25,[1611,1615,1619,1624,1628,1632],{"type":58,"tag":120,"props":1612,"children":1613},{"style":127},[1614],{"type":63,"value":919},{"type":58,"tag":120,"props":1616,"children":1617},{"style":491},[1618],{"type":63,"value":730},{"type":58,"tag":120,"props":1620,"children":1621},{"style":133},[1622],{"type":63,"value":1623},"\"Raw tracepoint triggered for execve syscall with parameter filename: %s",{"type":58,"tag":120,"props":1625,"children":1626},{"style":931},[1627],{"type":63,"value":934},{"type":58,"tag":120,"props":1629,"children":1630},{"style":133},[1631],{"type":63,"value":939},{"type":58,"tag":120,"props":1633,"children":1634},{"style":491},[1635],{"type":63,"value":944},{"type":58,"tag":120,"props":1637,"children":1639},{"class":122,"line":1638},26,[1640,1644,1648],{"type":58,"tag":120,"props":1641,"children":1642},{"style":951},[1643],{"type":63,"value":954},{"type":58,"tag":120,"props":1645,"children":1646},{"style":957},[1647],{"type":63,"value":960},{"type":58,"tag":120,"props":1649,"children":1650},{"style":491},[1651],{"type":63,"value":965},{"type":58,"tag":120,"props":1653,"children":1655},{"class":122,"line":1654},27,[1656],{"type":58,"tag":120,"props":1657,"children":1658},{"style":491},[1659],{"type":63,"value":974},{"type":58,"tag":454,"props":1661,"children":1662},{"kind":456},[1663],{"type":58,"tag":59,"props":1664,"children":1665},{},[1666,1667,1673,1674,1680],{"type":63,"value":982},{"type":58,"tag":87,"props":1668,"children":1670},{"className":1669},[],[1671],{"type":63,"value":1672},"SEC(\"raw_tp/xx\")",{"type":63,"value":990},{"type":58,"tag":87,"props":1675,"children":1677},{"className":1676},[],[1678],{"type":63,"value":1679},"SEC(\"raw_tracepoint/xx\")",{"type":63,"value":998},{"type":58,"tag":59,"props":1682,"children":1683},{},[1684,1686,1693,1695,1701,1702,1708,1710,1716],{"type":63,"value":1685},"Notice also that we are reading the syscall arguments from CPU registers. On x86-64, the ",{"type":58,"tag":275,"props":1687,"children":1690},{"href":1688,"rel":1689},"https://gitlab.com/x86-psABIs/x86-64-ABI/-/jobs/artifacts/master/raw/x86-64-ABI/abi.pdf?job=build",[279],[1691],{"type":63,"value":1692},"System V ABI",{"type":63,"value":1694}," defines the first argument in ",{"type":58,"tag":87,"props":1696,"children":1698},{"className":1697},[],[1699],{"type":63,"value":1700},"%rdi",{"type":63,"value":814},{"type":58,"tag":87,"props":1703,"children":1705},{"className":1704},[],[1706],{"type":63,"value":1707},"regs->di",{"type":63,"value":1709},"), the second in ",{"type":58,"tag":87,"props":1711,"children":1713},{"className":1712},[],[1714],{"type":63,"value":1715},"%rsi",{"type":63,"value":1717},", and so on.",{"type":58,"tag":109,"props":1719,"children":1721},{"className":478,"code":1720,"filename":480,"language":481,"meta":114,"style":114},"...\n    bpf_probe_read(&filename, sizeof(filename), &regs->di);\n...\n",[1722],{"type":58,"tag":87,"props":1723,"children":1724},{"__ignoreMap":114},[1725,1732,1784],{"type":58,"tag":120,"props":1726,"children":1727},{"class":122,"line":123},[1728],{"type":58,"tag":120,"props":1729,"children":1730},{"style":491},[1731],{"type":63,"value":494},{"type":58,"tag":120,"props":1733,"children":1734},{"class":122,"line":139},[1735,1739,1743,1747,1751,1756,1760,1764,1768,1772,1776,1780],{"type":58,"tag":120,"props":1736,"children":1737},{"style":127},[1738],{"type":63,"value":1511},{"type":58,"tag":120,"props":1740,"children":1741},{"style":491},[1742],{"type":63,"value":730},{"type":58,"tag":120,"props":1744,"children":1745},{"style":617},[1746],{"type":63,"value":1520},{"type":58,"tag":120,"props":1748,"children":1749},{"style":774},[1750],{"type":63,"value":845},{"type":58,"tag":120,"props":1752,"children":1753},{"style":491},[1754],{"type":63,"value":1755},", ",{"type":58,"tag":120,"props":1757,"children":1758},{"style":500},[1759],{"type":63,"value":897},{"type":58,"tag":120,"props":1761,"children":1762},{"style":491},[1763],{"type":63,"value":1534},{"type":58,"tag":120,"props":1765,"children":1766},{"style":617},[1767],{"type":63,"value":1520},{"type":58,"tag":120,"props":1769,"children":1770},{"style":491},[1771],{"type":63,"value":1543},{"type":58,"tag":120,"props":1773,"children":1774},{"style":617},[1775],{"type":63,"value":840},{"type":58,"tag":120,"props":1777,"children":1778},{"style":774},[1779],{"type":63,"value":1552},{"type":58,"tag":120,"props":1781,"children":1782},{"style":491},[1783],{"type":63,"value":850},{"type":58,"tag":120,"props":1785,"children":1786},{"class":122,"line":152},[1787],{"type":58,"tag":120,"props":1788,"children":1789},{"style":491},[1790],{"type":63,"value":494},{"type":58,"tag":59,"props":1792,"children":1793},{},[1794,1796,1802,1804,1810,1812,1818],{"type":63,"value":1795},"Since we rely on CPU registers, we need to target our binary for specific system architectures. One way to achieve this is to set a ",{"type":58,"tag":87,"props":1797,"children":1799},{"className":1798},[],[1800],{"type":63,"value":1801},"--target",{"type":63,"value":1803}," flag to the ",{"type":58,"tag":87,"props":1805,"children":1807},{"className":1806},[],[1808],{"type":63,"value":1809},"bpf2go",{"type":63,"value":1811}," command (actually ",{"type":58,"tag":87,"props":1813,"children":1815},{"className":1814},[],[1816],{"type":63,"value":1817},"clang",{"type":63,"value":1819}," internally).",{"type":58,"tag":109,"props":1821,"children":1826},{"className":1822,"code":1823,"filename":1824,"highlights":1825,"language":130,"meta":114,"style":114},"language-go shiki shiki-themes slack-dark","package main                                                                \n                                                                            \n//go:generate go run github.com/cilium/ebpf/cmd/bpf2go -target amd64 trace trace.c\n \nimport (\n  \"log\"\n","main.go",[152],[1827],{"type":58,"tag":87,"props":1828,"children":1829},{"__ignoreMap":114},[1830,1849,1856,1865,1873,1886],{"type":58,"tag":120,"props":1831,"children":1832},{"class":122,"line":123},[1833,1838,1844],{"type":58,"tag":120,"props":1834,"children":1835},{"style":500},[1836],{"type":63,"value":1837},"package",{"type":58,"tag":120,"props":1839,"children":1841},{"style":1840},"--shiki-default:#4EC9B0",[1842],{"type":63,"value":1843}," main",{"type":58,"tag":120,"props":1845,"children":1846},{"style":491},[1847],{"type":63,"value":1848},"                                                                \n",{"type":58,"tag":120,"props":1850,"children":1851},{"class":122,"line":139},[1852],{"type":58,"tag":120,"props":1853,"children":1854},{"style":491},[1855],{"type":63,"value":571},{"type":58,"tag":120,"props":1857,"children":1859},{"class":1858,"line":152},[122,1151],[1860],{"type":58,"tag":120,"props":1861,"children":1862},{"style":583},[1863],{"type":63,"value":1864},"//go:generate go run github.com/cilium/ebpf/cmd/bpf2go -target amd64 trace trace.c\n",{"type":58,"tag":120,"props":1866,"children":1867},{"class":122,"line":524},[1868],{"type":58,"tag":120,"props":1869,"children":1870},{"style":491},[1871],{"type":63,"value":1872}," \n",{"type":58,"tag":120,"props":1874,"children":1875},{"class":122,"line":538},[1876,1881],{"type":58,"tag":120,"props":1877,"children":1878},{"style":951},[1879],{"type":63,"value":1880},"import",{"type":58,"tag":120,"props":1882,"children":1883},{"style":491},[1884],{"type":63,"value":1885}," (\n",{"type":58,"tag":120,"props":1887,"children":1888},{"class":122,"line":551},[1889],{"type":58,"tag":120,"props":1890,"children":1891},{"style":133},[1892],{"type":63,"value":1893},"  \"log\"\n",{"type":58,"tag":199,"props":1895,"children":1897},{"id":1896},"ebpf-kernel-probes-kprobes",[1898],{"type":63,"value":1899},"eBPF Kernel Probes (kprobes)",{"type":58,"tag":59,"props":1901,"children":1902},{},[1903],{"type":63,"value":1904},"Regular and raw eBPF tracepoints might in fact be sufficient for your use case, but their main limitation is that they are limited to a set of predefined hook points in the kernel, disallowing you to trace arbitrary kernel events.",{"type":58,"tag":59,"props":1906,"children":1907},{},[1908],{"type":63,"value":1909},"Kprobes alleviate this by allowing dynamic hooks into any kernel function, including within function body, not just at the start or return.",{"type":58,"tag":454,"props":1911,"children":1912},{"kind":456},[1913],{"type":58,"tag":59,"props":1914,"children":1915},{},[1916,1918,1924],{"type":63,"value":1917},"💡 Kernel functions marked with the ",{"type":58,"tag":87,"props":1919,"children":1921},{"className":1920},[],[1922],{"type":63,"value":1923},"notrace",{"type":63,"value":1925}," keyword are exceptions, and kprobes cannot hook them.",{"type":58,"tag":59,"props":1927,"children":1928},{},[1929,1931,1937],{"type":63,"value":1930},"Conveniently, you can list all kernel symbols in ",{"type":58,"tag":87,"props":1932,"children":1934},{"className":1933},[],[1935],{"type":63,"value":1936},"/proc/kallsyms",{"type":63,"value":1938},":",{"type":58,"tag":109,"props":1940,"children":1942},{"className":111,"code":1941,"language":113,"meta":114,"style":114},"sudo cat /proc/kallsyms | less\n",[1943],{"type":58,"tag":87,"props":1944,"children":1945},{"__ignoreMap":114},[1946],{"type":58,"tag":120,"props":1947,"children":1948},{"class":122,"line":123},[1949,1953,1957,1962,1967],{"type":58,"tag":120,"props":1950,"children":1951},{"style":127},[1952],{"type":63,"value":158},{"type":58,"tag":120,"props":1954,"children":1955},{"style":133},[1956],{"type":63,"value":364},{"type":58,"tag":120,"props":1958,"children":1959},{"style":133},[1960],{"type":63,"value":1961}," /proc/kallsyms",{"type":58,"tag":120,"props":1963,"children":1964},{"style":617},[1965],{"type":63,"value":1966}," |",{"type":58,"tag":120,"props":1968,"children":1969},{"style":127},[1970],{"type":63,"value":1971}," less\n",{"type":58,"tag":109,"props":1973,"children":1976},{"className":1974,"code":1975,"language":63},[373],"ffffffff81000000 T startup_64\nffffffff81000000 T _stext\nffffffff81000000 T _text\nffffffff81000060 T secondary_startup_64\nffffffff81000065 T secondary_startup_64_no_verify\nffffffff81000120 t verify_cpu\n...\nffffffff812b7710 T __ia32_sys_execveat\nffffffff812b7780 T __ia32_sys_execve\nffffffff812b77d0 T __x64_sys_execveat\nffffffff812b7840 T __x64_sys_execve # \u003C- Our kernel function\n...\n",[1977],{"type":58,"tag":87,"props":1978,"children":1979},{"__ignoreMap":114},[1980],{"type":63,"value":1975},{"type":58,"tag":454,"props":1982,"children":1983},{"kind":456},[1984],{"type":58,"tag":59,"props":1985,"children":1986},{},[1987,1989,1994,1996,2002],{"type":63,"value":1988},"💡 If a function is not in ",{"type":58,"tag":87,"props":1990,"children":1992},{"className":1991},[],[1993],{"type":63,"value":1936},{"type":63,"value":1995},", it's likely because is was inlined at compile time. Also verify they are not blacklisted in ",{"type":58,"tag":87,"props":1997,"children":1999},{"className":1998},[],[2000],{"type":63,"value":2001},"/sys/kernel/debug/krpobes/blacklist",{"type":63,"value":392},{"type":58,"tag":109,"props":2004,"children":2006},{"className":478,"code":2005,"filename":480,"language":481,"meta":114,"style":114},"SEC(\"kprobe/__x64_sys_execve\")\nint kprobe_execve_non_core(struct pt_regs *ctx) {\n    // On x86-64, the entry wrapper __x64_sys_execve is called with a pointer to struct pt_regs in %rdi -> pt_regs.di\n    struct pt_regs *regs = (struct pt_regs *)ctx->di;\n\n    // Read the filename \"from the inner regs\"\n    unsigned long di = 0;\n    bpf_probe_read_kernel(&di, sizeof(di), &regs->di);\n    const char *filename = (const char *)di;\n\n    char buf[ARGSIZE];\n    bpf_probe_read_user_str(buf, sizeof(buf), filename);\n\n    bpf_printk(\"Kprobe triggered for execve syscall with parameter filename: %s\\n\", buf);\n\n    return 0;\n}\n",[2007],{"type":58,"tag":87,"props":2008,"children":2009},{"__ignoreMap":114},[2010,2030,2066,2074,2133,2140,2148,2176,2226,2271,2278,2293,2312,2319,2347,2354,2369],{"type":58,"tag":120,"props":2011,"children":2012},{"class":122,"line":123},[2013,2017,2021,2026],{"type":58,"tag":120,"props":2014,"children":2015},{"style":127},[2016],{"type":63,"value":725},{"type":58,"tag":120,"props":2018,"children":2019},{"style":491},[2020],{"type":63,"value":730},{"type":58,"tag":120,"props":2022,"children":2023},{"style":133},[2024],{"type":63,"value":2025},"\"kprobe/__x64_sys_execve\"",{"type":58,"tag":120,"props":2027,"children":2028},{"style":491},[2029],{"type":63,"value":740},{"type":58,"tag":120,"props":2031,"children":2032},{"class":122,"line":139},[2033,2037,2042,2046,2050,2054,2058,2062],{"type":58,"tag":120,"props":2034,"children":2035},{"style":500},[2036],{"type":63,"value":749},{"type":58,"tag":120,"props":2038,"children":2039},{"style":127},[2040],{"type":63,"value":2041}," kprobe_execve_non_core",{"type":58,"tag":120,"props":2043,"children":2044},{"style":491},[2045],{"type":63,"value":730},{"type":58,"tag":120,"props":2047,"children":2048},{"style":500},[2049],{"type":63,"value":503},{"type":58,"tag":120,"props":2051,"children":2052},{"style":491},[2053],{"type":63,"value":1410},{"type":58,"tag":120,"props":2055,"children":2056},{"style":617},[2057],{"type":63,"value":620},{"type":58,"tag":120,"props":2059,"children":2060},{"style":774},[2061],{"type":63,"value":777},{"type":58,"tag":120,"props":2063,"children":2064},{"style":491},[2065],{"type":63,"value":782},{"type":58,"tag":120,"props":2067,"children":2068},{"class":122,"line":152},[2069],{"type":58,"tag":120,"props":2070,"children":2071},{"style":583},[2072],{"type":63,"value":2073},"    // On x86-64, the entry wrapper __x64_sys_execve is called with a pointer to struct pt_regs in %rdi -> pt_regs.di\n",{"type":58,"tag":120,"props":2075,"children":2076},{"class":122,"line":524},[2077,2081,2085,2089,2093,2097,2101,2105,2109,2113,2117,2121,2125,2129],{"type":58,"tag":120,"props":2078,"children":2079},{"style":500},[2080],{"type":63,"value":1405},{"type":58,"tag":120,"props":2082,"children":2083},{"style":491},[2084],{"type":63,"value":1410},{"type":58,"tag":120,"props":2086,"children":2087},{"style":617},[2088],{"type":63,"value":620},{"type":58,"tag":120,"props":2090,"children":2091},{"style":491},[2092],{"type":63,"value":1419},{"type":58,"tag":120,"props":2094,"children":2095},{"style":617},[2096],{"type":63,"value":809},{"type":58,"tag":120,"props":2098,"children":2099},{"style":491},[2100],{"type":63,"value":814},{"type":58,"tag":120,"props":2102,"children":2103},{"style":500},[2104],{"type":63,"value":503},{"type":58,"tag":120,"props":2106,"children":2107},{"style":491},[2108],{"type":63,"value":1410},{"type":58,"tag":120,"props":2110,"children":2111},{"style":617},[2112],{"type":63,"value":620},{"type":58,"tag":120,"props":2114,"children":2115},{"style":491},[2116],{"type":63,"value":1368},{"type":58,"tag":120,"props":2118,"children":2119},{"style":774},[2120],{"type":63,"value":777},{"type":58,"tag":120,"props":2122,"children":2123},{"style":491},[2124],{"type":63,"value":840},{"type":58,"tag":120,"props":2126,"children":2127},{"style":774},[2128],{"type":63,"value":1552},{"type":58,"tag":120,"props":2130,"children":2131},{"style":491},[2132],{"type":63,"value":965},{"type":58,"tag":120,"props":2134,"children":2135},{"class":122,"line":538},[2136],{"type":58,"tag":120,"props":2137,"children":2138},{"emptyLinePlaceholder":11},[2139],{"type":63,"value":859},{"type":58,"tag":120,"props":2141,"children":2142},{"class":122,"line":551},[2143],{"type":58,"tag":120,"props":2144,"children":2145},{"style":583},[2146],{"type":63,"value":2147},"    // Read the filename \"from the inner regs\"\n",{"type":58,"tag":120,"props":2149,"children":2150},{"class":122,"line":565},[2151,2155,2159,2164,2168,2172],{"type":58,"tag":120,"props":2152,"children":2153},{"style":500},[2154],{"type":63,"value":1296},{"type":58,"tag":120,"props":2156,"children":2157},{"style":500},[2158],{"type":63,"value":1301},{"type":58,"tag":120,"props":2160,"children":2161},{"style":491},[2162],{"type":63,"value":2163}," di ",{"type":58,"tag":120,"props":2165,"children":2166},{"style":617},[2167],{"type":63,"value":809},{"type":58,"tag":120,"props":2169,"children":2170},{"style":957},[2171],{"type":63,"value":960},{"type":58,"tag":120,"props":2173,"children":2174},{"style":491},[2175],{"type":63,"value":965},{"type":58,"tag":120,"props":2177,"children":2178},{"class":122,"line":574},[2179,2184,2188,2192,2197,2201,2206,2210,2214,2218,2222],{"type":58,"tag":120,"props":2180,"children":2181},{"style":127},[2182],{"type":63,"value":2183},"    bpf_probe_read_kernel",{"type":58,"tag":120,"props":2185,"children":2186},{"style":491},[2187],{"type":63,"value":730},{"type":58,"tag":120,"props":2189,"children":2190},{"style":617},[2191],{"type":63,"value":1520},{"type":58,"tag":120,"props":2193,"children":2194},{"style":491},[2195],{"type":63,"value":2196},"di, ",{"type":58,"tag":120,"props":2198,"children":2199},{"style":500},[2200],{"type":63,"value":897},{"type":58,"tag":120,"props":2202,"children":2203},{"style":491},[2204],{"type":63,"value":2205},"(di), ",{"type":58,"tag":120,"props":2207,"children":2208},{"style":617},[2209],{"type":63,"value":1520},{"type":58,"tag":120,"props":2211,"children":2212},{"style":774},[2213],{"type":63,"value":1543},{"type":58,"tag":120,"props":2215,"children":2216},{"style":491},[2217],{"type":63,"value":840},{"type":58,"tag":120,"props":2219,"children":2220},{"style":774},[2221],{"type":63,"value":1552},{"type":58,"tag":120,"props":2223,"children":2224},{"style":491},[2225],{"type":63,"value":850},{"type":58,"tag":120,"props":2227,"children":2228},{"class":122,"line":589},[2229,2233,2237,2241,2246,2250,2254,2258,2262,2266],{"type":58,"tag":120,"props":2230,"children":2231},{"style":500},[2232],{"type":63,"value":609},{"type":58,"tag":120,"props":2234,"children":2235},{"style":500},[2236],{"type":63,"value":795},{"type":58,"tag":120,"props":2238,"children":2239},{"style":617},[2240],{"type":63,"value":656},{"type":58,"tag":120,"props":2242,"children":2243},{"style":491},[2244],{"type":63,"value":2245},"filename ",{"type":58,"tag":120,"props":2247,"children":2248},{"style":617},[2249],{"type":63,"value":809},{"type":58,"tag":120,"props":2251,"children":2252},{"style":491},[2253],{"type":63,"value":814},{"type":58,"tag":120,"props":2255,"children":2256},{"style":500},[2257],{"type":63,"value":651},{"type":58,"tag":120,"props":2259,"children":2260},{"style":500},[2261],{"type":63,"value":795},{"type":58,"tag":120,"props":2263,"children":2264},{"style":617},[2265],{"type":63,"value":656},{"type":58,"tag":120,"props":2267,"children":2268},{"style":491},[2269],{"type":63,"value":2270},")di;\n",{"type":58,"tag":120,"props":2272,"children":2273},{"class":122,"line":603},[2274],{"type":58,"tag":120,"props":2275,"children":2276},{"emptyLinePlaceholder":11},[2277],{"type":63,"value":859},{"type":58,"tag":120,"props":2279,"children":2280},{"class":122,"line":633},[2281,2285,2289],{"type":58,"tag":120,"props":2282,"children":2283},{"style":500},[2284],{"type":63,"value":530},{"type":58,"tag":120,"props":2286,"children":2287},{"style":774},[2288],{"type":63,"value":1575},{"type":58,"tag":120,"props":2290,"children":2291},{"style":491},[2292],{"type":63,"value":878},{"type":58,"tag":120,"props":2294,"children":2295},{"class":122,"line":669},[2296,2300,2304,2308],{"type":58,"tag":120,"props":2297,"children":2298},{"style":127},[2299],{"type":63,"value":887},{"type":58,"tag":120,"props":2301,"children":2302},{"style":491},[2303],{"type":63,"value":892},{"type":58,"tag":120,"props":2305,"children":2306},{"style":500},[2307],{"type":63,"value":897},{"type":58,"tag":120,"props":2309,"children":2310},{"style":491},[2311],{"type":63,"value":1599},{"type":58,"tag":120,"props":2313,"children":2314},{"class":122,"line":41},[2315],{"type":58,"tag":120,"props":2316,"children":2317},{"emptyLinePlaceholder":11},[2318],{"type":63,"value":859},{"type":58,"tag":120,"props":2320,"children":2321},{"class":122,"line":711},[2322,2326,2330,2335,2339,2343],{"type":58,"tag":120,"props":2323,"children":2324},{"style":127},[2325],{"type":63,"value":919},{"type":58,"tag":120,"props":2327,"children":2328},{"style":491},[2329],{"type":63,"value":730},{"type":58,"tag":120,"props":2331,"children":2332},{"style":133},[2333],{"type":63,"value":2334},"\"Kprobe triggered for execve syscall with parameter filename: %s",{"type":58,"tag":120,"props":2336,"children":2337},{"style":931},[2338],{"type":63,"value":934},{"type":58,"tag":120,"props":2340,"children":2341},{"style":133},[2342],{"type":63,"value":939},{"type":58,"tag":120,"props":2344,"children":2345},{"style":491},[2346],{"type":63,"value":944},{"type":58,"tag":120,"props":2348,"children":2349},{"class":122,"line":719},[2350],{"type":58,"tag":120,"props":2351,"children":2352},{"emptyLinePlaceholder":11},[2353],{"type":63,"value":859},{"type":58,"tag":120,"props":2355,"children":2356},{"class":122,"line":743},[2357,2361,2365],{"type":58,"tag":120,"props":2358,"children":2359},{"style":951},[2360],{"type":63,"value":954},{"type":58,"tag":120,"props":2362,"children":2363},{"style":957},[2364],{"type":63,"value":960},{"type":58,"tag":120,"props":2366,"children":2367},{"style":491},[2368],{"type":63,"value":965},{"type":58,"tag":120,"props":2370,"children":2371},{"class":122,"line":785},[2372],{"type":58,"tag":120,"props":2373,"children":2374},{"style":491},[2375],{"type":63,"value":974},{"type":58,"tag":59,"props":2377,"children":2378},{},[2379,2381,2386],{"type":63,"value":2380},"But the issue with kprobes is that you ",{"type":58,"tag":247,"props":2382,"children":2383},{},[2384],{"type":63,"value":2385},"depend on whatever code happens to be in the kernel your system runs and are not assured to be stable across different kernel versions",{"type":63,"value":2387},". Functions might exist in certain kernel versions, while not in others, structs can change, rename, or remove a field you are using.",{"type":58,"tag":59,"props":2389,"children":2390},{},[2391],{"type":63,"value":2392},"In the upcoming tutorial, we’ll look at how to avoid these kinds of non-portable scenarios. But in general, think of them as a last resort in case none other eBPF program type supports what you are looking for.",{"type":58,"tag":454,"props":2394,"children":2395},{"kind":456},[2396],{"type":58,"tag":59,"props":2397,"children":2398},{},[2399,2401,2406],{"type":63,"value":2400},"💡 The same applies for ",{"type":58,"tag":247,"props":2402,"children":2403},{},[2404],{"type":63,"value":2405},"kretprobes",{"type":63,"value":2407}," — kernel probes one can attach to the exit of the function.",{"type":58,"tag":59,"props":2409,"children":2410},{},[2411,2413,2420],{"type":63,"value":2412},"Also, when we attach a kprobe, it’s similar to inserting a breakpoint in a debugger: the ",{"type":58,"tag":275,"props":2414,"children":2417},{"href":2415,"rel":2416},"https://elixir.bootlin.com/linux/v6.15.6/source/kernel/kprobes.c#L1152",[279],[2418],{"type":63,"value":2419},"kernel patches the target instruction with one that triggers a debug exception",{"type":63,"value":2421},". When this instruction executes, the exception handler calls our probe handler.",{"type":58,"tag":59,"props":2423,"children":2424},{},[2425],{"type":63,"value":2426},"And while this mechanism works well, it has a downside.",{"type":58,"tag":59,"props":2428,"children":2429},{},[2430],{"type":63,"value":2431},"Each probe hit generates an exception, causing context switches and exception handling. That overhead may be negligible for infrequent probes, but if many probes are attached to “hot” kernel functions, performance can degrade significantly.",{"type":58,"tag":59,"props":2433,"children":2434},{},[2435],{"type":63,"value":2436},"Is there some alternative to allow triggering eBPF programs with less overhead? Yes, of course.",{"type":58,"tag":199,"props":2438,"children":2440},{"id":2439},"fprobes",[2441],{"type":63,"value":2442},"Fprobes",{"type":58,"tag":59,"props":2444,"children":2445},{},[2446],{"type":63,"value":2447},"As mentioned above, kprobes work by patching an instruction to trigger an exception, which adds context-switch and exception-handling overhead.",{"type":58,"tag":59,"props":2449,"children":2450},{},[2451,2453,2460],{"type":63,"value":2452},"Fprobes in contrast build on the ",{"type":58,"tag":275,"props":2454,"children":2457},{"href":2455,"rel":2456},"https://www.kernel.org/doc/html/v6.9/trace/ftrace.html",[279],[2458],{"type":63,"value":2459},"ftrace mechanism",{"type":63,"value":392},{"type":58,"tag":59,"props":2462,"children":2463},{},[2464,2466,2473],{"type":63,"value":2465},"In other words, at each function entry, the compiler emits a NOP instruction that can later be patched at runtime into a jump to an ",{"type":58,"tag":275,"props":2467,"children":2470},{"href":2468,"rel":2469},"https://lwn.net/Articles/804937/",[279],[2471],{"type":63,"value":2472},"eBPF trampoline",{"type":63,"value":2474},". This trampoline invokes the eBPF program as if it were called by the original caller itself, bypassing exceptions and greatly reducing the overhead.",{"type":58,"tag":59,"props":2476,"children":2477},{},[2478],{"type":63,"value":2479},"The main (rather small) limitation is that fprobes can only attach at function entry (fentry) and function exit (fexit) points, not at arbitrary instruction offsets like kprobes. However, fentry/fexit probes are flexible in that they can also attach to eBPF programs such as XDP, TC, or cgroup programs.",{"type":58,"tag":219,"props":2481,"children":2483},{":summary":2482},"Why would one ever attach to an eBPF program onto an eBPF XDP, TC or cgroup program?",[2484,2489,2503],{"type":58,"tag":59,"props":2485,"children":2486},{},[2487],{"type":63,"value":2488},"It may sound unusual, but using fprobes you can trace eBPF programs just like you would trace kernel functions.",{"type":58,"tag":59,"props":2490,"children":2491},{},[2492,2494,2501],{"type":63,"value":2493},"For example, I once used an fentry program to measure ",{"type":58,"tag":275,"props":2495,"children":2498},{"href":2496,"rel":2497},"https://github.com/dorkamotorka/xdpmonitor-ebpf",[279],[2499],{"type":63,"value":2500},"how frequently different XDP return codes occurred",{"type":63,"value":2502}," which was helpful while developing an eBPF-based firewall.",{"type":58,"tag":59,"props":2504,"children":2505},{},[2506,2508,2515],{"type":63,"value":2507},"I applied the same idea to ",{"type":58,"tag":275,"props":2509,"children":2512},{"href":2510,"rel":2511},"https://github.com/dorkamotorka/tcmonitor-ebpf",[279],[2513],{"type":63,"value":2514},"collect statistics of TC programs return codes",{"type":63,"value":392},{"type":58,"tag":59,"props":2517,"children":2518},{},[2519],{"type":63,"value":2520},"Additionally, fexit probes have access to the function’s input parameters, something kretprobes cannot provide.",{"type":58,"tag":109,"props":2522,"children":2524},{"className":478,"code":2523,"filename":480,"language":481,"meta":114,"style":114},"SEC(\"fentry/__x64_sys_execve\")\nint fentry_execve(u64 *ctx) {\n    struct pt_regs *regs = (struct pt_regs *)ctx[0];\n\n    // x86-64: first arg in rdi -> pt_regs.di\n    const char *filename = (const char *)regs->di;\n    char buf[ARGSIZE];\n    bpf_probe_read_user_str(buf, sizeof(buf), filename);\n\n    bpf_printk(\"Fentry tracepoint triggered (CO-RE) for execve syscall with parameter filename: %s\\n\", buf);\n    return 0;\n}\n",[2525],{"type":58,"tag":87,"props":2526,"children":2527},{"__ignoreMap":114},[2528,2548,2577,2636,2643,2651,2710,2725,2744,2751,2779,2794],{"type":58,"tag":120,"props":2529,"children":2530},{"class":122,"line":123},[2531,2535,2539,2544],{"type":58,"tag":120,"props":2532,"children":2533},{"style":127},[2534],{"type":63,"value":725},{"type":58,"tag":120,"props":2536,"children":2537},{"style":491},[2538],{"type":63,"value":730},{"type":58,"tag":120,"props":2540,"children":2541},{"style":133},[2542],{"type":63,"value":2543},"\"fentry/__x64_sys_execve\"",{"type":58,"tag":120,"props":2545,"children":2546},{"style":491},[2547],{"type":63,"value":740},{"type":58,"tag":120,"props":2549,"children":2550},{"class":122,"line":139},[2551,2555,2560,2565,2569,2573],{"type":58,"tag":120,"props":2552,"children":2553},{"style":500},[2554],{"type":63,"value":749},{"type":58,"tag":120,"props":2556,"children":2557},{"style":127},[2558],{"type":63,"value":2559}," fentry_execve",{"type":58,"tag":120,"props":2561,"children":2562},{"style":491},[2563],{"type":63,"value":2564},"(u64 ",{"type":58,"tag":120,"props":2566,"children":2567},{"style":617},[2568],{"type":63,"value":620},{"type":58,"tag":120,"props":2570,"children":2571},{"style":774},[2572],{"type":63,"value":777},{"type":58,"tag":120,"props":2574,"children":2575},{"style":491},[2576],{"type":63,"value":782},{"type":58,"tag":120,"props":2578,"children":2579},{"class":122,"line":152},[2580,2584,2588,2592,2596,2600,2604,2608,2612,2616,2620,2624,2628,2632],{"type":58,"tag":120,"props":2581,"children":2582},{"style":500},[2583],{"type":63,"value":1405},{"type":58,"tag":120,"props":2585,"children":2586},{"style":491},[2587],{"type":63,"value":1410},{"type":58,"tag":120,"props":2589,"children":2590},{"style":617},[2591],{"type":63,"value":620},{"type":58,"tag":120,"props":2593,"children":2594},{"style":491},[2595],{"type":63,"value":1419},{"type":58,"tag":120,"props":2597,"children":2598},{"style":617},[2599],{"type":63,"value":809},{"type":58,"tag":120,"props":2601,"children":2602},{"style":491},[2603],{"type":63,"value":814},{"type":58,"tag":120,"props":2605,"children":2606},{"style":500},[2607],{"type":63,"value":503},{"type":58,"tag":120,"props":2609,"children":2610},{"style":491},[2611],{"type":63,"value":1410},{"type":58,"tag":120,"props":2613,"children":2614},{"style":617},[2615],{"type":63,"value":620},{"type":58,"tag":120,"props":2617,"children":2618},{"style":491},[2619],{"type":63,"value":1368},{"type":58,"tag":120,"props":2621,"children":2622},{"style":774},[2623],{"type":63,"value":777},{"type":58,"tag":120,"props":2625,"children":2626},{"style":491},[2627],{"type":63,"value":1329},{"type":58,"tag":120,"props":2629,"children":2630},{"style":957},[2631],{"type":63,"value":1464},{"type":58,"tag":120,"props":2633,"children":2634},{"style":491},[2635],{"type":63,"value":1339},{"type":58,"tag":120,"props":2637,"children":2638},{"class":122,"line":524},[2639],{"type":58,"tag":120,"props":2640,"children":2641},{"emptyLinePlaceholder":11},[2642],{"type":63,"value":859},{"type":58,"tag":120,"props":2644,"children":2645},{"class":122,"line":538},[2646],{"type":58,"tag":120,"props":2647,"children":2648},{"style":583},[2649],{"type":63,"value":2650},"    // x86-64: first arg in rdi -> pt_regs.di\n",{"type":58,"tag":120,"props":2652,"children":2653},{"class":122,"line":551},[2654,2658,2662,2666,2670,2674,2678,2682,2686,2690,2694,2698,2702,2706],{"type":58,"tag":120,"props":2655,"children":2656},{"style":500},[2657],{"type":63,"value":609},{"type":58,"tag":120,"props":2659,"children":2660},{"style":500},[2661],{"type":63,"value":795},{"type":58,"tag":120,"props":2663,"children":2664},{"style":617},[2665],{"type":63,"value":656},{"type":58,"tag":120,"props":2667,"children":2668},{"style":491},[2669],{"type":63,"value":2245},{"type":58,"tag":120,"props":2671,"children":2672},{"style":617},[2673],{"type":63,"value":809},{"type":58,"tag":120,"props":2675,"children":2676},{"style":491},[2677],{"type":63,"value":814},{"type":58,"tag":120,"props":2679,"children":2680},{"style":500},[2681],{"type":63,"value":651},{"type":58,"tag":120,"props":2683,"children":2684},{"style":500},[2685],{"type":63,"value":795},{"type":58,"tag":120,"props":2687,"children":2688},{"style":617},[2689],{"type":63,"value":656},{"type":58,"tag":120,"props":2691,"children":2692},{"style":491},[2693],{"type":63,"value":1368},{"type":58,"tag":120,"props":2695,"children":2696},{"style":774},[2697],{"type":63,"value":1543},{"type":58,"tag":120,"props":2699,"children":2700},{"style":491},[2701],{"type":63,"value":840},{"type":58,"tag":120,"props":2703,"children":2704},{"style":774},[2705],{"type":63,"value":1552},{"type":58,"tag":120,"props":2707,"children":2708},{"style":491},[2709],{"type":63,"value":965},{"type":58,"tag":120,"props":2711,"children":2712},{"class":122,"line":565},[2713,2717,2721],{"type":58,"tag":120,"props":2714,"children":2715},{"style":500},[2716],{"type":63,"value":530},{"type":58,"tag":120,"props":2718,"children":2719},{"style":774},[2720],{"type":63,"value":1575},{"type":58,"tag":120,"props":2722,"children":2723},{"style":491},[2724],{"type":63,"value":878},{"type":58,"tag":120,"props":2726,"children":2727},{"class":122,"line":574},[2728,2732,2736,2740],{"type":58,"tag":120,"props":2729,"children":2730},{"style":127},[2731],{"type":63,"value":887},{"type":58,"tag":120,"props":2733,"children":2734},{"style":491},[2735],{"type":63,"value":892},{"type":58,"tag":120,"props":2737,"children":2738},{"style":500},[2739],{"type":63,"value":897},{"type":58,"tag":120,"props":2741,"children":2742},{"style":491},[2743],{"type":63,"value":1599},{"type":58,"tag":120,"props":2745,"children":2746},{"class":122,"line":589},[2747],{"type":58,"tag":120,"props":2748,"children":2749},{"emptyLinePlaceholder":11},[2750],{"type":63,"value":859},{"type":58,"tag":120,"props":2752,"children":2753},{"class":122,"line":603},[2754,2758,2762,2767,2771,2775],{"type":58,"tag":120,"props":2755,"children":2756},{"style":127},[2757],{"type":63,"value":919},{"type":58,"tag":120,"props":2759,"children":2760},{"style":491},[2761],{"type":63,"value":730},{"type":58,"tag":120,"props":2763,"children":2764},{"style":133},[2765],{"type":63,"value":2766},"\"Fentry tracepoint triggered (CO-RE) for execve syscall with parameter filename: %s",{"type":58,"tag":120,"props":2768,"children":2769},{"style":931},[2770],{"type":63,"value":934},{"type":58,"tag":120,"props":2772,"children":2773},{"style":133},[2774],{"type":63,"value":939},{"type":58,"tag":120,"props":2776,"children":2777},{"style":491},[2778],{"type":63,"value":944},{"type":58,"tag":120,"props":2780,"children":2781},{"class":122,"line":633},[2782,2786,2790],{"type":58,"tag":120,"props":2783,"children":2784},{"style":951},[2785],{"type":63,"value":954},{"type":58,"tag":120,"props":2787,"children":2788},{"style":957},[2789],{"type":63,"value":960},{"type":58,"tag":120,"props":2791,"children":2792},{"style":491},[2793],{"type":63,"value":965},{"type":58,"tag":120,"props":2795,"children":2796},{"class":122,"line":669},[2797],{"type":58,"tag":120,"props":2798,"children":2799},{"style":491},[2800],{"type":63,"value":974},{"type":58,"tag":59,"props":2802,"children":2803},{},[2804],{"type":63,"value":2805},"They do however require at least kernel version 5.5 which might be an issue if you need to support older kernels, at least for now. But otherwise they are mostly superior to kprobes.",{"type":58,"tag":454,"props":2807,"children":2808},{"kind":456},[2809],{"type":58,"tag":59,"props":2810,"children":2811},{},[2812,2814,2820,2822,2833],{"type":63,"value":2813},"💡 For the examples above, I intentionally read the register value using ",{"type":58,"tag":87,"props":2815,"children":2817},{"className":2816},[],[2818],{"type":63,"value":2819},"&regs→di",{"type":63,"value":2821},", where I could also use ",{"type":58,"tag":275,"props":2823,"children":2826},{"href":2824,"rel":2825},"https://docs.ebpf.io/ebpf-library/libbpf/ebpf/PT_REGS_PARM/",[279],[2827],{"type":58,"tag":87,"props":2828,"children":2830},{"className":2829},[],[2831],{"type":63,"value":2832},"PT_REGS_PARM*",{"type":63,"value":2834}," macro which should be preffered.",{"type":58,"tag":59,"props":2836,"children":2837},{},[2838],{"type":63,"value":2839},"Before I let you go, note that there are also BTF-enabled tracepoints, which we’ll briefly cover in the upcoming tutorial alongside an introduction to BTF (BPF Type Format).",{"type":58,"tag":2841,"props":2842,"children":2843},"style",{},[2844],{"type":63,"value":2845},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":114,"searchDepth":139,"depth":139,"links":2848},[2849,2850,2851,2852],{"id":201,"depth":139,"text":204},{"id":1035,"depth":139,"text":1038},{"id":1896,"depth":139,"text":1899},{"id":2439,"depth":139,"text":2442},["Reactive",2854],{},["Reactive",2856],{},["Reactive",2858],{},"#ebpf-tracing-46a570d1-server",{"left":39,"top":39,"width":968,"height":968,"rotate":39,"vFlip":2861,"hFlip":2861,"body":2862},false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":39,"top":39,"width":2864,"height":2864,"rotate":39,"vFlip":2861,"hFlip":2861,"body":2865},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",2867],{"$scurrentUser":2868,"$salerts":2872,"$scontentToggle":2873,"$ssite-config":2874},{"id":2869,"anonymous":11,"effectiveTier":2870,"hasEmailSubscription":2861},"697b5f64cc8f8f56faac74e1",{"name":2871},"free",[],{"/tutorials/ebpf-tracing-46a570d1":11},{"_priority":2875,"env":2878,"name":2879,"url":2880},{"name":2876,"env":2877,"url":39},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",2883],{"tutorial-page-tutorial-ebpf-tracing-46a570d1":-1,"content-tutorial-ebpf-tracing-46a570d1-v1762190616578":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/ebpf-tracing-46a570d1"]</script></body></html>