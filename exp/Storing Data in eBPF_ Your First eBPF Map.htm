<!DOCTYPE html>
<html lang="en" data-theme="cmyk"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Storing Data in eBPF: Your First eBPF Map</title><link nonce="" rel="stylesheet" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/inter.css"><link nonce="" rel="stylesheet" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/Source_Code_Pro.css"><link nonce="" integrity="sha384-W0UkFG5ktUlCLBh/tZDw+slzbqWhSr7IE92M0sRiua5PJAa1/rQ1oZeywI2xmhma" rel="stylesheet" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/css-tokens-theme.css"><style nonce="">.layout-enter-active,.layout-leave-active{transition:all .2s}.layout-enter-from,.layout-leave-to{filter:grayscale(1)}.page-enter-active,.page-leave-active{transition:all .2s}.page-enter-from,.page-leave-to{filter:blur(1rem);opacity:0}</style><style nonce="">.tutorial-header[data-v-0d30d5a9]{display:block;font-family:var(--typography-font-display);font-size:40px;font-weight:var(--prose-h1-fontWeight);letter-spacing:var(--prose-h1-letterSpacing);line-height:var(--prose-h1-lineHeight);margin:var(--prose-h1-margin);margin-bottom:20px;margin-top:20px}</style><style nonce="">#site-header[data-v-7f8ed6a6]{transition:border .25s ease}</style><style nonce="">a[data-v-c294bba9]{font-family:var(--typography-font-sans);font-weight:400}</style><style nonce="">[data-v-6adfc778]{font-family:var(--typography-font-body);font-size:.85rem;line-height:var(--prose-p-lineHeight)}</style><style nonce="">.fade-out[data-v-200caef3]{position:relative}.fade-out[data-v-200caef3]:after{background:linear-gradient(180deg,#fff0 0,#fff);bottom:0;content:"";height:200px;left:0;position:absolute;width:100%}.unit-title[data-v-200caef3]{font-family:var(--typography-font-display);font-size:1.25rem;font-weight:var(--prose-h3-fontWeight);letter-spacing:var(--prose-h3-letterSpacing);line-height:var(--prose-h3-lineHeight);margin-bottom:16px;margin-top:16px}@media(min-width:768px){.unit-title[data-v-200caef3]{font-size:var(--prose-h3-fontSize)}}.expand-all .unit-title[data-v-200caef3]{border-bottom:1px solid #eee;margin-bottom:4px;padding-bottom:.3em}.prose-h1[data-v-200caef3]{margin-top:24px}</style><style nonce="">p[data-v-b025fb9f]{font-family:var(--typography-font-body);font-size:var(--prose-p-fontSize);line-height:var(--prose-p-lineHeight);margin:var(--prose-p-margin)}p[data-v-b025fb9f] br{content:"";display:block;margin:var(--prose-p-br-margin)}</style><style nonce="">code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);font-family:var(--typography-font-code);padding:var(--prose-code-inline-padding);mx:1px;background-color:var(--prose-code-inline-backgroundColor);color:var(--prose-code-inline-color);font-size:var(--prose-code-inline-fontSize);font-weight:var(--prose-code-inline-fontWeight)}tbody code[data-v-a031129a]{font-size:var(--prose-tbody-code-inline-fontSize)}h1 a code[data-v-a031129a],h2 a code[data-v-a031129a],h3 a code[data-v-a031129a],h4 a code[data-v-a031129a],h5 a code[data-v-a031129a],h6 a code[data-v-a031129a]{border-radius:var(--prose-code-inline-borderRadius);color:var(--prose-code-inline-color);font-size:.777777em;padding:.15em .5em}a code[data-v-a031129a]{border-color:var(--prose-a-code-border-color-static);border-style:var(--prose-a-code-border-style);border-width:var(--prose-a-code-border-width);color:var(--prose-a-code-color-static)}a:hover code[data-v-a031129a]{background-color:var(--prose-a-code-background-hover);border-color:var(--prose-a-code-border-color-hover);color:var(--prose-a-code-color-hover)}</style><style nonce="">a[data-v-abeb6555]{color:#4078c0;font-family:var(--typography-font-body);font-weight:400;text-decoration:none}a[data-v-abeb6555]:hover{text-decoration:underline}a[data-v-abeb6555]:has(img){border-width:0}</style><style nonce="">h2[data-v-b9b1576a]{border-bottom:1px solid #eee;display:block;font-family:var(--typography-font-display);font-size:var(--prose-h2-fontSize);font-weight:var(--prose-h2-fontWeight);letter-spacing:var(--prose-h2-letterSpacing);line-height:var(--prose-h2-lineHeight);margin:var(--prose-h2-margin);padding-bottom:.3em}h2[data-v-b9b1576a] .icon{display:inline-block;height:var(--prose-h2-iconSize);margin-inline-start:12px;opacity:0;transition:opacity .1s;width:var(--prose-h2-iconSize)}h2 a[data-v-b9b1576a]:hover .icon{opacity:1}</style><style nonce="">ul[data-v-533e29f3]{font-family:var(--typography-font-body);list-style-type:var(--prose-ul-listStyleType);margin:var(--prose-ul-margin);padding-inline-start:var(--prose-ul-paddingInlineStart)}ul[data-v-533e29f3]>li::marker{color:var(--prose-ul-li-markerColor)}ul[data-v-533e29f3]>li ol,ul[data-v-533e29f3]>li ul{margin:0}</style><style nonce="">li[data-v-2969431c]{font-family:var(--typography-font-body);list-style-position:var(--prose-li-listStylePosition);margin:var(--prose-li-margin)}</style><style nonce="">strong[data-v-24022f14]{font-family:var(--typography-font-body);font-weight:var(--prose-strong-fontWeight)}</style><style nonce="">pre code .line{display:block;min-height:1rem}</style><style nonce="">.prose-code[data-v-4578ab24]{-webkit-backdrop-filter:var(--prose-code-block-backdropFilter);backdrop-filter:var(--prose-code-block-backdropFilter);background-color:var(--prose-code-block-backgroundColor);border-color:var(--prose-code-block-borderColor);border-radius:var(--prose-code-block-borderRadius);border-style:var(--prose-code-block-borderStyle);border-width:var(--prose-code-block-borderWidth);color:var(--prose-code-block-color);font-size:var(--prose-code-block-fontSize);margin:var(--prose-code-block-margin);overflow:hidden;position:relative;width:100%}.prose-code[data-v-4578ab24] code{flex-grow:1}.copy-button[data-v-4578ab24]{background-color:#3c3c3c99;bottom:0;color:#e6e6e6cc;inset-inline-end:0;opacity:0;position:absolute}.prose-code:hover .copy-button[data-v-4578ab24]{opacity:1}.prose-code:hover .copy-button[data-v-4578ab24]:hover{color:#e6e6e6}.copy-button[data-v-4578ab24]:focus{box-shadow:none!important}[data-v-4578ab24] code{display:flex;flex-direction:column}[data-v-4578ab24] .line{display:inline-table;min-height:1.5rem}.filename[data-v-4578ab24]{-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);border-radius:var(--typography-radii-lg);color:#e6e6e6;font-family:var(--typography-font-code);font-size:var(--typography-fontSize-xs);inset-inline-end:0;line-height:var(--typography-lead-normal);padding:.5rem .75rem;position:absolute;top:0;transition:opacity .2s}.prose-code:hover .filename[data-v-4578ab24]:hover{opacity:1}[data-v-4578ab24] pre{display:flex;flex:1;line-height:var(--typography-lead-relaxed);margin:0;overflow-x:auto;padding:var(--prose-code-block-pre-padding)}[data-v-4578ab24] .line.highlight{background-color:#000;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line:not(.highlight)+.line.highlight{border-top:1px solid #444}[data-v-4578ab24] .line.highlight+.line:not(.highlight){border-top:1px solid #444;margin:0 -16px;padding:0 16px}[data-v-4578ab24] .line.highlight:first-child{border-top:1px solid #444}[data-v-4578ab24] .line.highlight:last-child{border-bottom:1px solid #444}</style><style nonce="">button[data-v-134dddac]{border-radius:3px;margin:4px;opacity:0;padding:4px;transform:scale(.75);transition:all .2s}button[data-v-134dddac]:focus{box-shadow:0 0 0 2px var(--typography-color-primary-500);opacity:1;outline:none}button.show[data-v-134dddac]{opacity:1;transform:scale(1)}button .icon-wrapper[data-v-134dddac]{display:block;height:18px;position:relative;width:18px}button .icon-wrapper .icon[data-v-134dddac]{display:block;position:absolute}button .icon-wrapper .fade-enter-active[data-v-134dddac],button .icon-wrapper .fade-leave-active[data-v-134dddac]{transition:opacity .2s}button .icon-wrapper .fade-enter-from[data-v-134dddac],button .icon-wrapper .fade-leave-to[data-v-134dddac]{opacity:0}</style><style nonce="">details>summary[data-v-370f298d]{font-size:var(--prose-p-fontSize)}</style><style nonce="">hr[data-v-34b8dd49]{border-top:var(--prose-hr-width) var(--prose-hr-style) var(--prose-hr-color);margin:var(--prose-hr-margin)}</style><link nonce="" integrity="sha384-VgdaralgzMMDKoxbvggz88cSHbXjvjsd7NI4i46uVtHp/jjxBeJak6GsR2cO7GHi" rel="stylesheet" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/entry.DO90-MQw.css" crossorigin=""><link nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" rel="modulepreload" as="script" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/A538-Xd4.js"><link nonce="" integrity="sha384-Wc22hz0UYZLeSexsNb8aBw3zxHJlH2ESymLXu3JHi6m3sR49j4dleLGt1BVOkDjD" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CiaVwNEs.js"><link nonce="" integrity="sha384-wV/FyIfkoKuneA9gx32UbcC1rWydYJhlr+cMCHu0oN57ZtVcBz8nUCI/A5rPOyHo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DlAUqK2U.js"><link nonce="" integrity="sha384-JBRondsjCje9uCAk+glC4LA43omHrNK2Afdoafa36EDjES+Za12EFI00uupOcyt9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGeBmTCG.js"><link nonce="" integrity="sha384-iOrs0N2+i+e0F5pOd4kyCQpmnc35XQjz3RZS60HpeqOwIhinqlaiSmxKCbvBJsW1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMnvrPLD.js"><link nonce="" integrity="sha384-CEUXna7zyFjV1aUCqrEskDTDcYt8x65beb5ECylmP2u4a3XjjuBUt/selECdFNZK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B1saq5Fe.js"><link nonce="" integrity="sha384-syA1913w37X8NLuSOALbgW9QS2EPUV6mM/Ff8nCauX6ZiD/sHqOLDthOqDMKckCB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D1KxtS4O.js"><link nonce="" integrity="sha384-M0JTRKVfKGOUYhocKYuV/WMSR+qOluNgGUQsIG3GYlIiO+jnxgHfMO2WJmrUEqcK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cd08WlCA.js"><link nonce="" integrity="sha384-2W8FPc/1+bG0TweePWS4uRwvvuxGyDDRF59Oq4c+38RHPjntjyyWlD7v1Sa6zpkX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DTtjwkpk.js"><link nonce="" integrity="sha384-L1CRgqloambsm3q9dC2rb+ifjcv/8Hpqm7EHEDie0lhu2KclJZ/sSVOkeDGM9zDX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C82fcFPv.js"><link nonce="" integrity="sha384-0hD5FZjIYmNI9RitylIyG4efbmRl6kOaKiNnJAhMuCYGphbCEU2T/NgpXk32OXh5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4AR0jMDd.js"><link nonce="" integrity="sha384-DPKYF61GYn/kB6dn/ABdKqapefAnD2W9nBAk2ofHesgnyMnqMJkO7Too4t+mNYYP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B0C1x6gY.js"><link nonce="" integrity="sha384-YgqV0R4URFlIK0f7PeExV/RhB0jCgDJ9GeV41VNl6GAEEwy6vHA/PoQ3VSH8s56f" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwrbW19N.js"><link nonce="" integrity="sha384-0BznfphaLvyEnFT1usV091akUax6dLFoMcZMmzjansRVn5BItWKgsDDCoo8iT/TY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwAYGw04.js"><link nonce="" integrity="sha384-b3SarygGZMZbGN79KG/bEqtJ2xVRemDnvZgqDewtIpgFuNBh75kpOVhZZYbBBlV/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B6Ia1wBT.js"><link nonce="" integrity="sha384-WRh3x9Ejk0elAhcgJQ8ETP2IGNgvqNr91aJXHrH9yZxCCLgchCR41NgV3E7vAodd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChZSQl3-.js"><link nonce="" integrity="sha384-F2pzDKtK6Wor8cY0Y3zbRz+fFovMZFLX8BsggEVAPXGz2+Ycy1I3P2cDE2KS/wOh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/dzq8fjun.js"><link nonce="" integrity="sha384-I2aMPU2PaXlVS4e/fOmYY9zmZzsm1trtgIbztBZU0wObDOs1VIroOVWNsDhl6wHN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/M8Go6PQG.js"><link nonce="" integrity="sha384-uodls5TYxZ8s/FGmTB1Xi3Eu1LUqit11VZ0fVdqtz16nO/2EG8G6ftEpI1QClK52" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/A7blpOo1.js"><link nonce="" integrity="sha384-wZXyrgfemDfNvKK67noacMWWCC0zKLBCwby1agqLAZk1PYstO1pYXd5LJ1vuq0JB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BsfvSMgi.js"><link nonce="" integrity="sha384-Vs+CUGTU4JWQD2L1q1QN40N3Zvq9rYcfTbmA5eOdrmD/VMyI1iDmCHzMLPSdnCqv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWcS6GWa.js"><link nonce="" integrity="sha384-VVomnY5chwSXkMawT1OSXWNPPAe86IfpyIKeWX688WzzJ7lq/B0rADiyVnYOh6HM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/JEhZ6VKh.js"><link nonce="" integrity="sha384-AbnqAjVFi3AmpARRzjM6+16Kv+rETq5s6nmZjsBv+hcl6SxoewxvHT+bGBjAhXeK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ci8QyKoZ.js"><link nonce="" integrity="sha384-td3wGu7krmhEJ5seMu1AU/xkFk7vUdQ3suaalpFhM4fwTaVN1h/H9rGaxFj5hmG8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Btqf3kJo.js"><link nonce="" integrity="sha384-yQp3ZlUZQ0DO+FYouwTSmaxweszONpQqBRmj0jPaUrGPs6qVDenMPabcBy7ZVLmy" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bxj5g83y.js"><link nonce="" integrity="sha384-n1bd298ysXlcokRTgpfLCRSQT0AXTmnPEQXg4ZJzQHwX1PKezwdaLv1OJ/b4mzD0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvPDKjD7.js"><link nonce="" integrity="sha384-ZTF2eLLsj0u4hMXoY82NP13biwgJDAwMzR2d+xBY6rQLO4f3t7LajO3uzq/vZqRX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BcqSyfqL.js"><link nonce="" integrity="sha384-R5RBPCrYygxUzDyczdS9hiczqgYiS67n5heUG2T1GpfHtDEsmXSBLEmEO/BQzJaN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/kvsfWoeJ.js"><link nonce="" integrity="sha384-tb1vqM45YGGFhc7XMYx4bDtjYSaXzAs9cnrgfmG8GKlE7RhDH4qAyu26XzuJ2YIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CzEdsMlG.js"><link nonce="" integrity="sha384-sUqEz/7mCozcDTVa3220YpCuurG9+lxtT39mpvAKoTCj9QExlOBwmCIFpsInI+s1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/-3BZtTVG.js"><link nonce="" integrity="sha384-tnmwzNkA0rvNInwTi3QoUuQf2RJ/bW02kX94g7tDAOWaYuCg85E9BWXXixucWjqZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BupvEF6F.js"><link nonce="" integrity="sha384-cv5eYt8EdzDHogT9noRhAtFPV9+Lrtkd/pkrKyTuN5tJroumDowpyUzCzhwVtaiC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CxmcBoAF.js"><link nonce="" integrity="sha384-Y8UFu09ps1XTln8sVqrgbr/U3lz2Dhm/dACnR9sMrlzgij55P2HmnGCWzPoBSYyu" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSSuG8K0.js"><link nonce="" integrity="sha384-z9/ospmVZd5cw4nwu5/8Qp5hJ8LT0YLR5aprKBlth8ZdKwPYddtBV4lpwoGmUwfN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCu705Yd.js"><link nonce="" integrity="sha384-ZSbWNj1OjFWl7HowKKC8kafoBc1s/7LHOfE9M7ljrgu/wf1sJhfQbLAYyRCzhZdY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C_Jn_tlQ.js"><link nonce="" integrity="sha384-agWmXONfzBbTvKJgUzocvOAVtRahUQJ22dVI+EIlQcdvlhE/n+dJRuMKYyjQZNAJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DVSoXPMN.js"><link nonce="" integrity="sha384-mgFzSSjDqczZLwcbehdgDcFRYeUW6C3GqxjgZTu/SLT01MGi+dpHHVI922F+X7C3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CCTXTz88.js"><link nonce="" integrity="sha384-M74HEk3mc8nvuopWlZzTsK144Edv+f2lEjDaYoh2m4d7U7/KfZbi4AusDL0KhPHH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CjdH43sM.js"><link nonce="" integrity="sha384-1gFXWiA9BubdJu/94hOlNp2XvvHoVIz4IGNQv59ibBQfiufGbZxQNBNhF8TAG/RV" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDvDm27B.js"><link nonce="" integrity="sha384-jJcANp9lIArTZ9yN4OBsQ++lCuSSt2pGu3Scy2GlEgU3+8NcDeS7dyssrIUitInI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/7kwUfJ3d.js"><link nonce="" integrity="sha384-EbtRkNeZD9um6+KMX5jCfluq+qSLTrv0RoysLc7gM+g4HZFMODnEaMGiOldAKh8/" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bnu8tQBb.js"><link nonce="" integrity="sha384-UO8ijEdqHf7NyXBUpuq/GC4PXT75sLLrNgF2uqVsvASmGCRpiewQ2SHk9ea1IUqb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CDzRe_IS.js"><link nonce="" integrity="sha384-cKyEWFmQQXO6kDxrNQo20qgZ4VMzQi2uSYiRl05tv1cNyQqU0PJtKu5fqUe4Ki1o" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BzCtePKg.js"><link nonce="" integrity="sha384-COlwUySgtGE6J2TePCYfL/nRrHywmQ1Jwo60ID/objGu8uiCIxttVy2yMr+jbpxj" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Db0ou0G2.js"><link nonce="" integrity="sha384-Rzk+8Cz0gBXmLuLBTSGp80a8fquQIqhPvRlo1IiJeo7hkgncIWi34YKwBlxVgsHt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BARAL6rY.js"><link nonce="" integrity="sha384-/ZmdKieFBiaYx+w0UksW/OG8Hb72bs89W/nKPICK6PZl+kuDHDmuEvI4mRNPXLSv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CM8tEzsp.js"><link nonce="" integrity="sha384-giGL5jqk/0PqHOOqxQuvp4G+iXuMqkfE+1Zlf/2kKJV7sYQ+BxSclVpba3tX/wh+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CZ8UCyxH.js"><link nonce="" integrity="sha384-Jh+iKjfe7e7mgPtH9IYjVPHoUbiLzg8mm+xLGL/iff4u64ibokFnUpv/+RGj9dCO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D8ksmjjz.js"><link nonce="" integrity="sha384-PvErhVuPH41hvqTZ49vsoFCpIC/z4slDP48GmOyo1IxCgXgMmhZYcqWmXvxmDdE1" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BnA2AwGF.js"><link nonce="" integrity="sha384-ML7907U1uYAjBfEawIa16NlkvQLFs4sBc0O+ZsHqG36bs2G6qYgIBKOtB3fbDcm3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/mB6xp2LS.js"><link nonce="" integrity="sha384-obBf3ueJAL8aoDGeHfEgrAtpJ3qVSgFbWLFfi8i9I1zn7Fh9bL6xCWKRkSAsBPpf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DOnqS9Sz.js"><link nonce="" integrity="sha384-ozfcbqESKh4t4toPRMlI7E/LSfwducV89LLckOM/iIRj/4KZI3Wvkzv1IIlXs4/c" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUutWmwC.js"><link nonce="" integrity="sha384-WlWOhcPtQ/Kad84KA6wzn0gQeGRjnbnHA6YbAmrjb3x1h3Z2xgzDQn6hhPZNCoTd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CYc7oDxg.js"><link nonce="" integrity="sha384-mrDm7dap5ABkEwphhcEecvmbqNbeRsvBYymtq9QRTG7VpTjjYlz8cKc81RROUeFA" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/iModbmJm.js"><link nonce="" integrity="sha384-p4j3LmYqWA9vFZi8KI2yZhEabBARpNL/Oi3nVD0aXbx96P85FplA/9FgQDD2BLdP" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BttOikXX.js"><link nonce="" integrity="sha384-l/XpZEHaHpHdyvYueKCjFu/1G9Azm0MCiXUSR+fyOtckk4NeLZF8k6zYCoBVDUUg" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUFPZS4.js"><link nonce="" integrity="sha384-Av0300jLea50veBs6pE41xEXCjESbAfDNYm2yxz8d97vI9SoWmI0Hcp+uma/jcX+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4i9E6T8.js"><link nonce="" integrity="sha384-Kt/+bu7AOzFl0uwSyv3X04YhXDK4jzHtjffPy2aGEnk/FoJB9cOsHGnPwPSskKMh" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bv083VCc.js"><link nonce="" integrity="sha384-r/TOwaK7QKJSt/5vwLwCOITevVrg2DX1lGIdwdfBFVrN7yuzTWlORu7/uf2dJC9y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B57yXAr8.js"><link nonce="" integrity="sha384-0N5RM4kElInS4Fp1qFMxOc4OF69GD5JOJhCTDN1uFON4zETYzLPQhMF0kskTRzMM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bg33dJBS.js"><link nonce="" integrity="sha384-u3VmYVbrqSkrQNLkzFveD/vvLINNY0yl3cddefGwPydaEYiUQCs1uV/KRVUjPTa8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQwRZosE.js"><link nonce="" integrity="sha384-fH3nLz2uDngAE48/eCpdZrqWvpG0xiHSwlUR8aF2ihSqvqmN4OmDS/TVNCNTWnqR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CArlX-cu.js"><link nonce="" integrity="sha384-u74iMlKyC0kRP5BMHYNGkp5S9orN2/gCeJgj5aZX1XDbtHuAdZFrU8qFOFz/eNLm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DZyGvdVe.js"><link nonce="" integrity="sha384-GS5VYkWxfL4u4MdDC6Qo0DGKGF+lrWyOqK9ZJe2lisyIa7Svve0Ttt78PZZTwqY3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDKlkuys.js"><link nonce="" integrity="sha384-y80+/9hrjJwiVyHBE8AWXREf/wof34st0opT/h4kvDrEb2laljm3R8wJKQseme/J" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1LkmMtl7.js"><link nonce="" integrity="sha384-9c95hdmG6ReSHzePMhSkOHTJSopHenH0otWJ8vMBjpF9X3CPHtYIcbCAQTX8PdOl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/xOp4NLFu.js"><link nonce="" integrity="sha384-gMSBshNkqG1tBeB+L2gKaoY4oMW4+hYd4oWv9iLWHw9xBx0xV1OUHKMirXddsFRw" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BioJOeeE.js"><link nonce="" integrity="sha384-MwA0Sdu4AakDulpLReqjqw1RIa5qrB2TUqLJo+Db5G6CvTRTTDx4a8tEaOdSVNLx" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHPsZYYG.js"><link nonce="" integrity="sha384-0L2Td2nqsSLt4fMliUjq+dvceWfLxnsNNeggJgFL+z1RP6q2lY3dIpBRDM2ObZAH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CQUe4kzL.js"><link nonce="" integrity="sha384-53XwglVJLtGDmmynrYM9rgyETBLrmhyLZ7rrMhSo2SBjK3WgMof9cVczfk/F/Jzl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BXoysCvc.js"><link nonce="" integrity="sha384-gzXIriZQL0YJn1tbOutH7KABTCI37AxDXpfsDegtUpa5c156iQBTuhrfNROu5Thk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/bVVUK1Up.js"><link nonce="" integrity="sha384-NbmkXIRw/iEsysuJXcicjZ+p6w1q/BKa/sqxFk9dzfKtkUVNHl2dlWdzjczq3hQJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ChpWfMYt.js"><link nonce="" integrity="sha384-MiEIX+8nvVcF4/C2AnakM/xZVOSZUwgp9sX3M0dp9xuVHHHrJlv91nJQRgHk0Quv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/csMlMc7I.js"><link nonce="" integrity="sha384-svAxaky+wOkSm0FK3/zqjV14+w8HlkJNStl5PbW1q/6YLYNXa3TVQlNdyRs25Pg0" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7GKAtGK.js"><link nonce="" integrity="sha384-jWKAGfP+O3ErHtWOlwouqobnwxC2DN29v588eTZITOrTc2R01ngtrouBsqVdbCT7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BL7qTDAr.js"><link nonce="" integrity="sha384-4pI+RYdvJhid05b/siB7KHnNxZlPTOdPojDRfnbIxjZho/sWNJcNQ1SNb5Qjo3I9" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CK0M71lT.js"><link nonce="" integrity="sha384-0+pxV72C5SbjyQwCXwgd4DF8SkZtG84RqBISsq7+Ml6e6P5t2g9o94DWGpB0Oy0b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/c4uxQ8Wc.js"><link nonce="" integrity="sha384-1oAGdh3Ob3DhjeaIvvoAMwPn11xKR5BGJKypl8udvI7FxRd5094e7LiGBU+AXQNc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DAsZ60qF.js"><link nonce="" integrity="sha384-B9ZNtOQnOJzP0adjSA7vD9KFGE8wq8Az8dT/U/qpIgJb/YyEYs6uz2CgKvr2PUoX" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUAqYmp4.js"><link nonce="" integrity="sha384-pe7HW9XccXxhUCVvMVOXq3zlfWNDJ8M1xHyOt/JxJgJmlR0CXQ6TyVUa8J0WQabY" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DQyuHP0A.js"><link nonce="" integrity="sha384-4wAUkozzIJ0JmwD1ZWcwBO3VV7yJaa/KFi+K84/CamYjheklx4BVD8U8q8BtGJRe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D6_gAmFJ.js"><link nonce="" integrity="sha384-j+AUYc7gZxlxcek5ud0DEYE8my+mwN+Q+N4Dz4yL+oXAeag33srrntaaKZzvhKnQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BSBUAEYG.js"><link nonce="" integrity="sha384-FTHPQttPFF935jU0Dnu/R56VxY4WBQgpU2LGNNDf92i3nank9Q5S7x0bLH1PaLft" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/lTI5I4yu.js"><link nonce="" integrity="sha384-16L8vZm+5D4i9uhUuw6JV1TqCb9BMniQikxfKnswEUlRtfwDol+s4uqDhaZXwny2" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/91A8zhHS.js"><link nonce="" integrity="sha384-f+e1FVNE/T2lDce76NJMfxcdawJLbJnxqwGE8hcbh294/PD2/w5Ic3KQhSaNEleM" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkeRmi07.js"><link nonce="" integrity="sha384-Q2DxEGTJ8Qr8IWjOnEEarTzTz8gde4A/QHCSgTH3rWp5dsGATv7Scyjkhy7ULO3K" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/UbdPEwEM.js"><link nonce="" integrity="sha384-qfRcPAxqaf0zA/FjgoER7vbIrE7mKhDttRFftIiUGQpYjDdPRSBKwCgFcrcAzDni" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DuAV58dt.js"><link nonce="" integrity="sha384-kQvyEBtLdEc9VGMkIeoQTjia1w52BsUjOJOYQhO4IcjAiViZDvVuQppZBRTqH6so" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BtTtLD25.js"><link nonce="" integrity="sha384-I039ANJGHhr2CaXH4icET/UUPslTqPGKPSOSoyofSjqe6+kwX8LAdMPMrVjkYrPH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CUCNVA8S.js"><link nonce="" integrity="sha384-N1WfKiEg3SzR9CdokLFytZKVFw0H9QQCVqRyJABaCEAs5CF4oufjdkW9IgG+YoCf" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CvNiyATc.js"><link nonce="" integrity="sha384-Nmn6sUp07EnvYHCFN+bm3FSRVXMCEptrev8HKT04oml9cqtToSvJbrZa587R6Jwb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B5MQNTTm.js"><link nonce="" integrity="sha384-lKen8cvcDypP/BHrDug0k6q7J8SZJeaXgkUHjMjsguHHEFpwkiGYT1OhbXnethxH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4GYs45G9.js"><link nonce="" integrity="sha384-Ag2b5l4eEdsPCf7PE351pdvuMKZoAl2xcMge7HTtClEW6Y/izToOCEUSitNE2G0O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3oipLbd9.js"><link nonce="" integrity="sha384-gKkSnsBfMx5E3ar0WuTrpQkwVTJ/xlB3mCvlZvaxovj/RFWY82iBUBMnBhmMYWdk" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/m68L2hpN.js"><link nonce="" integrity="sha384-rkv14JDYlXj9BOiAfZaprkgZxm/Svqudu1oS7XH2J9epB768Yl/3zi4ob/iKWKym" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C5V8Z8ce.js"><link nonce="" integrity="sha384-C+9gFHof4xuWApmZD1yxSrq3zSFoAfCSJ7GdAqhtTlnwokHdyo/RUdleazn2uUBU" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/ctsQ0uQd.js"><link nonce="" integrity="sha384-6tGyJ7ePyQ9JREwDJFMygzTwMd3wV8grp9oPlS9f/f1eN55FC53MZQTJ5AfrnQk3" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CukEpSyf.js"><link nonce="" integrity="sha384-73mTlv6HnG9Y/nbl0pGyJZFeOvmZSPbu+1me5Mne55cH/oo55VPSkVNTAdt/S4dn" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0Gi0Wkx.js"><link nonce="" integrity="sha384-E/lIGMB3s8lSmW1Wb/y2n/Xeh8yv8M/bycUj4DFXJIUCtLirrzQjYAvrr0cPGR4v" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ct22R-2H.js"><link nonce="" integrity="sha384-HyGGNaFK3pSrLQbrCgicHYpnukgAQRnDKB0DsuokPeKmwta157YZJprLDc9ghWyt" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cw8bpxEW.js"><link nonce="" integrity="sha384-hbTX8CKF7jYJP0G/fLUHf6Den+wClgVnJM1tYFtts3mz+w8q91kwvb63K+slJYPm" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BUWl0FAQ.js"><link nonce="" integrity="sha384-ajwUaldUJ12nDzWlFnlolk74utt0j8jJqaMTyAkzRI4MV1e4V2dGQQoabzLyE8Xe" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9dB82Sf.js"><link nonce="" integrity="sha384-NBfcaWnmGwIH21ubW2vAcjF5699xmBnT3JrjgLtznuxJo9CV0BleGMglS1rDKfyR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/X_eaGsVb.js"><link nonce="" integrity="sha384-h5b/dAqAQnOmyK0J7Vl3n449/pgGKSEVcqhv2SdhBz1ubaugKj7Ma97Nqb2DXIEc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D4qSbAf1.js"><link nonce="" integrity="sha384-Za9VTnFnNXdDtfx8qy++/h46z9Q8Jws8W3x5v9jOAxh+6EiKNw6DLPuuqZGnPBFl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C54he5AG.js"><link nonce="" integrity="sha384-CVqcfYSVKDtGTSEQ43quuif5kNqhnHhBpbUB8cXrZ9XY45Lw7b9Fpm1XjVnQIBXi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dfjlac11.js"><link nonce="" integrity="sha384-lXI1SLhL09RmXzya8PN1uIOpbeLOUMZ6NRszs0Ei2Ntq0QMx1Dtp7vtZwND57Fjb" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BHRJrsMd.js"><link nonce="" integrity="sha384-p3t8bYj/Hb0MfjRxSxTVT3ovtJYHYJpNPl9pLF9ZR7TsXzJthhqJnBokc3sonzUL" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CLdKaltm.js"><link nonce="" integrity="sha384-WWKOB22oIiKi5I2OAXMQHZvQGDu0ovNny41vF0l4CE7v1XVyrnWC7qJHtcZ/IgSS" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BQOI21vo.js"><link nonce="" integrity="sha384-68SI/6ff1AXkeHD7fvD6HrZ4dVe0xaR9VHWFPFZD/uWGZ49pd2beFXIJsAMJr5o+" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqhnfTvz.js"><link nonce="" integrity="sha384-WZ5pik+7iVzN8oC3Y6RQG7ykH7JWlg+LnbNtCJuIgr0SDvTrcNYt94c3oKm89tU8" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DSbDmzAv.js"><link nonce="" integrity="sha384-6vY3TSy/Jbx4OzC1mO+pTJFKXG5FsZoX5U9pKycyll2vzak4TaVhz3DJEuKwpLRF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdSWIcVP.js"><link nonce="" integrity="sha384-/RmA7E98f7Q+6zOjyOE/ULDtygrXc/5K2AOI63oUjHAthpiOMd+llFdIZM+w25yC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CMBSaFfM.js"><link nonce="" integrity="sha384-ZBrMqdnfEdCkyyr7sKgzP5miIfpBq3c5XQvM1BXGyTo7SH4zallfB+4uxSClt8bo" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B7uvIniN.js"><link nonce="" integrity="sha384-UD9yC2AzbDdD5EK1l9Mi59WZoGGYcyprdctRDEEkzv3ZSjNThlQvozKYNZuIsbSd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/B8VfGPME.js"><link nonce="" integrity="sha384-KdUIrGSVNZI3k3A9OXg9Qiq9DO7CACohQnp26o19gGJlijOSgUwjfEbDqUe9OMEJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DdAcxpHr.js"><link nonce="" integrity="sha384-TR45iesdfuTCrAoS6OxSaJTVi+OQWD0mM/PKB2g7vrV8xHJ47GlcGoY0YduedI38" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp3dZx8A.js"><link nonce="" integrity="sha384-nOA2SAWnorgZE/YX8hKE6WZILbbK3iGh5o5j2evHngy3atd0PpBbO3INKw47qiaR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DbHZS3kB.js"><link nonce="" integrity="sha384-RM/Mo1ghfGkllOi+CDGLnd20DWVN1t08mtTcwNUiXBEJRjpZkQtDRx/jVXtJz41Y" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwRp0Xpq.js"><link nonce="" integrity="sha384-RyM4rUhyBSz8fmPFNbPomNhEGNVOzjIOLiaXC4Ko2qfim2oQsUxgSF5Ph2aIRqlG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bp1_D2AQ.js"><link nonce="" integrity="sha384-lBee+EBxJwlQT/EIkkt/pTv4vAQOc0fgN5o5eYkpq9gdj9noR5zDkusN3ShaWaF5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/9AJ66TUp.js"><link nonce="" integrity="sha384-vRjC9eer2LRI5TZCe1KoMcxRls7jex5ZFTsZ8MolJE1t7J7JVgbbbDulHcGIldMB" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CEXEj78B.js"><link nonce="" integrity="sha384-GIbFX+zhMJCEH4XGvK7kQyWHeRgqwPN1WYH9cBaw+k8RSsY9HxSg153f0yqDf/Ax" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CRfmA1bm.js"><link nonce="" integrity="sha384-mirQ9xkJWaO21ywpuWop5HjFICi9zbBXBKWFO3UK5YfsCSSehmyHqf4oZVWQqsID" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BZIEhpEc.js"><link nonce="" integrity="sha384-ZS0dy5T81natV7R6Dk5VaYA2d5MlO4t0nPsBc5NZh+R5t4Vbdx8QCONwl3Z7GDJQ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/6INMPEbM.js"><link nonce="" integrity="sha384-Hk6ffNtPiGoxfI8TygjqdFsxfFzqEojGwc/bGLgoLpAkbU2dGn4aFOTdHmsF/tTv" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BiHU9HLl.js"><link nonce="" integrity="sha384-VB229iY445N1sGEQKoH4OhWJJorS/KVSits7FB+9fCBfjVkYDrceq435k4P/wIjI" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D54rIIIu.js"><link nonce="" integrity="sha384-/NzF5r7B5Dd9FZj2VNaIuUf10brer8kf1ljNa8vxn96g7ELxSkQUU6OB5BSA14xl" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/_DUMccsq.js"><link nonce="" integrity="sha384-6RpWbACR1dR1X7lSttskfK8FjGSyc0vdg96WfBK+gn30b9+6pazk5ECO0XvxHMBF" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CwXlw7iE.js"><link nonce="" integrity="sha384-YEMzifEwiJDrTS+mZ8hRwFwDa9JRLZwCu8jNct/772Gz16vMt0IuCII9JLrUy45b" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/KpUMbPIU.js"><link nonce="" integrity="sha384-/qMPJ8gBan0mMr3YZ5j73nUXWbZcvlhzMBqC0s02HA33Er86ElDUEbyXHCHhsaM7" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/O5G_pKvf.js"><link nonce="" integrity="sha384-P+EqG43aviqK4615K2MQKC1g5znE1pq/eZuAsbh3ZIgRjCWM22s+4kgKYbw3GaAc" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BmSZo5vd.js"><link nonce="" integrity="sha384-vz7JjgW2QWGQncY16HiNPYbLYQ+OKtUb5KNndUdhuJw4j/5OrjTMCXQOuctsCP/s" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CqKT32sS.js"><link nonce="" integrity="sha384-9RFXdF3e3K3vvdvkDo9c/yTeofhQZot5z25S1RN+Gmd6uku2vAhs2PTN1Z15ttpO" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CVIvuSKk.js"><link nonce="" integrity="sha384-n0vfE37Xgk0xpViNLpNToKUiZ7I246oSVD3z0aUq+8u1upLNRhCTOuhKkPeV7UdH" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/yV0BN1R6.js"><link nonce="" integrity="sha384-hD3pihvQqvqOb47clwfGM7eoP30EGCxJA8mKCiPLx1iIGLnt/Jj0nJbDldzbdhe5" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DwLVdadC.js"><link nonce="" integrity="sha384-onBDVMoGwRE3QRfuzFk7cP7dUqrPv6fClKp0ZBgbBIHdiCztqd3MiVEkF8Kx2USa" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/1_iL_gOK.js"><link nonce="" integrity="sha384-4JErMhMwN9S+EdU+QgZJzIlMhxCePhDvuitEv+BAwMEfUXGh2ZmhItHg6LYCTlIC" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DDrhJvbN.js"><link nonce="" integrity="sha384-+mbTzQrAM16+5gzKhruDRbvkgzrWryRjppDLh3QORGSvAMtoFwNFY4SVnGcPIWxi" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CdgWLbM0.js"><link nonce="" integrity="sha384-8RFJigfxYGzVgxWTW2gy45MzjdX190pIR9DLZlr/+cIgm4WKj5QtEtMI3ZKn8SsN" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C9xFUvHG.js"><link nonce="" integrity="sha384-NhF4xsrG33Hrmoyk0CtdRHWVv5kuNSXCmoaxIiALakeXaeXpiAr3xrIcNMZMa082" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ajydhuh8.js"><link nonce="" integrity="sha384-w++Jp76+dXZEGKN3ApKy8R4s6Zclm1L+60MWfMkYKu1lSjOQ3E4GmzgXuQidTOaG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/W7wjYkEu.js"><link nonce="" integrity="sha384-cZ/Tz5zzHCOCUuJEGiqP1GPVQAEDCVhznrO/05dCFh4sBdXf8Vrwq61VUyRjGX6C" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BFQR5dwQ.js"><link nonce="" integrity="sha384-h/1ej+nEzHZyUTfGxz1GJ9y2bcEZAZ7aj7KXLaWnzA2v1yuPXAJnbJ/htYw3jg/O" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BGlOD76I.js"><link nonce="" integrity="sha384-1MYNPSB37FmA6FdFj077+wWfewzVbTpTR38q0rpWUoxDaqYBZ//322fFFzvDBozK" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C7L-Qewe.js"><link nonce="" integrity="sha384-/h2WZsDQgkoa7UZm/WayhkhqEod4IvIrmVY92WHHwcnpksYuurXZ5mnAkh/kpvjd" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DRoURJIp.js"><link nonce="" integrity="sha384-z7e7yUXQAueL7WeJPCaj0rMxioMrr9TNZXplqJCaL3WhmIMAQgePZfyLFq4pZqcJ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C0vOX3wI.js"><link nonce="" integrity="sha384-s7UennnA5+uKAXflJQSOiBFQyIuyesh7AMB9UevZ/tjSKbYxYRCDt0BVDI7nG/ZR" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BACt5QkB.js"><link nonce="" integrity="sha384-enuNAZc5uQxVc+Wi9HoS2wrqZ8AMvxq+MsAo0Q+nli3WKKMt5R8oDcZee7O5N3Ch" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/EsYxSuUn.js"><link nonce="" integrity="sha384-ijeWYzm10n+O+h47muVibKFhyxzTB5Lo+2bXVOgyJ992mRj3HWrKlCMTU4cid++L" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/TfVQFkXD.js"><link nonce="" integrity="sha384-fYZWSwq465LUeZBu+yR0gIqFWxVYMJkeADsDLAxHQi5iGoN4SU7i9tYfqjlqv3GG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Cwv0wPrA.js"><link nonce="" integrity="sha384-dmAK1hhiumNXMs/NjWqR1YxMm3vyiMg16sggZx3HjlYKju1wCeiJzsSNr9NEW6TG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddhl0Rna.js"><link nonce="" integrity="sha384-LHr9km/b9aujaROdMqpErXj2bbnZRPOSioFSLi5HEVZSRbpzxAEYzr8rKzs1LelZ" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DzRmAYvD.js"><link nonce="" integrity="sha384-jGINj1ShftWKDI7S23mVZ+L6D2f9piqFpjk0Pzqu1vUKQJ4qE55dJD6e7E5C0bPG" rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BBTDB2dI.js"><script nonce="" integrity="sha384-K18nopic+X0JunSv2KJqsE7W6KB015nwBWeFR+Jh5SQtvXW7Yy4WjDfxnYjG/Q6g" type="module" src="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/A538-Xd4.js" crossorigin=""></script><meta name="description" content="In this tutorial, you’ll learn how to store and update data inside the kernel, turning a simple eBPF Hello World program into one that tracks useful state. We’ll also briefly learn a few basics of bpftool, a handy CLI tool that will allow us to list and inspect our eBPF map."><link nonce="" rel="icon" type="image/png" href="https://labs.iximiuz.com/favicon.ico"><link nonce="" rel="apple-touch-icon" type="image/png" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/logo.webp"><meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1"><meta name="title" content="Storing Data in eBPF: Your First eBPF Map | iximiuz Labs"><meta name="keywords" content="eBPF"><meta name="author" content="Teodor Janez Podobnik"><meta property="og:type" content="article"><meta property="og:title" content="Storing Data in eBPF: Your First eBPF Map | iximiuz Labs"><meta property="og:description" content="In this tutorial, you’ll learn how to store and update data inside the kernel, turning a simple eBPF Hello World program into one that tracks useful state. We’ll also briefly learn a few basics of bpftool, a handy CLI tool that will allow us to list and inspect our eBPF map."><meta property="og:url" content="https://labs.iximiuz.com/tutorials/ebpf-maps-tutorial-3efd4617"><meta property="og:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-maps-tutorial-3efd4617/__static__/maps.png"><meta property="og:site_name" content="iximiuz Labs"><meta name="twitter:dnt" content="on"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:creator" content="@iximiuz"><meta name="twitter:title" content="Storing Data in eBPF: Your First eBPF Map | iximiuz Labs"><meta name="twitter:description" content="In this tutorial, you’ll learn how to store and update data inside the kernel, turning a simple eBPF Hello World program into one that tracks useful state. We’ll also briefly learn a few basics of bpftool, a handy CLI tool that will allow us to list and inspect our eBPF map."><meta name="twitter:image" content="https://labs.iximiuz.com/content/files/tutorials/ebpf-maps-tutorial-3efd4617/__static__/maps.png"><link nonce="" rel="canonical" href="https://labs.iximiuz.com/tutorials/ebpf-maps-tutorial-3efd4617"><link nonce="" rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-maps-tutorial-3efd4617/__static__/maps.png"><style>:is([id*='google_ads_iframe'],[id*='taboola-'],.taboolaHeight,.taboola-placeholder,#top-ad,#credential_picker_container,#credentials-picker-container,#credential_picker_iframe,[id*='google-one-tap-iframe'],#google-one-tap-popup-container,.google-one-tap__module,.google-one-tap-modal-div,#amp_floatingAdDiv,#ez-content-blocker-container) {display:none!important;min-height:0!important;height:0!important;}</style><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/SiteHeaderContent.DrFmd9xY.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ContentTable.ChTBbrAh.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ContentMetaFoot.DFr8HVAl.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ContentBox.rEdLfu6t.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/PlayBoxContentTab.CDHpeXMx.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/_name_.BsyFxT4E.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseP.DVN8_MMS.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseCodeInline.BhuXSD4-.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseA.CGc139Ky.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseH2.BDlwlsRA.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseUl.5leepCZD.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseLi.BqrAa653.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseStrong.DAaF5VAD.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseCodeCopyButton.dhGBryGn.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseCode.CdJo3ouR.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProsePre.B_fgAJq0.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/DetailsBox.3wfYThLq.css"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ProseHr.BdCZvnSy.css"><link rel="preconnect" href="https://plausible.io/"><link rel="image_src" href="https://labs.iximiuz.com/content/files/tutorials/ebpf-maps-tutorial-3efd4617/__static__/maps.png"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/3yJMaxvi.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C8wdN3Ik.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Bq0UkCYT.js"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/SiteHeaderDefault.CQ-9yJ45.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/GriQ8B2M.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CrYjDOdC.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CXxrP7zL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DUA4yL51.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/MTJvKNbD.js"><link rel="stylesheet" crossorigin="" href="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/AuthorProfileCard.B2bdkgLl.css"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D5PaCUAZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/C4h4q3zH.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dg959Yt1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CJ7oOdLD.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Hmopn4U9.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dv2DOayU.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/4J4r8vMm.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CAUMgW0h.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/QwXPddex.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/InMlYjVK.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dzr_TBnN.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BWu6ZW-1.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/8O-YeDGZ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ch3sV4Nw.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Jz7gehop.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CreFxVwq.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/djRO7Jx5.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Dx5dmUye.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/OfFSSdU4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BDLepdqL.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DF8Kb1Fe.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DGl8mbvI.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BkPnT0P4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/D9IPNEg4.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/CSKsp-sX.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BLGyX_7H.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/sTy7mATY.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/5aprXXgQ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/BEhoFAvJ.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/DNFnU2Va.js"><link rel="modulepreload" as="script" crossorigin="" href="https://labs.iximiuz.com/_nuxt/Ddtg1Dbv.js"></head><body><div id="__nuxt"><div class="bg-[length:100%_250px] bg-fixed bg-gradient-to-b bg-mist bg-no-repeat from-[#a6d7f7] min-w-[300px]"><!--[--><div data-v-0d30d5a9=""><header id="site-header" class="bg-base-100 border-b-[1px] border-base-content/40 flex min-h-[3rem] sticky top-0 z-50" data-v-0d30d5a9="" data-v-7f8ed6a6=""><nav class="flex grow items-center justify-between min-w-0 mx-auto px-2 sm:px-4 text-primary-content" data-v-7f8ed6a6=""><div data-headlessui-state="" class="mr-2 relative self-center shrink-0 sm:mr-4" data-v-7f8ed6a6=""><div><button id="button-header-nav-menu-left" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state="" class="flex items-center rounded-full text-primary-content text-sm"><img class="align-text-bottom h-6 inline mr-1 w-auto" src="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/logo.webp" alt="iximiuz Labs"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-4 hover:opacity-100 hover:scale-110 opacity-70 w-4"><path stroke-linecap="round" stroke-linejoin="round" d="m19.5 8.25-7.5 7.5-7.5-7.5"></path></svg></button></div><!----></div><div class="flex grow min-w-0" data-v-7f8ed6a6=""><div class="flex flex-col min-w-0 mr-5" data-v-7f8ed6a6=""><div class="flex gap-1 items-center" data-v-7f8ed6a6=""><!--[--><a aria-current="page" href="https://labs.iximiuz.com/tutorials/ebpf-maps-tutorial-3efd4617" class="router-link-active router-link-exact-active font-semibold text-md truncate" title="Storing Data in eBPF: Your First eBPF Map" data-v-7f8ed6a6=""><h1 class="truncate" data-v-7f8ed6a6="">Storing Data in eBPF: Your First eBPF Map</h1></a><!--]--><!--[--><!--]--></div><span title="Teodor Janez Podobnik" class="text-base-content/85 text-xs truncate" data-v-7f8ed6a6="">Tutorial by <!--[--><!--[--><a href="https://labs.iximiuz.com/a/teodor-janez-podobnik" class="hover:underline decoration-dotted" title="Teodor Janez Podobnik">Teodor Janez Podobnik</a><!----><!----><!--]--><!--]--></span></div></div><!--[--><div class="flex gap-x-3 items-center shrink-0" data-v-0d30d5a9=""><!----><!----><!----><!----></div><!--]--><div class="flex items-center ml-2 shrink-0 sm:ml-3" data-v-7f8ed6a6=""><!--[--><a href="https://labs.iximiuz.com/signin?return_to=%2Ftutorials%2Febpf-maps-tutorial-3efd4617" class="leading-6 ml-3 mr-4 shrink-0 text-base"> Sign in </a><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-maps-tutorial-3efd4617" class="bg-base-100 border border-primary-content leading-6 px-1.5 rounded-md shrink-0 text-base"> Sign up </a><!--]--></div></nav></header><div class="hidden bg-gradient-to-b flex flex-col from-base-200 gap-y-2 max-h-96 overflow-y-auto p-4 scrollbar-styled to-transparent w-full z-[999999] fixed" data-v-0d30d5a9=""><!--[--><!--]--></div><div class="flex justify-center relative" data-v-0d30d5a9=""><div class="hidden lg:flex lg:h-[calc(100vh-3rem)] lg:sticky lg:top-[3rem] shrink-0 transition-all"><!--[--><div class="duration-300 ease-in-out flex flex-col mb-[3px] mt-1.5 overflow-hidden relative transition-all bg-base-100 border border-slate-400 rounded-lg w-[320px] ml-1.5" data-v-0d30d5a9=""><div class="absolute left-0 right-0 top-0 cursor-pointer flex group h-8 items-center"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="group-hover:opacity-100 mr-2 opacity-60 stroke-[2.5px] ml-auto h-3 w-3"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5 8.25 12l7.5-7.5"></path></svg></div><div class="flex flex-col min-h-0 overflow-hidden pl-3 pr-0 pt-2 pt-3" style="" data-v-c294bba9=""><h3 class="flex mb-3 text-[0.875rem] text-base-content/80 text-nowrap tracking-tight" data-v-c294bba9=""> Table of contents <!----></h3><div class="flex-1 mb-3 min-h-0 relative" data-v-c294bba9=""><nav class="h-full overflow-y-auto pr-2 scrollbar-styled" data-v-c294bba9=""><ul data-v-c294bba9=""><!--[--><li data-v-c294bba9=""><a href="#storing-state-in-ebpf-maps" class="block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors pl-4 border-slate-500 !text-base-content/100" data-v-c294bba9="">Storing State in eBPF Maps</a><!----></li><li data-v-c294bba9=""><a href="#building-and-running-the-ebpf-application" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">Building and Running the eBPF Application</a><!----></li><li data-v-c294bba9=""><a href="#inspecting-the-ebpf-map" class="pl-4 border-slate-200 block border-l-[3px] duration-150 hover:bg-mist no-underline px-2 py-1.5 rounded rounded-l-none text-[0.85rem] text-base-content/80 transition-colors" data-v-c294bba9="">Inspecting the eBPF Map</a><!----></li><!--]--></ul></nav><!----></div></div><div class="bg-[#a6d7f7]/70 border-slate-400 border-t mt-auto p-2 py-4" style=""><div class="flex items-center justify-center"><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-maps-tutorial-3efd4617" class="btn bg-base-100 btn-outline btn-sm" role="button"><!--[--> Start tutorial <!--]--></a></div></div><div class="flex flex-col gap-y-5 !gap-y-4 border-slate-400 border-t px-4 py-5" style="" data-v-6adfc778=""><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Tutorial on&nbsp;</span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Linux</a><!--]--><!--[--><span data-v-6adfc778="">,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778="">Programming</a><!--]--><!--]--></div><div class="flex flex-wrap items-center" data-v-6adfc778=""><span class="font-semibold" data-v-6adfc778="">Discussion&nbsp;</span><a href="https://discord.gg/p6nxaHm46p" rel="noopener noreferrer" target="_blank noopener noreferrer" class="font-normal hover:opacity-100 hover:underline no-underline opacity-80" data-v-6adfc778=""> Discord <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1em] inline pb-[3px] stroke-[2px] w-[1em]" data-v-6adfc778=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a></div><div class="flex flex-wrap gap-y-2 items-center mt-1" data-v-6adfc778=""><!--[--><a href="https://labs.iximiuz.com/tutorials?tag=eBPF" class="bg-mist cursor-pointer duration-200 ease-in-out font-medium hover:bg-slate-200 hover:text-gray-800 inline-flex items-center min-w-0 no-underline py-0.5 rounded-md text-gray-600 transition-all px-2.5 text-sm mx-1 not-prose" title="#eBPF" data-v-6adfc778=""><span class="truncate">eBPF</span></a><!--]--></div></div></div><!--]--></div><div class="flex lg:basis-[950px] transition-[flex-basis] duration-300 ease-in-out grow justify-center lg:grow-0 lg:pb-[3px] min-h-[calc(100vh-3rem)] min-w-0 mx-auto overflow-hidden p-1.5 pb-14"><div class="w-full"><!--[--><article class="flex grow min-h-full min-w-0" data-v-0d30d5a9=""><meta itemprop="name" content="Storing Data in eBPF: Your First eBPF Map"><meta itemprop="abstract" content="In this tutorial, you’ll learn how to store and update data inside the kernel, turning a simple eBPF Hello World program into one that tracks useful state. We’ll also briefly learn a few basics of bpftool, a handy CLI tool that will allow us to list and inspect our eBPF map."><meta itemprop="dateCreated" content="2025-08-23T00:00:00.000Z"><meta itemprop="datePublished" content="2025-08-23T00:00:00.000Z"><meta itemprop="dateModified" content="2025-08-23T00:00:00.000Z"><!--[--><div class="flex flex-col grow min-h-full min-w-0" data-v-0d30d5a9="" data-v-200caef3=""><!--[--><!--]--><div class="bg-base-100 border-[1px] border-slate-400 flex flex-col grow overflow-hidden relative rounded-lg shadow-lg" data-v-200caef3=""><div class="px-4 md:px-8 xl:px-12" data-v-200caef3=""><!--[--><div class="flex flex-col mb-8" data-v-0d30d5a9=""><div class="-mx-4 bg-content-tutorial border-b-[1px] border-b-slate-400 flex flex-nowrap items-center md:-mx-8 min-w-0 px-3 py-1.5 rounded-t-lg text-primary-content/70 text-sm xl:-mx-12"><div class="group/content-icon relative cursor-help"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1.2em] mr-2 w-[1.2em]"><path stroke-linecap="round" stroke-linejoin="round" d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"></path></svg><div class="absolute bg-base-content duration-300 ease-in-out group-hover/content-icon:opacity-100 group-hover/content-icon:visible invisible left-0 mt-1 opacity-0 px-3 py-2 right-0 rounded-md text-slate-200 transition-all w-[20em] z-20">This tutorial was carefully crafted by an independent author and proudly hosted by iximiuz Labs.</div></div> Tutorial <span> &nbsp;on&nbsp; </span><!--[--><!--[--><!----><a href="https://labs.iximiuz.com/tutorials?category=linux" class="font-normal hover:underline no-underline truncate">Linux</a><!--]--><!--[--><span>,&nbsp;</span><a href="https://labs.iximiuz.com/tutorials?category=programming" class="font-normal hover:underline no-underline truncate">Programming</a><!--]--><!--]--><!--[--><span class="cursor-help hover:tooltip-open ml-auto pl-4 shrink-0 tooltip tooltip-left" data-tip="Published: Aug 23, 2025"><time datetime="createdAt"> Published: Aug 23, 2025</time></span><!--[--><button type="button" class="hidden lg:flex ml-2" title="Expand content to full width" data-v-0d30d5a9=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--material-symbols-light h-5 w-5" style="" width="1em" height="1em" viewBox="0 0 24 24"><path fill="currentColor" d="M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z"></path></svg></button><!--]--><!----><!--]--></div><!----></div><h1 class="tutorial-header" data-v-0d30d5a9="">Storing Data in eBPF: Your First eBPF Map</h1><!--]--></div><!----><!--[--><!--[--><div class="flex flex-col" data-v-200caef3=""><!----><div class="h-auto pb-5 px-4 md:px-8 xl:px-12 duration-200 ease-out max-w-full overflow-hidden prose relative transition-all" data-v-200caef3=""><div class="" data-v-200caef3=""><p class="prose-p" data-v-b025fb9f=""><!--[-->When you start the tutorial, you’ll see a <code class="prose-code-inline" data-v-a031129a=""><!--[-->Term 1<!--]--></code> terminal and an <code class="prose-code-inline" data-v-a031129a=""><!--[-->IDE<!--]--></code> on the right-hand side. You are logged in as <code class="prose-code-inline" data-v-a031129a=""><!--[-->laborant<!--]--></code>, and the current working directory already contains the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-hello-world<!--]--></code> folder. Inside, you’ll find the <a href="https://github.com/dorkamotorka/ebpf-hello-world" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->eBPF Hello World labs<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>, implemented with <a href="https://ebpf-go.dev/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->ebpf-go<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> — a Golang eBPF framework developed as part of the <a href="https://cilium.io/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->Cilium<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> project.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This tutorial serves as the continuation of <a href="https://labs.iximiuz.com/tutorials/my-first-ebpf-program-5120140e" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->From Zero to Your First eBPF Program<!--]--><!----></a>, expanding on the introduced concepts.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In
 this part, you’ll learn about eBPF Maps, which allow data to be 
persisted or shared between eBPF programs and user space services. To 
keep things straightforward, we’ll skip sending events to user space for
 now. Instead, we’ll focus on how to persist a state inside an eBPF 
program. Through a simple example, you’ll learn to use an eBPF map to 
store a counter that tracks how many times specific binary executables 
are triggered.<!--]--></p><h2 id="storing-state-in-ebpf-maps" class="prose-h2" data-v-b9b1576a=""><!--[-->Storing State in eBPF Maps<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->When you want to store a state in eBPF kernel program, there are several eBPF Map types you can choose from. Just to name a few:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Hash Map<!--]--></strong>: A generic key/value store where both keys and values can be of arbitrary types<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Array Map<!--]--></strong>: Similar to hash map, but key is always 32-bit unsigned integer<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Per-CPU Hash/Array Map<!--]--></strong>: Same as hash (and array) map, but each CPU gets its own copy of it<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->LRU Hash Map<!--]--></strong>: A hash map with Least Recently Used eviction policy, automatically removing old entries after being full<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->Ring Buffer<!--]--></strong>: Used for passing kernel events data from kernel space to user space<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->Which
 map type to use depends heavily on your specific use case. We’ll cover 
the design choices in another tutorial, but for our example, we’ll just 
use a <strong class="prose-strong" data-v-24022f14=""><!--[-->Hash Map<!--]--></strong>.<!--]--></p><div class="bg-base-100" style="padding:0;margin:30px auto;max-width:800px;"><div class="text-center"><img src="Storing%20Data%20in%20eBPF_%20Your%20First%20eBPF%20Map_files/ebpf-map2.webp" alt="Storing state in eBPF Applications" class="cursor-pointer m-0 max-w-full" style=""><!--[--><!--]--></div><!----></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Before we can use an eBPF map in our kernel program, we need to define it. Navigate to the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-hello-world/lab2<!--]--></code> folder with either using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->Term 1<!--]--></code> terminal or the <code class="prose-code-inline" data-v-a031129a=""><!--[-->IDE<!--]--></code>. Then, open the <code class="prose-code-inline" data-v-a031129a=""><!--[-->hello.c<!--]--></code> file.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Inside, add the following code lines and eBPF map definition (under Step 1):<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#C586C0">#define</span><span style="--shiki-default:#DCDCAA"> MAX_PATH</span><span style="--shiki-default:#B5CEA8"> 256
</span></span><span class="line" line="2"><span emptylineplaceholder="true">
</span></span><span class="line" line="3"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> path_key {
</span></span><span class="line" line="4"><span style="--shiki-default:#569CD6">    char</span><span style="--shiki-default:#9CDCFE"> path</span><span style="--shiki-default:#E6E6E6">[MAX_PATH];
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">};
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="8"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(type, BPF_MAP_TYPE_HASH);
</span></span><span class="line" line="9"><span style="--shiki-default:#DCDCAA">    __uint</span><span style="--shiki-default:#E6E6E6">(max_entries, </span><span style="--shiki-default:#B5CEA8">16384</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="10"><span style="--shiki-default:#DCDCAA">    __type</span><span style="--shiki-default:#E6E6E6">(key, </span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> path_key);
</span></span><span class="line" line="11"><span style="--shiki-default:#DCDCAA">    __type</span><span style="--shiki-default:#E6E6E6">(value, __u64);
</span></span><span class="line" line="12"><span style="--shiki-default:#E6E6E6">} exec_count </span><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">".maps"</span><span style="--shiki-default:#E6E6E6">);
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->As you can see in the code, our eBPF map stores key/value pairs, where:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->The <strong class="prose-strong" data-v-24022f14=""><!--[-->key<!--]--></strong> is a <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct path_key<!--]--></code>, which contains the binary execution path (e.g., <code class="prose-code-inline" data-v-a031129a=""><!--[-->/usr/bin/ls<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->/usr/bin/cat<!--]--></code>)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->The <strong class="prose-strong" data-v-24022f14=""><!--[-->value<!--]--></strong> is a <code class="prose-code-inline" data-v-a031129a=""><!--[-->__u64<!--]--></code> integer that counts how many times that binary has been executed (e.g., <code class="prose-code-inline" data-v-a031129a=""><!--[-->1<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->2<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->3<!--]--></code>, ...)<!--]--></li><!--]--></ul><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">What about `max_entries` parameter?</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->The <code class="prose-code-inline" data-v-a031129a=""><!--[-->max_entries<!--]--></code> field defines the upper bound on how many key/value pairs a map can hold.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In this example, we set it to <code class="prose-code-inline" data-v-a031129a=""><!--[-->16384<!--]--></code> but in practice, the value can range from just a few (e.g., <code class="prose-code-inline" data-v-a031129a=""><!--[-->1<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->128<!--]--></code>, <code class="prose-code-inline" data-v-a031129a=""><!--[-->1024<!--]--></code>) up to hundreds of thousands or even millions, depending on kernel configuration (<code class="prose-code-inline" data-v-a031129a=""><!--[-->ulimit<!--]--></code>, locked memory) and available RAM.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To avoid hitting the memory lock limit (<code class="prose-code-inline" data-v-a031129a=""><!--[-->RLIMIT_MEMLOCK<!--]--></code>), we include the following code in the user space program:<!--]--></p><!--[--><div class="highlight-go prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">main.go</span><!--[--><pre class="language-go shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D4D4D4">...
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">func</span><span style="--shiki-default:#DCDCAA"> main</span><span style="--shiki-default:#E6E6E6">() {
</span></span><span class="line" line="3"><span style="--shiki-default:#6A9955">    // By default (for Linux &lt; 5.11), Linux sets a RLIMIT_MEMLOCK (memory lock limit) that restricts how much memory a process can lock into RAM. 
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955">    // eBPF maps and programs use pinned memory that counts against this limit. 
</span></span><span class="line" line="5"><span style="--shiki-default:#6A9955">    // If you don’t raise or remove the limit, loading larger eBPF programs or maps will fail with errors like “operation not permitted” or “memory locked limit exceeded.”
</span></span><span class="line highlight" line="6"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#9CDCFE"> err</span><span style="--shiki-default:#D4D4D4"> :=</span><span style="--shiki-default:#9CDCFE"> rlimit</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">RemoveMemlock</span><span style="--shiki-default:#E6E6E6">(); </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#D4D4D4"> !=</span><span style="--shiki-default:#569CD6"> nil</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line highlight" line="7"><span style="--shiki-default:#9CDCFE">        log</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#DCDCAA">Fatal</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"Removing memlock:"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">err</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line highlight" line="8"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="9"><span style="--shiki-default:#D4D4D4">...
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->NOTE:<!--]--></strong> Starting with Linux v5.11, the <a href="https://docs.ebpf.io/linux/concepts/resource-limit/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->memory accounting and limiting was moved from rlimit to cGroups<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>. In other words, if the resource limits need to be raised, it should be done so with the <code class="prose-code-inline" data-v-a031129a=""><!--[-->memory.max<!--]--></code> setting on the cGroup.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Technically,
 this eBPF map could now be updated (store/read/delete key/value pairs) 
from any eBPF kernel or user space program, but in our case we just 
update it from our eBPF kernel function. And we do so by modifying our 
kernel program as such (under Step 2):<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"tracepoint/syscalls/sys_enter_execve"</span><span style="--shiki-default:#E6E6E6">)
</span></span><span class="line" line="2"><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#DCDCAA"> handle_execve_tp</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> trace_event_raw_sys_enter </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="3"><span style="--shiki-default:#6A9955">    // The eBPF program reads the first argument of the input context `struct trace_event_raw_sys_enter`, whose 
</span></span><span class="line" line="4"><span style="--shiki-default:#6A9955">    // values/parameters align with the execve() system call: https://man7.org/linux/man-pages/man2/execve.2.html
</span></span><span class="line" line="5"><span style="--shiki-default:#6A9955">    // You can also view this allignment using `sudo cat /sys/kernel/debug/tracing/events/syscalls/sys_enter_execve/format`
</span></span><span class="line" line="6"><span style="--shiki-default:#6A9955">    // * The first argument `ctx-&gt;args[0]` is `const char *pathname` -&gt; either a binary executable, or 
</span></span><span class="line" line="7"><span style="--shiki-default:#6A9955">    //   a script starting with a line of the form `#!interpreter [optional-arg]` (e.g. your bash scripts)
</span></span><span class="line" line="8"><span style="--shiki-default:#569CD6">    const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">filename </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> (</span><span style="--shiki-default:#569CD6">const</span><span style="--shiki-default:#569CD6"> char</span><span style="--shiki-default:#D4D4D4"> *</span><span style="--shiki-default:#E6E6E6">)</span><span style="--shiki-default:#9CDCFE">ctx</span><span style="--shiki-default:#E6E6E6">-&gt;</span><span style="--shiki-default:#9CDCFE">args</span><span style="--shiki-default:#E6E6E6">[</span><span style="--shiki-default:#B5CEA8">0</span><span style="--shiki-default:#E6E6E6">];
</span></span><span class="line" line="9"><span style="--shiki-default:#E6E6E6">    
</span></span><span class="line" line="10"><span style="--shiki-default:#6A9955">    // * The second argument `ctx-&gt;args[1]` is `char *const argv[]` -&gt; array of pointers to strings passed to the 
</span></span><span class="line" line="11"><span style="--shiki-default:#6A9955">    //   new program as its command-line arguments
</span></span><span class="line" line="12"><span emptylineplaceholder="true">
</span></span><span class="line" line="13"><span style="--shiki-default:#6A9955">    // * The third argument `ctx-&gt;args[2]` is `char *const envp[]` -&gt; array of pointers to strings, conventionally of 
</span></span><span class="line" line="14"><span style="--shiki-default:#6A9955">    //   the form key=value, which are passed as the environment of the new program (a.k.a. env variables)
</span></span><span class="line" line="15"><span emptylineplaceholder="true">
</span></span><span class="line" line="16"><span style="--shiki-default:#6A9955">    // Instantiate and store the first argument as our key of the eBPF map using `bpf_probe_read_user_str` which is a
</span></span><span class="line" line="17"><span style="--shiki-default:#6A9955">    // handy eBPF helper function, to copy a NULL terminated string from an (unsafe) user address
</span></span><span class="line" line="18"><span style="--shiki-default:#569CD6">    struct</span><span style="--shiki-default:#E6E6E6"> path_key key </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {};
</span></span><span class="line" line="19"><span style="--shiki-default:#569CD6">    long</span><span style="--shiki-default:#E6E6E6"> n </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_probe_read_user_str</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">path</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#569CD6">sizeof</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">path</span><span style="--shiki-default:#E6E6E6">), filename);
</span></span><span class="line" line="20"><span style="--shiki-default:#6A9955">    // Validate the copy operation was succesfull
</span></span><span class="line" line="21"><span style="--shiki-default:#6A9955">    // On success, the strictly positive length of the output string, including the trailing NULL character is returned. 
</span></span><span class="line" line="22"><span style="--shiki-default:#6A9955">    // On error, a negative value is returned.
</span></span><span class="line" line="23"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (n </span><span style="--shiki-default:#D4D4D4">&lt;=</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">) {
</span></span><span class="line" line="24"><span style="--shiki-default:#C586C0">        return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="25"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="26"><span emptylineplaceholder="true">
</span></span><span class="line" line="27"><span style="--shiki-default:#6A9955">    // Check whether this key (binary executable path) already exists in our map and 
</span></span><span class="line" line="28"><span style="--shiki-default:#E6E6E6">    __u64 </span><span style="--shiki-default:#D4D4D4">*</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#DCDCAA"> bpf_map_lookup_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">exec_count, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key);
</span></span><span class="line" line="29"><span style="--shiki-default:#C586C0">    if</span><span style="--shiki-default:#E6E6E6"> (val) {
</span></span><span class="line" line="30"><span style="--shiki-default:#6A9955">        // Update the value of the counter under that key we found in the map
</span></span><span class="line" line="31"><span style="--shiki-default:#6A9955">        // NOTE: this is not a safe way to update the value - we'll learn about atomic operations in the upcoming tutorial
</span></span><span class="line" line="32"><span style="--shiki-default:#D4D4D4">        *</span><span style="--shiki-default:#E6E6E6">val </span><span style="--shiki-default:#D4D4D4">+=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="33"><span style="--shiki-default:#E6E6E6">    } </span><span style="--shiki-default:#C586C0">else</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="34"><span style="--shiki-default:#6A9955">        // If this binary is executed for the first time since our eBPF application has been run, we just set the counter value to 1
</span></span><span class="line" line="35"><span style="--shiki-default:#E6E6E6">        __u64 init </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="36"><span style="--shiki-default:#DCDCAA">        bpf_map_update_elem</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">exec_count, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">key, </span><span style="--shiki-default:#D4D4D4">&amp;</span><span style="--shiki-default:#E6E6E6">init, BPF_NOEXIST);
</span></span><span class="line" line="37"><span style="--shiki-default:#E6E6E6">    }
</span></span><span class="line" line="38"><span emptylineplaceholder="true">
</span></span><span class="line" line="39"><span style="--shiki-default:#6A9955">    // Optional: print to debug
</span></span><span class="line" line="40"><span style="--shiki-default:#DCDCAA">    bpf_printk</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"execve: %s</span><span style="--shiki-default:#D7BA7D">\n</span><span style="--shiki-default:#CE9178">"</span><span style="--shiki-default:#E6E6E6">, </span><span style="--shiki-default:#9CDCFE">key</span><span style="--shiki-default:#E6E6E6">.</span><span style="--shiki-default:#9CDCFE">path</span><span style="--shiki-default:#E6E6E6">);
</span></span><span class="line" line="41"><span emptylineplaceholder="true">
</span></span><span class="line" line="42"><span style="--shiki-default:#C586C0">    return</span><span style="--shiki-default:#B5CEA8"> 0</span><span style="--shiki-default:#E6E6E6">;
</span></span><span class="line" line="43"><span style="--shiki-default:#E6E6E6">}
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->It might feel like a lot to take in at first, so we’ve added detailed comments to each line of code.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->The interesting lines of code, related to the eBPF map are:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_lookup_elem(map, key)<!--]--></code> - Looks up an element in the map by key and returns a pointer to the value in kernel space if it exists, or NULL if not found.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_update_elem(map, key, value, flags)<!--]--></code> - Inserts or updates a map entry. The <code class="prose-code-inline" data-v-a031129a=""><!--[-->flags<!--]--></code> parameter controls the update behavior:
<ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_ANY<!--]--></code>: create new or update existing<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_NOEXIST<!--]--></code>: create only if key doesn’t exist<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_EXIST<!--]--></code>: update only if key exists<!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">More information about eBPF map helpers</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Some other eBPF map helper functions that you’ll encounter in the wild:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_delete_elem(map, key)<!--]--></code> for deleting the map entry<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_lookup_and_delete_elem(map, key)<!--]--></code> for looking up and deleting the entry right after<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_push_elem(map, value, flags)<!--]--></code> for pushing an element into a Queue, Stack and Bloom filter eBPF Maps.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_pop_elem(map, value_out)<!--]--></code> for popping (removing) an element from a Queue and Stack eBPF Maps.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_map_peek_elem(map, value_out)<!--]--></code> for retrieving the top element from a Queue, Stack and Bloom filter eBPF Maps without removing it.<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->and others..<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->⚠️ Not all helpers are supported by every map type. For details, check the <a href="https://docs.ebpf.io/linux/map-type/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->official eBPF documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> to see which helpers are available for each map type.<!--]--></p><!--]--></details><!--]--></div><h2 id="building-and-running-the-ebpf-application" class="prose-h2" data-v-b9b1576a=""><!--[-->Building and Running the eBPF Application<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->With that behind us, we can now build and run our eBPF application, using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">cd</span><span style="--shiki-default:#CE9178"> ebpf-hello-world/lab2</span><span style="--shiki-default:#6A9955"> # Go inside the ebpf-hello-world/lab2 folder if you haven't already
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> generate
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">go</span><span style="--shiki-default:#CE9178"> build
</span></span><span class="line" line="4"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> ./lab2
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->If you looked closely at the code, you’ll must have seen that our eBPF program calls <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_printk()<!--]--></code>. This means we should get a log message each time a certain binary is executed.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->To view these logs, open the <strong class="prose-strong" data-v-24022f14=""><!--[-->Term 2<!--]--></strong> tab on the right (click the <code class="prose-code-inline" data-v-a031129a=""><!--[-->+<!--]--></code> at the top), and run:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> cat</span><span style="--shiki-default:#CE9178"> /sys/kernel/debug/tracing/trace_pipe
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->It's
 quite unlikely you won't see any logs. But this could be the case, 
since there is little going on in a small VM like ours, so let's execute
 some process ourself.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->Open the third <code class="prose-code-inline" data-v-a031129a=""><!--[-->Term 3<!--]--></code> tab, and execute:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">cat</span><span style="--shiki-default:#CE9178"> /etc/os-release
</span></span><span class="line" line="2"><span style="--shiki-default:#6A9955"># or
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">uname</span><span style="--shiki-default:#CE9178"> -a
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><h2 id="inspecting-the-ebpf-map" class="prose-h2" data-v-b9b1576a=""><!--[-->Inspecting the eBPF Map<!--]--><!----></h2><p class="prose-p" data-v-b025fb9f=""><!--[-->But
 we already learned how to view the logs in the first tutorial and it 
doesn't really tell us a lot about how many times certain binaries were 
executed.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->A 
more useful approach would be to inspect the contents of our eBPF map 
directly. That way, we would see each key (the binary name) along with 
its value (the number of times it was executed).<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->This is achieved using <a href="https://github.com/libbpf/bpftool" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->bpftool<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->As this is an eBPF playground, this tool is already installed. Open (or go back to <code class="prose-code-inline" data-v-a031129a=""><!--[-->Term 3<!--]--></code> terminal) and list all the eBPF maps loaded on the system using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> map</span><span style="--shiki-default:#CE9178"> list
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->The output will be similar to this:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">303:</span><span style="--shiki-default:#CE9178"> hash</span><span style="--shiki-default:#CE9178">  name</span><span style="--shiki-default:#CE9178"> exec_count</span><span style="--shiki-default:#CE9178">  flags</span><span style="--shiki-default:#B5CEA8"> 0x0
</span></span><span class="line" line="2"><span style="--shiki-default:#DCDCAA">    key</span><span style="--shiki-default:#CE9178"> 256B</span><span style="--shiki-default:#CE9178">  value</span><span style="--shiki-default:#CE9178"> 8B</span><span style="--shiki-default:#CE9178">  max_entries</span><span style="--shiki-default:#B5CEA8"> 16384</span><span style="--shiki-default:#CE9178">  memlock</span><span style="--shiki-default:#CE9178"> 5397440B
</span></span><span class="line" line="3"><span style="--shiki-default:#DCDCAA">    btf_id</span><span style="--shiki-default:#B5CEA8"> 490
</span></span><span class="line" line="4"><span style="--shiki-default:#DCDCAA">305:</span><span style="--shiki-default:#CE9178"> array</span><span style="--shiki-default:#CE9178">  name</span><span style="--shiki-default:#CE9178"> .rodata</span><span style="--shiki-default:#CE9178">  flags</span><span style="--shiki-default:#B5CEA8"> 0x480
</span></span><span class="line" line="5"><span style="--shiki-default:#DCDCAA">    key</span><span style="--shiki-default:#CE9178"> 4B</span><span style="--shiki-default:#CE9178">  value</span><span style="--shiki-default:#CE9178"> 12B</span><span style="--shiki-default:#CE9178">  max_entries</span><span style="--shiki-default:#B5CEA8"> 1</span><span style="--shiki-default:#CE9178">  memlock</span><span style="--shiki-default:#CE9178"> 8192B
</span></span><span class="line" line="6"><span style="--shiki-default:#DCDCAA">    btf_id</span><span style="--shiki-default:#B5CEA8"> 491</span><span style="--shiki-default:#CE9178">  frozen
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->On the right side of the output, the IDs of the eBPF maps are listed. Using the ID we can print it's content using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> map</span><span style="--shiki-default:#CE9178"> dump</span><span style="--shiki-default:#CE9178"> id</span><span style="--shiki-default:#B5CEA8"> 303</span><span style="--shiki-default:#6A9955"> # Update the ID according to your output
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Output of `bpftool map list` explained in detail</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Our <code class="prose-code-inline" data-v-a031129a=""><!--[-->exec_count<!--]--></code> eBPF map that we loaded using our application includes the following parameters:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->303<!--]--></code> → the map ID assigned by the kernel, which can be used to reference the map (e.g., with <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpftool map dump id 303<!--]--></code>)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->hash<!--]--></code> → the map type, in this case a hash map (<code class="prose-code-inline" data-v-a031129a=""><!--[-->BPF_MAP_TYPE_HASH<!--]--></code>)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->name exec_count<!--]--></code> → the map’s name, set when it was defined in the eBPF program (e.g., <code class="prose-code-inline" data-v-a031129a=""><!--[-->SEC("maps") struct { ... } exec_count<!--]--></code>)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->flags 0x0<!--]--></code> → creation flags for the map, with <code class="prose-code-inline" data-v-a031129a=""><!--[-->0x0<!--]--></code> meaning no special flags were used. Check the available flags for each map type <a href="https://docs.ebpf.io/linux/map-type/BPF_MAP_TYPE_HASH/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->under the flags section in the documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->key 256B<!--]--></code> → the key size, where each key is 256 bytes long corresponding to our <code class="prose-code-inline" data-v-a031129a=""><!--[-->#define MAX_PATH 256<!--]--></code> preprocessor macro definition macro<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->value 8B<!--]--></code> → the value size, where each value is 8 bytes corresponding to our count variable of type <code class="prose-code-inline" data-v-a031129a=""><!--[-->__u64<!--]--></code><!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->max_entries 16384<!--]--></code> → the maximum number of key-value pairs the map can hold<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->memlock 5397440B<!--]--></code> → the amount of pinned kernel memory reserved for this map (about ~5.15 MB)<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[--><code class="prose-code-inline" data-v-a031129a=""><!--[-->btf_id 490<!--]--></code> → the <a href="https://docs.ebpf.io/concepts/btf/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->BPF Type Format (BTF)<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a> ID associated with this map. We'll learn about BTF later on<!--]--></li><!--]--></ul><hr class="prose-hr" data-v-34b8dd49=""><p class="prose-p" data-v-b025fb9f=""><!--[--><strong class="prose-strong" data-v-24022f14=""><!--[-->❓ What about the second <code class="prose-code-inline" data-v-a031129a=""><!--[-->.rodata<!--]--></code> eBPF map?<!--]--></strong><!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->We’ll dig into this in more detail later, but here’s the short answer.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In eBPF, things work differently compared to normal C programs:<!--]--></p><ul class="prose-ul" data-v-533e29f3=""><!--[--><li class="prose-li" data-v-2969431c=""><!--[-->There’s no heap (so you can’t just <code class="prose-code-inline" data-v-a031129a=""><!--[-->malloc<!--]--></code> memory).<!--]--></li><li class="prose-li" data-v-2969431c=""><!--[-->You only have a small stack and some pointers into kernel space.<!--]--></li><!--]--></ul><p class="prose-p" data-v-b025fb9f=""><!--[-->To work around this,  <strong class="prose-strong" data-v-24022f14=""><!--[-->array maps<!--]--></strong>
 are automatically created (during eBPF program loading) as a storage 
for global data. In our case, the data considered global is the string 
passed to the <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_printk<!--]--></code> function, as explained in the <a href="https://docs.ebpf.io/ebpf-library/libbpf/ebpf/bpf_printk/" rel="nofollow" target="_blank" class="prose-a" data-v-abeb6555=""><!--[-->documentation<!--]--><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-[1rem] inline ml-[1px] pb-[5px] stroke-[2px] w-[1rem]" data-v-abeb6555=""><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->We can confirm this using:<!--]--></p><!--[--><div class="highlight-bash prose-code" meta="" data-v-4578ab24=""><!----><!--[--><pre class="language-bash shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#DCDCAA">sudo</span><span style="--shiki-default:#CE9178"> bpftool</span><span style="--shiki-default:#CE9178"> map</span><span style="--shiki-default:#CE9178"> dump</span><span style="--shiki-default:#CE9178"> id</span><span style="--shiki-default:#B5CEA8"> 305</span><span style="--shiki-default:#6A9955"> # Update the ID according to your output
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><!--[--><div class="highlight-text prose-code" data-v-4578ab24=""><!----><!--[--><pre class="language-text" style=""><!--[--><code>[{
        "value": {
            ".rodata": [{
                    "handle_execve_tp.____fmt": [101,120,101,99,118,101,58,32,37,115,10,0
                    ]
                }
            ]
        }
    }
]
</code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->Where the sequence <code class="prose-code-inline" data-v-a031129a=""><!--[-->101,120,101,99,118,101,58,32,37,115,10,0<!--]--></code> is ASCII for <code class="prose-code-inline" data-v-a031129a=""><!--[-->execve: %s\n<!--]--></code>. Exactly the format string we provided to our <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpf_printk<!--]--></code> function call.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->That's it for this tutorial - and no worries, we'll see a lot more of <code class="prose-code-inline" data-v-a031129a=""><!--[-->bpftool<!--]--></code> in the the next tutorial.<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->If along the you encountered any issues, look inside the <code class="prose-code-inline" data-v-a031129a=""><!--[-->ebpf-hello-world/lab3<!--]--></code> folder for the complete solution.<!--]--></p><div class="border-[2px] my-[24px] px-6 py-0 rounded-lg border-primary/50 bg-[#f7fbfe]" data-v-370f298d=""><!--[--><details data-v-370f298d=""><summary class="cursor-pointer my-3 select-none text-[#4078c0]" data-v-370f298d="">Legacy eBPF Maps</summary><!--[--><p class="prose-p" data-v-b025fb9f=""><!--[-->Not to get confused, there is a legacy way of defining maps using the <code class="prose-code-inline" data-v-a031129a=""><!--[-->struct bpf_map_def type<!--]--></code>.<!--]--></p><!--[--><div class="highlight-c prose-code" meta="" data-v-4578ab24=""><span class="filename" data-v-4578ab24="">hello.c</span><!--[--><pre class="language-c shiki shiki-themes slack-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> bpf_map_def exec_count </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> {
</span></span><span class="line" line="2"><span style="--shiki-default:#E6E6E6">    .type </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> BPF_MAP_TYPE_HASH,
</span></span><span class="line" line="3"><span style="--shiki-default:#E6E6E6">    .key_size </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#569CD6"> sizeof</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">struct</span><span style="--shiki-default:#E6E6E6"> path_key),
</span></span><span class="line" line="4"><span style="--shiki-default:#E6E6E6">    .value_size </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#569CD6"> sizeof</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#569CD6">int</span><span style="--shiki-default:#E6E6E6">),
</span></span><span class="line" line="5"><span style="--shiki-default:#E6E6E6">    .max_entries </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#B5CEA8"> 16384</span><span style="--shiki-default:#E6E6E6">,
</span></span><span class="line" line="6"><span style="--shiki-default:#E6E6E6">    .map_flags </span><span style="--shiki-default:#D4D4D4">=</span><span style="--shiki-default:#E6E6E6"> BPF_F_NO_PREALLOC,
</span></span><span class="line" line="7"><span style="--shiki-default:#E6E6E6">} </span><span style="--shiki-default:#DCDCAA">SEC</span><span style="--shiki-default:#E6E6E6">(</span><span style="--shiki-default:#CE9178">"maps"</span><span style="--shiki-default:#E6E6E6">);
</span></span></code><!--]--></pre><!--]--><button class="copy-button" data-v-4578ab24="" data-v-134dddac=""><span class="sr-only" data-v-134dddac="">Copy to clipboard</span><span class="icon-wrapper" data-v-134dddac=""><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:18px;" width="1em" height="1em" viewBox="0 0 256 256" data-v-134dddac=""><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg></span></button></div><!--]--><p class="prose-p" data-v-b025fb9f=""><!--[-->The major downside of this "method" is that key and value type information is lost, which is why it was replaced.<!--]--></p><!--]--></details><!--]--></div><p class="prose-p" data-v-b025fb9f=""><!--[-->Congrats, you've came to the end of this tutorial. 🥳<!--]--></p><p class="prose-p" data-v-b025fb9f=""><!--[-->In the <a href="https://labs.iximiuz.com/tutorials/inspecting-ebpf-using-bpftool-43dfa319" rel="nofollow" target="_blank" class="prose-a !underline !underline-offset-2 !decoration-dashed !text-black" data-v-abeb6555=""><!--[-->next tutorial<!--]--><!----></a>,
 you’ll learn how to inspect eBPF programs and maps loaded into the 
kernel with bpftool, and monitor their activity with bpftop.<!--]--></p><style nonce="">html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}</style></div><!----></div></div><!--]--><div class="px-4 md:px-8 xl:px-12 mt-auto" data-v-200caef3=""><!--[--><div class="bg-frost-light border-[2px] border-primary/30 flex flex-wrap gap-6 items-center px-6 py-6 rounded-lg my-10" data-v-0d30d5a9=""><p class="basis-[480px] grow my-0 py-0 text-slate-700 text-xl"><!--[--> Level up your Server Side game — Join 20,000 engineers who receive insightful learning materials straight to their inbox <!--]--></p><div class="basis-[150px] flex flex-wrap gap-x-5 gap-y-2 grow min-w-[150px]"><input class="focus:ring-0 grow-[4] input input-bordered min-w-[150px]" placeholder="Email" data-ddg-inputtype="identities.emailAddress" data-ddg-autofill="true" style="background-size: auto 24px !important; background-position: right center !important; background-repeat: no-repeat !important; background-origin: content-box !important; background-image: url(&quot;data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTY0IDEyOEM5OS4zNTg2IDEyOCAxMjggOTkuMzU4NiAxMjggNjRDMTI4IDI4LjY0MTQgOTkuMzU4NiAwIDY0IDBDMjguNjQxNCAwIDAgMjguNjQxNCAwIDY0QzAgOTkuMzU4NiAyOC42NDE0IDEyOCA2NCAxMjhaIiBmaWxsPSIjNDQ0NDQ0Ii8+CiAgICA8cGF0aCBkPSJNNzYuOTk5MSA1Mi4yMTM3Qzc3LjQ5NjYgNTIuMjEzNyA3Ny45MDA5IDUxLjgwOTQgNzcuOTAwOSA1MS4zMTE4Qzc3LjkwMDkgNTAuODE0MyA3Ny40OTY2IDUwLjQxIDc2Ljk5OTEgNTAuNDFDNzYuNTAxNSA1MC40MSA3Ni4wOTcyIDUwLjgxNDMgNzYuMDk3MiA1MS4zMTE4Qzc2LjA5NzIgNTEuODA5NCA3Ni41MDE1IDUyLjIxMzcgNzYuOTk5MSA1Mi4yMTM3WiIgZmlsbD0id2hpdGUiLz4KICAgIDxwYXRoIGQ9Ik01MC4xOTI0IDU0LjU0NkM1MC43ODMzIDU0LjU0NiA1MS4yNDk3IDU0LjA3OTYgNTEuMjQ5NyA1My40ODg3QzUxLjI0OTcgNTIuODk3OCA1MC43ODMzIDUyLjQzMTQgNTAuMTkyNCA1Mi40MzE0QzQ5LjYwMTUgNTIuNDMxNCA0OS4xMzUxIDUyLjg5NzggNDkuMTM1MSA1My40ODg3QzQ5LjEzNTEgNTQuMDc5NiA0OS42MDE1IDU0LjU0NiA1MC4xOTI0IDU0LjU0NloiIGZpbGw9IndoaXRlIi8+CiAgICA8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyMi43NSA2NEMxMjIuNzUgOTYuNDQ2OCA5Ni40NDY3IDEyMi43NSA2NCAxMjIuNzVDMzEuNTUzMyAxMjIuNzUgNS4yNSA5Ni40NDY4IDUuMjUgNjRDNS4yNSAzMS41NTMzIDMxLjU1MzMgNS4yNSA2NCA1LjI1Qzk2LjQ0NjcgNS4yNSAxMjIuNzUgMzEuNTUzMyAxMjIuNzUgNjRaTTQ2Ljc4MzcgMTE0LjkzNEM0NS41MjI5IDExMC41NTggNDIuNjQzNCAxMDAuMjYgMzguMjUwNyA4Mi42NTlDMzEuOTM3OCA1Ny4zNzYyIDI3LjI0MTkgMzYuNzU4MSA1MC45Mzg3IDMwLjMyMDhDNTEuMTg3NSAzMC4yNTg2IDUxLjI4MDggMjkuOTc4NyA1MS4wOTQyIDI5LjgyMzJDNDguMzU3NiAyNy4zMzUzIDQzLjcyNCAyNi45IDM5LjE4MzYgMjcuODAxOEMzOC45NjU5IDI3LjgzMjkgMzguODEwNSAyNy42Nzc0IDM4LjgxMDUgMjcuNDkwOEMzOC44MTA1IDI3LjQyODYgMzguODEwNSAyNy4zNjY0IDM4Ljg3MjYgMjcuMzA0MkMzOS45NjExIDI1Ljc4MDQgNDEuOTIwMyAyNC41OTg3IDQzLjI1NzUgMjMuODgzNEM0Mi4zMjQ1IDIzLjA0MzggNDEuMDgwNiAyMi40ODQgNDAuMDIzMyAyMi4xMTA5QzM5LjcxMjMgMjEuOTg2NSAzOS43MTIzIDIxLjQ1NzggMzkuOTkyMiAyMS4zMzM0QzQwLjAyMzMgMjEuMzAyMyA0MC4wNTQ0IDIxLjI3MTIgNDAuMTE2NiAyMS4yNzEyQzQ5LjQ0NiAyMC4wMjczIDU5LjI0MTkgMjIuODI2MSA2NC4wNjIyIDI4Ljk4MzVDNjQuMTI0MyAyOS4wNDU3IDY0LjE4NjUgMjkuMDc2OCA2NC4yNDg3IDI5LjEwNzlDODAuMDc3NyAzMi40OTc2IDgyLjk2OTggNTQuOTE5NCA4Mi4wMDU4IDYxLjEwNzlDODcuNTcyNCA2MC40NTQ5IDkxLjczOTUgNTkuMDg2NiA5NC41MDcyIDU4LjAyOTJDOTguNDg3OCA1Ni41MDU0IDk5Ljg4NzIgNTYuODQ3NSAxMDAuMzg1IDU3Ljc0OTNDMTAwLjkxMyA1OC43NzU2IDEwMC4yOTIgNjAuNDg2IDk4Ljg5MjEgNjIuMDcyQzk2LjI0ODcgNjUuMDg4NSA5MS40NTk2IDY3LjQ1MiA4My4wMzIgNjguMTM2MUM4MC4xMTg5IDY4LjM3MjYgNzcuNTQ0IDY4LjI1OTggNzUuMzIyNSA2OC4xNjI1QzcxLjExNzQgNjcuOTc4NCA2OC4xNzkxIDY3Ljg0OTcgNjYuNjEyMiA3MC4yNTA4QzY1LjU4NiA3MS44MzY4IDY2LjM5NDUgNzUuNTY4NiA3NC41NDIyIDc2Ljc1MDNDODAuMzU4NiA3Ny41ODgzIDg1LjYyODEgNzcuMDAyNiA4OS40NzAxIDc2LjU3NTVDOTIuODk5OCA3Ni4xOTQzIDk1LjE5MiA3NS45Mzk1IDk1LjcyMDEgNzYuOTM2OUM5Ni44Mzk2IDc5LjA4MjcgOTAuNDAyMyA4My4zNzQyIDc5LjM2MjQgODMuNDY3NUM3OC41MjI4IDgzLjQ2NzUgNzcuNjgzMSA4My40MzY0IDc2Ljg3NDYgODMuNDA1M0M3MC4wMzMgODMuMDYzMyA2NC45OTUxIDgxLjE5NzQgNjEuODU0MiA3OS40ODdDNjEuNzYwOSA3OS40NTU5IDYxLjY5ODcgNzkuNDI0OCA2MS42Njc2IDc5LjM5MzdDNjEuMTA3OCA3OS4wODI3IDYwLjAxOTQgNzkuNjQyNCA2MC42NzI1IDgwLjgyNDJDNjEuMDQ1NiA4MS41Mzk0IDYzLjAzNTkgODMuMzc0MiA2Ni4wMjEzIDg0Ljk2MDJDNjUuNzEwNCA4Ny40NDgxIDY2LjQ4NzggOTEuMjczMiA2Ny44MjUgOTUuNjI2OUM2Ny45ODA0IDk1LjYwMSA2OC4xMzU3IDk1LjU2OTcgNjguMjk1NSA5NS41Mzc2QzY4LjUxOTYgOTUuNDkyNCA2OC43NTI2IDk1LjQ0NTUgNjkuMDA2OCA5NS40MDkyQzcxLjcxMjMgOTQuOTczOCA3My4xNDI4IDk1LjQ3MTQgNzMuOTUxNCA5Ni4zNDIyQzc3Ljc3NjQgOTMuNDgxMSA4NC4xNTE2IDg5LjQzODQgODQuNzczNSA5MC4xODQ3Qzg3Ljg4MzMgOTMuODg1NCA4OC4yODc2IDEwMi42MjQgODcuNjAzNSAxMDYuMTM4Qzg3LjU3MjQgMTA2LjIgODcuNTEwMiAxMDYuMjYyIDg3LjM4NTggMTA2LjMyNUM4NS45MjQyIDEwNi45NDcgNzcuODY5OCAxMDQuNzQ2IDc3Ljg2OTggMTAzLjU5NkM3Ny41NTg4IDk3Ljg2NiA3Ni40OTM3IDk3LjMzNzMgNzUuMjQ5OCA5Ny4wNTc0SDc0LjQxNzhDNzQuNDQ4OSA5Ny4wODg1IDc0LjQ4IDk3LjE1MDcgNzQuNTExMSA5Ny4yMTI5TDc0Ljc5MSA5Ny44NjZDNzUuMjg4NiA5OS4yMzQzIDc2LjA2NiAxMDMuNTI2IDc1LjQ3NTIgMTA0LjU4M0M3NC44ODQzIDEwNS42NDEgNzEuMDI4MSAxMDYuMTY5IDY4LjYzMzYgMTA2LjJDNjYuMjcwMSAxMDYuMjMxIDY1Ljc0MTUgMTA1LjM2MSA2NS4yNDM5IDEwNC4wMjNDNjQuODcwNyAxMDIuOTM1IDY0LjY4NDEgMTAwLjQxNiA2NC42ODQxIDk4Ljk1NDRDNjQuNjUzIDk4LjUxOSA2NC42ODQxIDk4LjE0NTkgNjQuNzQ2MyA5Ny44MDM4QzY0LjAzMTEgOTguMTE0OCA2Mi45ODE2IDk4LjgzIDYyLjYzOTUgOTkuMjk2NEM2Mi41NDYyIDEwMC42OTYgNjIuNTQ2MiAxMDIuOTM1IDYzLjI5MjUgMTA1LjQyM0M2My42NjU3IDEwNi42MDUgNTUuMTk5MiAxMTEuNjQyIDU0LjAxNzQgMTEwLjcxQzUyLjgwNDYgMTA5Ljc0NSA1MC42Mjc4IDEwMC4yOTIgNTEuNTYwNyA5Ni40NjY2QzUwLjU2NTYgOTYuNTU5OSA0OS43NTcgOTYuODcwOCA0OS4zMjE2IDk3LjQ5MjhDNDcuMzYyNCAxMDAuMTk4IDQ5LjgxOTIgMTEzLjEzNSA1Mi40MzE0IDExNC44MTRDNTMuNzk5OCAxMTUuNzE2IDYwLjY0MTQgMTExLjg2IDY0LjAzMTEgMTA4Ljk2OEM2NC41OTA4IDEwOS43NDUgNjUuNjYzOCAxMDkuODA4IDY2Ljk4NTQgMTA5LjgwOEM2OC43MjY5IDEwOS43NDUgNzEuMTUyNSAxMDkuNDk3IDcyLjg2MjkgMTA4Ljk2OEM3My44ODY3IDExMS4zNjcgNzUuMTIxOSAxMTQuMTU3IDc2LjEzNTMgMTE2LjM3NEM5OS45NzU5IDExMC44NzMgMTE3Ljc1IDg5LjUxMjEgMTE3Ljc1IDY0QzExNy43NSAzNC4zMTQ3IDkzLjY4NTMgMTAuMjUgNjQgMTAuMjVDMzQuMzE0NyAxMC4yNSAxMC4yNSAzNC4zMTQ3IDEwLjI1IDY0QzEwLjI1IDg3LjY2NCAyNS41NDIzIDEwNy43NTYgNDYuNzgzNyAxMTQuOTM0Wk03Ny4xMjc1IDQyLjUxOThDNzcuMTY4IDQyLjUzNzkgNzcuMjA4MSA0Mi41NTU4IDc3LjI0NzggNDIuNTczNEM3Ny40NjU1IDQyLjY2NjcgNzcuNzE0MiA0Mi40MTggNzcuNTU4NyA0Mi4yMzE0Qzc2Ljg0MzUgNDEuMjY3MyA3NS43ODYyIDQwLjM2NTUgNzMuNTQ3MSA0MC4zNjU1QzcxLjMwOCA0MC4zNjU1IDY5LjkzOTcgNDEuMTQyOSA2OS4zMTc3IDQyLjEzODFDNjkuMTkzMyA0Mi4zODY5IDY5LjU2NjUgNDIuNjM1NiA2OS44MTUzIDQyLjUxMTJDNzAuNTYxNyA0Mi4xMDcgNzEuNzEyMyA0MS42NDA1IDczLjU0NzEgNDEuNjcxNkM3NS4yOTUyIDQxLjcwMTIgNzYuMzA5NCA0Mi4xNTQzIDc3LjEyNzUgNDIuNTE5OFpNNzUuNDQ0MSA1NS45MTQ2Qzc3LjM3MjIgNTUuOTE0NiA3OC45MjcxIDU0LjM1OTYgNzguOTI3MSA1Mi40NjI3Qzc4LjkyNzEgNTAuNTM0NiA3Ny4zNzIyIDQ5LjAxMDggNzUuNDQ0MSA0OS4wMTA4QzczLjUxNiA0OS4wMTA4IDcxLjk2MTEgNTAuNTY1NyA3MS45NjExIDUyLjQ2MjdDNzEuOTYxMSA1NC4zNTk2IDczLjUxNiA1NS45MTQ2IDc1LjQ0NDEgNTUuOTE0NlpNNTIuNDMxNCA1NC44NTcyQzUyLjQzMTQgNTIuNjE4MSA1MC42Mjc4IDUwLjgxNDUgNDguMzg4NyA1MC44MTQ1QzQ2LjE0OTYgNTAuODE0NSA0NC4zMTQ4IDUyLjYxODEgNDQuMzQ1OSA1NC44NTcyQzQ0LjM0NTkgNTcuMDk2MyA0Ni4xNDk2IDU4LjkgNDguMzg4NyA1OC45QzUwLjYyNzggNTguOSA1Mi40MzE0IDU3LjA5NjMgNTIuNDMxNCA1NC44NTcyWk00MC44NjI5IDQ1Ljk2MzFDNDEuMjk4MyA0NS4zMTAxIDQxLjk4MjUgNDQuMzE0OSA0NC4xNTkzIDQzLjQxMzFDNDYuMzM2MiA0Mi41MTEyIDQ4LjA0NjYgNDIuNjM1NiA0OS4yMjgzIDQyLjkxNTVDNDkuNDc3MSA0Mi45Nzc3IDQ5LjY2MzcgNDIuNjk3OCA0OS40NDYgNDIuNTQyM0M0OC41MTMxIDQxLjc2NDkgNDYuNDI5NSA0MC44MzE5IDQzLjY5MjkgNDEuODU4MkM0MS4yNjcyIDQyLjc2IDQwLjExNjYgNDQuNjU3IDQwLjExNjYgNDUuOTAwOUM0MC4xMTY2IDQ2LjE4MDggNDAuNzA3NCA0Ni4yMTE5IDQwLjg2MjkgNDUuOTYzMVoiIGZpbGw9IndoaXRlIi8+Cjwvc3ZnPg==&quot;) !important; transition: background !important;"><button type="button" class="btn relative btn-primary grow min-w-[150px]"><div class="flex grow items-center justify-center"><!--[--> Subscribe <!--]--></div><!----></button></div></div><!--]--></div><!--]--></div><!--[--><!--]--></div><!--]--></article><!--]--></div></div><!--[--><!----><div class="hidden duration-300 ease-in-out h-[calc(100vh-3rem)] lg:pb-[3px] overflow-y-auto pb-14 pl-[3px] pr-[3px] pt-1.5 scrollbar-styled top-[3rem] transition-[flex-basis]"><!--[--><!--]--></div><!--]--></div><dialog id="contentEditDialog-tutorial-ebpf-maps-tutorial-3efd4617" class="modal" data-v-0d30d5a9=""><form method="dialog" class="lg:max-w-3xl modal-box overflow-hidden p-0 relative scrollbar-hidden"><button class="absolute btn btn-circle btn-ghost btn-xs hover:rotate-90 right-2 top-2 transition-transform z-10"> ✕ </button><div class="max-h-[calc(100vh-8rem)] overflow-y-auto px-8 py-6 scrollbar-hidden"><h3 class="font-bold mb-2 text-lg"> How to Author Tutorials on iximiuz Labs</h3><p class="py-3 text-base-content/90"> Instead of providing a subpar online editing experience, iximiuz Labs offers a helper CLI tool called <a href="https://github.com/iximiuz/labctl" rel="noopener noreferrer" target="_blank noopener noreferrer" class="link">labctl</a>,
 allowing you to use your favorite text editor (or a full-featured IDE) 
to write content from the comfort of your local machine. </p><div class="flex flex-col gap-y-6 mt-4"><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Install labctl CLI </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> curl -sf https://labs.iximiuz.com/cli/install.sh | sh <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will download and install the latest version of the labctl CLI. You only need to do this once per workstation. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Authorize labctl </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl auth login <!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 This will open a browser window asking you to authorize labctl to 
access your account. You need to do it after a fresh install of labctl 
and repeat it whenever the auth session expires. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Pull tutorial content </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content pull tutorial ebpf-maps-tutorial-3efd4617<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm"> This will create a local copy of the tutorial content in a directory named <code class="bg-base-300 px-1 py-0.5 rounded">ebpf-maps-tutorial-3efd4617</code>. You only need to do this once per tutorial. </p></div><div class="bg-frost-light border border-primary/50 hover:shadow-md p-5 rounded-xl shadow-sm transition-all"><h4 class="flex font-semibold items-center mb-4"> Stream your changes </h4><div class="bg-base-content flex items-center justify-between px-3 py-2 rounded-md my-2"><div class="flex grow min-w-0"><code class="break-all md:break-normal md:truncate text-base-200 text-sm"><!--[--> labctl content push -fw tutorial ebpf-maps-tutorial-3efd4617<!--]--></code></div><button type="button" class="btn relative bg-base-content border-base-content btn-sm btn-square hover:bg-base-content hover:border-base-300/20 hover:text-base-100 text-base-200"><div class="flex grow items-center justify-center"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--ph" style="font-size:22px;" width="1em" height="1em" viewBox="0 0 256 256"><path fill="currentColor" d="M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z"></path></svg><!--]--></div><!----></button></div><p class="italic mt-3 text-base-content/90 text-sm">
 Run this command in a separate terminal to continuously upload your 
changes to the server while editing the tutorial in your favorite text 
editor or IDE. </p></div><p class="leading-relaxed p-4 text-base-content/90 text-sm"> You can also use labctl to create, list, and delete your content. Learn more about the available commands: <code class="bg-base-300 px-1 py-0.5 rounded">labctl content --help</code></p></div></div></form><form method="dialog" class="backdrop-blur-sm modal-backdrop"><button>close</button></form></dialog><div class="border-slate-400 border-t bottom-0 fixed left-0 lg:hidden right-0 z-50" data-v-0d30d5a9=""><div class="flex glass items-center justify-center p-2.5"><!--[--><a href="https://labs.iximiuz.com/signup?return_to=%2Ftutorials%2Febpf-maps-tutorial-3efd4617" class="btn bg-base-100 btn-neutral btn-outline btn-sm gap-2 shadow-md" role="button"><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-4 mr-1 w-4"><path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd"></path></svg> Start tutorial<!--]--></a><!--]--></div></div></div><!--]--></div></div><div id="teleports"></div><script nonce="">window.__NUXT__={};window.__NUXT__.config={public:{environment:"production",siteName:"iximiuz Labs",siteEmail:"ivan@iximiuz.com",siteUrl:"https://labs.iximiuz.com",site:{url:"https://labs.iximiuz.com"},siteTitle:"iximiuz Labs - Indie Learning Platform to Master Server Side Craft",siteDescription:"Skill up in Linux, Networking, Containers, and Kubernetes by taking courses, following interactive tutorials, and solving fun DevOps challenges.",discordServerUrl:"https://discord.gg/p6nxaHm46p",gumroadProfileUrl:"https://products.iximiuz.com",newsletterUrl:"https://newsletter.iximiuz.com/",emailSubsCount:"20,000",mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote",pre:"prose-pre","code-inline":"prose-code-inline",code:"prose-code-inline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",script:"prose-script",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},customElements:[]},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}},highlight:{theme:"slack-dark",preload:["ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"],highlighter:"shiki",shikiEngine:"oniguruma",langs:["js","jsx","json","ts","tsx","vue","css","html","bash","md","mdc","yaml","ada","c","csharp","diff","java","js","json","docker","go","hcl","make","md","php","proto","python","rust","shell","ts","yaml","toml"]}},plausible:{enabled:true,hashMode:false,domain:"labs.iximiuz.com",ignoredHostnames:["localhost"],ignoreSubDomains:false,trackLocalhost:"",apiHost:"https://plausible.io",autoPageviews:true,autoOutboundTracking:false,logIgnoredEvents:false,proxy:false,proxyBaseEndpoint:"/_plausible"},"nuxt-robots":{version:"5.7.0",isNuxtContentV2:false,debug:false,credits:false,groups:[{userAgent:["*"],disallow:["/account","/dashboard","/new","/enter","/main","/signin","/signup","/*/settings","*?returnTo=","*?return_to=","_nuxt"],allow:[],contentUsage:[],contentSignal:[],_indexable:true,_rules:[{pattern:"/account",allow:false},{pattern:"/dashboard",allow:false},{pattern:"/new",allow:false},{pattern:"/enter",allow:false},{pattern:"/main",allow:false},{pattern:"/signin",allow:false},{pattern:"/signup",allow:false},{pattern:"/*/settings",allow:false},{pattern:"*?returnTo=",allow:false},{pattern:"*?return_to=",allow:false},{pattern:"_nuxt",allow:false}],_normalized:true}],sitemap:["https://labs.iximiuz.com/sitemap.xml","/sitemap.xml"],header:true,robotsEnabledValue:"index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1",robotsDisabledValue:"noindex, nofollow",cacheControl:"max-age=14400, must-revalidate",botDetection:true,pageMetaRobots:{}}},app:{baseURL:"/",buildId:"b756282a-436d-4378-9e80-d3bbd54cd54a",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script nonce="" type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__">[["ShallowReactive",1],{"data":2,"state":2855,"once":2870,"_errors":2871,"serverRendered":11,"path":2873},["ShallowReactive",3],{"tutorial-page-tutorial-ebpf-maps-tutorial-3efd4617":4,"content-tutorial-ebpf-maps-tutorial-3efd4617-v1760554309428":49,"i-material-symbols-light:expand-content":2849,"i-ph:copy":2852},{"id":5,"kind":6,"name":7,"title":8,"description":9,"createdAt":10,"updatedAt":10,"independent":11,"trusted":11,"published":11,"playground":12,"units":13,"owner":18,"authors":19,"contentVersion":26,"pageUrl":27,"cover":28,"categories":29,"tags":32,"status":34,"tasks":35,"attemptCount":40,"completionCount":41,"accessControl":42,"userAccess":48},"68a98eb3267bd76725945ecf","tutorial","ebpf-maps-tutorial-3efd4617","Storing Data in eBPF: Your First eBPF Map","In this tutorial, you’ll learn how to store and update data inside the kernel, turning a simple eBPF Hello World program into one that tracks useful state. We’ll also briefly learn a few basics of bpftool, a handy CLI tool that will allow us to list and inspect our eBPF map.","2025-08-23T00:00:00.000Z",true,"ebpf-playground-2bd77c1c",[14],{"name":7,"hash":15,"title":8,"description":9,"createdAt":16,"updatedAt":16,"file":17},"#ebpf-maps-tutorial-3efd4617","2025-08-23","tutorials/ebpf-maps-tutorial-3efd4617/index.md","6620fa0e724db85e6791a6e2",[20],{"id":21,"createdAt":22,"userId":18,"name":23,"displayName":24,"avatarUrl":25,"independent":11,"certified":11},"68a57e83267bd767257a8c00","2025-08-20T07:51:31.012Z","teodor-janez-podobnik","Teodor Janez Podobnik","https://avatars.githubusercontent.com/u/48418580",1760554309428,"https://labs.iximiuz.com/tutorials/ebpf-maps-tutorial-3efd4617","/content/files/tutorials/ebpf-maps-tutorial-3efd4617/__static__/maps.png",[30,31],"linux","programming",[33],"eBPF","todo",{"clone_hello_world":36},{"init":11,"user":37,"name":38,"status":39},"laborant","clone_hello_world",0,193,83,{"canList":43,"canPreview":45,"canRead":46,"canStart":47},[44],"anyone",[44],[44],[44],{"canList":11,"canPreview":11,"canRead":11,"canStart":11},[50],{"title":8,"description":51,"kind":6,"playground":52,"categories":53,"tagz":54,"createdAt":10,"updatedAt":10,"cover":28,"type":55,"children":56,"hash":15,"preview":-1,"pageUrl":27,"tasks":2836,"toc":2837,"tutorials":2842,"challenges":2844,"courses":2846,"key":2848},"In this tutorial, you’ll learn how to store and update data inside the kernel, turning a simple eBPF Hello World program into one that tracks useful state. We’ll also briefly learn a few basics of bpftool, a handy CLI tool that will allow us to list and inspect our eBPF map.\n",{"name":12},[30,31],[33],"root",[57,126,140,145,152,157,213,224,230,265,270,482,487,566,841,846,1601,1606,1611,1680,1766,1772,1777,1841,1854,1874,1898,1903,1916,1957,1963,1968,1973,1986,1998,2027,2032,2214,2219,2261,2599,2611,2624,2811,2816,2830],{"type":58,"tag":59,"props":60,"children":61},"element","p",{},[62,65,72,74,80,82,87,89,95,97,106,108,115,117,124],{"type":63,"value":64},"text","When you start the tutorial, you’ll see a ",{"type":58,"tag":66,"props":67,"children":69},"code",{"className":68},[],[70],{"type":63,"value":71},"Term 1",{"type":63,"value":73}," terminal and an ",{"type":58,"tag":66,"props":75,"children":77},{"className":76},[],[78],{"type":63,"value":79},"IDE",{"type":63,"value":81}," on the right-hand side. You are logged in as ",{"type":58,"tag":66,"props":83,"children":85},{"className":84},[],[86],{"type":63,"value":37},{"type":63,"value":88},", and the current working directory already contains the ",{"type":58,"tag":66,"props":90,"children":92},{"className":91},[],[93],{"type":63,"value":94},"ebpf-hello-world",{"type":63,"value":96}," folder. Inside, you’ll find the ",{"type":58,"tag":98,"props":99,"children":103},"a",{"href":100,"rel":101},"https://github.com/dorkamotorka/ebpf-hello-world",[102],"nofollow",[104],{"type":63,"value":105},"eBPF Hello World labs",{"type":63,"value":107},", implemented with ",{"type":58,"tag":98,"props":109,"children":112},{"href":110,"rel":111},"https://ebpf-go.dev/",[102],[113],{"type":63,"value":114},"ebpf-go",{"type":63,"value":116}," — a Golang eBPF framework developed as part of the ",{"type":58,"tag":98,"props":118,"children":121},{"href":119,"rel":120},"https://cilium.io/",[102],[122],{"type":63,"value":123},"Cilium",{"type":63,"value":125}," project.",{"type":58,"tag":59,"props":127,"children":128},{},[129,131,138],{"type":63,"value":130},"This tutorial serves as the continuation of ",{"type":58,"tag":98,"props":132,"children":135},{"href":133,"rel":134},"https://labs.iximiuz.com/tutorials/my-first-ebpf-program-5120140e",[102],[136],{"type":63,"value":137},"From Zero to Your First eBPF Program",{"type":63,"value":139},", expanding on the introduced concepts.",{"type":58,"tag":59,"props":141,"children":142},{},[143],{"type":63,"value":144},"In this part, you’ll learn about eBPF Maps, which allow data to be persisted or shared between eBPF programs and user space services. To keep things straightforward, we’ll skip sending events to user space for now. Instead, we’ll focus on how to persist a state inside an eBPF program. Through a simple example, you’ll learn to use an eBPF map to store a counter that tracks how many times specific binary executables are triggered.",{"type":58,"tag":146,"props":147,"children":149},"h2",{"id":148},"storing-state-in-ebpf-maps",[150],{"type":63,"value":151},"Storing State in eBPF Maps",{"type":58,"tag":59,"props":153,"children":154},{},[155],{"type":63,"value":156},"When you want to store a state in eBPF kernel program, there are several eBPF Map types you can choose from. Just to name a few:",{"type":58,"tag":158,"props":159,"children":160},"ul",{},[161,173,183,193,203],{"type":58,"tag":162,"props":163,"children":164},"li",{},[165,171],{"type":58,"tag":166,"props":167,"children":168},"strong",{},[169],{"type":63,"value":170},"Hash Map",{"type":63,"value":172},": A generic key/value store where both keys and values can be of arbitrary types",{"type":58,"tag":162,"props":174,"children":175},{},[176,181],{"type":58,"tag":166,"props":177,"children":178},{},[179],{"type":63,"value":180},"Array Map",{"type":63,"value":182},": Similar to hash map, but key is always 32-bit unsigned integer",{"type":58,"tag":162,"props":184,"children":185},{},[186,191],{"type":58,"tag":166,"props":187,"children":188},{},[189],{"type":63,"value":190},"Per-CPU Hash/Array Map",{"type":63,"value":192},": Same as hash (and array) map, but each CPU gets its own copy of it",{"type":58,"tag":162,"props":194,"children":195},{},[196,201],{"type":58,"tag":166,"props":197,"children":198},{},[199],{"type":63,"value":200},"LRU Hash Map",{"type":63,"value":202},": A hash map with Least Recently Used eviction policy, automatically removing old entries after being full",{"type":58,"tag":162,"props":204,"children":205},{},[206,211],{"type":58,"tag":166,"props":207,"children":208},{},[209],{"type":63,"value":210},"Ring Buffer",{"type":63,"value":212},": Used for passing kernel events data from kernel space to user space",{"type":58,"tag":59,"props":214,"children":215},{},[216,218,222],{"type":63,"value":217},"Which map type to use depends heavily on your specific use case. We’ll cover the design choices in another tutorial, but for our example, we’ll just use a ",{"type":58,"tag":166,"props":219,"children":220},{},[221],{"type":63,"value":170},{"type":63,"value":223},".",{"type":58,"tag":225,"props":226,"children":229},"image-box",{":alt":227,":src":228},"Storing state in eBPF Applications","/content/files/tutorials/ebpf-maps-tutorial-3efd4617/__static__/ebpf-map2.png",[],{"type":58,"tag":59,"props":231,"children":232},{},[233,235,241,243,248,250,255,257,263],{"type":63,"value":234},"Before we can use an eBPF map in our kernel program, we need to define it. Navigate to the ",{"type":58,"tag":66,"props":236,"children":238},{"className":237},[],[239],{"type":63,"value":240},"ebpf-hello-world/lab2",{"type":63,"value":242}," folder with either using the ",{"type":58,"tag":66,"props":244,"children":246},{"className":245},[],[247],{"type":63,"value":71},{"type":63,"value":249}," terminal or the ",{"type":58,"tag":66,"props":251,"children":253},{"className":252},[],[254],{"type":63,"value":79},{"type":63,"value":256},". Then, open the ",{"type":58,"tag":66,"props":258,"children":260},{"className":259},[],[261],{"type":63,"value":262},"hello.c",{"type":63,"value":264}," file.",{"type":58,"tag":59,"props":266,"children":267},{},[268],{"type":63,"value":269},"Inside, add the following code lines and eBPF map definition (under Step 1):",{"type":58,"tag":271,"props":272,"children":277},"pre",{"className":273,"code":274,"filename":262,"language":275,"meta":276,"style":276},"language-c shiki shiki-themes slack-dark","#define MAX_PATH 256\n\nstruct path_key {\n    char path[MAX_PATH];\n};\n\nstruct {\n    __uint(type, BPF_MAP_TYPE_HASH);\n    __uint(max_entries, 16384);\n    __type(key, struct path_key);\n    __type(value, __u64);\n} exec_count SEC(\".maps\");\n","c","",[278],{"type":58,"tag":66,"props":279,"children":280},{"__ignoreMap":276},[281,305,314,330,350,359,367,380,394,417,440,453],{"type":58,"tag":282,"props":283,"children":286},"span",{"class":284,"line":285},"line",1,[287,293,299],{"type":58,"tag":282,"props":288,"children":290},{"style":289},"--shiki-default:#C586C0",[291],{"type":63,"value":292},"#define",{"type":58,"tag":282,"props":294,"children":296},{"style":295},"--shiki-default:#DCDCAA",[297],{"type":63,"value":298}," MAX_PATH",{"type":58,"tag":282,"props":300,"children":302},{"style":301},"--shiki-default:#B5CEA8",[303],{"type":63,"value":304}," 256\n",{"type":58,"tag":282,"props":306,"children":308},{"class":284,"line":307},2,[309],{"type":58,"tag":282,"props":310,"children":311},{"emptyLinePlaceholder":11},[312],{"type":63,"value":313},"\n",{"type":58,"tag":282,"props":315,"children":317},{"class":284,"line":316},3,[318,324],{"type":58,"tag":282,"props":319,"children":321},{"style":320},"--shiki-default:#569CD6",[322],{"type":63,"value":323},"struct",{"type":58,"tag":282,"props":325,"children":327},{"style":326},"--shiki-default:#E6E6E6",[328],{"type":63,"value":329}," path_key {\n",{"type":58,"tag":282,"props":331,"children":333},{"class":284,"line":332},4,[334,339,345],{"type":58,"tag":282,"props":335,"children":336},{"style":320},[337],{"type":63,"value":338},"    char",{"type":58,"tag":282,"props":340,"children":342},{"style":341},"--shiki-default:#9CDCFE",[343],{"type":63,"value":344}," path",{"type":58,"tag":282,"props":346,"children":347},{"style":326},[348],{"type":63,"value":349},"[MAX_PATH];\n",{"type":58,"tag":282,"props":351,"children":353},{"class":284,"line":352},5,[354],{"type":58,"tag":282,"props":355,"children":356},{"style":326},[357],{"type":63,"value":358},"};\n",{"type":58,"tag":282,"props":360,"children":362},{"class":284,"line":361},6,[363],{"type":58,"tag":282,"props":364,"children":365},{"emptyLinePlaceholder":11},[366],{"type":63,"value":313},{"type":58,"tag":282,"props":368,"children":370},{"class":284,"line":369},7,[371,375],{"type":58,"tag":282,"props":372,"children":373},{"style":320},[374],{"type":63,"value":323},{"type":58,"tag":282,"props":376,"children":377},{"style":326},[378],{"type":63,"value":379}," {\n",{"type":58,"tag":282,"props":381,"children":383},{"class":284,"line":382},8,[384,389],{"type":58,"tag":282,"props":385,"children":386},{"style":295},[387],{"type":63,"value":388},"    __uint",{"type":58,"tag":282,"props":390,"children":391},{"style":326},[392],{"type":63,"value":393},"(type, BPF_MAP_TYPE_HASH);\n",{"type":58,"tag":282,"props":395,"children":397},{"class":284,"line":396},9,[398,402,407,412],{"type":58,"tag":282,"props":399,"children":400},{"style":295},[401],{"type":63,"value":388},{"type":58,"tag":282,"props":403,"children":404},{"style":326},[405],{"type":63,"value":406},"(max_entries, ",{"type":58,"tag":282,"props":408,"children":409},{"style":301},[410],{"type":63,"value":411},"16384",{"type":58,"tag":282,"props":413,"children":414},{"style":326},[415],{"type":63,"value":416},");\n",{"type":58,"tag":282,"props":418,"children":420},{"class":284,"line":419},10,[421,426,431,435],{"type":58,"tag":282,"props":422,"children":423},{"style":295},[424],{"type":63,"value":425},"    __type",{"type":58,"tag":282,"props":427,"children":428},{"style":326},[429],{"type":63,"value":430},"(key, ",{"type":58,"tag":282,"props":432,"children":433},{"style":320},[434],{"type":63,"value":323},{"type":58,"tag":282,"props":436,"children":437},{"style":326},[438],{"type":63,"value":439}," path_key);\n",{"type":58,"tag":282,"props":441,"children":443},{"class":284,"line":442},11,[444,448],{"type":58,"tag":282,"props":445,"children":446},{"style":295},[447],{"type":63,"value":425},{"type":58,"tag":282,"props":449,"children":450},{"style":326},[451],{"type":63,"value":452},"(value, __u64);\n",{"type":58,"tag":282,"props":454,"children":456},{"class":284,"line":455},12,[457,462,467,472,478],{"type":58,"tag":282,"props":458,"children":459},{"style":326},[460],{"type":63,"value":461},"} exec_count ",{"type":58,"tag":282,"props":463,"children":464},{"style":295},[465],{"type":63,"value":466},"SEC",{"type":58,"tag":282,"props":468,"children":469},{"style":326},[470],{"type":63,"value":471},"(",{"type":58,"tag":282,"props":473,"children":475},{"style":474},"--shiki-default:#CE9178",[476],{"type":63,"value":477},"\".maps\"",{"type":58,"tag":282,"props":479,"children":480},{"style":326},[481],{"type":63,"value":416},{"type":58,"tag":59,"props":483,"children":484},{},[485],{"type":63,"value":486},"As you can see in the code, our eBPF map stores key/value pairs, where:",{"type":58,"tag":158,"props":488,"children":489},{},[490,526],{"type":58,"tag":162,"props":491,"children":492},{},[493,495,500,502,508,510,516,518,524],{"type":63,"value":494},"The ",{"type":58,"tag":166,"props":496,"children":497},{},[498],{"type":63,"value":499},"key",{"type":63,"value":501}," is a ",{"type":58,"tag":66,"props":503,"children":505},{"className":504},[],[506],{"type":63,"value":507},"struct path_key",{"type":63,"value":509},", which contains the binary execution path (e.g., ",{"type":58,"tag":66,"props":511,"children":513},{"className":512},[],[514],{"type":63,"value":515},"/usr/bin/ls",{"type":63,"value":517},", ",{"type":58,"tag":66,"props":519,"children":521},{"className":520},[],[522],{"type":63,"value":523},"/usr/bin/cat",{"type":63,"value":525},")",{"type":58,"tag":162,"props":527,"children":528},{},[529,530,535,536,542,544,550,551,557,558,564],{"type":63,"value":494},{"type":58,"tag":166,"props":531,"children":532},{},[533],{"type":63,"value":534},"value",{"type":63,"value":501},{"type":58,"tag":66,"props":537,"children":539},{"className":538},[],[540],{"type":63,"value":541},"__u64",{"type":63,"value":543}," integer that counts how many times that binary has been executed (e.g., ",{"type":58,"tag":66,"props":545,"children":547},{"className":546},[],[548],{"type":63,"value":549},"1",{"type":63,"value":517},{"type":58,"tag":66,"props":552,"children":554},{"className":553},[],[555],{"type":63,"value":556},"2",{"type":63,"value":517},{"type":58,"tag":66,"props":559,"children":561},{"className":560},[],[562],{"type":63,"value":563},"3",{"type":63,"value":565},", ...)",{"type":58,"tag":567,"props":568,"children":570},"details-box",{":summary":569},"What about `max_entries` parameter?",[571,583,624,637,814],{"type":58,"tag":59,"props":572,"children":573},{},[574,575,581],{"type":63,"value":494},{"type":58,"tag":66,"props":576,"children":578},{"className":577},[],[579],{"type":63,"value":580},"max_entries",{"type":63,"value":582}," field defines the upper bound on how many key/value pairs a map can hold.",{"type":58,"tag":59,"props":584,"children":585},{},[586,588,593,595,600,601,607,608,614,616,622],{"type":63,"value":587},"In this example, we set it to ",{"type":58,"tag":66,"props":589,"children":591},{"className":590},[],[592],{"type":63,"value":411},{"type":63,"value":594}," but in practice, the value can range from just a few (e.g., ",{"type":58,"tag":66,"props":596,"children":598},{"className":597},[],[599],{"type":63,"value":549},{"type":63,"value":517},{"type":58,"tag":66,"props":602,"children":604},{"className":603},[],[605],{"type":63,"value":606},"128",{"type":63,"value":517},{"type":58,"tag":66,"props":609,"children":611},{"className":610},[],[612],{"type":63,"value":613},"1024",{"type":63,"value":615},") up to hundreds of thousands or even millions, depending on kernel configuration (",{"type":58,"tag":66,"props":617,"children":619},{"className":618},[],[620],{"type":63,"value":621},"ulimit",{"type":63,"value":623},", locked memory) and available RAM.",{"type":58,"tag":59,"props":625,"children":626},{},[627,629,635],{"type":63,"value":628},"To avoid hitting the memory lock limit (",{"type":58,"tag":66,"props":630,"children":632},{"className":631},[],[633],{"type":63,"value":634},"RLIMIT_MEMLOCK",{"type":63,"value":636},"), we include the following code in the user space program:",{"type":58,"tag":271,"props":638,"children":644},{"className":639,"code":640,"filename":641,"highlights":642,"language":643,"meta":276,"style":276},"language-go shiki shiki-themes slack-dark","...\nfunc main() {\n    // By default (for Linux \u003C 5.11), Linux sets a RLIMIT_MEMLOCK (memory lock limit) that restricts how much memory a process can lock into RAM. \n    // eBPF maps and programs use pinned memory that counts against this limit. \n    // If you don’t raise or remove the limit, loading larger eBPF programs or maps will fail with errors like “operation not permitted” or “memory locked limit exceeded.”\n    if err := rlimit.RemoveMemlock(); err != nil {\n        log.Fatal(\"Removing memlock:\", err)\n    }\n...\n","main.go",[361,369,382],"go",[645],{"type":58,"tag":66,"props":646,"children":647},{"__ignoreMap":276},[648,657,675,684,692,700,758,798,807],{"type":58,"tag":282,"props":649,"children":650},{"class":284,"line":285},[651],{"type":58,"tag":282,"props":652,"children":654},{"style":653},"--shiki-default:#D4D4D4",[655],{"type":63,"value":656},"...\n",{"type":58,"tag":282,"props":658,"children":659},{"class":284,"line":307},[660,665,670],{"type":58,"tag":282,"props":661,"children":662},{"style":320},[663],{"type":63,"value":664},"func",{"type":58,"tag":282,"props":666,"children":667},{"style":295},[668],{"type":63,"value":669}," main",{"type":58,"tag":282,"props":671,"children":672},{"style":326},[673],{"type":63,"value":674},"() {\n",{"type":58,"tag":282,"props":676,"children":677},{"class":284,"line":316},[678],{"type":58,"tag":282,"props":679,"children":681},{"style":680},"--shiki-default:#6A9955",[682],{"type":63,"value":683},"    // By default (for Linux \u003C 5.11), Linux sets a RLIMIT_MEMLOCK (memory lock limit) that restricts how much memory a process can lock into RAM. \n",{"type":58,"tag":282,"props":685,"children":686},{"class":284,"line":332},[687],{"type":58,"tag":282,"props":688,"children":689},{"style":680},[690],{"type":63,"value":691},"    // eBPF maps and programs use pinned memory that counts against this limit. \n",{"type":58,"tag":282,"props":693,"children":694},{"class":284,"line":352},[695],{"type":58,"tag":282,"props":696,"children":697},{"style":680},[698],{"type":63,"value":699},"    // If you don’t raise or remove the limit, loading larger eBPF programs or maps will fail with errors like “operation not permitted” or “memory locked limit exceeded.”\n",{"type":58,"tag":282,"props":701,"children":704},{"class":702,"line":361},[284,703],"highlight",[705,710,715,720,725,729,734,739,744,749,754],{"type":58,"tag":282,"props":706,"children":707},{"style":289},[708],{"type":63,"value":709},"    if",{"type":58,"tag":282,"props":711,"children":712},{"style":341},[713],{"type":63,"value":714}," err",{"type":58,"tag":282,"props":716,"children":717},{"style":653},[718],{"type":63,"value":719}," :=",{"type":58,"tag":282,"props":721,"children":722},{"style":341},[723],{"type":63,"value":724}," rlimit",{"type":58,"tag":282,"props":726,"children":727},{"style":326},[728],{"type":63,"value":223},{"type":58,"tag":282,"props":730,"children":731},{"style":295},[732],{"type":63,"value":733},"RemoveMemlock",{"type":58,"tag":282,"props":735,"children":736},{"style":326},[737],{"type":63,"value":738},"(); ",{"type":58,"tag":282,"props":740,"children":741},{"style":341},[742],{"type":63,"value":743},"err",{"type":58,"tag":282,"props":745,"children":746},{"style":653},[747],{"type":63,"value":748}," !=",{"type":58,"tag":282,"props":750,"children":751},{"style":320},[752],{"type":63,"value":753}," nil",{"type":58,"tag":282,"props":755,"children":756},{"style":326},[757],{"type":63,"value":379},{"type":58,"tag":282,"props":759,"children":761},{"class":760,"line":369},[284,703],[762,767,771,776,780,785,789,793],{"type":58,"tag":282,"props":763,"children":764},{"style":341},[765],{"type":63,"value":766},"        log",{"type":58,"tag":282,"props":768,"children":769},{"style":326},[770],{"type":63,"value":223},{"type":58,"tag":282,"props":772,"children":773},{"style":295},[774],{"type":63,"value":775},"Fatal",{"type":58,"tag":282,"props":777,"children":778},{"style":326},[779],{"type":63,"value":471},{"type":58,"tag":282,"props":781,"children":782},{"style":474},[783],{"type":63,"value":784},"\"Removing memlock:\"",{"type":58,"tag":282,"props":786,"children":787},{"style":326},[788],{"type":63,"value":517},{"type":58,"tag":282,"props":790,"children":791},{"style":341},[792],{"type":63,"value":743},{"type":58,"tag":282,"props":794,"children":795},{"style":326},[796],{"type":63,"value":797},")\n",{"type":58,"tag":282,"props":799,"children":801},{"class":800,"line":382},[284,703],[802],{"type":58,"tag":282,"props":803,"children":804},{"style":326},[805],{"type":63,"value":806},"    }\n",{"type":58,"tag":282,"props":808,"children":809},{"class":284,"line":396},[810],{"type":58,"tag":282,"props":811,"children":812},{"style":653},[813],{"type":63,"value":656},{"type":58,"tag":59,"props":815,"children":816},{},[817,822,824,831,833,839],{"type":58,"tag":166,"props":818,"children":819},{},[820],{"type":63,"value":821},"NOTE:",{"type":63,"value":823}," Starting with Linux v5.11, the ",{"type":58,"tag":98,"props":825,"children":828},{"href":826,"rel":827},"https://docs.ebpf.io/linux/concepts/resource-limit/",[102],[829],{"type":63,"value":830},"memory accounting and limiting was moved from rlimit to cGroups",{"type":63,"value":832},". In other words, if the resource limits need to be raised, it should be done so with the ",{"type":58,"tag":66,"props":834,"children":836},{"className":835},[],[837],{"type":63,"value":838},"memory.max",{"type":63,"value":840}," setting on the cGroup.",{"type":58,"tag":59,"props":842,"children":843},{},[844],{"type":63,"value":845},"Technically, this eBPF map could now be updated (store/read/delete key/value pairs) from any eBPF kernel or user space program, but in our case we just update it from our eBPF kernel function. And we do so by modifying our kernel program as such (under Step 2):",{"type":58,"tag":271,"props":847,"children":849},{"className":273,"code":848,"filename":262,"language":275,"meta":276,"style":276},"SEC(\"tracepoint/syscalls/sys_enter_execve\")\nint handle_execve_tp(struct trace_event_raw_sys_enter *ctx) {\n    // The eBPF program reads the first argument of the input context `struct trace_event_raw_sys_enter`, whose \n    // values/parameters align with the execve() system call: https://man7.org/linux/man-pages/man2/execve.2.html\n    // You can also view this allignment using `sudo cat /sys/kernel/debug/tracing/events/syscalls/sys_enter_execve/format`\n    // * The first argument `ctx->args[0]` is `const char *pathname` -> either a binary executable, or \n    //   a script starting with a line of the form `#!interpreter [optional-arg]` (e.g. your bash scripts)\n    const char *filename = (const char *)ctx->args[0];\n    \n    // * The second argument `ctx->args[1]` is `char *const argv[]` -> array of pointers to strings passed to the \n    //   new program as its command-line arguments\n\n    // * The third argument `ctx->args[2]` is `char *const envp[]` -> array of pointers to strings, conventionally of \n    //   the form key=value, which are passed as the environment of the new program (a.k.a. env variables)\n\n    // Instantiate and store the first argument as our key of the eBPF map using `bpf_probe_read_user_str` which is a\n    // handy eBPF helper function, to copy a NULL terminated string from an (unsafe) user address\n    struct path_key key = {};\n    long n = bpf_probe_read_user_str(key.path, sizeof(key.path), filename);\n    // Validate the copy operation was succesfull\n    // On success, the strictly positive length of the output string, including the trailing NULL character is returned. \n    // On error, a negative value is returned.\n    if (n \u003C= 0) {\n        return 0;\n    }\n\n    // Check whether this key (binary executable path) already exists in our map and \n    __u64 *val = bpf_map_lookup_elem(&exec_count, &key);\n    if (val) {\n        // Update the value of the counter under that key we found in the map\n        // NOTE: this is not a safe way to update the value - we'll learn about atomic operations in the upcoming tutorial\n        *val += 1;\n    } else {\n        // If this binary is executed for the first time since our eBPF application has been run, we just set the counter value to 1\n        __u64 init = 1;\n        bpf_map_update_elem(&exec_count, &key, &init, BPF_NOEXIST);\n    }\n\n    // Optional: print to debug\n    bpf_printk(\"execve: %s\\n\", key.path);\n\n    return 0;\n}\n",[850],{"type":58,"tag":66,"props":851,"children":852},{"__ignoreMap":276},[853,873,914,922,930,938,946,954,1033,1041,1049,1057,1064,1073,1082,1090,1099,1108,1131,1201,1210,1219,1228,1255,1273,1281,1289,1298,1348,1361,1370,1379,1406,1424,1433,1454,1493,1501,1509,1518,1567,1575,1592],{"type":58,"tag":282,"props":854,"children":855},{"class":284,"line":285},[856,860,864,869],{"type":58,"tag":282,"props":857,"children":858},{"style":295},[859],{"type":63,"value":466},{"type":58,"tag":282,"props":861,"children":862},{"style":326},[863],{"type":63,"value":471},{"type":58,"tag":282,"props":865,"children":866},{"style":474},[867],{"type":63,"value":868},"\"tracepoint/syscalls/sys_enter_execve\"",{"type":58,"tag":282,"props":870,"children":871},{"style":326},[872],{"type":63,"value":797},{"type":58,"tag":282,"props":874,"children":875},{"class":284,"line":307},[876,881,886,890,894,899,904,909],{"type":58,"tag":282,"props":877,"children":878},{"style":320},[879],{"type":63,"value":880},"int",{"type":58,"tag":282,"props":882,"children":883},{"style":295},[884],{"type":63,"value":885}," handle_execve_tp",{"type":58,"tag":282,"props":887,"children":888},{"style":326},[889],{"type":63,"value":471},{"type":58,"tag":282,"props":891,"children":892},{"style":320},[893],{"type":63,"value":323},{"type":58,"tag":282,"props":895,"children":896},{"style":326},[897],{"type":63,"value":898}," trace_event_raw_sys_enter ",{"type":58,"tag":282,"props":900,"children":901},{"style":653},[902],{"type":63,"value":903},"*",{"type":58,"tag":282,"props":905,"children":906},{"style":341},[907],{"type":63,"value":908},"ctx",{"type":58,"tag":282,"props":910,"children":911},{"style":326},[912],{"type":63,"value":913},") {\n",{"type":58,"tag":282,"props":915,"children":916},{"class":284,"line":316},[917],{"type":58,"tag":282,"props":918,"children":919},{"style":680},[920],{"type":63,"value":921},"    // The eBPF program reads the first argument of the input context `struct trace_event_raw_sys_enter`, whose \n",{"type":58,"tag":282,"props":923,"children":924},{"class":284,"line":332},[925],{"type":58,"tag":282,"props":926,"children":927},{"style":680},[928],{"type":63,"value":929},"    // values/parameters align with the execve() system call: https://man7.org/linux/man-pages/man2/execve.2.html\n",{"type":58,"tag":282,"props":931,"children":932},{"class":284,"line":352},[933],{"type":58,"tag":282,"props":934,"children":935},{"style":680},[936],{"type":63,"value":937},"    // You can also view this allignment using `sudo cat /sys/kernel/debug/tracing/events/syscalls/sys_enter_execve/format`\n",{"type":58,"tag":282,"props":939,"children":940},{"class":284,"line":361},[941],{"type":58,"tag":282,"props":942,"children":943},{"style":680},[944],{"type":63,"value":945},"    // * The first argument `ctx->args[0]` is `const char *pathname` -> either a binary executable, or \n",{"type":58,"tag":282,"props":947,"children":948},{"class":284,"line":369},[949],{"type":58,"tag":282,"props":950,"children":951},{"style":680},[952],{"type":63,"value":953},"    //   a script starting with a line of the form `#!interpreter [optional-arg]` (e.g. your bash scripts)\n",{"type":58,"tag":282,"props":955,"children":956},{"class":284,"line":382},[957,962,967,972,977,982,987,992,996,1000,1004,1008,1013,1018,1023,1028],{"type":58,"tag":282,"props":958,"children":959},{"style":320},[960],{"type":63,"value":961},"    const",{"type":58,"tag":282,"props":963,"children":964},{"style":320},[965],{"type":63,"value":966}," char",{"type":58,"tag":282,"props":968,"children":969},{"style":653},[970],{"type":63,"value":971}," *",{"type":58,"tag":282,"props":973,"children":974},{"style":326},[975],{"type":63,"value":976},"filename ",{"type":58,"tag":282,"props":978,"children":979},{"style":653},[980],{"type":63,"value":981},"=",{"type":58,"tag":282,"props":983,"children":984},{"style":326},[985],{"type":63,"value":986}," (",{"type":58,"tag":282,"props":988,"children":989},{"style":320},[990],{"type":63,"value":991},"const",{"type":58,"tag":282,"props":993,"children":994},{"style":320},[995],{"type":63,"value":966},{"type":58,"tag":282,"props":997,"children":998},{"style":653},[999],{"type":63,"value":971},{"type":58,"tag":282,"props":1001,"children":1002},{"style":326},[1003],{"type":63,"value":525},{"type":58,"tag":282,"props":1005,"children":1006},{"style":341},[1007],{"type":63,"value":908},{"type":58,"tag":282,"props":1009,"children":1010},{"style":326},[1011],{"type":63,"value":1012},"->",{"type":58,"tag":282,"props":1014,"children":1015},{"style":341},[1016],{"type":63,"value":1017},"args",{"type":58,"tag":282,"props":1019,"children":1020},{"style":326},[1021],{"type":63,"value":1022},"[",{"type":58,"tag":282,"props":1024,"children":1025},{"style":301},[1026],{"type":63,"value":1027},"0",{"type":58,"tag":282,"props":1029,"children":1030},{"style":326},[1031],{"type":63,"value":1032},"];\n",{"type":58,"tag":282,"props":1034,"children":1035},{"class":284,"line":396},[1036],{"type":58,"tag":282,"props":1037,"children":1038},{"style":326},[1039],{"type":63,"value":1040},"    \n",{"type":58,"tag":282,"props":1042,"children":1043},{"class":284,"line":419},[1044],{"type":58,"tag":282,"props":1045,"children":1046},{"style":680},[1047],{"type":63,"value":1048},"    // * The second argument `ctx->args[1]` is `char *const argv[]` -> array of pointers to strings passed to the \n",{"type":58,"tag":282,"props":1050,"children":1051},{"class":284,"line":442},[1052],{"type":58,"tag":282,"props":1053,"children":1054},{"style":680},[1055],{"type":63,"value":1056},"    //   new program as its command-line arguments\n",{"type":58,"tag":282,"props":1058,"children":1059},{"class":284,"line":455},[1060],{"type":58,"tag":282,"props":1061,"children":1062},{"emptyLinePlaceholder":11},[1063],{"type":63,"value":313},{"type":58,"tag":282,"props":1065,"children":1067},{"class":284,"line":1066},13,[1068],{"type":58,"tag":282,"props":1069,"children":1070},{"style":680},[1071],{"type":63,"value":1072},"    // * The third argument `ctx->args[2]` is `char *const envp[]` -> array of pointers to strings, conventionally of \n",{"type":58,"tag":282,"props":1074,"children":1076},{"class":284,"line":1075},14,[1077],{"type":58,"tag":282,"props":1078,"children":1079},{"style":680},[1080],{"type":63,"value":1081},"    //   the form key=value, which are passed as the environment of the new program (a.k.a. env variables)\n",{"type":58,"tag":282,"props":1083,"children":1085},{"class":284,"line":1084},15,[1086],{"type":58,"tag":282,"props":1087,"children":1088},{"emptyLinePlaceholder":11},[1089],{"type":63,"value":313},{"type":58,"tag":282,"props":1091,"children":1093},{"class":284,"line":1092},16,[1094],{"type":58,"tag":282,"props":1095,"children":1096},{"style":680},[1097],{"type":63,"value":1098},"    // Instantiate and store the first argument as our key of the eBPF map using `bpf_probe_read_user_str` which is a\n",{"type":58,"tag":282,"props":1100,"children":1102},{"class":284,"line":1101},17,[1103],{"type":58,"tag":282,"props":1104,"children":1105},{"style":680},[1106],{"type":63,"value":1107},"    // handy eBPF helper function, to copy a NULL terminated string from an (unsafe) user address\n",{"type":58,"tag":282,"props":1109,"children":1111},{"class":284,"line":1110},18,[1112,1117,1122,1126],{"type":58,"tag":282,"props":1113,"children":1114},{"style":320},[1115],{"type":63,"value":1116},"    struct",{"type":58,"tag":282,"props":1118,"children":1119},{"style":326},[1120],{"type":63,"value":1121}," path_key key ",{"type":58,"tag":282,"props":1123,"children":1124},{"style":653},[1125],{"type":63,"value":981},{"type":58,"tag":282,"props":1127,"children":1128},{"style":326},[1129],{"type":63,"value":1130}," {};\n",{"type":58,"tag":282,"props":1132,"children":1134},{"class":284,"line":1133},19,[1135,1140,1145,1149,1154,1158,1162,1166,1171,1175,1180,1184,1188,1192,1196],{"type":58,"tag":282,"props":1136,"children":1137},{"style":320},[1138],{"type":63,"value":1139},"    long",{"type":58,"tag":282,"props":1141,"children":1142},{"style":326},[1143],{"type":63,"value":1144}," n ",{"type":58,"tag":282,"props":1146,"children":1147},{"style":653},[1148],{"type":63,"value":981},{"type":58,"tag":282,"props":1150,"children":1151},{"style":295},[1152],{"type":63,"value":1153}," bpf_probe_read_user_str",{"type":58,"tag":282,"props":1155,"children":1156},{"style":326},[1157],{"type":63,"value":471},{"type":58,"tag":282,"props":1159,"children":1160},{"style":341},[1161],{"type":63,"value":499},{"type":58,"tag":282,"props":1163,"children":1164},{"style":326},[1165],{"type":63,"value":223},{"type":58,"tag":282,"props":1167,"children":1168},{"style":341},[1169],{"type":63,"value":1170},"path",{"type":58,"tag":282,"props":1172,"children":1173},{"style":326},[1174],{"type":63,"value":517},{"type":58,"tag":282,"props":1176,"children":1177},{"style":320},[1178],{"type":63,"value":1179},"sizeof",{"type":58,"tag":282,"props":1181,"children":1182},{"style":326},[1183],{"type":63,"value":471},{"type":58,"tag":282,"props":1185,"children":1186},{"style":341},[1187],{"type":63,"value":499},{"type":58,"tag":282,"props":1189,"children":1190},{"style":326},[1191],{"type":63,"value":223},{"type":58,"tag":282,"props":1193,"children":1194},{"style":341},[1195],{"type":63,"value":1170},{"type":58,"tag":282,"props":1197,"children":1198},{"style":326},[1199],{"type":63,"value":1200},"), filename);\n",{"type":58,"tag":282,"props":1202,"children":1204},{"class":284,"line":1203},20,[1205],{"type":58,"tag":282,"props":1206,"children":1207},{"style":680},[1208],{"type":63,"value":1209},"    // Validate the copy operation was succesfull\n",{"type":58,"tag":282,"props":1211,"children":1213},{"class":284,"line":1212},21,[1214],{"type":58,"tag":282,"props":1215,"children":1216},{"style":680},[1217],{"type":63,"value":1218},"    // On success, the strictly positive length of the output string, including the trailing NULL character is returned. \n",{"type":58,"tag":282,"props":1220,"children":1222},{"class":284,"line":1221},22,[1223],{"type":58,"tag":282,"props":1224,"children":1225},{"style":680},[1226],{"type":63,"value":1227},"    // On error, a negative value is returned.\n",{"type":58,"tag":282,"props":1229,"children":1231},{"class":284,"line":1230},23,[1232,1236,1241,1246,1251],{"type":58,"tag":282,"props":1233,"children":1234},{"style":289},[1235],{"type":63,"value":709},{"type":58,"tag":282,"props":1237,"children":1238},{"style":326},[1239],{"type":63,"value":1240}," (n ",{"type":58,"tag":282,"props":1242,"children":1243},{"style":653},[1244],{"type":63,"value":1245},"\u003C=",{"type":58,"tag":282,"props":1247,"children":1248},{"style":301},[1249],{"type":63,"value":1250}," 0",{"type":58,"tag":282,"props":1252,"children":1253},{"style":326},[1254],{"type":63,"value":913},{"type":58,"tag":282,"props":1256,"children":1258},{"class":284,"line":1257},24,[1259,1264,1268],{"type":58,"tag":282,"props":1260,"children":1261},{"style":289},[1262],{"type":63,"value":1263},"        return",{"type":58,"tag":282,"props":1265,"children":1266},{"style":301},[1267],{"type":63,"value":1250},{"type":58,"tag":282,"props":1269,"children":1270},{"style":326},[1271],{"type":63,"value":1272},";\n",{"type":58,"tag":282,"props":1274,"children":1276},{"class":284,"line":1275},25,[1277],{"type":58,"tag":282,"props":1278,"children":1279},{"style":326},[1280],{"type":63,"value":806},{"type":58,"tag":282,"props":1282,"children":1284},{"class":284,"line":1283},26,[1285],{"type":58,"tag":282,"props":1286,"children":1287},{"emptyLinePlaceholder":11},[1288],{"type":63,"value":313},{"type":58,"tag":282,"props":1290,"children":1292},{"class":284,"line":1291},27,[1293],{"type":58,"tag":282,"props":1294,"children":1295},{"style":680},[1296],{"type":63,"value":1297},"    // Check whether this key (binary executable path) already exists in our map and \n",{"type":58,"tag":282,"props":1299,"children":1301},{"class":284,"line":1300},28,[1302,1307,1311,1316,1320,1325,1329,1334,1339,1343],{"type":58,"tag":282,"props":1303,"children":1304},{"style":326},[1305],{"type":63,"value":1306},"    __u64 ",{"type":58,"tag":282,"props":1308,"children":1309},{"style":653},[1310],{"type":63,"value":903},{"type":58,"tag":282,"props":1312,"children":1313},{"style":326},[1314],{"type":63,"value":1315},"val ",{"type":58,"tag":282,"props":1317,"children":1318},{"style":653},[1319],{"type":63,"value":981},{"type":58,"tag":282,"props":1321,"children":1322},{"style":295},[1323],{"type":63,"value":1324}," bpf_map_lookup_elem",{"type":58,"tag":282,"props":1326,"children":1327},{"style":326},[1328],{"type":63,"value":471},{"type":58,"tag":282,"props":1330,"children":1331},{"style":653},[1332],{"type":63,"value":1333},"&",{"type":58,"tag":282,"props":1335,"children":1336},{"style":326},[1337],{"type":63,"value":1338},"exec_count, ",{"type":58,"tag":282,"props":1340,"children":1341},{"style":653},[1342],{"type":63,"value":1333},{"type":58,"tag":282,"props":1344,"children":1345},{"style":326},[1346],{"type":63,"value":1347},"key);\n",{"type":58,"tag":282,"props":1349,"children":1351},{"class":284,"line":1350},29,[1352,1356],{"type":58,"tag":282,"props":1353,"children":1354},{"style":289},[1355],{"type":63,"value":709},{"type":58,"tag":282,"props":1357,"children":1358},{"style":326},[1359],{"type":63,"value":1360}," (val) {\n",{"type":58,"tag":282,"props":1362,"children":1364},{"class":284,"line":1363},30,[1365],{"type":58,"tag":282,"props":1366,"children":1367},{"style":680},[1368],{"type":63,"value":1369},"        // Update the value of the counter under that key we found in the map\n",{"type":58,"tag":282,"props":1371,"children":1373},{"class":284,"line":1372},31,[1374],{"type":58,"tag":282,"props":1375,"children":1376},{"style":680},[1377],{"type":63,"value":1378},"        // NOTE: this is not a safe way to update the value - we'll learn about atomic operations in the upcoming tutorial\n",{"type":58,"tag":282,"props":1380,"children":1382},{"class":284,"line":1381},32,[1383,1388,1392,1397,1402],{"type":58,"tag":282,"props":1384,"children":1385},{"style":653},[1386],{"type":63,"value":1387},"        *",{"type":58,"tag":282,"props":1389,"children":1390},{"style":326},[1391],{"type":63,"value":1315},{"type":58,"tag":282,"props":1393,"children":1394},{"style":653},[1395],{"type":63,"value":1396},"+=",{"type":58,"tag":282,"props":1398,"children":1399},{"style":301},[1400],{"type":63,"value":1401}," 1",{"type":58,"tag":282,"props":1403,"children":1404},{"style":326},[1405],{"type":63,"value":1272},{"type":58,"tag":282,"props":1407,"children":1409},{"class":284,"line":1408},33,[1410,1415,1420],{"type":58,"tag":282,"props":1411,"children":1412},{"style":326},[1413],{"type":63,"value":1414},"    } ",{"type":58,"tag":282,"props":1416,"children":1417},{"style":289},[1418],{"type":63,"value":1419},"else",{"type":58,"tag":282,"props":1421,"children":1422},{"style":326},[1423],{"type":63,"value":379},{"type":58,"tag":282,"props":1425,"children":1427},{"class":284,"line":1426},34,[1428],{"type":58,"tag":282,"props":1429,"children":1430},{"style":680},[1431],{"type":63,"value":1432},"        // If this binary is executed for the first time since our eBPF application has been run, we just set the counter value to 1\n",{"type":58,"tag":282,"props":1434,"children":1436},{"class":284,"line":1435},35,[1437,1442,1446,1450],{"type":58,"tag":282,"props":1438,"children":1439},{"style":326},[1440],{"type":63,"value":1441},"        __u64 init ",{"type":58,"tag":282,"props":1443,"children":1444},{"style":653},[1445],{"type":63,"value":981},{"type":58,"tag":282,"props":1447,"children":1448},{"style":301},[1449],{"type":63,"value":1401},{"type":58,"tag":282,"props":1451,"children":1452},{"style":326},[1453],{"type":63,"value":1272},{"type":58,"tag":282,"props":1455,"children":1457},{"class":284,"line":1456},36,[1458,1463,1467,1471,1475,1479,1484,1488],{"type":58,"tag":282,"props":1459,"children":1460},{"style":295},[1461],{"type":63,"value":1462},"        bpf_map_update_elem",{"type":58,"tag":282,"props":1464,"children":1465},{"style":326},[1466],{"type":63,"value":471},{"type":58,"tag":282,"props":1468,"children":1469},{"style":653},[1470],{"type":63,"value":1333},{"type":58,"tag":282,"props":1472,"children":1473},{"style":326},[1474],{"type":63,"value":1338},{"type":58,"tag":282,"props":1476,"children":1477},{"style":653},[1478],{"type":63,"value":1333},{"type":58,"tag":282,"props":1480,"children":1481},{"style":326},[1482],{"type":63,"value":1483},"key, ",{"type":58,"tag":282,"props":1485,"children":1486},{"style":653},[1487],{"type":63,"value":1333},{"type":58,"tag":282,"props":1489,"children":1490},{"style":326},[1491],{"type":63,"value":1492},"init, BPF_NOEXIST);\n",{"type":58,"tag":282,"props":1494,"children":1496},{"class":284,"line":1495},37,[1497],{"type":58,"tag":282,"props":1498,"children":1499},{"style":326},[1500],{"type":63,"value":806},{"type":58,"tag":282,"props":1502,"children":1504},{"class":284,"line":1503},38,[1505],{"type":58,"tag":282,"props":1506,"children":1507},{"emptyLinePlaceholder":11},[1508],{"type":63,"value":313},{"type":58,"tag":282,"props":1510,"children":1512},{"class":284,"line":1511},39,[1513],{"type":58,"tag":282,"props":1514,"children":1515},{"style":680},[1516],{"type":63,"value":1517},"    // Optional: print to debug\n",{"type":58,"tag":282,"props":1519,"children":1521},{"class":284,"line":1520},40,[1522,1527,1531,1536,1542,1547,1551,1555,1559,1563],{"type":58,"tag":282,"props":1523,"children":1524},{"style":295},[1525],{"type":63,"value":1526},"    bpf_printk",{"type":58,"tag":282,"props":1528,"children":1529},{"style":326},[1530],{"type":63,"value":471},{"type":58,"tag":282,"props":1532,"children":1533},{"style":474},[1534],{"type":63,"value":1535},"\"execve: %s",{"type":58,"tag":282,"props":1537,"children":1539},{"style":1538},"--shiki-default:#D7BA7D",[1540],{"type":63,"value":1541},"\\n",{"type":58,"tag":282,"props":1543,"children":1544},{"style":474},[1545],{"type":63,"value":1546},"\"",{"type":58,"tag":282,"props":1548,"children":1549},{"style":326},[1550],{"type":63,"value":517},{"type":58,"tag":282,"props":1552,"children":1553},{"style":341},[1554],{"type":63,"value":499},{"type":58,"tag":282,"props":1556,"children":1557},{"style":326},[1558],{"type":63,"value":223},{"type":58,"tag":282,"props":1560,"children":1561},{"style":341},[1562],{"type":63,"value":1170},{"type":58,"tag":282,"props":1564,"children":1565},{"style":326},[1566],{"type":63,"value":416},{"type":58,"tag":282,"props":1568,"children":1570},{"class":284,"line":1569},41,[1571],{"type":58,"tag":282,"props":1572,"children":1573},{"emptyLinePlaceholder":11},[1574],{"type":63,"value":313},{"type":58,"tag":282,"props":1576,"children":1578},{"class":284,"line":1577},42,[1579,1584,1588],{"type":58,"tag":282,"props":1580,"children":1581},{"style":289},[1582],{"type":63,"value":1583},"    return",{"type":58,"tag":282,"props":1585,"children":1586},{"style":301},[1587],{"type":63,"value":1250},{"type":58,"tag":282,"props":1589,"children":1590},{"style":326},[1591],{"type":63,"value":1272},{"type":58,"tag":282,"props":1593,"children":1595},{"class":284,"line":1594},43,[1596],{"type":58,"tag":282,"props":1597,"children":1598},{"style":326},[1599],{"type":63,"value":1600},"}\n",{"type":58,"tag":59,"props":1602,"children":1603},{},[1604],{"type":63,"value":1605},"It might feel like a lot to take in at first, so we’ve added detailed comments to each line of code.",{"type":58,"tag":59,"props":1607,"children":1608},{},[1609],{"type":63,"value":1610},"The interesting lines of code, related to the eBPF map are:",{"type":58,"tag":158,"props":1612,"children":1613},{},[1614,1625],{"type":58,"tag":162,"props":1615,"children":1616},{},[1617,1623],{"type":58,"tag":66,"props":1618,"children":1620},{"className":1619},[],[1621],{"type":63,"value":1622},"bpf_map_lookup_elem(map, key)",{"type":63,"value":1624}," - Looks up an element in the map by key and returns a pointer to the value in kernel space if it exists, or NULL if not found.",{"type":58,"tag":162,"props":1626,"children":1627},{},[1628,1634,1636,1642,1644],{"type":58,"tag":66,"props":1629,"children":1631},{"className":1630},[],[1632],{"type":63,"value":1633},"bpf_map_update_elem(map, key, value, flags)",{"type":63,"value":1635}," - Inserts or updates a map entry. The ",{"type":58,"tag":66,"props":1637,"children":1639},{"className":1638},[],[1640],{"type":63,"value":1641},"flags",{"type":63,"value":1643}," parameter controls the update behavior:\n",{"type":58,"tag":158,"props":1645,"children":1646},{},[1647,1658,1669],{"type":58,"tag":162,"props":1648,"children":1649},{},[1650,1656],{"type":58,"tag":66,"props":1651,"children":1653},{"className":1652},[],[1654],{"type":63,"value":1655},"BPF_ANY",{"type":63,"value":1657},": create new or update existing",{"type":58,"tag":162,"props":1659,"children":1660},{},[1661,1667],{"type":58,"tag":66,"props":1662,"children":1664},{"className":1663},[],[1665],{"type":63,"value":1666},"BPF_NOEXIST",{"type":63,"value":1668},": create only if key doesn’t exist",{"type":58,"tag":162,"props":1670,"children":1671},{},[1672,1678],{"type":58,"tag":66,"props":1673,"children":1675},{"className":1674},[],[1676],{"type":63,"value":1677},"BPF_EXIST",{"type":63,"value":1679},": update only if key exists",{"type":58,"tag":567,"props":1681,"children":1683},{":summary":1682},"More information about eBPF map helpers",[1684,1689,1752],{"type":58,"tag":59,"props":1685,"children":1686},{},[1687],{"type":63,"value":1688},"Some other eBPF map helper functions that you’ll encounter in the wild:",{"type":58,"tag":158,"props":1690,"children":1691},{},[1692,1703,1714,1725,1736,1747],{"type":58,"tag":162,"props":1693,"children":1694},{},[1695,1701],{"type":58,"tag":66,"props":1696,"children":1698},{"className":1697},[],[1699],{"type":63,"value":1700},"bpf_map_delete_elem(map, key)",{"type":63,"value":1702}," for deleting the map entry",{"type":58,"tag":162,"props":1704,"children":1705},{},[1706,1712],{"type":58,"tag":66,"props":1707,"children":1709},{"className":1708},[],[1710],{"type":63,"value":1711},"bpf_map_lookup_and_delete_elem(map, key)",{"type":63,"value":1713}," for looking up and deleting the entry right after",{"type":58,"tag":162,"props":1715,"children":1716},{},[1717,1723],{"type":58,"tag":66,"props":1718,"children":1720},{"className":1719},[],[1721],{"type":63,"value":1722},"bpf_map_push_elem(map, value, flags)",{"type":63,"value":1724}," for pushing an element into a Queue, Stack and Bloom filter eBPF Maps.",{"type":58,"tag":162,"props":1726,"children":1727},{},[1728,1734],{"type":58,"tag":66,"props":1729,"children":1731},{"className":1730},[],[1732],{"type":63,"value":1733},"bpf_map_pop_elem(map, value_out)",{"type":63,"value":1735}," for popping (removing) an element from a Queue and Stack eBPF Maps.",{"type":58,"tag":162,"props":1737,"children":1738},{},[1739,1745],{"type":58,"tag":66,"props":1740,"children":1742},{"className":1741},[],[1743],{"type":63,"value":1744},"bpf_map_peek_elem(map, value_out)",{"type":63,"value":1746}," for retrieving the top element from a Queue, Stack and Bloom filter eBPF Maps without removing it.",{"type":58,"tag":162,"props":1748,"children":1749},{},[1750],{"type":63,"value":1751},"and others..",{"type":58,"tag":59,"props":1753,"children":1754},{},[1755,1757,1764],{"type":63,"value":1756},"⚠️ Not all helpers are supported by every map type. For details, check the ",{"type":58,"tag":98,"props":1758,"children":1761},{"href":1759,"rel":1760},"https://docs.ebpf.io/linux/map-type/",[102],[1762],{"type":63,"value":1763},"official eBPF documentation",{"type":63,"value":1765}," to see which helpers are available for each map type.",{"type":58,"tag":146,"props":1767,"children":1769},{"id":1768},"building-and-running-the-ebpf-application",[1770],{"type":63,"value":1771},"Building and Running the eBPF Application",{"type":58,"tag":59,"props":1773,"children":1774},{},[1775],{"type":63,"value":1776},"With that behind us, we can now build and run our eBPF application, using:",{"type":58,"tag":271,"props":1778,"children":1782},{"className":1779,"code":1780,"language":1781,"meta":276,"style":276},"language-bash shiki shiki-themes slack-dark","cd ebpf-hello-world/lab2 # Go inside the ebpf-hello-world/lab2 folder if you haven't already\ngo generate\ngo build\nsudo ./lab2\n","bash",[1783],{"type":58,"tag":66,"props":1784,"children":1785},{"__ignoreMap":276},[1786,1804,1816,1828],{"type":58,"tag":282,"props":1787,"children":1788},{"class":284,"line":285},[1789,1794,1799],{"type":58,"tag":282,"props":1790,"children":1791},{"style":295},[1792],{"type":63,"value":1793},"cd",{"type":58,"tag":282,"props":1795,"children":1796},{"style":474},[1797],{"type":63,"value":1798}," ebpf-hello-world/lab2",{"type":58,"tag":282,"props":1800,"children":1801},{"style":680},[1802],{"type":63,"value":1803}," # Go inside the ebpf-hello-world/lab2 folder if you haven't already\n",{"type":58,"tag":282,"props":1805,"children":1806},{"class":284,"line":307},[1807,1811],{"type":58,"tag":282,"props":1808,"children":1809},{"style":295},[1810],{"type":63,"value":643},{"type":58,"tag":282,"props":1812,"children":1813},{"style":474},[1814],{"type":63,"value":1815}," generate\n",{"type":58,"tag":282,"props":1817,"children":1818},{"class":284,"line":316},[1819,1823],{"type":58,"tag":282,"props":1820,"children":1821},{"style":295},[1822],{"type":63,"value":643},{"type":58,"tag":282,"props":1824,"children":1825},{"style":474},[1826],{"type":63,"value":1827}," build\n",{"type":58,"tag":282,"props":1829,"children":1830},{"class":284,"line":332},[1831,1836],{"type":58,"tag":282,"props":1832,"children":1833},{"style":295},[1834],{"type":63,"value":1835},"sudo",{"type":58,"tag":282,"props":1837,"children":1838},{"style":474},[1839],{"type":63,"value":1840}," ./lab2\n",{"type":58,"tag":59,"props":1842,"children":1843},{},[1844,1846,1852],{"type":63,"value":1845},"If you looked closely at the code, you’ll must have seen that our eBPF program calls ",{"type":58,"tag":66,"props":1847,"children":1849},{"className":1848},[],[1850],{"type":63,"value":1851},"bpf_printk()",{"type":63,"value":1853},". This means we should get a log message each time a certain binary is executed.",{"type":58,"tag":59,"props":1855,"children":1856},{},[1857,1859,1864,1866,1872],{"type":63,"value":1858},"To view these logs, open the ",{"type":58,"tag":166,"props":1860,"children":1861},{},[1862],{"type":63,"value":1863},"Term 2",{"type":63,"value":1865}," tab on the right (click the ",{"type":58,"tag":66,"props":1867,"children":1869},{"className":1868},[],[1870],{"type":63,"value":1871},"+",{"type":63,"value":1873}," at the top), and run:",{"type":58,"tag":271,"props":1875,"children":1877},{"className":1779,"code":1876,"language":1781,"meta":276,"style":276},"sudo cat /sys/kernel/debug/tracing/trace_pipe\n",[1878],{"type":58,"tag":66,"props":1879,"children":1880},{"__ignoreMap":276},[1881],{"type":58,"tag":282,"props":1882,"children":1883},{"class":284,"line":285},[1884,1888,1893],{"type":58,"tag":282,"props":1885,"children":1886},{"style":295},[1887],{"type":63,"value":1835},{"type":58,"tag":282,"props":1889,"children":1890},{"style":474},[1891],{"type":63,"value":1892}," cat",{"type":58,"tag":282,"props":1894,"children":1895},{"style":474},[1896],{"type":63,"value":1897}," /sys/kernel/debug/tracing/trace_pipe\n",{"type":58,"tag":59,"props":1899,"children":1900},{},[1901],{"type":63,"value":1902},"It's quite unlikely you won't see any logs. But this could be the case, since there is little going on in a small VM like ours, so let's execute some process ourself.",{"type":58,"tag":59,"props":1904,"children":1905},{},[1906,1908,1914],{"type":63,"value":1907},"Open the third ",{"type":58,"tag":66,"props":1909,"children":1911},{"className":1910},[],[1912],{"type":63,"value":1913},"Term 3",{"type":63,"value":1915}," tab, and execute:",{"type":58,"tag":271,"props":1917,"children":1919},{"className":1779,"code":1918,"language":1781,"meta":276,"style":276},"cat /etc/os-release\n# or\nuname -a\n",[1920],{"type":58,"tag":66,"props":1921,"children":1922},{"__ignoreMap":276},[1923,1936,1944],{"type":58,"tag":282,"props":1924,"children":1925},{"class":284,"line":285},[1926,1931],{"type":58,"tag":282,"props":1927,"children":1928},{"style":295},[1929],{"type":63,"value":1930},"cat",{"type":58,"tag":282,"props":1932,"children":1933},{"style":474},[1934],{"type":63,"value":1935}," /etc/os-release\n",{"type":58,"tag":282,"props":1937,"children":1938},{"class":284,"line":307},[1939],{"type":58,"tag":282,"props":1940,"children":1941},{"style":680},[1942],{"type":63,"value":1943},"# or\n",{"type":58,"tag":282,"props":1945,"children":1946},{"class":284,"line":316},[1947,1952],{"type":58,"tag":282,"props":1948,"children":1949},{"style":295},[1950],{"type":63,"value":1951},"uname",{"type":58,"tag":282,"props":1953,"children":1954},{"style":474},[1955],{"type":63,"value":1956}," -a\n",{"type":58,"tag":146,"props":1958,"children":1960},{"id":1959},"inspecting-the-ebpf-map",[1961],{"type":63,"value":1962},"Inspecting the eBPF Map",{"type":58,"tag":59,"props":1964,"children":1965},{},[1966],{"type":63,"value":1967},"But we already learned how to view the logs in the first tutorial and it doesn't really tell us a lot about how many times certain binaries were executed.",{"type":58,"tag":59,"props":1969,"children":1970},{},[1971],{"type":63,"value":1972},"A more useful approach would be to inspect the contents of our eBPF map directly. That way, we would see each key (the binary name) along with its value (the number of times it was executed).",{"type":58,"tag":59,"props":1974,"children":1975},{},[1976,1978,1985],{"type":63,"value":1977},"This is achieved using ",{"type":58,"tag":98,"props":1979,"children":1982},{"href":1980,"rel":1981},"https://github.com/libbpf/bpftool",[102],[1983],{"type":63,"value":1984},"bpftool",{"type":63,"value":223},{"type":58,"tag":59,"props":1987,"children":1988},{},[1989,1991,1996],{"type":63,"value":1990},"As this is an eBPF playground, this tool is already installed. Open (or go back to ",{"type":58,"tag":66,"props":1992,"children":1994},{"className":1993},[],[1995],{"type":63,"value":1913},{"type":63,"value":1997}," terminal) and list all the eBPF maps loaded on the system using:",{"type":58,"tag":271,"props":1999,"children":2001},{"className":1779,"code":2000,"language":1781,"meta":276,"style":276},"sudo bpftool map list\n",[2002],{"type":58,"tag":66,"props":2003,"children":2004},{"__ignoreMap":276},[2005],{"type":58,"tag":282,"props":2006,"children":2007},{"class":284,"line":285},[2008,2012,2017,2022],{"type":58,"tag":282,"props":2009,"children":2010},{"style":295},[2011],{"type":63,"value":1835},{"type":58,"tag":282,"props":2013,"children":2014},{"style":474},[2015],{"type":63,"value":2016}," bpftool",{"type":58,"tag":282,"props":2018,"children":2019},{"style":474},[2020],{"type":63,"value":2021}," map",{"type":58,"tag":282,"props":2023,"children":2024},{"style":474},[2025],{"type":63,"value":2026}," list\n",{"type":58,"tag":59,"props":2028,"children":2029},{},[2030],{"type":63,"value":2031},"The output will be similar to this:",{"type":58,"tag":271,"props":2033,"children":2035},{"className":1779,"code":2034,"language":1781,"meta":276,"style":276},"303: hash  name exec_count  flags 0x0\n    key 256B  value 8B  max_entries 16384  memlock 5397440B\n    btf_id 490\n305: array  name .rodata  flags 0x480\n    key 4B  value 12B  max_entries 1  memlock 8192B\n    btf_id 491  frozen\n",[2036],{"type":58,"tag":66,"props":2037,"children":2038},{"__ignoreMap":276},[2039,2072,2115,2128,2159,2197],{"type":58,"tag":282,"props":2040,"children":2041},{"class":284,"line":285},[2042,2047,2052,2057,2062,2067],{"type":58,"tag":282,"props":2043,"children":2044},{"style":295},[2045],{"type":63,"value":2046},"303:",{"type":58,"tag":282,"props":2048,"children":2049},{"style":474},[2050],{"type":63,"value":2051}," hash",{"type":58,"tag":282,"props":2053,"children":2054},{"style":474},[2055],{"type":63,"value":2056},"  name",{"type":58,"tag":282,"props":2058,"children":2059},{"style":474},[2060],{"type":63,"value":2061}," exec_count",{"type":58,"tag":282,"props":2063,"children":2064},{"style":474},[2065],{"type":63,"value":2066},"  flags",{"type":58,"tag":282,"props":2068,"children":2069},{"style":301},[2070],{"type":63,"value":2071}," 0x0\n",{"type":58,"tag":282,"props":2073,"children":2074},{"class":284,"line":307},[2075,2080,2085,2090,2095,2100,2105,2110],{"type":58,"tag":282,"props":2076,"children":2077},{"style":295},[2078],{"type":63,"value":2079},"    key",{"type":58,"tag":282,"props":2081,"children":2082},{"style":474},[2083],{"type":63,"value":2084}," 256B",{"type":58,"tag":282,"props":2086,"children":2087},{"style":474},[2088],{"type":63,"value":2089},"  value",{"type":58,"tag":282,"props":2091,"children":2092},{"style":474},[2093],{"type":63,"value":2094}," 8B",{"type":58,"tag":282,"props":2096,"children":2097},{"style":474},[2098],{"type":63,"value":2099},"  max_entries",{"type":58,"tag":282,"props":2101,"children":2102},{"style":301},[2103],{"type":63,"value":2104}," 16384",{"type":58,"tag":282,"props":2106,"children":2107},{"style":474},[2108],{"type":63,"value":2109},"  memlock",{"type":58,"tag":282,"props":2111,"children":2112},{"style":474},[2113],{"type":63,"value":2114}," 5397440B\n",{"type":58,"tag":282,"props":2116,"children":2117},{"class":284,"line":316},[2118,2123],{"type":58,"tag":282,"props":2119,"children":2120},{"style":295},[2121],{"type":63,"value":2122},"    btf_id",{"type":58,"tag":282,"props":2124,"children":2125},{"style":301},[2126],{"type":63,"value":2127}," 490\n",{"type":58,"tag":282,"props":2129,"children":2130},{"class":284,"line":332},[2131,2136,2141,2145,2150,2154],{"type":58,"tag":282,"props":2132,"children":2133},{"style":295},[2134],{"type":63,"value":2135},"305:",{"type":58,"tag":282,"props":2137,"children":2138},{"style":474},[2139],{"type":63,"value":2140}," array",{"type":58,"tag":282,"props":2142,"children":2143},{"style":474},[2144],{"type":63,"value":2056},{"type":58,"tag":282,"props":2146,"children":2147},{"style":474},[2148],{"type":63,"value":2149}," .rodata",{"type":58,"tag":282,"props":2151,"children":2152},{"style":474},[2153],{"type":63,"value":2066},{"type":58,"tag":282,"props":2155,"children":2156},{"style":301},[2157],{"type":63,"value":2158}," 0x480\n",{"type":58,"tag":282,"props":2160,"children":2161},{"class":284,"line":352},[2162,2166,2171,2175,2180,2184,2188,2192],{"type":58,"tag":282,"props":2163,"children":2164},{"style":295},[2165],{"type":63,"value":2079},{"type":58,"tag":282,"props":2167,"children":2168},{"style":474},[2169],{"type":63,"value":2170}," 4B",{"type":58,"tag":282,"props":2172,"children":2173},{"style":474},[2174],{"type":63,"value":2089},{"type":58,"tag":282,"props":2176,"children":2177},{"style":474},[2178],{"type":63,"value":2179}," 12B",{"type":58,"tag":282,"props":2181,"children":2182},{"style":474},[2183],{"type":63,"value":2099},{"type":58,"tag":282,"props":2185,"children":2186},{"style":301},[2187],{"type":63,"value":1401},{"type":58,"tag":282,"props":2189,"children":2190},{"style":474},[2191],{"type":63,"value":2109},{"type":58,"tag":282,"props":2193,"children":2194},{"style":474},[2195],{"type":63,"value":2196}," 8192B\n",{"type":58,"tag":282,"props":2198,"children":2199},{"class":284,"line":361},[2200,2204,2209],{"type":58,"tag":282,"props":2201,"children":2202},{"style":295},[2203],{"type":63,"value":2122},{"type":58,"tag":282,"props":2205,"children":2206},{"style":301},[2207],{"type":63,"value":2208}," 491",{"type":58,"tag":282,"props":2210,"children":2211},{"style":474},[2212],{"type":63,"value":2213},"  frozen\n",{"type":58,"tag":59,"props":2215,"children":2216},{},[2217],{"type":63,"value":2218},"On the right side of the output, the IDs of the eBPF maps are listed. Using the ID we can print it's content using:",{"type":58,"tag":271,"props":2220,"children":2222},{"className":1779,"code":2221,"language":1781,"meta":276,"style":276},"sudo bpftool map dump id 303 # Update the ID according to your output\n",[2223],{"type":58,"tag":66,"props":2224,"children":2225},{"__ignoreMap":276},[2226],{"type":58,"tag":282,"props":2227,"children":2228},{"class":284,"line":285},[2229,2233,2237,2241,2246,2251,2256],{"type":58,"tag":282,"props":2230,"children":2231},{"style":295},[2232],{"type":63,"value":1835},{"type":58,"tag":282,"props":2234,"children":2235},{"style":474},[2236],{"type":63,"value":2016},{"type":58,"tag":282,"props":2238,"children":2239},{"style":474},[2240],{"type":63,"value":2021},{"type":58,"tag":282,"props":2242,"children":2243},{"style":474},[2244],{"type":63,"value":2245}," dump",{"type":58,"tag":282,"props":2247,"children":2248},{"style":474},[2249],{"type":63,"value":2250}," id",{"type":58,"tag":282,"props":2252,"children":2253},{"style":301},[2254],{"type":63,"value":2255}," 303",{"type":58,"tag":282,"props":2257,"children":2258},{"style":680},[2259],{"type":63,"value":2260}," # Update the ID according to your output\n",{"type":58,"tag":567,"props":2262,"children":2264},{":summary":2263},"Output of `bpftool map list` explained in detail",[2265,2278,2438,2442,2458,2463,2468,2489,2517,2522,2561,2571],{"type":58,"tag":59,"props":2266,"children":2267},{},[2268,2270,2276],{"type":63,"value":2269},"Our ",{"type":58,"tag":66,"props":2271,"children":2273},{"className":2272},[],[2274],{"type":63,"value":2275},"exec_count",{"type":63,"value":2277}," eBPF map that we loaded using our application includes the following parameters:",{"type":58,"tag":158,"props":2279,"children":2280},{},[2281,2299,2317,2335,2361,2380,2396,2407,2418],{"type":58,"tag":162,"props":2282,"children":2283},{},[2284,2290,2292,2298],{"type":58,"tag":66,"props":2285,"children":2287},{"className":2286},[],[2288],{"type":63,"value":2289},"303",{"type":63,"value":2291}," → the map ID assigned by the kernel, which can be used to reference the map (e.g., with ",{"type":58,"tag":66,"props":2293,"children":2295},{"className":2294},[],[2296],{"type":63,"value":2297},"bpftool map dump id 303",{"type":63,"value":525},{"type":58,"tag":162,"props":2300,"children":2301},{},[2302,2308,2310,2316],{"type":58,"tag":66,"props":2303,"children":2305},{"className":2304},[],[2306],{"type":63,"value":2307},"hash",{"type":63,"value":2309}," → the map type, in this case a hash map (",{"type":58,"tag":66,"props":2311,"children":2313},{"className":2312},[],[2314],{"type":63,"value":2315},"BPF_MAP_TYPE_HASH",{"type":63,"value":525},{"type":58,"tag":162,"props":2318,"children":2319},{},[2320,2326,2328,2334],{"type":58,"tag":66,"props":2321,"children":2323},{"className":2322},[],[2324],{"type":63,"value":2325},"name exec_count",{"type":63,"value":2327}," → the map’s name, set when it was defined in the eBPF program (e.g., ",{"type":58,"tag":66,"props":2329,"children":2331},{"className":2330},[],[2332],{"type":63,"value":2333},"SEC(\"maps\") struct { ... } exec_count",{"type":63,"value":525},{"type":58,"tag":162,"props":2336,"children":2337},{},[2338,2344,2346,2352,2354],{"type":58,"tag":66,"props":2339,"children":2341},{"className":2340},[],[2342],{"type":63,"value":2343},"flags 0x0",{"type":63,"value":2345}," → creation flags for the map, with ",{"type":58,"tag":66,"props":2347,"children":2349},{"className":2348},[],[2350],{"type":63,"value":2351},"0x0",{"type":63,"value":2353}," meaning no special flags were used. Check the available flags for each map type ",{"type":58,"tag":98,"props":2355,"children":2358},{"href":2356,"rel":2357},"https://docs.ebpf.io/linux/map-type/BPF_MAP_TYPE_HASH/",[102],[2359],{"type":63,"value":2360},"under the flags section in the documentation",{"type":58,"tag":162,"props":2362,"children":2363},{},[2364,2370,2372,2378],{"type":58,"tag":66,"props":2365,"children":2367},{"className":2366},[],[2368],{"type":63,"value":2369},"key 256B",{"type":63,"value":2371}," → the key size, where each key is 256 bytes long corresponding to our ",{"type":58,"tag":66,"props":2373,"children":2375},{"className":2374},[],[2376],{"type":63,"value":2377},"#define MAX_PATH 256",{"type":63,"value":2379}," preprocessor macro definition macro",{"type":58,"tag":162,"props":2381,"children":2382},{},[2383,2389,2391],{"type":58,"tag":66,"props":2384,"children":2386},{"className":2385},[],[2387],{"type":63,"value":2388},"value 8B",{"type":63,"value":2390}," → the value size, where each value is 8 bytes corresponding to our count variable of type ",{"type":58,"tag":66,"props":2392,"children":2394},{"className":2393},[],[2395],{"type":63,"value":541},{"type":58,"tag":162,"props":2397,"children":2398},{},[2399,2405],{"type":58,"tag":66,"props":2400,"children":2402},{"className":2401},[],[2403],{"type":63,"value":2404},"max_entries 16384",{"type":63,"value":2406}," → the maximum number of key-value pairs the map can hold",{"type":58,"tag":162,"props":2408,"children":2409},{},[2410,2416],{"type":58,"tag":66,"props":2411,"children":2413},{"className":2412},[],[2414],{"type":63,"value":2415},"memlock 5397440B",{"type":63,"value":2417}," → the amount of pinned kernel memory reserved for this map (about ~5.15 MB)",{"type":58,"tag":162,"props":2419,"children":2420},{},[2421,2427,2429,2436],{"type":58,"tag":66,"props":2422,"children":2424},{"className":2423},[],[2425],{"type":63,"value":2426},"btf_id 490",{"type":63,"value":2428}," → the ",{"type":58,"tag":98,"props":2430,"children":2433},{"href":2431,"rel":2432},"https://docs.ebpf.io/concepts/btf/",[102],[2434],{"type":63,"value":2435},"BPF Type Format (BTF)",{"type":63,"value":2437}," ID associated with this map. We'll learn about BTF later on",{"type":58,"tag":2439,"props":2440,"children":2441},"hr",{},[],{"type":58,"tag":59,"props":2443,"children":2444},{},[2445],{"type":58,"tag":166,"props":2446,"children":2447},{},[2448,2450,2456],{"type":63,"value":2449},"❓ What about the second ",{"type":58,"tag":66,"props":2451,"children":2453},{"className":2452},[],[2454],{"type":63,"value":2455},".rodata",{"type":63,"value":2457}," eBPF map?",{"type":58,"tag":59,"props":2459,"children":2460},{},[2461],{"type":63,"value":2462},"We’ll dig into this in more detail later, but here’s the short answer.",{"type":58,"tag":59,"props":2464,"children":2465},{},[2466],{"type":63,"value":2467},"In eBPF, things work differently compared to normal C programs:",{"type":58,"tag":158,"props":2469,"children":2470},{},[2471,2484],{"type":58,"tag":162,"props":2472,"children":2473},{},[2474,2476,2482],{"type":63,"value":2475},"There’s no heap (so you can’t just ",{"type":58,"tag":66,"props":2477,"children":2479},{"className":2478},[],[2480],{"type":63,"value":2481},"malloc",{"type":63,"value":2483}," memory).",{"type":58,"tag":162,"props":2485,"children":2486},{},[2487],{"type":63,"value":2488},"You only have a small stack and some pointers into kernel space.",{"type":58,"tag":59,"props":2490,"children":2491},{},[2492,2494,2499,2501,2507,2509,2516],{"type":63,"value":2493},"To work around this,  ",{"type":58,"tag":166,"props":2495,"children":2496},{},[2497],{"type":63,"value":2498},"array maps",{"type":63,"value":2500}," are automatically created (during eBPF program loading) as a storage for global data. In our case, the data considered global is the string passed to the ",{"type":58,"tag":66,"props":2502,"children":2504},{"className":2503},[],[2505],{"type":63,"value":2506},"bpf_printk",{"type":63,"value":2508}," function, as explained in the ",{"type":58,"tag":98,"props":2510,"children":2513},{"href":2511,"rel":2512},"https://docs.ebpf.io/ebpf-library/libbpf/ebpf/bpf_printk/",[102],[2514],{"type":63,"value":2515},"documentation",{"type":63,"value":223},{"type":58,"tag":59,"props":2518,"children":2519},{},[2520],{"type":63,"value":2521},"We can confirm this using:",{"type":58,"tag":271,"props":2523,"children":2525},{"className":1779,"code":2524,"language":1781,"meta":276,"style":276},"sudo bpftool map dump id 305 # Update the ID according to your output\n",[2526],{"type":58,"tag":66,"props":2527,"children":2528},{"__ignoreMap":276},[2529],{"type":58,"tag":282,"props":2530,"children":2531},{"class":284,"line":285},[2532,2536,2540,2544,2548,2552,2557],{"type":58,"tag":282,"props":2533,"children":2534},{"style":295},[2535],{"type":63,"value":1835},{"type":58,"tag":282,"props":2537,"children":2538},{"style":474},[2539],{"type":63,"value":2016},{"type":58,"tag":282,"props":2541,"children":2542},{"style":474},[2543],{"type":63,"value":2021},{"type":58,"tag":282,"props":2545,"children":2546},{"style":474},[2547],{"type":63,"value":2245},{"type":58,"tag":282,"props":2549,"children":2550},{"style":474},[2551],{"type":63,"value":2250},{"type":58,"tag":282,"props":2553,"children":2554},{"style":301},[2555],{"type":63,"value":2556}," 305",{"type":58,"tag":282,"props":2558,"children":2559},{"style":680},[2560],{"type":63,"value":2260},{"type":58,"tag":271,"props":2562,"children":2566},{"className":2563,"code":2565,"language":63},[2564],"language-text","[{\n        \"value\": {\n            \".rodata\": [{\n                    \"handle_execve_tp.____fmt\": [101,120,101,99,118,101,58,32,37,115,10,0\n                    ]\n                }\n            ]\n        }\n    }\n]\n",[2567],{"type":58,"tag":66,"props":2568,"children":2569},{"__ignoreMap":276},[2570],{"type":63,"value":2565},{"type":58,"tag":59,"props":2572,"children":2573},{},[2574,2576,2582,2584,2590,2592,2597],{"type":63,"value":2575},"Where the sequence ",{"type":58,"tag":66,"props":2577,"children":2579},{"className":2578},[],[2580],{"type":63,"value":2581},"101,120,101,99,118,101,58,32,37,115,10,0",{"type":63,"value":2583}," is ASCII for ",{"type":58,"tag":66,"props":2585,"children":2587},{"className":2586},[],[2588],{"type":63,"value":2589},"execve: %s\\n",{"type":63,"value":2591},". Exactly the format string we provided to our ",{"type":58,"tag":66,"props":2593,"children":2595},{"className":2594},[],[2596],{"type":63,"value":2506},{"type":63,"value":2598}," function call.",{"type":58,"tag":59,"props":2600,"children":2601},{},[2602,2604,2609],{"type":63,"value":2603},"That's it for this tutorial - and no worries, we'll see a lot more of ",{"type":58,"tag":66,"props":2605,"children":2607},{"className":2606},[],[2608],{"type":63,"value":1984},{"type":63,"value":2610}," in the the next tutorial.",{"type":58,"tag":59,"props":2612,"children":2613},{},[2614,2616,2622],{"type":63,"value":2615},"If along the you encountered any issues, look inside the ",{"type":58,"tag":66,"props":2617,"children":2619},{"className":2618},[],[2620],{"type":63,"value":2621},"ebpf-hello-world/lab3",{"type":63,"value":2623}," folder for the complete solution.",{"type":58,"tag":567,"props":2625,"children":2627},{":summary":2626},"Legacy eBPF Maps",[2628,2640,2806],{"type":58,"tag":59,"props":2629,"children":2630},{},[2631,2633,2639],{"type":63,"value":2632},"Not to get confused, there is a legacy way of defining maps using the ",{"type":58,"tag":66,"props":2634,"children":2636},{"className":2635},[],[2637],{"type":63,"value":2638},"struct bpf_map_def type",{"type":63,"value":223},{"type":58,"tag":271,"props":2641,"children":2643},{"className":273,"code":2642,"filename":262,"language":275,"meta":276,"style":276},"struct bpf_map_def exec_count = {\n    .type = BPF_MAP_TYPE_HASH,\n    .key_size = sizeof(struct path_key),\n    .value_size = sizeof(int),\n    .max_entries = 16384,\n    .map_flags = BPF_F_NO_PREALLOC,\n} SEC(\"maps\");\n",[2644],{"type":58,"tag":66,"props":2645,"children":2646},{"__ignoreMap":276},[2647,2667,2684,2714,2743,2764,2781],{"type":58,"tag":282,"props":2648,"children":2649},{"class":284,"line":285},[2650,2654,2659,2663],{"type":58,"tag":282,"props":2651,"children":2652},{"style":320},[2653],{"type":63,"value":323},{"type":58,"tag":282,"props":2655,"children":2656},{"style":326},[2657],{"type":63,"value":2658}," bpf_map_def exec_count ",{"type":58,"tag":282,"props":2660,"children":2661},{"style":653},[2662],{"type":63,"value":981},{"type":58,"tag":282,"props":2664,"children":2665},{"style":326},[2666],{"type":63,"value":379},{"type":58,"tag":282,"props":2668,"children":2669},{"class":284,"line":307},[2670,2675,2679],{"type":58,"tag":282,"props":2671,"children":2672},{"style":326},[2673],{"type":63,"value":2674},"    .type ",{"type":58,"tag":282,"props":2676,"children":2677},{"style":653},[2678],{"type":63,"value":981},{"type":58,"tag":282,"props":2680,"children":2681},{"style":326},[2682],{"type":63,"value":2683}," BPF_MAP_TYPE_HASH,\n",{"type":58,"tag":282,"props":2685,"children":2686},{"class":284,"line":316},[2687,2692,2696,2701,2705,2709],{"type":58,"tag":282,"props":2688,"children":2689},{"style":326},[2690],{"type":63,"value":2691},"    .key_size ",{"type":58,"tag":282,"props":2693,"children":2694},{"style":653},[2695],{"type":63,"value":981},{"type":58,"tag":282,"props":2697,"children":2698},{"style":320},[2699],{"type":63,"value":2700}," sizeof",{"type":58,"tag":282,"props":2702,"children":2703},{"style":326},[2704],{"type":63,"value":471},{"type":58,"tag":282,"props":2706,"children":2707},{"style":320},[2708],{"type":63,"value":323},{"type":58,"tag":282,"props":2710,"children":2711},{"style":326},[2712],{"type":63,"value":2713}," path_key),\n",{"type":58,"tag":282,"props":2715,"children":2716},{"class":284,"line":332},[2717,2722,2726,2730,2734,2738],{"type":58,"tag":282,"props":2718,"children":2719},{"style":326},[2720],{"type":63,"value":2721},"    .value_size ",{"type":58,"tag":282,"props":2723,"children":2724},{"style":653},[2725],{"type":63,"value":981},{"type":58,"tag":282,"props":2727,"children":2728},{"style":320},[2729],{"type":63,"value":2700},{"type":58,"tag":282,"props":2731,"children":2732},{"style":326},[2733],{"type":63,"value":471},{"type":58,"tag":282,"props":2735,"children":2736},{"style":320},[2737],{"type":63,"value":880},{"type":58,"tag":282,"props":2739,"children":2740},{"style":326},[2741],{"type":63,"value":2742},"),\n",{"type":58,"tag":282,"props":2744,"children":2745},{"class":284,"line":352},[2746,2751,2755,2759],{"type":58,"tag":282,"props":2747,"children":2748},{"style":326},[2749],{"type":63,"value":2750},"    .max_entries ",{"type":58,"tag":282,"props":2752,"children":2753},{"style":653},[2754],{"type":63,"value":981},{"type":58,"tag":282,"props":2756,"children":2757},{"style":301},[2758],{"type":63,"value":2104},{"type":58,"tag":282,"props":2760,"children":2761},{"style":326},[2762],{"type":63,"value":2763},",\n",{"type":58,"tag":282,"props":2765,"children":2766},{"class":284,"line":361},[2767,2772,2776],{"type":58,"tag":282,"props":2768,"children":2769},{"style":326},[2770],{"type":63,"value":2771},"    .map_flags ",{"type":58,"tag":282,"props":2773,"children":2774},{"style":653},[2775],{"type":63,"value":981},{"type":58,"tag":282,"props":2777,"children":2778},{"style":326},[2779],{"type":63,"value":2780}," BPF_F_NO_PREALLOC,\n",{"type":58,"tag":282,"props":2782,"children":2783},{"class":284,"line":369},[2784,2789,2793,2797,2802],{"type":58,"tag":282,"props":2785,"children":2786},{"style":326},[2787],{"type":63,"value":2788},"} ",{"type":58,"tag":282,"props":2790,"children":2791},{"style":295},[2792],{"type":63,"value":466},{"type":58,"tag":282,"props":2794,"children":2795},{"style":326},[2796],{"type":63,"value":471},{"type":58,"tag":282,"props":2798,"children":2799},{"style":474},[2800],{"type":63,"value":2801},"\"maps\"",{"type":58,"tag":282,"props":2803,"children":2804},{"style":326},[2805],{"type":63,"value":416},{"type":58,"tag":59,"props":2807,"children":2808},{},[2809],{"type":63,"value":2810},"The major downside of this \"method\" is that key and value type information is lost, which is why it was replaced.",{"type":58,"tag":59,"props":2812,"children":2813},{},[2814],{"type":63,"value":2815},"Congrats, you've came to the end of this tutorial. 🥳",{"type":58,"tag":59,"props":2817,"children":2818},{},[2819,2821,2828],{"type":63,"value":2820},"In the ",{"type":58,"tag":98,"props":2822,"children":2825},{"href":2823,"rel":2824},"https://labs.iximiuz.com/tutorials/inspecting-ebpf-using-bpftool-43dfa319",[102],[2826],{"type":63,"value":2827},"next tutorial",{"type":63,"value":2829},", you’ll learn how to inspect eBPF programs and maps loaded into the kernel with bpftool, and monitor their activity with bpftop.",{"type":58,"tag":2831,"props":2832,"children":2833},"style",{},[2834],{"type":63,"value":2835},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}",["Reactive",35],{"title":276,"searchDepth":307,"depth":307,"links":2838},[2839,2840,2841],{"id":148,"depth":307,"text":151},{"id":1768,"depth":307,"text":1771},{"id":1959,"depth":307,"text":1962},["Reactive",2843],{},["Reactive",2845],{},["Reactive",2847],{},"#ebpf-maps-tutorial-3efd4617-server",{"left":39,"top":39,"width":1257,"height":1257,"rotate":39,"vFlip":2850,"hFlip":2850,"body":2851},false,"\u003Cpath fill=\"currentColor\" d=\"M6 18v-5h1v4h4v1zm11-7V7h-4V6h5v5z\"/>",{"left":39,"top":39,"width":2853,"height":2853,"rotate":39,"vFlip":2850,"hFlip":2850,"body":2854},256,"\u003Cpath fill=\"currentColor\" d=\"M216 32H88a8 8 0 0 0-8 8v40H40a8 8 0 0 0-8 8v128a8 8 0 0 0 8 8h128a8 8 0 0 0 8-8v-40h40a8 8 0 0 0 8-8V40a8 8 0 0 0-8-8m-56 176H48V96h112Zm48-48h-32V88a8 8 0 0 0-8-8H96V48h112Z\"/>",["Reactive",2856],{"$scurrentUser":2857,"$salerts":2861,"$scontentToggle":2862,"$ssite-config":2863},{"id":2858,"anonymous":11,"effectiveTier":2859,"hasEmailSubscription":2850},"697b5f64cc8f8f56faac74e1",{"name":2860},"free",[],{"/tutorials/ebpf-maps-tutorial-3efd4617":11},{"_priority":2864,"env":2867,"name":2868,"url":2869},{"name":2865,"env":2866,"url":39},-3,-15,"production","iximiuz Labs","https://labs.iximiuz.com",["Set"],["ShallowReactive",2872],{"tutorial-page-tutorial-ebpf-maps-tutorial-3efd4617":-1,"content-tutorial-ebpf-maps-tutorial-3efd4617-v1760554309428":-1,"tutorial-page-play-none":-1,"i-material-symbols-light:expand-content":-1,"i-ph:copy":-1},"/tutorials/ebpf-maps-tutorial-3efd4617"]</script></body></html>